<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Concepts Guide: Concepts Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Concepts Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title"></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<img src="infa_logo.png" width="400" height="138" alt="Informatica"/><br/><br/>
<big><b>Ultra Messaging</b></big> <small>(Version 6.17)</small><br/>
<br/><br/><br/>
<center class="mytitle">Concepts Guide</center>
<br/><br/><br/>
[&nbsp;<a href="../index.html">Multi-page HTML</a>&nbsp;]&nbsp;&nbsp;|&nbsp;&nbsp;[&nbsp;<a href="../Concepts_Guide=en.pdf">PDF</a>&nbsp;]
<br/><br/>
 </p>
<h1><a class="anchor" id="firstsect"></a>
Introduction&nbsp;&nbsp;<small><a href="#firstsect">&lt;-</a></small></h1>
<p>This document introduces the basic concepts and design approaches used by Ultra Messaging (UM).</p>
<p>For policies and procedures related to Ultra Messaging Technical Support, see <a href="https://ultramessaging.github.io/UM_Support.html">UM Support</a>.</p>
<p><b>(C) Copyright 2004,2025 Informatica Inc. All Rights Reserved.</b></p>
<p>This software and documentation are provided only under a separate license agreement containing restrictions on use and disclosure. No part of this document may be reproduced or transmitted in any form, by any means (electronic, photocopying, recording or otherwise) without prior consent of Informatica LLC.</p>
<p>A current list of Informatica trademarks is available on the web at <a href="https://www.informatica.com/trademarks.html">https://www.informatica.com/trademarks.html</a>.</p>
<p>Portions of this software and/or documentation are subject to copyright held by third parties. Required third party notices are included with the product.</p>
<p>This software is protected by patents as detailed at <a href="https://www.informatica.com/legal/patents.html">https://www.informatica.com/legal/patents.html</a>.</p>
<p>The information in this documentation is subject to change without notice. If you find any problems in this documentation, please report them to us in writing at Informatica LLC 2100 Seaport Blvd. Redwood City, CA 94063.</p>
<p>Informatica products are warranted according to the terms and conditions of the agreements under which they are provided. <br />
INFORMATICA LLC PROVIDES THE INFORMATION IN THIS DOCUMENT "AS IS" WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING WITHOUT ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND ANY WARRANTY OR CONDITION OF NON-INFRINGEMENT.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="fundamentalconcepts"></a>
Fundamental Concepts&nbsp;&nbsp;<small><a href="#fundamentalconcepts">&lt;-</a></small></h1>
<p>Ultra Messaging is a software layer, supplied in the form of a dynamic library (shared object), which provides applications with message delivery functionality that adds considerable value to the basic networking services contained in the host operating system. The UMP and UMQ products also include a "Store" daemon that implements Persistence. The UMQ product also includes a "broker" daemon that implements Brokered Queuing.</p>
<p>See <a class="el" href="index.html#umglossary">UM Glossary</a> for Ultra Messaging terminology, abbreviations, and acronyms.</p>
<p>Ultra Messaging is supported on a variety of platforms. There are three general categories of supported platforms: </p><ul>
<li>
Core platforms: Linux, Windows, Solaris. These are built and shipped every release of UM. </li>
<li>
On-demand Platforms: AIX, HP-UX, Stratus (VOS), HP-NonStop (OSS), OpenVMS. These are only built and shipped by request from users. </li>
<li>
VM and Containers: UM can run in virtualized environments, including containers and VMs. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/virtualizedenvironments.html">Virtualized Environments</a> </li>
</ul>
<p>In addition, Darwin (Mac OS) is supported (on demand) for development and test purposes. We do not support Darwin for production.</p>
<dl class="section note"><dt>Note</dt><dd>There are many different distributions of Linux and many different releases of all operating systems. Informatica does not certify UM on specific distributions or versions of operating systems. We do keep our test lab current and test on recent versions of the Core platforms. And we support users on the OS versions that they use in production. But we do not formally certify.</dd></dl>
<p>Applications access Ultra Messaging features through the Ultra Messaging Application Programming Interface (API). Ultra Messaging includes the following APIs: the UM C API, the UM Java API, and the UM .NET API. For details on these APIs, see: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/index.html#umcapi">UM C API</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/index.html#umjavaapi">UM Java API</a> </li>
<li>
<a href="../../DotNetAPI/index.html#umnetapi">UM .NET API</a> </li>
</ul>
<p>These APIs are very similar, and for the most part, this document concentrates on the C API. The translation from C functions to Java or .NET methods should be reasonably straightforward; see <a href="../../QuickStart/index.html">Quick Start Guide</a> for sample applications in C, Java, and .NET. See also <a href="../../example/index.html">C Example Source Code</a>, <a href="../../java_example/index.html">Java Example Source Code</a>, and <a href="../../dotnet_example/index.html">C# Example Source Code</a>.</p>
<p>The UMQ product also supports the JMS API via the ActiveMQ broker.</p>
<p>The UM product is highly configurable to allow optimization over a wide variety of use cases. See <a class="el" href="index.html#configurationintroduction">Configuration Introduction</a> for more information.</p>
<p>The three most important design goals of Ultra Messaging are to minimize message latency (the time that a given message spends "in transit"), maximize throughput, and ensure delivery of all messages under a wide variety of operational and failure scenarios. Ultra Messaging achieves these goals by not duplicating services provided by the underlying network whenever possible. Instead of implementing special messaging servers and daemons to receive and re-transmit messages, Ultra Messaging routes messages primarily with the network infrastructure at wire speed. Placing little or nothing in between the sender and receiver is an important and unique design principle of Ultra Messaging.</p>
<p>A UM application can function as a publisher (sometimes call a "source"), or a subscriber (sometimes called a "receiver"). A publishing application sends messages, and a subscribing application receives them. (It is also common for an application to function as both publisher and subscriber; we separate the concepts for organizational purposes.)</p>
<p><br />
 </p>
<h2><a class="anchor" id="licensekey"></a>
License Key&nbsp;&nbsp;<small><a href="#licensekey">&lt;-</a></small></h2>
<p>Before you can use UM, you must obtain a valid license key. A license key comes in two forms: a file and a string.</p>
<p>A license key file is a normal text file containing 4 lines. For example: </p><pre class="fragment">Product=UME,UMQ,LBM,UMDRO
Organization=My Company
Expiration-Date=never
License-Key=xxxx xxxx xxxx xxxx
</pre><p>A license key string is a single line of normal text which combines the above 4 lines, separated by colons. For example: </p><pre class="fragment">Product=UME,UMQ,LBM,UMDRO:Organization=My Company:Expiration-Date=never:License-Key=xxxx xxxx xxxx xxxx
</pre><p>The key (file or string) can be supplied to UM in two different ways: XML configuration file and environment.</p>
<p><br />
 </p>
<h3><a class="anchor" id="licenseviaxmlconfigurationfile"></a>
License Via XML Configuration File&nbsp;&nbsp;<small><a href="#licenseviaxmlconfigurationfile">&lt;-</a></small></h3>
<p>If you use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html">XML Configuration Files</a> to configure the UM library, you can specify a license key file using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html#umelementlicense">UM Element "&lt;license&gt;"</a> with format="filename". For example: </p><pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;um-configuration version="1.0"&gt;
  &lt;license format="filename"&gt;my_um_license.txt&lt;/license&gt;
...
</pre><p>Alternatively, you can supply the license information as a string in the XML with format="string": </p><pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;um-configuration version="1.0"&gt;
  &lt;license format="string"&gt;
    Product=UME,UMQ,LBM,UMDRO:Organization=My Company:Expiration-Date=never:License-Key=xxxx xxxx xxxx xxxx
  &lt;/license&gt;
...
</pre><p>Note that you cannot supply a license key in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/plaintextconfigurationfiles.html">Plain Text Configuration Files</a> ("flat" files). See <a class="el" href="index.html#licenseviaenvironment">License Via Environment</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="licenseviaenvironment"></a>
License Via Environment&nbsp;&nbsp;<small><a href="#licenseviaenvironment">&lt;-</a></small></h3>
<p>You can specify a license key file using the environment variable <code>LBM_LICENSE_FILENAME</code>. For example: </p><pre class="fragment">export LBM_LICENSE_FILENAME="my_um_license.txt"
</pre><p>Alternatively, you can supply a license information as a string in the environment variable <code>LBM_LICENSE_INFO</code>. For example: </p><pre class="fragment">export LBM_LICENSE_INFO="Product=UME,UMQ,LBM,UMDRO:Organization=My Company:Expiration-Date=never:License-Key=xxxx xxxx xxxx xxxx"
</pre><p><br />
 </p>
<h2><a class="anchor" id="messagingparadigms"></a>
Messaging Paradigms&nbsp;&nbsp;<small><a href="#messagingparadigms">&lt;-</a></small></h2>
<p>UM supports three basic messaging paradigms (sometimes called Quality Of Service, or QOS): </p><ul>
<li>
<a class="el" href="index.html#streaming">Streaming</a>. </li>
<li>
<a class="el" href="index.html#persistence">Persistence</a>. </li>
<li>
<a class="el" href="index.html#queuing">Queuing</a>. </li>
</ul>
<p>Sometimes people equate those paradigms with the UM product names "UMS", "UMP", and "UMQ". But this is not accurate. The UMP product supports both streaming and persistence. You can write streaming applications with UMP. The UMQ product supports streaming, persistence, and queuing. You can write streaming or persistent applications with UMQ.</p>
<p><br />
 </p>
<h3><a class="anchor" id="streaming"></a>
Streaming&nbsp;&nbsp;<small><a href="#streaming">&lt;-</a></small></h3>
<p>The UMS, UMP, and UMQ products support "Streaming" as their basic messaging paradigm. With Streaming, messages are sent directly from publisher to subscriber (no broker). A subscriber to a given topic joins the data stream of a publisher of that topic to receive messages. Messages sent during times that the subscriber is not joined are generally not available to the subscriber (live-only), although see <a class="el" href="index.html#latejoin">Late Join</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="persistence"></a>
Persistence&nbsp;&nbsp;<small><a href="#persistence">&lt;-</a></small></h3>
<p>The UMP and UMQ products support <a class="el" href="index.html#streaming">Streaming</a> and Persistence messaging paradigms. Persistence, sometimes called "durable" or "guaranteed" messages, saves messages sent by a publisher in non-volatile storage so that subscribers can recover missed messages under a variety of failure scenarios. If multiple subscribers exist for the same topic, each subscriber will get all messages sent by the publisher.</p>
<p>Persistence includes a component known as the persistent Store, which provides stable storage (disk or memory) of message streams.</p>
<p>UM delivers persisted messages from publisher to subscriber with very low latency by using the same technology as <a class="el" href="index.html#streaming">Streaming</a>. This offers the functionality of durable subscriptions and confirmed message delivery.</p>
<p>(FYI - you will see references to "UME" in the configuration and APIs for persistence. "UME" is an earlier abbreviation for "UMP".)</p>
<p>For full details on UM Persistence, see the <a href="../../UME/index.html">UM Guide for Persistence</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="queuing"></a>
Queuing&nbsp;&nbsp;<small><a href="#queuing">&lt;-</a></small></h3>
<p>The UMQ product supports <a class="el" href="index.html#streaming">Streaming</a>, <a class="el" href="index.html#persistence">Persistence</a>, and Queuing messaging paradigms. Queuing supports "load balancing" whereby published messages can be distributed across a set of subscribers such each message is only handled by one of the subscribers.</p>
<p>UMQ supports both Brokered queuing (where the Queue is a separate component which can store messages independent of the source and receiver), and Ultra Load Balancing (ULB), where the Queue is memory-based and resides in the source.</p>
<p>For full details on UM Queuing, see the <a href="../../UMQ/index.html">UM Guide to Queuing</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="messages"></a>
Messages&nbsp;&nbsp;<small><a href="#messages">&lt;-</a></small></h2>
<p>The primary function of UM is to transport application messages from a publisher to one or more subscribers. For the purposes of UM, a message is a sequence of bytes, the parsing and interpretation of which is the responsibility of the application.</p>
<p>Since UM does not parse or interpret the messages, UM cannot reformat messages for architectural differences in a heterogeneous environment. For example, UM does not do byte-swapping between big and little endian CPUs.</p>
<p>However, there are some specific exceptions to this rule: </p><ul>
<li>
The <a class="el" href="index.html#selfdescribingmessaging">Self Describing Messaging</a> feature is a separate library that allows the construction and parsing of structured messages as arbitrary name/value pairs. </li>
<li>
The <a class="el" href="index.html#predefinedmessages">Pre-Defined Messages</a> feature is another separate library that allows the construction and parsing of structured messages. </li>
<li>
The <a class="el" href="index.html#messageproperties">Message Properties</a> feature allows the setting of structured metadata which is sent along with an application message. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="messageintegrity"></a>
Message Integrity&nbsp;&nbsp;<small><a href="#messageintegrity">&lt;-</a></small></h3>
<p>To minimize latency and CPU overhead, UM relies on the Operating System and the Network equipment to ensure the integrity of message data. That is, UM does not add a checksum or digital signature to detect message corruption. Modern network hardware implements very reliable CRCs.</p>
<p>However, we have encountered a case of a microwave-based link that apparently did not use a strong error detection method. This user reported occasional packet corruptions.</p>
<p>We also encountered a situation where an Operating System and a network interface card were configured in an unusual way which led to reproducible undetected packet corruption.</p>
<p>Users who wish to reduce the possibility of message corruption to near-zero will want to implement some sort of message checksum or digital signature outside of UM. (<a class="el" href="index.html#messageproperties">Message Properties</a> could be used to carry the checksum or signature.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="messagemetadata"></a>
Message Metadata&nbsp;&nbsp;<small><a href="#messagemetadata">&lt;-</a></small></h3>
<p>It is sometimes useful for applications to send a message with additional metadata associated with the message. This metadata could be simply added to the message itself, but it is sometimes preferred that the metadata be separated from the message data.</p>
<p>For example, some organizations wrap UM in their own messaging middleware layer that provides a rich set of domain-specific functionality to their applications. This domain-specific functionality allows applications to be written more easily and quickly. However, that layer may need to add its own state-maintenance information which is independent from the application's message data. This middleware data can be supplied either as metadata attached to the message, or as separate non-application messages which are tagged with metadata. (The latter approach is often preferred when application messages must be sent with the minimum possible latency and overhead; adding metadata to a message adds processing overhead, so sending application messages without metadata is the most efficient.)</p>
<p>There are two different UM features that allow adding metadata to messages: </p><ul>
<li>
<a class="el" href="index.html#messageproperties">Message Properties</a> - a general system of typed name/value pairs. </li>
<li>
<a class="el" href="index.html#applicationheaders">Application Headers</a> - an older (deprecated) system of attaching small binary values. </li>
</ul>
<p>Informatica generally recommends the use of Message Properties over Application headers.</p>
<p><br />
 </p>
<h2><a class="anchor" id="topicstructureandmanagement"></a>
Topic Structure and Management&nbsp;&nbsp;<small><a href="#topicstructureandmanagement">&lt;-</a></small></h2>
<p>UM offers the Publish/Subscribe model for messaging ("Pub/Sub"), whereby one or more receiver programs express interest in a topic ("subscribe"), and one or more source programs send to that topic ("publish"). So, a topic can be thought of as a data stream that can have multiple producers and multiple consumers. One of the functions of the messaging layer is to make sure that all messages sent to a given topic are distributed to all receivers listening to that topic. So another way of thinking of a topic is as a generalized destination identifier - a message is sent "to" a topic, and all subscribers receive it. UM accomplishes this through an automatic process known as topic resolution.</p>
<p>(There is an exception to this Publish/Subscribe model; see <a class="el" href="index.html#immediatemessaging">Immediate Messaging</a>.)</p>
<p>A topic is just an arbitrary string. For example:</p>
<pre class="fragment">Orders
Market/US/DJIA/Sym1
</pre><p>It is not unusual for an application system to have many thousands of topics, perhaps even more than a million, with each one carrying a very specific range of information (e.g. quotes for a single stock symbol).</p>
<p>It is also possible to configure receiving programs to match multiple topics using wildcards. UM uses powerful regular expression pattern matching to allow applications to match topics in a very flexible way. Messages cannot be <em>sent</em> to wildcarded topic names. See <a class="el" href="index.html#umwildcardreceivers">UM Wildcard Receivers</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="messageordering"></a>
Message Ordering&nbsp;&nbsp;<small><a href="#messageordering">&lt;-</a></small></h3>
<p>UM normally ensures that received messages are delivered to the application in the same order as they were sent. However, this only applies to a specific topic from a single publisher. UM does not guarantee to retain order across different topics, even if those topics are carried on the same <a class="el" href="index.html#transportsessions">Transport Session</a>. It also does not guarantee order within the same topic across different publishers. For users that need to retain order between different topics from a single publisher, see <a class="el" href="index.html#spectrum">Spectrum</a>.</p>
<p>Alternatively, it is possible to enforce cross-topic ordering in a very restrictive use case: </p><ul>
<li>
The topics are from a single publisher (context), </li>
<li>
The topics are mapped to the same <a class="el" href="index.html#transportsessions">transport session</a>, </li>
<li>
The Transport Session is configured for <a class="el" href="index.html#transporttcp">TCP</a> (receiver-paced), <a class="el" href="index.html#transportlbtipc">IPC</a> (receiver-paced), or <a class="el" href="index.html#transportlbtsmx">SMX</a>, </li>
<li>
The subscriber is in the same <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a> (TRD) as the publisher (no DRO in the data path), </li>
<li>
The messages being received are "live" - not being recovered from <a class="el" href="index.html#latejoin">Late Join</a>, <a class="el" href="index.html#offtransportrecoveryotr">OTR</a>, or Persistence, </li>
<li>
The subscriber is not participating in Queuing, </li>
<li>
The subscriber is not using <a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="topicresolutionoverview"></a>
Topic Resolution Overview&nbsp;&nbsp;<small><a href="#topicresolutionoverview">&lt;-</a></small></h3>
<p>Topic Resolution ("TR") is a set of protocols and algorithms used internally by Ultra Messaging to establish and maintain shared state. Here are the basic functions of TR:</p>
<ul>
<li>
Receiver discovery of sources. </li>
<li>
DRO routing information distribution. </li>
<li>
Persistent Store name resolution. </li>
<li>
Fault tolerance. </li>
</ul>
<p>For more information, see <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="topicresolutiondomain"></a>
Topic Resolution Domain&nbsp;&nbsp;<small><a href="#topicresolutiondomain">&lt;-</a></small></h3>
<p>A "Topic Resolution Domain" (TRD) is a set of applications and UM components which share the same Topic Resolution configuration and therefore participate in the TR protocols with each other. The key characteristic of a TRD is that all UM instances communicate directly with each other.</p>
<p>In small deployments of UM, a single TRD is all that is needed.</p>
<p>For larger deployments, especially deployments that are geographically separated with bandwidth-limited WAN links, the deployment is usually divided into multiple TRDs. Each TRD uses a different TR configuration, such that the applications in one TRD don't communicate directly applications in another TRD. The DRO is used to interconnect TRDs and provide connectivity between TRDs.</p>
<p>For more information, see <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="messagingreliability"></a>
Messaging Reliability&nbsp;&nbsp;<small><a href="#messagingreliability">&lt;-</a></small></h2>
<p>Users of a messaging system expect every sent message to be successfully received and processed by the appropriately subscribed receivers with the lowest possible latency, 100% of the time. However, this would require perfect networks and computers that can handle unlimited load at infinite speed with complete reliability. Real world networks, computers, and software systems have limitations and are subject to overload and failure, which can lead to message loss.</p>
<p>One job of a messaging system is to detect lost messages and take additional steps to arrange their successful recovery. But again, the limits of hardware and software robustness can make 100% reliability impractical. Part of UM's power is to give the user tools to make intelligent trade-offs between reliability and other important factors, like memory consumption, delivery latencies, hardware redundancies, etc.</p>
<p><br />
 </p>
<h3><a class="anchor" id="unrecoverableloss1"></a>
Unrecoverable Loss&nbsp;&nbsp;<small><a href="#unrecoverableloss1">&lt;-</a></small></h3>
<p>There are two important concepts when talking about loss: </p><ul>
<li>
Simple Loss - usually a case of lost packets due to an overloaded component. UM can be configured in a variety of ways to recover simple loss. </li>
<li>
Unrecoverable Loss - usually a case where a user-configured constraint has been exceeded and the messaging system has to give up trying to recover the lost data. </li>
</ul>
<p>Simple loss is undesirable, even if the messaging system is able to recover the loss. Any recovery mechanism adds delay to the ultimate delivery of the message, and most uses have limits on the amount of time they are willing to wait for recovery. For example, consider a network hardware outage that takes 10 minutes to repair. A user might have a 5 minutes limit on the age of a message. Thus, the user would like messages sent during the first 5 minutes of the 10-minute outage to simply be declare unrecoverable. Messages sent during the last 5 minutes should be recovered and delivered.</p>
<p>However, when the messaging layer gives up trying to recover messages, it is important for the application software to be informed of this fact. UM delivers unrecoverable loss <em>events</em> to the application followed by subsequent messages successfully received. Applications can use those unrecoverable loss events to take corrective action, like informing the end user, and possibly initiating a re-synchronization operation between distributed components.</p>
<p>Obviously unrecoverable loss is considered a serious event. However, even simple loss should be monitored by users. Daily data rates tend to increase over time. A "clean" network this month might have overload-related simple loss next month, which might progress to unrecoverable loss the month after that.</p>
<p>UM does not deliver specific events to the application when simple loss is detected and successfully recovered. Instead, users have a variety of tools at their disposal to monitor UM transport statistics, which includes counters for simple loss. Applications themselves can use the UM API to "self-monitor" and alert end users when simple loss happens. Or external monitoring applications can be written to receive transport statistics from many applications, and provide a central point where small problems can be detected and dealt with before they become big problems.</p>
<p>See <a class="el" href="index.html#packetloss">Packet Loss</a> for an extended discussion of packet loss and how UM deals with it.</p>
<p>There are some special cases of unrecoverable loss that deserve additional description: </p><ul>
<li>
<a class="el" href="index.html#headloss">Head Loss</a> </li>
<li>
<a class="el" href="index.html#leadingloss">Leading Loss</a> </li>
<li>
<a class="el" href="index.html#tailloss">Tail Loss</a> </li>
<li>
<a class="el" href="index.html#burstloss1">Burst Loss</a> </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="headloss"></a>
Head Loss&nbsp;&nbsp;<small><a href="#headloss">&lt;-</a></small></h3>
<p>When an application wants to publish messages, it creates one or more <em>UM sources</em> for topics. The design of UM is such that a subscriber <em>discovers</em> the sources of interest and <em>joins</em> them. The process of receivers discovering and joining sources (in UM it is called "Topic Resolution") takes a non-zero amount of time. Since UM is a fully-distributed system with no central master broker, the publisher has no way of knowing when the subscribers have completed the discovery/join process. As a result, it is possible for a publisher to create its sources and send messages, and some of those messages might not reach all of the subscribed receivers.</p>
<p>For many UM-based applications, this is not a problem. Consider a market data distribution system. The market data is a continuous stream of updates with no beginning or end. When a receiver joins, it has no expectation to get the "first" message; it joins at an arbitrary point in the stream and starts getting messages from that point.</p>
<p>But there are other applications where a sender comes up and wants to send a request to a pre-existing receiver. In this case, the sender is very interested in avoiding head loss so that the receiver will get the request.</p>
<p>UM's <a class="el" href="index.html#persistence">Persistence</a> feature does a rigorous job of recovering from head loss. UM's <a class="el" href="index.html#latejoin">Late Join</a> feature is sometimes used by streaming receivers to recover from head loss, although it requires care in the case of a receiver restart since late join can also delivery duplicate messages.</p>
<p><br />
 </p>
<h3><a class="anchor" id="leadingloss"></a>
Leading Loss&nbsp;&nbsp;<small><a href="#leadingloss">&lt;-</a></small></h3>
<p>The behavior described in this section does not apply to Persisted data streams where delivery of all messages is important.</p>
<p>For Streaming (non-persisted) data streams, once a receiver successfully joins a source, it should start getting messages. However, there are some circumstances which interfere with the initial message reception.</p>
<p>For example, if a sender is sending a series of very large messages, those messages are <a class="el" href="index.html#glossaryumfragmentation">fragmented</a>, broken into smaller pieces and sent serially. If a receiver joins the message stream after the first message of a large message has already gone by, the receiver will no longer be able to successfully reassemble that first message. In UM versions prior to 6.12, this led to delivery of one or more Unrecoverable Loss events to the application receiver callback prior to delivery of the first successfully-received message.</p>
<p>Some users attempt to use the <a class="el" href="index.html#latejoin">Late Join</a> feature to avoid this problem, but the Late Join feature depends on a circular buffer of message fragments. Requesting Late Join may well recover the initial fragment of the message currently under transmission, but it might also recover the final fragments of the message before that. That leads to an unrecoverable loss event for that previous message.</p>
<p>As a final example, suppose that a receiver joins a source during a period of severe overload leading to packet loss. The receiver may not be able to get a full message until the overload condition subsides. This can deliver one or more unrecoverable loss events prior to the first successfully delivered message.</p>
<p>In all of these examples, UM has either gotten no messages or incomplete messages during the startup phase of a new receiver. Starting in UM version 6.12, UM will not deliver unrecoverable loss events to the application in these cases. Once UM is able to successfully deliver its first message to a receiver, UM will enable the delivery of unrecoverable loss events.</p>
<p>This matches what most programmers want to see. They are not interested in messages that came before their first, but they are interested in any gaps that happen after that first message.</p>
<p>Be aware that pre-6.12 versions of UM <em>do</em> deliver leading unrecoverable loss events to the application under some circumstances, leading application developers to implement their own filter for those leading events. Those applications can safely upgrade to 6.12 or beyond; their filter will simply never be executed since UM filters the leading events first.</p>
<p>Finally, remember that it is important for UM-based systems to be monitored for transport statistics, including loss. Since leading unrecoverable loss events are now suppressed (and even pre-6.12 were not reliably delivered in all cases), the transport stats should be used to determine the "health" of the network.</p>
<dl class="section note"><dt>Note</dt><dd>Persisted receivers should not suppress leading unrecoverable loss. However, this behavior was mistakenly applied to persisted receivers in UM version 6.12 - 6.16.1 (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/changelog.tag:../../ChangeLog/" href="../../ChangeLog/umversion6_17.html#bug11338">bug 11338</a>). Starting in UM version 6.17, the leading loss suppression behavior has been removed from persisted receivers.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="tailloss"></a>
Tail Loss&nbsp;&nbsp;<small><a href="#tailloss">&lt;-</a></small></h3>
<p>Packet loss is a fact of life. Temporary overloads of network hardware can lead to dropped packets. UM receivers are designed to recover those lost packets from the sender, but that recovery takes greater than zero time.</p>
<p>Suppose a application has some messages to send, and then exits. You could have a situation where the last message sent fell victim to a network drop. If the publisher exits immediately, the receivers may not have had enough time to recover the lost packets; may not even have detected the loss.</p>
<p>If the delivery of those tail messages is important, UM's persistence functionality should be used. A sender should delay its exit until the persistence layer informs it that all messages are "stable".</p>
<p>Non-persistent applications can implement an application-level handshake where the receivers tell the senders that they have successfully processed the final message.</p>
<p>Sometimes, delivery of the final message is not of critical importance. In that case, some application developers choose to simply introduce a delay of a second or two after the last message is sent before the sources are deleted. This will give UM a chance to detect and recover any lost messages.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/interrelatedconfigurationoptions.html#preventingnakstormswithnakintervals">Preventing NAK Storms with NAK Intervals</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/interrelatedconfigurationoptions.html#preventingundetectedloss">Preventing Undetected Unrecoverable Loss</a> for configuration details related to tail loss.</p>
<p><br />
 </p>
<h3><a class="anchor" id="burstloss1"></a>
Burst Loss&nbsp;&nbsp;<small><a href="#burstloss1">&lt;-</a></small></h3>
<p>UM's "burst loss" feature is no longer recommended. All known use cases for the burst loss feature are better accomplished through other means. For example, controlling latency after loss should be done using NAK-related and OTR-related configuration options. Informatica recommends disabling the burst loss feature by setting the configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#deliverycontrolmaximumburstlossreceiver">delivery_control_maximum_burst_loss (receiver)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html#deliverycontrolmaximumburstlosshfx">delivery_control_maximum_burst_loss (hfx)</a> to 1,000,000,000.</p>
<p>When setting the burst loss options, be sure to include all subscribers, including all instances of UM Stores, DROs, and UMDS servers.</p>
<p>This is especially important for persistent receivers and Stores.</p>
<p><b>Feature Description</b></p>
<p>Normally, when the <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> detects a gap in topic sequence numbers of received message fragments, it waits for a NAK generation interval (defaults to 10 seconds) before declaring the missing message fragments unrecoverably lost. This wait time allows the underlying transport layer to attempt to retrieve the missing message fragments.</p>
<p>The configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#deliverycontrolmaximumburstlossreceiver">delivery_control_maximum_burst_loss (receiver)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html#deliverycontrolmaximumburstlosshfx">delivery_control_maximum_burst_loss (hfx)</a> specify a size for a contiguous gap in topic sequence numbers beyond which the gap is defined to be a "burst loss". When this happens, the delivery controller <em>immediately</em> declares the entire gap to be unrecoverably lost and resets its loss-handling structures.</p>
<p>Note that the burst loss feature does not reduce NAKs and retransmissions. If burst loss is invoked, the underlying transport layer will still attempt to recover the lost messages. NAK-based protocols will continue to send NAKs and retransmissions. However, the delivery controller will discard any successfully recovered messages because they were already declared unrecoverable as part of the burst loss event.</p>
<p>For burst loss, a single <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6629139aaf902976c8df9de3f37d10db">LBM_MSG_UNRECOVERABLE_LOSS_BURST</a> event is delivered for the entire sequence number gap. Contrast this with simple (not burst) loss events, where a separate <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a88920e0a4188081f9a14fc8f76c18578">LBM_MSG_UNRECOVERABLE_LOSS</a> event will be delivered to the receiver for each lost sequence number.</p>
<dl class="section note"><dt>Note</dt><dd>The burst loss control takes priority over all recovery methods. For example, if the subscriber is receiving persistent data and OTR is enabled, a gap longer than delivery_control_maximum_burst_loss will immediately declare the gap as unrecoverable without trying to use OTR to recover.</dd></dl>
<p>Finally, be aware that successfully-received but buffered messages can be discarded when a burst loss is detected. For example, let's say that topic sequence number 10 is lost, and number 11 through 30 are successfully received. Datagrams 11 through 30 will be buffered, awaiting datagram 10 being retransmitted. But if the next topic sequence number is 1055, that exceeds the burst loss threshold, which clears the entire order map, discarding messages 11 through 30. The application sees message 9, followed by a burst loss notification, followed by message 1055.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umsoftwarestack"></a>
UM Software Stack&nbsp;&nbsp;<small><a href="#umsoftwarestack">&lt;-</a></small></h2>
<p>Here is a simplified diagram of the software stack:</p>
<div class="image">
<img src="Arch_layers.png" alt="Arch_layers.png"/>
</div>
 <p>At the bottom is the operating system socket layer, the computer hardware, and the network infrastructure. UM opens normal network sockets using standard operating system APIs. It expects the socket communications to operate properly within the constraints of the operational environment. For example, UM expects sent datagrams to be successfully delivered to their destinations, except when overload conditions exist, in which case packet loss is expected.</p>
<p>The UM library implements a Transport Layer on top of Sockets. The primary responsibility of the Transport Layer is to reliably route datagrams from a publishing instance instance of UM to a receiving instance of UM. If datagram delivery fails, the Transport Layer detects a gap in the data stream and arranges retransmission.</p>
<p>UM implements a Topic Layer on top of its Transport Layer. Publishers usually map multiple topics to a Transport Session, therefore there can be multiple instances of the topic layer on top of a given transport layer instance ("Transport Session"). The Topic layer is responsible for <a class="el" href="index.html#glossaryfragmentation">UM fragmentation</a> of messages (splitting large application messages into datagram-sized pieces) and sending them on the proper Transport Session. On the receiving side, the Topic Layer (by default) reassembles fragmented messages, makes sure they are in the right order, and delivers them to the application. Note that the receive-side Topic Layer has a special name: the <em>Delivery Controller</em>.</p>
<p>In addition to those layers is a Topic Resolution module which is responsible for topic discovery and triggering the receive-side joining of Transport Sessions.</p>
<p><br />
 </p>
<h3><a class="anchor" id="deliverycontroller"></a>
Delivery Controller&nbsp;&nbsp;<small><a href="#deliverycontroller">&lt;-</a></small></h3>
<p>The interaction between the receiver Transport Layer and the Delivery Controller (receive-side Topic Layer) deserves some special explanation.</p>
<p>In UM, publishing applications typically map multiple topic sources to a Transport Session. These topics are multiplexed onto a single Transport Session. A subscribing application will instantiate an independent Delivery Controller for each topic source on the Transport Session that is subscribed. The distribution of datagrams from the Transport Session to the appropriate Delivery Controller instances is a de-multiplexing process.</p>
<p>In most communication stacks, the transport layer is responsible for both reliability and ordering - ensuring that messages are delivered in the same order that they were sent. The UM division of functionality is different. It is the Delivery Controller which re-orders the datagrams into the order originally sent.</p>
<p>The transport layer delivers datagrams to the Delivery Controller in the order that they arrive. If there is datagram loss, the Delivery Controller sees a gap in the series of topic messages. It buffers the post-gap messages in a structure called the <em>Order Map</em> until transport layer arranges retransmission of the lost datagrams and gives them to the Delivery Controller. The Delivery Controller will then deliver to the application the re-transmitted message, followed by the buffered messages in proper order.</p>
<p>To prevent unbounded memory growth during sustained loss, there are two configuration options that control the size and behavior of the Order Map: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#deliverycontrolmaximumtotalmapentriescontext">delivery_control_maximum_total_map_entries (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrmessagecachingthresholdreceiver">otr_message_caching_threshold (receiver)</a>.</p>
<p>This is an important feature because if a datagram is lost and requires retransmission, significant latency is introduced. However, because the Transport Layer delivers datagrams as they arrive, the Delivery Controller is able to deliver messages for topics that are unaffected by the loss. See <a class="el" href="index.html#examplelossrecovery">Example: Loss Recovery</a> for an illustration of this.</p>
<p>This design also enables the UM "Arrival Order Delivery" feature directly to applications (see <a class="el" href="index.html#ordereddelivery">Ordered Delivery</a>). There are some use cases where a subscribing application does not need to receive every message; it is only important that it get the <em>latest</em> message for a topic with the lowest possible latency. For example, an automated trading application needs the latest quote for a symbol, and doesn't care about older quotes. With Arrival Order delivery, the transport layer will attempt to recover a lost datagram, an unavoidable latency. While waiting for the retransmission, a newer datagram for that topic might be received. Rather than waiting for the retransmitted lost datagram, the Delivery Controller will immediately deliver the newer datagram to the application. Then, when the lost datagram is retransmitted, it will also be delivered to the application. (Note: with arrival order delivery, the Order Map does not need to buffer any messages since all messages are delivered immediately on reception.)</p>
<p>Applications can track when Delivery Controllers are created and deleted using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#sourcenotificationfunctionreceiver">source_notification_function (receiver)</a> configuration option. This is generally preferable to using <a class="el" href="index.html#receiverbosandeosevents">Receiver BOS and EOS Events</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umthreading"></a>
UM Threading&nbsp;&nbsp;<small><a href="#umthreading">&lt;-</a></small></h2>
<p>Ultra Messaging is designed for event-driven, asynchronous, distributed applications. Threads are used to implement the asynchronous behavior, with application callbacks being made from UM threads independently from application threads.</p>
<p>The UM <a class="el" href="index.html#contextobject">Context Object</a> owns a thread called the "context thread". This thread waits for network activity and handles much of the protocol work for UM. In particular, the context thread is responsible for reading messages from the network socket, preparing them, and delivering them to the application's receiver callback function.</p>
<p>However, the context thread often is not involved in the sending of application messages. An application thread calls the UM send function, and in a typical case, that thread flows through the UM code and makes the socket "send" call. An exception to this is if <a class="el" href="index.html#implicitbatching">Implicit Batching</a> is used and a timeout trigger the sending of a partial batch; in this case it is the context thread that sends the message.</p>
<p>The context thread can either be created implicitly when the context is created (<a class="el" href="index.html#embeddedmode">Embedded Mode</a>), or the application can choose to create the context thread external to UM and "donate" it to a context (<a class="el" href="index.html#sequentialmode">Sequential Mode</a>).</p>
<p>There are some <a class="el" href="index.html#otherspecializedthreads">Other Specialized Threads</a> that the context can create, depending on which UM features you use.</p>
<p><br />
 </p>
<h3><a class="anchor" id="embeddedmode"></a>
Embedded Mode&nbsp;&nbsp;<small><a href="#embeddedmode">&lt;-</a></small></h3>
<p>When you create a context (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a>) with the UM configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#operationalmodecontext">operational_mode (context)</a> set to embedded (the default), UM creates an independent thread, called the context thread, which handles timer and socket events, and does protocol-level processing, like retransmission of dropped packets.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sequentialmode"></a>
Sequential Mode&nbsp;&nbsp;<small><a href="#sequentialmode">&lt;-</a></small></h3>
<p>Ultra Messaging typically relies on certain independent threads to perform a variety of its functions. For example, network messages are received by either a context thread or an XSP thread.</p>
<p>By default, UM creates the necessary threads internally using the operating system's thread primitives. However, there are times where an application needs more control. Here are two example use cases: </p><ol>
<li>
The application wants to create the threads so that specific thread attributes can be set as part of creating the threads. For example, CPU affinity, execution priority, even stack size. </li>
<li>
The application wants to serialize all UM operations without the use of any independent threads of execution. In this case, the application may want to have a single thread which executes application code and UM code serially. </li>
</ol>
<p>These goals can be met using "sequential" mode. With this mode, UM does not create the thread. It becomes the application's responsibility to call the event processing API. For use case 1 above, the application typically creates its own independent thread which simply calls the event processing API in a loop. For use case 2 above, the application calls the event processing API from its main thread.</p>
<p><br />
 </p>
<h3><a class="anchor" id="contextsequentialmode"></a>
Context Sequential Mode&nbsp;&nbsp;<small><a href="#contextsequentialmode">&lt;-</a></small></h3>
<p>When you create a context (C API: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a>), by default a separate independent thread is created. This is the "context thread".</p>
<p>You enable Sequential mode by setting the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#operationalmodecontext">operational_mode (context)</a> to the value "sequential". For example:</p>
<pre class="fragment">context operational_mode sequential
</pre><p>The event processing C API for the context is <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad9416b1f0b474b5d4c4f39bb3c4bda77">lbm_context_process_events()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a>. Java: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMContext.html#a78125f80281b91950f0409a4caddc4e3">LBMContext.processEvents()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>If using sequential mode and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#fdmanagementtypecontext">fd_management_type</a> "wincompport", the thread that creates the context must not exit while the context is active. Furthermore, you gain a small performance improvement if the thread that creates the context is the same thread that calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad9416b1f0b474b5d4c4f39bb3c4bda77">lbm_context_process_events()</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="xspsequentialmode"></a>
XSP Sequential Mode&nbsp;&nbsp;<small><a href="#xspsequentialmode">&lt;-</a></small></h3>
<p>An <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> is a specialized form of a context. When you create an XSP (C API: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae38035c6036a84f07f9ba7cee1747dbf">lbm_xsp_create()</a>), by default a separate independent thread is created. This is the "XSP thread".</p>
<p>You enable Sequential mode by setting the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#operationalmodexsp">operational_mode (xsp)</a> to the value "sequential". For example:</p>
<pre class="fragment">xsp operational_mode sequential
</pre><p>The event processing C API for XSP is <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6bd865fcdeee4e0ec2bb31748ee76164">lbm_xsp_process_events()</a>. Java: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMXSP.html#a0e138196a68aeb7cf12f0c2a0b1bfcad">LBMXSP.processEvents()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>If using sequential mode and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#fdmanagementtypecontext">fd_management_type</a> "wincompport", the thread that creates the XSP must not exit while the context is active. Furthermore, you gain a small performance improvement if the thread that creates the context is the same thread that calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6bd865fcdeee4e0ec2bb31748ee76164">lbm_xsp_process_events()</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="ipcsequentialmode"></a>
IPC Sequential Mode&nbsp;&nbsp;<small><a href="#ipcsequentialmode">&lt;-</a></small></h3>
<p>When a receiver joins an <a class="el" href="index.html#transportlbtipc">IPC</a> source's transport, by default the context dynamically creates an independent thread to service the IPC shared memory. This is the "IPC thread".</p>
<p>You enable Sequential mode by setting the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcreceiveroperationalmodecontext">transport_lbtipc_receiver_operational_mode (context)</a> to the value "sequential". For example:</p>
<pre class="fragment">context transport_lbtipc_receiver_operational_mode sequential
</pre><p>The event processing C API for IPC is <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8729a284ef9f01f329fbf0edbc147227">lbm_context_process_lbtipc_messages()</a>. The Java API does not support IPC sequential mode.</p>
<p><br />
 </p>
<h3><a class="anchor" id="otherspecializedthreads"></a>
Other Specialized Threads&nbsp;&nbsp;<small><a href="#otherspecializedthreads">&lt;-</a></small></h3>
<p>In addition to the context thread, there are other UM features which rely on specialized threads: </p><ul>
<li>
The <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> feature, when used, creates its own specialized receive thread. However, unlike the context thread and the LBT-IPC threads, the creation of the LBT-SMX thread is handled by UM. There is no sequential mode for the LBT-SMX thread. </li>
<li>
The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#myricomdatagrambypasslayerdbl">DBL transport acceleration</a> feature, when used, creates its own specialized receive thread. However, unlike the context thread and the LBT-IPC threads, the creation of the DBL thread is handled by UM; there is no sequential mode for the DBL thread. </li>
<li>
The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#automaticmonitoring">Automatic Monitoring</a> feature, when used, creates an independent context to publish statistics via UM, and a second internal thread for sampling data. The creation of the automatic monitoring threads is handled by UM; there is no sequential mode for the automatic monitoring threads. </li>
<li>
The <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-based Topic Resolution</a>, when used, creates its own thread to handle communication with the SRSes. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="deletingumobjects"></a>
Deleting UM Objects&nbsp;&nbsp;<small><a href="#deletingumobjects">&lt;-</a></small></h2>
<p>Before you can delete a given UM object, you must first delete all associated objects. For example, before deleting a context, you must delete all sources and receivers associated with that context.</p>
<p>The general order of object deletion is: </p><ol>
<li>
<p class="startli"><b>Cancel <a class="el" href="index.html#umtimers">UM Timers</a></b> ("cancel" instead of "delete").</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Delete any outstanding <a class="el" href="index.html#requestresponse">request objects</a></b>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Delete <a class="el" href="index.html#sourceobject">sources</a> and <a class="el" href="index.html#receiverobject">receivers</a>, and cancel <a class="el" href="index.html#registeredfiledescriptors">Registered File Descriptors</a></b>. ("Receivers" includes wildcard, hf, and hfx receivers.)</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Delete <a class="el" href="index.html#transportservicesproviderxsp">XSP(s)</a></b>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Delete <a class="el" href="index.html#contextobject">context(s)</a></b>.</p>
<p class="endli"></p>
</li>
<li>
<b>Delete <a class="el" href="index.html#eventqueueobject">event queue(s)</a></b>. See <a class="el" href="index.html#deletinganeventqueue">"Deleting an Event Queue"</a> for more information. </li>
</ol>
<p>Some important warnings: </p><ul>
<li>
When deleting a source object, any messages waiting to be sent due to implicit batching or rate limiter might not be sent (if deleting the source also deletes the transport session). Also, any subscribers sending retransmission requests will be ignored. </li>
<li>
For objects that have application callbacks (e.g. receivers), there can be a race condition where the object deletion function returns but an application callback is still executing. See the <a class="el" href="index.html#callbackafterdelete">Callback After Delete</a>. </li>
<li>
In UM's Java and .NET APIs, each object should be explicitly deleted, usually by calling its "close" method. You should not simply release all references to a UM object and expect the garbage collector to do the cleanup. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="callbackafterdelete"></a>
Callback After Delete&nbsp;&nbsp;<small><a href="#callbackafterdelete">&lt;-</a></small></h3>
<p>For objects with application callbacks, there are circumstances where the delete function successfully returns to the caller while its callback is still executing. This can lead to race conditions and hard-to-diagnose bugs. For example, an application might delete a receiver object and then immediately delete some resources (memory, etc) that the receiver callback uses. But if the receiver callback is executing at the same time that the resources are being deleted, you can get corrupted memory and crashes.</p>
<p>For most object types, this can only happen if the deleted object is associated with an <a class="el" href="index.html#eventqueueobject">event queue</a>. However, for <a class="el" href="index.html#umtimers">UM Timers</a> and <a class="el" href="index.html#registeredfiledescriptors">Registered File Descriptors</a>, you can have callback execution continuing after the cancel returns even if no event queue is used.</p>
<p>One effective technique of avoiding this race condition is called "event sync". An alternative for C programs is to use the <a class="el" href="index.html#capiextendeddelete">C API Extended Delete</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="eventsync"></a>
Event Sync&nbsp;&nbsp;<small><a href="#eventsync">&lt;-</a></small></h3>
<p>The "event sync" technique works with all APIs and object types, with or without an event queue. It is not a separate UM feature; rather it is a technique of using a <a class="el" href="index.html#umtimers">UM timer</a> to synchronize threads.</p>
<p>The event sync technique consists of deleting one or more objects, and then scheduling a zero-duration timer with a "deletion
complete" callback. The timer is associated with the same context as the object(s) being deleted. If the object(s) being deleted are associated with an <a class="el" href="index.html#eventqueueobject">event queue</a>, the timer should be associated with the same event queue.</p>
<p>Since the timer has a duration of zero, it expires immediately. The UM context thread and/or event queue will finish whatever it is doing and expire the timer. For the non-event queue case, the timer expiration callback is executed immediately by the context. If the timer is associated with an event queue, the dispatch thread will finish whatever it is doing and execute the timer expiration callback. This guarantees that any executing callback for the object being deleted will be completed before the event sync callback is executed.</p>
<p>It is common for a program shutting down to delete hundreds, or even thousands of source and/or receiver objects. It is usually not necessary to perform an event sync for each object. You can delete all of the source and receiver objects and then perform a single event sync to guarantee that all callbacks are done. Then resources used by the callbacks can be safely cleaned up.</p>
<p>See <a href="https://github.com/UltraMessaging/event_sync">event_sync</a> for C and Java examples.</p>
<p><br />
 </p>
<h3><a class="anchor" id="capiextendeddelete"></a>
C API Extended Delete&nbsp;&nbsp;<small><a href="#capiextendeddelete">&lt;-</a></small></h3>
<p>For a C application deleting an object that is associated with an event queue, there is an "extended" delete function which notifies the application via callback when UM guarantees no further callbacks are executing.</p>
<p>The C functions are: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4018719af554eac487e60172d35e871a">lbm_context_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acd48cd37dda3e76c9daa7b7a939846e4">lbm_cancel_timer_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55bed50f2627d24371ab9acae1f27f33">lbm_cancel_fd_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa714727708c894e3cfcf9c41c265c986">lbm_src_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aeb6fc66ee4fdd7f4c9d439af54d45f68">lbm_rcv_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af69d50b0f35e28bf6f36a9c5d9df2258">lbm_request_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a154f64dd4a7027866cff1dd24e6014b9">lbm_wildcard_rcv_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a755bd1ee0a12622098b618cef46d254f">lbm_hf_rcv_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3b091cdffac78f4d1fff38e79c0cd410">lbm_hfx_delete_ex()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a08d8cbd7f47af1d7b2199c85ecf7c44c">lbm_hfx_rcv_delete_ex()</a> </li>
</ul>
<p>Note that the "cancel callback" might be invoked synchronously with the call to the ..._ex() function, or it might be invoked asynchronously by the event queue dispatch thread.</p>
<p>Note that the Java and .NET APIs do not have this extended form of object deletion; Informatica recommends using <a class="el" href="index.html#eventsync">Event Sync</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umrouter"></a>
DRO&nbsp;&nbsp;<small><a href="#umrouter">&lt;-</a></small></h2>
<p>The Ultra Messaging Dynamic Routing Option (DRO) consists of a daemon named "tnwgd" that bridges disjoint <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs) by effectively forwarding control and user traffic between them. Thus, the DRO facilitates WAN routing where multicast routing capability is absent, possibly due to technical obstacles or enterprise policies.</p>
<p>The DRO transfers multicast and/or unicast topic resolution information, thus ensuring that receivers in disjoint topic resolution domains from the source can receive the topic messages to which they subscribe.</p>
<p>See the <a href="../../Gateway/index.html">Dynamic Routing Guide</a> for more information.</p>
<p><br />
 </p>
<h2><a class="anchor" id="latejoin"></a>
Late Join&nbsp;&nbsp;<small><a href="#latejoin">&lt;-</a></small></h2>
<p>In many applications, a new receiver may be interested in messages sent before that receiver joins the source's transport session. The Ultra Messaging Late Join feature allows a new receiver to obtain previously-sent messages from a source. Without the Late Join feature, the receiver would only deliver messages sent after the receiver successfully joins the source's transport session. With Late Join, the source locally stores recently sent messages according to its Late Join configuration options, and a new receiver is able to retrieve those messages.</p>
<p>For late join to happen, the source must be configured to offer it, and the receiver must be configured to participate.</p>
<p>Source-side configuration options:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoinsource">late_join (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpinterfacecontext">request_tcp_interface (context)</a> </li>
</ul>
<p>Receiver-side configuration options:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#uselatejoinreceiver">use_late_join (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestintervalreceiver">retransmit_request_interval (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestmessagetimeoutreceiver">retransmit_request_message_timeout (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestoutstandingmaximumreceiver">retransmit_request_outstanding_maximum (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoininforequestintervalreceiver">late_join_info_request_interval (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoininforequestmaximumreceiver">late_join_info_request_maximum (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitinitialsequencenumberrequestreceiver">retransmit_initial_sequence_number_request (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#responsetcpinterfacecontext">response_tcp_interface (context)</a> </li>
</ul>
<dl class="section note"><dt>Note</dt><dd>With <a class="el" href="index.html#smartsources">Smart Sources</a>, the following configuration options have limited or no support: <ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a> </li>
</ul>
</dd>
<dd>
You cannot use Late Join with Queuing functionality (UMQ).</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="requestresponse"></a>
Request/Response&nbsp;&nbsp;<small><a href="#requestresponse">&lt;-</a></small></h2>
<p>Ultra Messaging also offers a Request/Response messaging model. A publisher (the requester) sends a message to a topic. Every receiving application listening to that topic gets a copy of the request. One or more of those receiving applications (responder) can then send one or more responses back to the original requester. Ultra Messaging sends the request message via the normal pub/sub method, whereas Ultra Messaging delivers the response message directly to the requester.</p>
<p>An important aspect of the Ultra Messaging Request/Response model is that it allows the application to keep track of which request corresponds to a given response. Due to the asynchronous nature of Ultra Messaging requests, any number of requests can be outstanding, and as the responses come in, they can be matched to their corresponding requests.</p>
<p>Request/Response can be used in many ways and is often used during the initialization of Ultra Messaging receiver objects. When an application starts a receiver, it can issue a request on the topic the receiver is interested in. Source objects for the topic can respond and begin publishing data. This method prevents the Ultra Messaging source objects from publishing to a topic without subscribers.</p>
<p>Be careful not to be confused with the sending/receiving terminology. Any application can send a request, including one that creates and manages Ultra Messaging receiver objects. And any application can receive and respond to a request, including one that creates and manages Ultra Messaging source objects.</p>
<dl class="section note"><dt>Note</dt><dd>You cannot use Request/Response with <a class="el" href="index.html#queuing">Queuing</a> functionality.</dd></dl>
<p>For more details, see <a class="el" href="index.html#requestresponsemodel">Request/Response Model</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="registeredfiledescriptors"></a>
Registered File Descriptors&nbsp;&nbsp;<small><a href="#registeredfiledescriptors">&lt;-</a></small></h2>
<p>The UM C API running on Unix supports an application creating its own network socket and registering it with the UM context. This allows state changes of the file descriptor (e.g. readable, writable) to be monitored by the UM context. The application provides a callback function that UM invokes when the file descriptor state changes.</p>
<p>This is a rarely-used feature of UM, mostly by market data feed handlers.</p>
<p>Java and .NET sockets are not supported. Windows is also not supported.</p>
<p>To register and cancel an application file descriptor with a context, use: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a50d8ea5a6ebb5f1f0c6c5d9155c09657">lbm_register_fd()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aea6845ad513f07a994d23d3c50201436">lbm_cancel_fd()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55bed50f2627d24371ab9acae1f27f33">lbm_cancel_fd_ex()</a> </li>
</ul>
<p>To register and cancel an application file descriptor with an XSP, use: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae289a20cdc857feeda3eaba9f286b946">lbm_xsp_register_fd()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa8d3582b9bb8126a34924063ed00b8c4">lbm_xsp_cancel_fd()</a> (no "_ex()" form is available) </li>
</ul>
<p>When canceling a registration, the guidelines for <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a> must be followed. Pay special attention to <a class="el" href="index.html#callbackafterdelete">Callback After Delete</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umtransports"></a>
UM Transports&nbsp;&nbsp;<small><a href="#umtransports">&lt;-</a></small></h2>
<p>A source application uses a UM transport to send messages to a receiver application. An Ultra Messaging transport type is built on top of a standard IP protocol. For example, the UM transport type "LBT-RM" is built on top of the standard UDP protocol using standard multicast addressing. The different Ultra Messaging transport types have different trade-offs in terms of latency, scalability, throughput, bandwidth sharing, and flexibility. The publisher chooses the transport type that is most appropriate for the data being sent, at the topic level. A programmer might choose different transport types for different topics within the same application.</p>
<p>Se <a class="el" href="index.html#transporttypes">Transport Types</a> for the different types of UM transports available.</p>
<p><br />
 </p>
<h2><a class="anchor" id="transportsessions"></a>
Transport Sessions&nbsp;&nbsp;<small><a href="#transportsessions">&lt;-</a></small></h2>
<p>An Ultra Messaging publisher can make use of very many topics - possibly over a million. Ultra Messaging maps those topics onto a much smaller number of <em>Transport Sessions</em>. A Transport Session can be thought of as a specific running instance of a transport type, running within a context. A given Transport Session might carry a single topic, or might carry tens of thousands of topics.</p>
<p>A publishing application can either explicitly map each topic source to specific Transport Sessions, or it can make use of an automatic mapping of sources to a default pool of Transport Sessions. If explicitly mapping, the application must configure a new source with identifying information to specify the desired Transport Session. The form of this identifying information depends on the transport type. For example, in the case of the LBT-RM transport type, a Transport Session is identified by a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresssource">multicast group IP address</a> and a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmdestinationportsource">destination port number</a>. Alternatively, if the application does not specify a Transport Session for a new topic source, a Transport Session is implicitly selected from the default pool of Transport Sessions, configured when the context was created. For example, with the LBT-RM transport type, the default pool of implicit Transport Sessions is created with a range of multicast groups, from <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresslowcontext">low</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresshighcontext">high</a>, and the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmdestinationportsource">destination port number</a>. Note that at context creation, the Transport Sessions in the configured default pool are not immediately activated. As topic sources are created and mapped to Transport Sessions, those Transport Sessions are activated.</p>
<p>There are many cases where a transport session is identified using a <a class="el" href="index.html#sourcestring">Source String</a> (minus the bracketed topic index).</p>
<dl class="section note"><dt>Note</dt><dd>When two contexts are in use, each context may be used to create a topic source for the same topic name. These sources are considered separate and independent, since they are owned by separate contexts. This is true regardless of whether the contexts are within the same application process or are separate processes. A Transport Session is also owned by a context, and sources are mapped to Transport Sessions within the same context. So, for example, if application process A creates two contexts, ctx1 and ctx2, and creates a source for topic "current_price" in each context, the sources will be mapped to completely independent Transport Sessions. This can even be true if the same Transport Session identification information is supplied to both. For example, if the source for "current_price" is created in ctx1 with LBT-RM on multicast group 224.10.10.10 and destination port 14400, and the source for the same topic is created in ctx2, also on LBT-RM with the same multicast group and destination port, the two Transport Sessions will be separate and independent, although a subscribing application will receive both Transport Sessions on the same network socket.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="subscribingtoatransportsession"></a>
Subscribing to a Transport Session&nbsp;&nbsp;<small><a href="#subscribingtoatransportsession">&lt;-</a></small></h3>
<p>A receiving application might subscribe to a small subset of the topics that a publisher has mapped to a given Transport Session. In most cases, the subscribing process will receive all messages for all topics on that Transport Session, and the UM library will discard messages for topics not subscribed. This user-space filtering does consume system resources (primarily CPU and bandwidth), and can be minimized by carefully mapping topics onto Transport Sessions according to receiving application interest (having receivers). (Certain transport types allow that filtering to happen in the publishing application; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsourcesidefilteringbehaviorsource">transport_source_side_filtering_behavior (source)</a>.)</p>
<p>When a subscribing application creates its first receiver for a topic, UM will join any and all Transport Sessions that have that topic mapped. The application might then create additional receivers for other topics on that same Transport Session, but UM will not "join" the Transport Session multiple times. It simply sets UM internal state indicating the topic subscriptions. When the publisher sends its next message of any kind on that Transport Session, the subscribing UM will deliver a BOS event (Beginning Of Stream) to all topic receivers mapped to that Transport Session, and will consider the Transport Session to be <em>active</em>. Once active, any subsequent receivers created for topics mapped to that same Transport Session will deliver an immediate BOS to that topic receiver.</p>
<p>If the publisher deletes a topic source, the subscribing application may or may not get an immediate EOS event (End Of Stream), depending on different circumstances. For example, in many cases, the deletion of topic sources by a publisher will not trigger an EOS event until <em>all</em> sources mapped to a Transport Session are deleted. When the last topic is deleted, the Transport Session itself is deleted, and an EOS event might then be delivered to <em>all</em> topic receivers that were mapped to that Transport Session. (The use of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversendfinaladvertisementssource">resolver_send_final_advertisements (source)</a>, <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-Based Topic Resolution Details</a>, or <a class="el" href="index.html#umrouter">DROs</a> can change this behavior.) Note that for UDP transports, the deletion of a Transport Session by the publisher is not immediately detected by a subscriber, but rather requires the expiration of an activity timeout.</p>
<p>Be aware that in a deployment that includes the DRO, BOS and EOS may only indicate the link between the receiver and the local DRO portal, not necessarily full end-to-end connectivity. Subscribing application should not use BOS and EOS events as an accurate and timely indication of the creation and deletion of sources by a publisher.</p>
<dl class="section note"><dt>Note</dt><dd>Non-multicast Ultra Messaging transport types can use source-side filtering to decrease user-space filtering on the receiving side by doing the filtering on the sending side. However, be aware that system resources consumed on the source side affect all receivers, and that the filtering for multiple receivers must be done serially, whereas letting the receivers do the filtering allows that filtering to be done in parallel, only affecting those receivers that need the filtering.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="transportsessiondifferences"></a>
Transport Session Differences&nbsp;&nbsp;<small><a href="#transportsessiondifferences">&lt;-</a></small></h3>
<p>There are a few subtle differences in behavior of transport sessions depending on which transport type is being used.</p>
<p>As sources are created but not explicitly assigned to a specific transport session, UM will assign the source to a transport session in the default pool, in a "round-robin" fashion. But how is the default pool populated with transport sessions?</p>
<ul>
<li>
<a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a> - the range of multicast groups from <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresslowcontext">transport_lbtrm_multicast_address_low (context)</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresshighcontext">transport_lbtrm_multicast_address_high (context)</a> defines the default pool. Note that an LBT-RM transport session is also specified with a destination port, but that port is not specified as a range and is not iterated to create multiple transport sessions. </li>
<li>
<a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a> and <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> - the range of IDs, low to high, defines the default pool. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidlowcontext">transport_lbtipc_id_low (context)</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidhighcontext">transport_lbtipc_id_high (context)</a> for IPC, or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidlowcontext">transport_lbtsmx_id_low (context)</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidhighcontext">transport_lbtsmx_id_high (context)</a> for SMX. </li>
<li>
<a class="el" href="index.html#transporttcp">Transport TCP</a>, <a class="el" href="index.html#transportlbtru">Transport LBT-RU</a> - both transport types have a range of ports that the default pool is populated from, but the number of transport sessions in the default pool is not simply the port low-to-high difference. Instead, both have a "maximum ports" option that limits the number of transport sessions automatically created. This is because the port low-to-high range is often made large so that multiple application processes can share from it, with each process limited to the maximum ports setting. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpnetwork.html#transporttcpportlowcontext">transport_tcp_port_low (context)</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpnetwork.html#transporttcpporthighcontext">transport_tcp_port_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpnetwork.html#transporttcpmaximumportscontext">transport_tcp_maximum_ports (context)</a> for TCP, or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#transportlbtruportlowcontext">transport_lbtru_port_low (context)</a> to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#transportlbtruporthighcontext">transport_lbtru_port_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#transportlbtrumaximumportscontext">transport_lbtru_maximum_ports (context)</a> for LBT-RU. </li>
</ul>
<p>An application can configure a source to a specific transport session, either in the default pool, or outside of it. For example, an application might use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresssource">transport_lbtrm_multicast_address (source)</a> to assign a source to a multicast group that is outside of the low-to-high range.</p>
<p>The different source transport types differ in how this kind of "outside of the default pool" assignment affects the transport session default pool: </p><ul>
<li>
<a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a>, <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>, and <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> - the explicitly added transport session outside of the configured default pool range does not affect the default pool. For example, assigning a source to a multicast group outside of the low-to-high range does not affect the default pool. Subsequent sources created without a specific multicast group will only be assigned to groups within the low-to-high range. Assigning a source to a transport session that is outside the low-to-high range will prevent other sources from sharing that transport session. </li>
<li>
<a class="el" href="index.html#transporttcp">Transport TCP</a>, <a class="el" href="index.html#transportlbtru">Transport LBT-RU</a> - the explicitly added transport session will be added to the default pool. For example, if the low port is 12000 and the high port is 12049 and the maximum ports if 5, the publishing context might assign ports 12000 - 12004 to the default pool. If the publisher then creates a source assigned to port 12020 and another assigned to port 12099, both of those transport sessions will be added to the default pool, making it 7 transport sessions. In particular, creating a source without a specific port assigned will be automatically assigned to one of the default pool transport sessions, and so might be assigned to port 12020 or 12099. Assigning a source to a transport session outside of the low-to-high range does not prevent other sources from sharing the transport session. </li>
</ul>
<p>See the configuration section for each transport type for specifics on how Transport Sessions are created: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpnetwork.html#tcptransportsessionmanagement">TCP Transport Session Management</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#lbtrmtransportsessionmanagement">LBT-RM Transport Session Management</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#lbtrutransportsessionmanagement">LBT-RU Transport Session Management</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#lbtipctransportsessionmanagement">LBT-IPC Transport Session Management</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#lbtsmxtransportsessionmanagement">LBT-SMX Transport Session Management</a> </li>
</ul>
<p>With the UMQ product, a ULB source makes use of the same transport types as Streaming, but a Brokered Queuing source must use the <b>broker</b> transport.</p>
<p><br />
 </p>
<h3><a class="anchor" id="flexiblelbtrutopicassignment"></a>
Flexible LBT-RU Topic Assignment&nbsp;&nbsp;<small><a href="#flexiblelbtrutopicassignment">&lt;-</a></small></h3>
<p>Starting in UM version 6.17, the user is given more flexibility in assigning topics to <a class="el" href="index.html#transportlbtru">LBT-RU</a> transport sessions.</p>
<p>Topics are assigned to RU transport sessions by specifying a source port with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#transportlbtruportsource">transport_lbtru_port (source)</a>. For example, in an XML configuration file you might have: </p><pre class="fragment">      &lt;contexts&gt;
        &lt;context&gt;
          &lt;sources&gt;
            &lt;topic topicname="topic1"&gt;
              &lt;options type="source"&gt;
                &lt;option name="transport" default-value="lbtru"/&gt;
                &lt;option name="transport_lbtru_port" default-value="12000"/&gt;
              &lt;/options&gt;
            &lt;/topic&gt;
            &lt;topic topicname="topic2"&gt;
              &lt;options type="source"&gt;
                &lt;option name="transport" default-value="lbtru"/&gt;
                &lt;option name="transport_lbtru_port" default-value="12000"/&gt;
              &lt;/options&gt;
            &lt;/topic&gt;
          &lt;/sources&gt;
        &lt;/context&gt;
      &lt;/contexts&gt;
</pre><p> This tells UM to map topic1 and topic2 to the same transport session, and use the port 12000 for that session.</p>
<p>This causes a problem if two applications want to publish to the same topic are run on the same host. If they both use the same configuration, they will both try to open port, and the second one will fail.</p>
<p>Starting with UM version 6.17, the user can specify <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrunetwork.html#transportlbtruallowephemeralsource">transport_lbtru_allow_ephemeral (source)</a>. For example: </p><pre class="fragment">      &lt;contexts&gt;
        &lt;context&gt;
          &lt;sources&gt;
            &lt;topic topicname="topic1"&gt;
              &lt;options type="source"&gt;
                &lt;option name="transport" default-value="lbtru"/&gt;
                &lt;option name="transport_lbtru_port" default-value="12000"/&gt;
                &lt;option name="transport_lbtru_allow_ephemeral" default-value="1"/&gt;
              &lt;/options&gt;
            &lt;/topic&gt;
            &lt;topic topicname="topic2"&gt;
              &lt;options type="source"&gt;
                &lt;option name="transport" default-value="lbtru"/&gt;
                &lt;option name="transport_lbtru_port" default-value="12000"/&gt;
                &lt;option name="transport_lbtru_allow_ephemeral" default-value="1"/&gt;
              &lt;/options&gt;
            &lt;/topic&gt;
          &lt;/sources&gt;
        &lt;/context&gt;
      &lt;/contexts&gt;
</pre><p> This allows the second instance to attempt to bind to port 12000, and upon failing will instead allocate an ephemeral port.</p>
<p>Note that the port number specified for transport_lbtru_port is still used for topic grouping. In the above example, both topic1 and topic2 will be mapped to the same ephemeral port.</p>
<p><br />
 </p>
<h2><a class="anchor" id="transportpacing"></a>
Transport Pacing&nbsp;&nbsp;<small><a href="#transportpacing">&lt;-</a></small></h2>
<p>Pacing refers to the controlling of when messages can be sent. <em>Source Pacing</em> is when the publisher of messages controls when messages are sent, and <em>Receiver Pacing</em> is when the subscribers can essentially push back on the publisher if the publisher is sending faster than the subscribers can consume messages.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcepacing"></a>
Source Pacing&nbsp;&nbsp;<small><a href="#sourcepacing">&lt;-</a></small></h3>
<p>In its simplest case, source pacing means that the publishing application controls when to send messages by having messages to send. For example, market data distribution system sends messages when the exchanges it is monitoring sends updates. The subscribers must be able to accept those messages at the rates that the exchanges send them.</p>
<p>A slow subscriber will fall behind and can lose data if buffers overflow. There is no way for a slow subscriber to "push back" on a fast publisher.</p>
<p>Some of Ultra Messaging's transport types have features that allow the publisher to establish upper limits on the outgoing message data. For example, LBT-RM has the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdataratelimitcontext">transport_lbtrm_data_rate_limit (context)</a> configuration option. If the application attempts to send too many messages in too short a time, the send function can block for a short time, or return an error indicating that it attempted to exceed the configured rate limit. This is still called source pacing because the rate limit is optional and is under the control of the publisher.</p>
<p>The source-paced transports are: </p><ul>
<li>
<a class="el" href="index.html#transporttcp">Transport TCP</a> (can be <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpmultiplereceiverbehaviorsource">configured</a> for source or receiver pacing) </li>
<li>
<a class="el" href="index.html#transportlbtru">Transport LBT-RU</a> (source pacing only) </li>
<li>
<a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a> (source pacing only) </li>
<li>
<a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a> (can be <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcbehaviorsource">configured</a> for source or receiver pacing) </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="receiverpacing"></a>
Receiver Pacing&nbsp;&nbsp;<small><a href="#receiverpacing">&lt;-</a></small></h3>
<p>In a receiver-paced transport, a publisher still attempts to send when it has messages to send, but the send function can block or return an error if the publisher is sending faster than the slowest subscribed receiver can consume. There is a configurable amount of buffering that can be used to allow the publisher to exceed the consumption rate for short periods of time, but when those buffers fill, the sender will be prevented from sending until the buffers have enough room.</p>
<p>The receiver-paced transports are: </p><ul>
<li>
<a class="el" href="index.html#transporttcp">Transport TCP</a> (can be <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpmultiplereceiverbehaviorsource">configured</a> for source or receiver pacing) </li>
<li>
<a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a> (can be <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcbehaviorsource">configured</a> for source or receiver pacing) </li>
<li>
<a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> (receiver-pacing only) </li>
</ul>
<p>However, it is generally inadvisable to rely on receiver pacing to ensure reliable system operation. Subscribers should be designed and provisioned to support the maximum possible incoming data rates. The reasons for this recommendation are described below.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiverqueuing"></a>
Receiver Queuing&nbsp;&nbsp;<small><a href="#receiverqueuing">&lt;-</a></small></h3>
<p>This use case is not related to the <a class="el" href="index.html#queuing">Queuing</a> paradigm. It is referring to the use of a software queue between the context thread which receives the UM message and the application thread which processes the message.</p>
<p>A receiver-paced transport does not necessarily mean that a slow application will push back on a fast publisher. Suppose that the actual message reception action by UM's context thread is fast, and the received messages are placed in an unbounded memory queue. Then, one or more application threads take messages from the queue to process them. If those application threads don't process messages quickly enough, instead of pushing back on the publisher, the message queue will grow.</p>
<p>For example, the UM <a class="el" href="index.html#eventqueueobject">Event Queue Object</a> is an unbounded memory-based queue. You could use <a class="el" href="index.html#transporttcp">Transport TCP</a> configured for receiver pacing, but if the subscriber uses an event queue for message delivery, then a slow consumer will not slow down the publisher. Instead the subscriber's event queue will grow without bound, eventually leading to an out-of-memory condition.</p>
<p><br />
 </p>
<h3><a class="anchor" id="pacinganddro"></a>
Pacing and DRO&nbsp;&nbsp;<small><a href="#pacinganddro">&lt;-</a></small></h3>
<p>Transport pacing refers to the connection within a a <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a> (TRD) from source to receiver. If multiple TRDs are connected with a <a class="el" href="index.html#umrouter">DRO</a>, there can be multiple hops between the originating publisher and the final subscriber, with the DROs providing proxy sources and receivers to pass messages across the hops. The pacing of a particular transport session only applies to the link between the source (or proxy source) and the receiver (or proxy receiver) of a particular hop.</p>
<p>This means that UM does not support end-to-end transport pacing.</p>
<p>For example, if a DRO joins two TRDs, both of which use receiver-paced TCP for transport, a slow receiver might push back on the DRO's proxy source, leading to queuing in the DRO. Since the DRO uses bounded queues, the DRO's queue will fill, leading to dropped messages.</p>
<p><br />
 </p>
<h3><a class="anchor" id="pacingandqueuing"></a>
Pacing and Queuing&nbsp;&nbsp;<small><a href="#pacingandqueuing">&lt;-</a></small></h3>
<p>Brokered <a class="el" href="index.html#queuing">Queuing</a> is receiver paced between the source and the broker. For ULB queuing, the transport pacing is determined by the chosen transport type.</p>
<p>There is also a form of end-to-end application receiver-pacing with queuing. For both brokered ULB, the size of queue is configurable. As receivers consume messages, they are removed from the queue. If the queue fills due to the source exceeding the consumption rate of the receiver, the next send call will either block or return a "WOULDBLOCK" error until sufficient room opens up in the queue. Note that lifetimes can be configured for messages (to prevent unbounded blocking) and the application can be notified if a message exceeds its lifetime.</p>
<p>See <a href="../../UMQ/index.html">UM Guide to Queuing</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="pacingandpersistence"></a>
Pacing and Persistence&nbsp;&nbsp;<small><a href="#pacingandpersistence">&lt;-</a></small></h3>
<p>With Persistence, the pacing is layered: </p><ul>
<li>
<p class="startli">At the transport level, pacing is determined by the chosen transport type.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">At the persistence level, <a class="el" href="index.html#transportpacing">Transport Pacing</a> provides receiver pacing between the source and the Store. This helps to ensure that a publisher sending on a source-paced transport like LBT-RM will not overwhelm the Store.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">By default, the end-to-end pacing is source-paced. Which is to say that if a subscribed receiver cannot keep up with the publish rate, eventually the receiver can experience unrecoverable loss, although this normally will only happen if the receiver falls further behind than the total size of the Store's repository.</p>
<p class="endli"></p>
</li>
<li>
Alternatively, the end-to-end pacing can be switched to receiver-paced. This is done using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/operationalview.html#receiverpacedpersistenceoperations">RPP: Receiver-Paced Persistence</a>. Note that if a subscribed receiver crashes, it can lead to unbounded blockage of the publisher until the subscriber is successfully restarted. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="suspendedreceiverproblem"></a>
Suspended Receiver Problem&nbsp;&nbsp;<small><a href="#suspendedreceiverproblem">&lt;-</a></small></h3>
<p>This is a problem that one of our users encountered. Their system used receiver-paced TCP because they wanted the publishing speed to be limited to the rate that the slowest receiver could consume. This was fine until one day the publisher appeared to stop working.</p>
<p>With some help from Support, the problem was trace to a receiver at a particular IP address that was joined to the transport but apparently was not reading any data. It took some time to find the receiver by its IP address, and what they found was a Windows machine with a dialog box telling the user that the process had generated an exception and did the user want abort the process or enter the debugger.</p>
<p>When Windows does this, it suspends the process waiting for user input. In that suspended state, the kernel maintains the network connections, but the process is not able to read any data. So the socket buffers filled up and the publisher's send call blocked.</p>
<p><br />
 </p>
<h2><a class="anchor" id="eventdelivery"></a>
Event Delivery&nbsp;&nbsp;<small><a href="#eventdelivery">&lt;-</a></small></h2>
<p>There are many different events that UM may want to deliver to the application. Many events carry data with them (e.g. received messages); some do not (e.g. end-of-stream events). Some examples of UM events:</p>
<ul>
<li>
Received message. UM delivers messages on subscribed topics to the receiver. </li>
<li>
Receiver loss. UM can inform the application when a data gap is detected on a subscribed topic that could not be recovered through the normal retransmission mechanism. </li>
<li>
End of Stream. UM can inform a receiving application when a data stream (<a class="el" href="index.html#transportsessions">Transport Session</a>) has terminated. </li>
<li>
Connect and Disconnect events. Source-side events delivered to a publisher when receivers connect to and disconnect from the source's transport session. </li>
<li>
A timer expiring. Applications can schedule timers to expire in a desired number of milliseconds (although the OS may not deliver them with millisecond precision). </li>
<li>
An application-managed file descriptor event. The application can <a class="el" href="index.html#registeredfiledescriptors">register its own file descriptors</a> with UM to be monitored for state changes (readable, writable, error, etc.). </li>
<li>
New source notification. UM can inform the application when sources are discovered by Topic Resolution. </li>
</ul>
<p>UM delivers events to the application via callbacks. The application explicitly gives UM a pointer to one of its functions to be the handler for a particular event, and UM calls that function to deliver the event, passing it the parameters that the application requires to process the event. In particular, the last parameter of each callback type is a client data pointer (clientdp). This pointer can be used at the application's discretion for any purpose. It's value is specified by the application when the callback function is identified to UM (typically when UM objects are created), and that same value is passed back to the application when the callback function is called.</p>
<p>There are two methods that UM can use to call the application callbacks: through context thread callback, or <a class="el" href="index.html#eventqueueobject">event queue</a> dispatch.</p>
<p>In the context thread callback method (sometimes called direct callback), the UM context thread calls the application function directly. This offers the lowest latency, but imposes significant restrictions on the application function. See <a class="el" href="index.html#eventqueueobject">Event Queue Object</a>.</p>
<p>The <a class="el" href="index.html#eventqueueobject">event queue</a> dispatch of application callback introduces a dynamic buffer into which the UM context thread writes events. The application then uses a thread of its own to dispatch the buffered events. Thus, the application callback functions are called from the application thread, not directly from the context thread.</p>
<p>With event queue dispatching, the use of the application thread to make the callback allows the application function to make full, unrestricted use of the UM API. It also allows parallel execution of UM processing and application processing, which can significantly improve throughput on multi-processor hardware. The dynamic buffering provides resilience between the rate of event generation and the rate of event consumption (e.g. message arrival rate v.s. message processing rate).</p>
<p>In addition, an UM event queue allows the application to be warned when the queue exceeds a threshold of event count or event latency. This allows the application to take corrective action if it is running too slow, such as throwing away all events older than a threshold, or all events that are below a given priority.</p>
<p>Note that while most UM events can be delivered via event queue, there are some that cannot (e.g. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#resolversourcenotificationfunctioncontext">resolver_source_notification_function (context)</a>).</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiverbosandeosevents"></a>
Receiver BOS and EOS Events&nbsp;&nbsp;<small><a href="#receiverbosandeosevents">&lt;-</a></small></h3>
<p>There are two receive-side events that some applications use but which are not recommended for most use cases: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab5489080adc7157549a9930b30c68425">LBM_MSG_BOS</a> - Beginning of (transport) Session. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2647b87f92adb5a34ea129fbfeeed5a3">LBM_MSG_EOS</a> - End of (transport) Session. </li>
</ul>
<p>The BOS and EOS events are delivered to receivers on a topic basis, but were originally designed to represent the joining and exiting of the underlying <a class="el" href="index.html#transportsessions">Transport Session</a>.</p>
<p>Note that the BOS and EOS receive-side events are very similar to the <a class="el" href="index.html#sourceconnectanddisconnectevents">Source Connect and Disconnect Events</a>.</p>
<p>The BOS event means slightly different things for different transport types. The basic principal is that a UM receiver won't deliver BOS until it has seen some kind of activity on the transport after joining it. For example, a session message for <a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a>. Or perhaps a <a class="el" href="index.html#lossdetectionusingtsnis">TSNI</a> on any of the transport types. Or even an actual user message. Any of these will trigger BOS. But if the newly-joined transport session is completely silent, then BOS is delayed until first activity is detected. Under some configurations, that delay is unbounded.</p>
<p>EOS is also triggered by different things for different transport types. For example, for the <a class="el" href="index.html#transporttcp">TCP transport</a>, a disconnect will trigger EOS for any receivers that were subscribed to topics carried on that transport session. For LBT-RM, an <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmactivitytimeoutreceiver">activity timeout</a> can trigger EOS.</p>
<p>However, in recent versions of UM, the meaning of EOS has become more complicated, and no longer necessarily indicates that the transport session has ended. There are circumstances in many versions of UM where a publisher of a source that is in a remote TRD can delete that source, and the receiver will receive a timely EOS, even though the transport session that carried the source stays in effect and joined by the receiver. Starting with UM version 6.10, the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversendfinaladvertisementssource">resolver_send_final_advertisements (source)</a> can be used to trigger EOS on receivers in the same TRD, even if the transport session remains joined. Starting with UM version 6.12, <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-based Topic Resolution</a> will have the same effect. In in a mixed-version UM environment including <a class="el" href="index.html#umrouter">DROs</a>, it can be difficult to predict when an EOS will be generated for a deleted source.</p>
<p>Be aware that BOS does <em>not</em> necessarily indicate end-to-end connectivity between sources and receivers. In a <a class="el" href="index.html#umrouter">DRO</a> network, where the source is in a different <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a> (TRD) from the receiver, BOS only indicates the establishment of the transport session between the DRO's proxy source and the receiver.</p>
<p>Also, BOS and EOS do not necessarily come in balanced pairs. For example, if a BOS is delivered to a receiver, and then the subscriber application deletes the receiver object, UM does not deliver an EOS to the receiver callback. Also, it is possible to get an EOS event without first getting a BOS. Let's say that a receiver attempts to join an LBT-RM transport session for a source that was just deleted. BOS will not be delivered because there will be no communication of a user or control message. However, after LBT-RM times out the transport session, it will deliver EOS.</p>
<p>Finally, in some versions of UM, EOS represents the end of the entire transport session, so you can have situations where a publisher deletes a source, but the receiver for that topic does not get an EOS for an unbounded period of time. Let's say that the publisher maps sources for topics X, Y, and Z to the same transport session. Let's further say that a subscriber has a receiver for topic Y. It will join the transport session, get a BOS for receiver Y, and will receive messages that the publisher sends to Y. Now let's say that the publisher deletes the source for topic Y, but keeps the sources for topics X and Z. The subscriber may not be informed of the deletion of the source for Y, and can remain subscribed to the transport session. It won't be until the publisher deletes sources X and Z that it will delete the underlying transport session, which can then deliver EOS to the subscriber. However, if using <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-based Topic Resolution</a>, this same scenario can produce an EOS event on the receiver immediately.</p>
<p>For these reasons and others, Informatica does not recommend using the BOS and EOS events to indicate "connectedness" between a source and a receiver. Instead, Informatica recommends logging the events in your application log file. If something goes wrong, these messages can assist in diagnosing the problem.</p>
<p>For programmers who are tempted to use BOS and EOS events, Informatica recommends instead using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#sourcenotificationfunctionreceiver">source_notification_function (receiver)</a> configuration option. This provides receiving applications a callbacks when a <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> is created and deleted, and is usually what the programmer <em>really</em> wants.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourceconnectanddisconnectevents"></a>
Source Connect and Disconnect Events&nbsp;&nbsp;<small><a href="#sourceconnectanddisconnectevents">&lt;-</a></small></h3>
<p>There are two source-side events that some applications use but which are not recommended for most use cases: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adb8a3d729fdaa96b9729144ee86668ad">LBM_SRC_EVENT_CONNECT</a> - Beginning of (transport) Session to receiver. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acf50e4167d38a398bf5ae12c163ff2bb">LBM_SRC_EVENT_DISCONNECT</a> - End of (transport) Session to receiver. </li>
</ul>
<p>The Connect and Disconnect events are delivered to source on a topic basis, but actually represent the joining and exiting of the underlying <a class="el" href="index.html#transportsessions">Transport Session</a> to a specific receiver.</p>
<dl class="section note"><dt>Note</dt><dd>The Connect and Disconnect events are <em>not</em> available for <a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a> or <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> sources.</dd></dl>
<p>Note that the Connect and Disconnect source-side events are very similar to the <a class="el" href="index.html#receiverbosandeosevents">Receiver BOS and EOS Events</a>. However, while BOS and especially EOS have deviated from their pure "transport session" roots, Connect and Disconnect are still purely implemented with respect to the underlying transport session.</p>
<p>Be aware that Connect does <em>not</em> necessarily indicate end-to-end connectivity between sources and receivers. In a <a class="el" href="index.html#umrouter">DRO</a> network, where the source is in a different <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a> (TRD) from the receiver, Connect only indicates the establishment of the transport session between the DRO's proxy receiver and the source. For example, if a source in TRD1 is sending messages to two receivers in TRD2 via a DRO, the source will only receive a single Connect event when the first of the two receivers subscribe. Note also that the IP and port indicated in the Connect event will be for the DRO portal on TRD1.</p>
<p>Also, since Disconnect represents the end of the entire transport session, you can have situations where a subscriber deletes a receiver, but the source for that topic does not get a Disconnect for an unbounded period of time. Let's say that the publisher maps sources for topics X, Y, and Z to the same transport session. Let's further say that a subscriber has a receiver for topic Y and Z. It will join the transport session, and the source will get Connect events for <em>all three</em> topics, X, Y, and Z. Now let's say that the subscriber deletes the receiver for topic Y, but keeps the receiver for topic Z. The source will not be informed of the deletion of the receiver for Y, since the transport session continues to be maintained. It won't be until the subscriber deletes both receivers, Y and Z, that it will delete the underlying transport session, which can then deliver Disconnect to the source.</p>
<p>For these reasons and others, Informatica does not recommend using the Connect and Disconnect events to indicate "connectedness". Instead, Informatica recommends logging the events in your application log file. If something goes wrong, these messages can assist in diagnosing the problem.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcewakeupevent"></a>
Source Wakeup Event&nbsp;&nbsp;<small><a href="#sourcewakeupevent">&lt;-</a></small></h3>
<p>The source event <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa905cb268bbee255c71b74694370fe61">LBM_SRC_EVENT_WAKEUP</a> is delivered to the application when a non-blocking "send" function is called but returns the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a> error. When that happens, the message was not sent due to a flow controlling condition. When that flow controlling condition is cleared, UM delivers the wakeup to the source event callback, informing the application that it can resume sending.</p>
<p>The flow controlling conditions are: </p><ul>
<li>
The source uses the TCP (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpmultiplereceiverbehaviorsource">normal</a>), IPC (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcbehaviorsource">receiver_paced</a>), or SMX protocol, and one or more receivers are not reading fast enough. When both the receiver's and sender's buffers are full, a non-blocking "send" will return <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>. When the slow receiver(s) read more data, the flow control condition is cleared and the wakeup source event is delivered. </li>
<li>
The source uses a UDP-based protocol and the data rate limit is exceeded (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdataratelimitcontext">transport_lbtrm_data_rate_limit (context)</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrudataratelimitcontext">transport_lbtru_data_rate_limit (context)</a>). A non-blocking "send" will return <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>. When the rate interval expires and the rate limiter adds bandwidth, the flow control condition is cleared and the wakeup source event is delivered. </li>
<li>
The source uses persistence and exceeds a flight size limit (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umeflightsizesource">ume_flight_size (source)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umeflightsizebytessource">ume_flight_size_bytes (source)</a>). A non-blocking "send" will return <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>. When the Store sends stability ACKs to the source and the in-flight message data drops below the limit, the flow control condition is cleared and the wakeup source event is delivered. </li>
</ul>
<p>In all cases, the wakeup event is delivered by the UM context thread.</p>
<p>However, note that typically a separate thread (created by the application) is calling the non-blocking "send" function. There can be cases where the call to "send" detects the flow control condition, but before it can return <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>, the context thread clears the condition and delivers the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa905cb268bbee255c71b74694370fe61">LBM_SRC_EVENT_WAKEUP</a> event via the the application's source callback. From the application's point of view, this represents the notification of UM's internal state transitions is reversed, with the wakeup appearing to happen <em>before</em> the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>. This potential reversal of event notification is a natural consequence of the design of UM and is not considered a bug. The application must be carefully coded to take this race condition into account.</p>
<p>For example, here's a modified excerpt from the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmsrc_c">Example lbmsrc.c</a> program (see similar code in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmsrc_java">Java</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmsrc_cs">.NET</a>): </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> blocked = 0;  <span class="comment">/* global state variable. */</span></div><div class="line">...</div><div class="line"></div><div class="line">int handle_src_event(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a717ff27bb10ae7800330c21d810dffb8">lbm_src_t</a> *src, <span class="keywordtype">int</span> event, <span class="keywordtype">void</span> *extra_data, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (event) {</div><div class="line">    <span class="keywordflow">case</span> <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa905cb268bbee255c71b74694370fe61">LBM_SRC_EVENT_WAKEUP</a>:</div><div class="line">        blocked = 0;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">...</div></div><!-- fragment --><p>The wakeup event indicates that a blocked source is no longer blocked. This example uses a global variable to track the blocked state of the source, so the wakeup event clears it.</p>
<p>Here is the application sending code: </p><div class="fragment"><div class="line"><span class="comment">/* Assume that the source is blocked. */</span></div><div class="line">blocked = 1;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send</a>(src, message, opts-&gt;msglen, LBM_SRC_NONBLOCK);</div><div class="line"><span class="keywordflow">if</span> (err == LBM_FAILURE) {</div><div class="line">    <span class="keywordflow">if</span> (<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af3a827eb26d87be5b1a6b9fd3a4b63aa">lbm_errnum</a>() == LBM_EWOULDBLOCK) {</div><div class="line">        <span class="comment">/* Source is blocked, message did not send. The &quot;lbmsrc.c&quot; example</span></div><div class="line"><span class="comment">         * reacts by spin-waiting for &quot;blocked&quot; to be set to zero, and then</span></div><div class="line"><span class="comment">         * looping back to re-send the same message.</span></div><div class="line"><span class="comment">         * Alternatively, you could simply return to do other work, and</span></div><div class="line"><span class="comment">         * re-send the message later when &quot;blocked&quot; is zero.</span></div><div class="line"><span class="comment">         * Note that it is possible that &quot;blocked&quot; is already zero at this point.</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line">blocked = 0;  <span class="comment">/* The message sent successfully; source is not blocked. */</span></div></div><!-- fragment --><p>The important part of this code is that the global "blocked" flag is set before* the call to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a>. If you try to set it after the send function returns, the wakeup event might execute before your sending thread can set it. This will leave "blocked" set even though the wakeup event has already been delivered.</p>
<p>Note that there should be a separate "blocked" variable for each source object the application creates. This flag would typically be placed in a "clientd" structure instead of being a process-global variable.</p>
<dl class="section warning"><dt>Warning</dt><dd>The above example code is NOT safe for multiple application threads sending to the same source object.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="sourceflightnotificationevent"></a>
Source Flight Notification Event&nbsp;&nbsp;<small><a href="#sourceflightnotificationevent">&lt;-</a></small></h3>
<p>The source event <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6d75dfecae9635b61c289efa3a8aa017">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION</a> can be delivered to the application when a source is configured for persistence and has set its <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umeflightsizebehaviorsource">ume_flight_size_behavior (source)</a> to "notify".</p>
<p>As the application sends messages, the flight size increases, and as the Store delivers message stability ACKs, the flight size decreases. As the application sends messages increasing the flight size, if it crosses a flight size limit, the internal flight size state for that source becomes "over" and the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6d75dfecae9635b61c289efa3a8aa017">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION</a> event is delivered with state <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a117eda1a0792b41a8a6ffbab7becf834">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION_STATE_OVER</a>.</p>
<p>Subsequently, as Store stability acknowledgements are delivered to the source decreasing the flight size, if it goes below the flight size limits, the internal flight size state for that source becomes "under" and the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6d75dfecae9635b61c289efa3a8aa017">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION</a> event is delivered with state <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adf54f7b5bcae5127f6cf814945a62ab9">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION_STATE_UNDER</a>.</p>
<p>However, these two events are delivered by separate threads. The "OVER" notification is delivered by the application thread calling the "send" function, and the "UNDER" notification is delivered by the UM context receiving the Store's stability ACK. There can be cases where the application will process the two events concurrently, or even in the reverse order that the internal state changed. For example, the actual order of state transitions might be "UNDER", "OVER", "UNDER", but the application will process the events as "UNDER", "UNDER", "OVER". This potential reversal of event notification is a natural consequence of the design of UM and is not considered a bug. The application must be carefully coded to take this race condition into account.</p>
<p>Here is some example code to demonstrate a possible use pattern: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> over_delivered = 0;  <span class="comment">/* global. */</span></div><div class="line"><span class="keywordtype">int</span> under_delivered = 0;  <span class="comment">/* global. */</span></div><div class="line">...</div><div class="line"></div><div class="line">int handle_src_event(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a717ff27bb10ae7800330c21d810dffb8">lbm_src_t</a> *src, <span class="keywordtype">int</span> event, <span class="keywordtype">void</span> *extra_data, <span class="keywordtype">void</span> *client_data)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (event) {</div><div class="line">    <span class="keywordflow">case</span> <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6d75dfecae9635b61c289efa3a8aa017">LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION</a>:</div><div class="line">    {</div><div class="line">        <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__event__flight__size__notification__t__stct.html">lbm_src_event_flight_size_notification_t</a> *notification = (<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__event__flight__size__notification__t__stct.html">lbm_src_event_flight_size_notification_t</a> *)extra_data;</div><div class="line">        <span class="keywordflow">if</span> (notification-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__event__flight__size__notification__t__stct.html#a4805e12cbac941f189ea511d48d02445">state</a> == LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION_STATE_OVER) {</div><div class="line">            over_delivered = 1;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span> {  <span class="comment">/* state == LBM_SRC_EVENT_FLIGHT_SIZE_NOTIFICATION_STATE_UNDER */</span></div><div class="line">            under_delivered = 1;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">...</div></div><!-- fragment --><p>This example uses two global state variables to indicate when the two notification events have been delivered.</p>
<p>Here's some code that checks to see if flight size is "over" and wait for it to be "under" before sending: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (over_delivered) {</div><div class="line">    <span class="keywordflow">while</span> (! under_delivered) {</div><div class="line">        <span class="comment">/* While waiting for &quot;under&quot;, can do other things. */</span></div><div class="line">    }</div><div class="line">    <span class="comment">/* Both &quot;over&quot; and &quot;under&quot; events were delivered. Reset them so we can send again. */</span></div><div class="line">    over_delivered = 0;</div><div class="line">    under_delivered = 0;</div><div class="line">}</div><div class="line"><span class="comment">/* Send next message. */</span></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send</a>(src, message, opts-&gt;msglen, LBM_SRC_NONBLOCK);</div></div><!-- fragment --><p>This code works because the "over" event is delivered synchronously with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> function. If <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> exceeds the flight size, UM guarantees that the "over" event will be delivered before the send function returns. This guarantee enables the code to handle the "under" event being delivered before the "over" event.</p>
<p>Note that there should be a separate "over_delivered" and "under_delivered" variables for each source object the application creates. These flags would typically be placed in a "clientd" structure instead of being process-global variables.</p>
<p>Also note that unlike the "wakeup" event (described <a class="el" href="index.html#sourceflightnotificationevent">above</a>), getting an "over" event does not prevent the "send" function from successfully sending the message. The point of setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umeflightsizebehaviorsource">ume_flight_size_behavior (source)</a> to "notify" is to allow the publisher to continue sending in spite of exceeding flight size. But note that doing this can prevent UM from guaranteeing delivery of messages.</p>
<dl class="section warning"><dt>Warning</dt><dd>The above example code is NOT safe for multiple application threads sending to the same source object.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="ratecontrols"></a>
Rate Controls&nbsp;&nbsp;<small><a href="#ratecontrols">&lt;-</a></small></h2>
<p>For UDP-based communications (LBT-RU, LBT-RM, and <a class="el" href="index.html#topicresolutionoverview">Topic Resolution</a>), UM network stability is ensured through the use of rate controls. Without rate controls, sources can send UDP data so fast that the network can be flooded. Using rate controls, the source's bandwidth usage is limited. If the source attempts to exceed its bandwidth allocation, it is slowed down.</p>
<p>Setting the rate controls properly requires some planning; see <a href="https://ultramessaging.github.io/thpm/thpm.html#GROUP-RATE-CONTROL">Topics in High Performance Messaging, Group Rate Control</a> for details.</p>
<p>Ultra Messaging's rate limiter algorithms are based on dividing time into intervals (configurable), and only allowing a certain number of bits of data to be sent during each interval. That number is divided by the number of intervals per second. For example, a limit of 1,000,000 bps and an interval of 100 ms results in the limiter allowing 100,000 bits to be sent during each interval. Dividing by 8 to get bytes gives 12,500 bytes per interval.</p>
<p>Data are not sent over a network as individual bytes, but rather are grouped into datagrams. Since it is not possible to send only part of a datagram, the rate limiter algorithm needs to decide what to do if an outgoing datagram would exceed the number of bits allowed during the current time interval. The data transport rate limiter algorithm, for LBT-RM and LBT-RU, differs from the Topic Resolution rate limiter algorithm.</p>
<p><br />
 </p>
<h3><a class="anchor" id="transportratecontrol"></a>
Transport Rate Control&nbsp;&nbsp;<small><a href="#transportratecontrol">&lt;-</a></small></h3>
<p>With data transport, if an application sends a message and the outgoing datagram would exceed the number of bits allowed during the current time interval, that datagram is queued and the transport type is put into a "blocked" state in the current context. Note that success is returned to the application, even though the datagram has not yet been transmitted.</p>
<p>However, any subsequent sends within the same time interval will not queue, but instead will either block (for blocking sends), or return the error <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a> (for non-blocking sends). When the time interval expires, the context thread will refresh the number of allowable bits, send the queued datagram, and unblock the transport type.</p>
<p>Note that for very small settings of transport rate limit, the end-of-interval refresh of allowable bits may still not be enough to send a queued full datagram. In that case, the datagram will remain on the queue for additional intervals to pass, until enough bits have accumulated to send the queued datagram. However, it would be very unusual for a transport rate limit to be set that small.</p>
<p><b>Transport Rate Control Configuration</b></p>
<p>Configuration parameters of interest are: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmrateintervalcontext">transport_lbtrm_rate_interval (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdataratelimitcontext">transport_lbtrm_data_rate_limit (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmretransmitratelimitcontext">transport_lbtrm_retransmit_rate_limit (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrurateintervalcontext">transport_lbtru_rate_interval (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrudataratelimitcontext">transport_lbtru_data_rate_limit (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtruretransmitratelimitcontext">transport_lbtru_retransmit_rate_limit (context)</a> </li>
</ul>
<p><b>LBM_EWOULDBLOCK</b></p>
<p>When non-blocking sends are done (LBM_SRC_NONBLOCK), the send can fail with an error number of LBM_EWOULDBLOCK. This means you have exceeded the rate limit and must wait before sending the message.</p>
<p>Most applications don't need to handle this because they use blocking sends. Instead of returning a failure when the rate limit is exceeded, the send function sleeps until the transport becomes unblocked again, at which point the UM context thread wakes up the sleeping send call. However, there are times that blocking behavior is not permitted. For example, if the application is running as a UM Context thread callback (timer, receiver event, source event, etc), then only non-blocking sends are allowed.</p>
<p>To assist the application in retrying the message send, the UM context thread will deliver the LBM_SRC_EVENT_WAKEUP source event to the application. (This only happens if a non-blocking send was tried and failed with LBM_EWOULDBLOCK.) The application can use that event to re-try sending the message.</p>
<p>Alternatively, exceeding the rate limit can be avoided by increasing the configured rate limit and/or rate interval. This can reduce latency, but also increases the risk of packet loss.</p>
<p>The rate limit controls how many bits can be transmitted during a given second of time. The rate interval controls the "shape" of the transmissions over the second of time.</p>
<p><b>Adjusting the Rate Interval</b></p>
<p>A long rate interval will allow intense bursts of traffic to be sent, which can overload switch port queues or NIC ring buffers, leading to packet loss. A short rate interval will reduce the intensity of the bursts, spreading the burst over a longer time, but does so by introducing short delays in the transmissions, which increases message latency.</p>
<p>The LBT-RM default rate interval of 10 milliseconds was chosen to be reasonably "safe" in terms of avoiding loss, at the expense of possible transmission delays. Latency-sensitive applications may require a larger value, but increases the risk of switch or NIC loss.</p>
<p>There is no analytical way of choosing an optimal value for the rate interval. Latency-sensitive users should test different values with intense bursts to find the largest value which avoids packet loss.</p>
<p><br />
 </p>
<h3><a class="anchor" id="topicresolutionratecontrol"></a>
Topic Resolution Rate Control&nbsp;&nbsp;<small><a href="#topicresolutionratecontrol">&lt;-</a></small></h3>
<p>With UDP-based Topic Resolution ("TR"), the algorithm acts differently. It is designed to allow at least one datagram per time interval, and is allowed to exceed the rate limit by at most one topic's worth. Thus, the TR rate limiter value should only be considered a "reasonably accurate" approximation.</p>
<p>This approximation can seem very inaccurate at very small rate limits. As an extreme example, suppose that a user configures the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversustainadvertisementbpscontext">sustaining advertisement rate limiter</a> to 1 bit per second. Since the TR rate limiter allows at least one Advertisement (TIR) to be sent per interval, and a TIR of a 240-character topic creates a datagram about 400 bytes long (exact size depends on user options), ten of those per second is 32,000 bits, which is over 3 million percent of the desired rate. This sounds extreme, but understand that this works out to only 10 packets per second, a trivial load for modern networks. In practice, the minimum <em>effective</em> rate limit works out to be one datagram per interval.</p>
<p>For details of Topic Resolution, see <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="operationalstatistics"></a>
Operational Statistics&nbsp;&nbsp;<small><a href="#operationalstatistics">&lt;-</a></small></h2>
<p>UM maintains a variety of transport-level statistics which gives a real-time snapshot of UM's internal handling. For example, it gives counts for transport messages transferred, bytes transferred, retransmissions requested, unrecoverable loss, etc.</p>
<p>The UM monitoring API provides framework to allow the convenient gathering and transmission of UM statistics to a central monitoring point. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html">Monitoring</a> for more information.</p>
<p><br />
 </p>
<h2><a class="anchor" id="immediatemessaging"></a>
Immediate Messaging&nbsp;&nbsp;<small><a href="#immediatemessaging">&lt;-</a></small></h2>
<p>UM has an alternate form of messaging that deviates from the normal publish/subscribe paradigm. An "immediate message" can be sent and received without the need for topic resolution. Note that immediate messaging is less efficient than normal source-based messaging and will not provide the same low latency and high throughput.</p>
<p>There are two forms of immediate messaging: </p><ul>
<li>
<a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> (UIM) - TCP-based point-to-point. </li>
<li>
<a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a> (MIM) - flooding-based multicast; use rarely. </li>
</ul>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="umobjects"></a>
UM Objects&nbsp;&nbsp;<small><a href="#umobjects">&lt;-</a></small></h1>
<p>Many UM documents use the term object. Be aware that with the C API, they do not refer to formal class-based objects as supported by C++. The term is used here in an informal sense to denote an entity that can be created, used, and (usually) deleted, has functionality and data associated with it, and is managed through the API. The handle that is used to refer to an object is usually implemented as a pointer to a data structure (defined in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html">lbm.h</a>), but the internal structure of an object is said to be opaque, meaning that application code should not read or write the structure directly.</p>
<p>However, the UM Java and .NET APIs <em>are</em> formally object oriented, with Java/C# class-based objects. See the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/index.html#umjavaapi">UM Java API</a> and the <a href="../../DotNetAPI/index.html#umnetapi">UM .NET API</a> documentation.</p>
<p>The UM API is designed around a set of UM objects. The most-often used object types are: </p><ul>
<li>
<a class="el" href="index.html#contextobject">Context</a> - a fairly "heavy-weight" parent object for most other UM objects. Also represents an "instance" of UM, with all foreground and background functions. </li>
<li>
<a class="el" href="index.html#sourceobject">Source</a> - a publisher creates one or more Source objects, one per topic to be published. </li>
<li>
<a class="el" href="index.html#receiverobject">Receiver</a> - a subscriber creates one or more Receivers, one per topic that is subscribed. </li>
<li>
<a class="el" href="index.html#umwildcardreceivers">Wildcard Receiver</a> - a subscriber can optionally create Wildcard Receivers to subscribe to patterns that can match multiple topics. </li>
<li>
<a class="el" href="index.html#hotfailoverhf">Hot Failover Receiver</a> - a specialized type of Receiver object that allows for redundant publishing. </li>
<li>
<a class="el" href="index.html#hotfailoveracrossmultiplecontexts">HFX Receiver</a> - a specialized type of Hot Failover Receiver object that allows redundant sources across multiple Context objects. (Note: HFX is deprecated.) </li>
<li>
<a class="el" href="index.html#eventqueueobject">Event Queue</a> - an active object (requires one or more threads) which is used to queue and deliver UM events (including received messages) to the application using a separate thread. Event queues are normally not required; by default UM delivers events using the Context's own thread. But there are circumstances where it is useful to transfer the received message or event to an independent thread for delivery. </li>
</ul>
<p>A typical UM application program manages UM objects following certain ordering rules: </p><ol>
<li>
If desired, Event Queues are typically created first. (Most UM applications do not use Event Queues.) </li>
<li>
Create a Context object. A typical application creates only one context, but there are some specialized use cases in which a small number of contexts (typically less than 5) are useful. </li>
<li>
Create one or more Source and Receiver objects. It is not unusual for an application to create thousands of sources or receivers. </li>
<li>
The application's main processing phase consists of publishing messages using the Source objects, and receiving messages using the Receiver objects. UM is most efficiently used if those Source and Receiver objects are created during initialization. Dynamic object creation during normal operation is possible, but can require special coding. </li>
<li>
When the application is ready to shut down, Sources and Receivers should be deleted. </li>
<li>
Contexts are deleted after all Sources and Receivers are deleted. Note that if the context uses <a class="el" href="index.html#sequentialmode">Sequential Mode</a>, the event processing thread should be unblocked and joined prior to Context deletion. </li>
<li>
Event Queues, if used, are deleted last. Note that the Event Queue dispatching thread(s) should be unblocked and joined prior to deletion of the Event Queue. </li>
</ol>
<p>Note that it is very important to enforce the above deletion order. For example, it can lead to crashes if you delete a context while it still has active Sources or Receivers associated with it. Similarly, crashes can result if you delete an event queue while it still has active Contexts associated with it.</p>
<p>Also, note that deletion of Source objects can affect the reliability of message delivery. UM Receivers are designed to detect lost packets and request retransmission. However, once a Source object is deleted, it can no longer fulfill retransmission requests. It is usually best for an application to delay a few seconds after sending its last messages before deleting the Sources. This is especially important if <a class="el" href="index.html#implicitbatching">Implicit Batching</a> is used since outgoing messages might be held in the Batcher.</p>
<p><br />
 </p>
<h2><a class="anchor" id="contextobject"></a>
Context Object&nbsp;&nbsp;<small><a href="#contextobject">&lt;-</a></small></h2>
<p>A UM context object conceptually is an environment in which UM runs. An application creates a context, typically during initialization, and uses it for most other UM operations. In the process of creating the context, UM normally starts an independent thread (the context thread) to do the necessary background processing such as the following: </p><ul>
<li>
Topic resolution </li>
<li>
Enforce rate controls for sending messages </li>
<li>
Manage timers </li>
<li>
Manage state </li>
<li>
Implement UM protocols </li>
<li>
Manage <a class="el" href="index.html#transportsessions">Transport Sessions</a> </li>
</ul>
<p>You create a context with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a>. When an application is finished with the context (no more message passing needed), it should delete the context by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a962bfceb336c65191ba08497ac70602b">lbm_context_delete()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Before deleting a context, you must first delete all objects contained within that context (sources, receivers, wildcard receivers). See <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a>.</dd></dl>
<p>Your application can give a context a name, which are optional but should be unique across your UM network. You set a context name before calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a> in the following ways:</p>
<ul>
<li>
If you are using XML UM configuration files, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3a97ec59981f5b863b0b40faf82eceb8">lbm_context_attr_set_from_xml()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a04d99cc97d32f359888c5befcc50512e">lbm_context_attr_create_from_xml()</a> and set the name in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#contextnamecontext">context_name (context)</a> parameter. </li>
<li>
If you are using plain text UM configuration files, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab67f641d5a0ad1a9fe53d415da58d961">lbm_context_attr_setopt()</a> and specify <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#contextnamecontext">context_name (context)</a> as the optname and the context's name as the optval. Don't forget to set the optlen. </li>
<li>
Create a plain text UM configuration file with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#contextnamecontext">context_name (context)</a> set to the name of the context. </li>
</ul>
<p>Context names are optional but should be unique within a process. UM does not enforce uniqueness, rather issues a log warning if it encounters duplicate context names. Application context names are only used to load template and individual option values within an XML UM configuration file.</p>
<p>One of the more important functions of a context is to hold configuration information that is of context scope. See the <a href="../../Config/index.html">UM Configuration Guide</a> for options that are of context scope.</p>
<p>Most UM applications create a single context. However, there are some specialized circumstances where an application would create multiple contexts. For example, with appropriate configuration options, two contexts can provide separate topic name spaces. Also, multiple contexts can be used to portion available bandwidth across topic sub-spaces (in effect allocating more bandwidth to high-priority topics).</p>
<dl class="section attention"><dt>Attention</dt><dd>Regardless of the number of contexts created by your application, a good practice is to keep them open throughout the life of your application. Do not close them until you close the application.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="topicobject"></a>
Topic Object&nbsp;&nbsp;<small><a href="#topicobject">&lt;-</a></small></h2>
<p>A UM topic object is conceptually very simple; it is little more than a container for a string (the topic name). However, UM uses the topic object to hold a variety of state information used by UM for internal processing. It is conceptually contained within a context. Topic objects are used by applications in the creation of <a class="el" href="index.html#sourceobject">sources</a> and <a class="el" href="index.html#receiverobject">receivers</a>.</p>
<p>Technically, the user's application does not create or delete topic objects. Their management is handled internally by UM, as needed. The application uses APIs to gain access to topic objects. A publishing application calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1ba60407fa2bde0997aab6d5a5d2da1a">lbm_src_topic_alloc()</a> to get a reference to a topic object that it intends to use for creation of a <a class="el" href="index.html#sourceobject">Source Object</a>. A subscribing application calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3de8a6a659896f76475c453683db4e18">lbm_rcv_topic_lookup()</a> to get a reference to a topic object that it intends to use for creation of a <a class="el" href="index.html#receiverobject">Receiver Object</a>.</p>
<p>The application does not need to explicitly tell UM when it no longer needs the topic object. The application's reference can simply be discarded.</p>
<p><br />
 </p>
<h2><a class="anchor" id="sourceobject"></a>
Source Object&nbsp;&nbsp;<small><a href="#sourceobject">&lt;-</a></small></h2>
<p>A UM source object is used to send messages to the topic that it is bound to. It is conceptually contained within a context.</p>
<p>You create a source object by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8dd76271bf9df7a5f88476d431f523e">lbm_src_create()</a>. One of its parameters is a <a class="el" href="index.html#topicobject">Topic Object</a>. A source object can be bound to only one topic. The application is responsible for deleting a source object when it is no longer needed by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a29d45db8f76835b4ae78f4568c25712f">lbm_src_delete()</a>. See <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcestring"></a>
Source String&nbsp;&nbsp;<small><a href="#sourcestring">&lt;-</a></small></h3>
<p>Every source that a publishing application creates has associated with it a unique "source string". Note that if multiple publishing UM contexts (applications) create sources for the same topic, each context's source will have its own unique source string. Similarly, if one publishing UM context (application) creates multiple sources for different topics, each topic's source will have its own unique source string. So a source string identifies one specific instance of a topic within a UM context.</p>
<p>The source string is used in a few different ways in the UM API, for example to identify which <a class="el" href="index.html#transportsessions">Transport Session</a> to retrieve statistics for in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4094c703f97a7ebe340b985b2ed1ac2b">lbm_rcv_retrieve_transport_stats()</a>. The source string is made available to the application in several callbacks, for example <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a20d2e77507380a39c081a95462acb995">lbm_src_notify_function_cb</a>, or the "source" field of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t_stct</a> of a received message. See also <a class="el" href="index.html#sendingtosources">Sending to Sources</a>.</p>
<p>The format of a source string depends on the transport type: </p><ul>
<li>
<p class="startli">TCP:src_ip:src_port:session_id[topic_idx] <br />
 example: <code>TCP:10.29.3.88:45789:f1789bcc[1539853954]</code></p>
<p class="endli"></p>
</li>
<li>
<p class="startli">LBTRM:src_ip:src_port:session_id:mc_group:dest_port[topic_idx] <br />
 example: <code>LBTRM:10.29.3.88:14390:e0679abb:231.13.13.13:14400[1539853954]</code></p>
<p class="endli"></p>
</li>
<li>
<p class="startli">LBT-RU:src_ip:src_port:session_id[topic_idx] <br />
 example: <code>LBT-RU:10.29.3.88:14382:263170a3[1539853954]</code></p>
<p class="endli"></p>
</li>
<li>
<p class="startli">LBT-IPC:session_id:transport_id[topic_idx] <br />
 example: <code>LBT-IPC:6481f8d4:20000[1539853954]</code></p>
<p class="endli"></p>
</li>
<li>
<p class="startli">LBT-SMX:session_id:transport_id[topic_idx] <br />
 example: <code>LBT-SMX:6481f8d4:20000[1539853954]</code></p>
<p class="endli"></p>
</li>
<li>
BROKER <br />
 example: <code>BROKER</code> </li>
</ul>
<p>Please note that the topic index field (topic_idx) may or may not be included, depending on the context in which it is presented, your version of UM, and the setting for configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#sourceincludestopicindexcontext">source_includes_topic_index (context)</a>. For example, a receiver callback probably will include the topic index since the callback is specific to a topic, while <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html">Monitoring</a> output will not, since it is referring to a transport session, not an individual topic.</p>
<p>See also <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#afa35ad2c7d5d473ffeda6727022f9b94">lbm_transport_source_format()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a30bf33dce2021f6ea8915b45f511af56">lbm_transport_source_parse()</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcestringsinaroutednetwork"></a>
Source Strings in a Routed Network&nbsp;&nbsp;<small><a href="#sourcestringsinaroutednetwork">&lt;-</a></small></h3>
<p>In a UM network consisting of multiple Topic Resolution Domains (TRDs) connected by <a class="el" href="index.html#umrouter">DROs</a>, a given source will be uniquely identifiable within a TRD by its source string. However, that same source will have different source strings in different TRDs. For receivers in the same TRD as the source, the source string will refer to the source. But in remote TRDs, that same source's source string will refer to the <em>proxy source</em> of the DRO on the shortest path to the source. The IP information contained in the source string will refer to the DRO.</p>
<p>This can lead to a situation where multiple originating sources located elsewhere in the UM network will have source strings with the same IP information in a given TRD. They will differ by Topic Index number, but even that topic index will be different in different TRDs.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourceconfigurationandtransportsessions"></a>
Source Configuration and Transport Sessions&nbsp;&nbsp;<small><a href="#sourceconfigurationandtransportsessions">&lt;-</a></small></h3>
<p>As with contexts, a source holds configuration information that is of source scope. This includes network options, operational options and reliability options for LBT-RU and LBT-RM. For example, each source can use a different transport and would therefore configure a different network address to which to send topic messages. See the <a href="../../Config/index.html">UM Configuration Guide</a> for source configuration options.</p>
<p>As stated in <a class="el" href="index.html#umtransports">UM Transports</a>, many topics (and therefore sources) can be mapped to a single transport. Many of the configuration options for sources actually control or influence <a class="el" href="index.html#transportsessions">Transport Session</a> activity. If many sources are sending topic messages over a single Transport Session (TCP, LBT-RU or LBT-RM), UM only uses the configuration options for the first source assigned to the transport.</p>
<p>For example, if the first source to use a LBT-RM Transport Session sets the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakgenerationintervalreceiver">transport_lbtrm_nak_generation_interval (receiver)</a> to 24 MB and the second source sets the same option to 2 MB, UM assigns 24 MB to the Transport Session's <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakgenerationintervalreceiver">transport_lbtrm_nak_generation_interval (receiver)</a>.</p>
<p>The <a href="../../Config/index.html">UM Configuration Guide</a> identifies the source configuration options that may be ignored when UM assigns the source to an existing Transport Session. Log file warnings also appear when UM ignores source configuration options.</p>
<p><br />
 </p>
<h2><a class="anchor" id="receiverobject"></a>
Receiver Object&nbsp;&nbsp;<small><a href="#receiverobject">&lt;-</a></small></h2>
<p>A UM receiver object is used to receive messages from the topic that it is bound to. It is conceptually contained within a context. Messages are delivered to the application by an application callback function, specified when the receiver object is created.</p>
<p>You create a receiver object by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa7491c50fefbc2b70f8035fce7ac1477">lbm_rcv_create()</a>. One of its parameters is a <a class="el" href="index.html#topicobject">Topic Object</a>. A receiver object can be bound to only one topic. The application is responsible for deleting a receiver object when it is no longer needed by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8d5e8713f5ae776330b23a1e371f934d">lbm_rcv_delete()</a>. See <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a>.</p>
<p>Multiple receiver objects can be created for the same topic within a single context, which can be used to trigger multiple delivery callbacks when messages arrive for that topic.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiverconfigurationandtransportsessions"></a>
Receiver Configuration and Transport Sessions&nbsp;&nbsp;<small><a href="#receiverconfigurationandtransportsessions">&lt;-</a></small></h3>
<p>A receiver holds configuration information that is of receiver scope. This includes network options, operational options and reliability options for LBT-RU and LBT-RM. See the <a href="../../Config/index.html">UM Configuration Guide</a> for receiver configuration options.</p>
<p>As stated above in <a class="el" href="index.html#sourceconfigurationandtransportsessions">Source Configuration and Transport Sessions</a>, multiple topics (and therefore receivers) can be mapped to a single transport. As with source configuration options, many receiver configuration options control or influence <a class="el" href="index.html#transportsessions">Transport Session</a> activity. If multiple receivers are receiving topic messages over a single Transport Session (TCP, LBT-RU or LBT-RM), UM only uses the configuration options for the first receiver assigned to the transport.</p>
<p>For example, if the first receiver to use a LBT-RM Transport Session sets <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakgenerationintervalreceiver">transport_lbtrm_nak_generation_interval (receiver)</a> to 10 seconds, that value is applied to the Transport Session. If a second receiver using the same transport session sets the same option to 2 seconds, that value is ignored.</p>
<p>The <a href="../../Config/index.html">UM Configuration Guide</a> identifies the receiver configuration options that may be ignored when UM assigns the receiver to an existing Transport Session. Log file warnings also appear when UM ignores receiver configuration options.</p>
<p><br />
 </p>
<h3><a class="anchor" id="umwildcardreceivers"></a>
UM Wildcard Receivers&nbsp;&nbsp;<small><a href="#umwildcardreceivers">&lt;-</a></small></h3>
<p>You create a wildcard receiver object by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5b5d52f6b87499213757b73b09bc8160">lbm_wildcard_rcv_create()</a>. Instead of a topic object, the caller supplies a pattern which UM uses to match multiple topics. Because the application does not explicitly lookup the topics, UM passes the topic attribute into <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5b5d52f6b87499213757b73b09bc8160">lbm_wildcard_rcv_create()</a> so that it can set options. Also, wildcard receivers have their own set of options, such as pattern type. The application is responsible for deleting a wildcard receiver object when it is no longer needed by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a64407f3874012efaebcba322ea6d229d">lbm_wildcard_rcv_delete()</a>.</p>
<p>The wildcard pattern supplied for matching is a PCRE regular expression that Perl recognizes. See <a href="http://perldoc.perl.org/perlrequick.html">http://perldoc.perl.org/perlrequick.html</a> for details about PCRE.</p>
<dl class="section note"><dt>Note</dt><dd>Ultra Messaging has deprecated two other wildcard receiver pattern types, regex POSIX extended regular expressions and appcb application callback, as of UM Version 6.1. Only PCRE is supported.</dd></dl>
<p>Be aware that some platforms may not support all of the regular expression wildcard types. For example, UM does not support the use of Unicode PCRE characters in wildcard receiver patterns on any system that communicates with a HP-UX or AIX system. See the Informatica Knowledge Base article, <a href="https://kb.informatica.com/faq/5/Pages/80077.aspx">Platform-Specific Dependencies</a> for details.</p>
<p>For examples of wildcard usage, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmwrcv_c">Example lbmwrcv.c</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmwrcv_java">Example lbmwrcv.java</a>, and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmwrcv_cs">Example lbmwrcv.cs</a>.</p>
<p>For more information on wildcard receivers, see <a class="el" href="index.html#wildcardreceivertopicresolution">Wildcard Receiver Topic Resolution</a>, and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpwildcardreceiver.html">Wildcard Receiver Options</a>.</p>
<p>TIBCO users see the Informatica Knowledge Base articles, <a href="https://kb.informatica.com/faq/5/Pages/80075.aspx">Wildcard topic regular expressions and SmartSockets wildcards</a> and <a href="https://kb.informatica.com/faq/5/Pages/80277.aspx">Wildcard topic regular expressions and Rendezvous wildcards</a>.</p>
<p><a class="anchor" id="overlappingreceivers"></a><b>Overlapping Receivers</b></p>
<p>Suppose an application creates three receivers:</p>
<ol>
<li>
Wildcard receiver1: "^example[0-9]$" </li>
<li>
Single-topic receiver: "example1". </li>
<li>
Wildcard receiver2: "^[a-z]*1$" </li>
</ol>
<p>A source for topic "example1" will match all three receivers. Each receiver's object's "receiver callback" will be invoked sequentially for each received message. However, be aware that these are simply multiple callbacks from a single underlying UM receiver; they are not independent.</p>
<p>This becomes significant if different "receiver" scoped configuration options are specified for the different receiver objects, a usage that Informatica recommends against. Only one of the receiver object's configuration is used to create the underlying receiver; the others are ignored. In the above example, it is not necessarily the first receiver object which applies its configuration. If, for example, the source is not yet discovered until later, UM does not define which of the above three receiver objects will be used.</p>
<p>Informatica recommends users always use the same configuration options when creating multiple receiver objects that overlap.</p>
<p><br />
 </p>
<h3><a class="anchor" id="transportservicesproviderobject"></a>
Transport Services Provider Object&nbsp;&nbsp;<small><a href="#transportservicesproviderobject">&lt;-</a></small></h3>
<p>The Transport Services Provider object ("XSP") was introduced with UM version 6.11 to manage sockets, threads, and other receive-side resources associated with subscribed <a class="el" href="index.html#transportsessions">Transport Sessions</a>. The primary purpose for an XSP object is to allow the programmer to control the threading of received messages, based on the Transport Sessions of those messages.</p>
<p>For more information on XSP, see <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="umhotfailoveracrosscontextsobjects"></a>
UM Hot Failover Across Contexts Objects (HFX)&nbsp;&nbsp;<small><a href="#umhotfailoveracrosscontextsobjects">&lt;-</a></small></h3>
<p>Hot Failover Across Contexts objects ("HFX") provide a form of hot failover that can operate across multiple network interfaces.</p>
<p>Note that the HFX feature is deprecated.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#drohotlinks">DRO Hotlinks</a> for a similar feature.</p>
<p><br />
 </p>
<h2><a class="anchor" id="eventqueueobject"></a>
Event Queue Object&nbsp;&nbsp;<small><a href="#eventqueueobject">&lt;-</a></small></h2>
<p>Most UM events, like received messages, are delivered to the application via event handler callbacks, like a receiver callback. A UM "event queue" object is a queue for moving execution of a UM callbacks to a different thread - the event queue dispatch thread.</p>
<p>Note that unlike other UM objects, event queues are not owned by a context. An event queue is a top-level object, and can be associated with contexts, sources, and/or receivers.</p>
<dl class="section warning"><dt>Warning</dt><dd>Before deleting an event queue, you must first delete all objects associated with it (contexts, sources, receivers, timers). See <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a>.</dd></dl>
<p>By default, UM events will be delivered from a variety of different threads, frequently a context or XSP thread. Context/XSP thread callbacks are the most efficient form of event delivery, but place restrictions on your callback code. For example:</p>
<ul>
<li>
The application function is not allowed to make certain API calls (mostly having to do with creating or deleting UM objects). </li>
<li>
The application function must execute very quickly without blocking. </li>
<li>
The application does not have control over when the callback executes. For example, events might be delivered concurrently from different application and context/XSP threads. </li>
</ul>
<p>For these reasons, you might want to transfer handling of UM events to a different thread. This can impose strict serialization and remove restrictions.</p>
<p>You could make use of your own queue for this, perhaps a standard library queue (although be careful of multiple threads enqueuing on the same queue), or perhaps <a href="https://lmax-exchange.github.io/disruptor/disruptor.html">LMAX's "Disruptor"</a>. Or you can use the UM event queue.</p>
<p>An advantage of the UM event queue is that it retains all of the semantics of the UM callback. The callback code is structured the same, regardless of whether it is called from a context/XSP thread or from an event queue dispatch thread. A disadvantage of the UM event queue is efficiency: it makes a kernel call for each enqueue and each dequeue.</p>
<p>UM event queues are unbounded, non-blocking queues and provide the following features:</p>
<ul>
<li>
Queue length monitoring. Informatica strongly recommends using the event queue monitor callback to warn if the configured <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html#queuesizewarningeventqueue">size</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html#queuedelaywarningeventqueue">latency</a> thresholds are exceeded. (Note: exceeding a threshold does not prevent new events from being enqueued.) See <a class="el" href="index.html#eventqueuemonitor">Event Queue Monitor</a> for more information. </li>
<li>
The application callback function has no UM API restrictions. </li>
<li>
Your application can control exactly when UM delivers queued events with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a>. And you can have control return to your application either when specifically asked to do so (by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af4b1b274cb142acefe0826673ecffdbe">lbm_event_dispatch_unblock()</a>), or optionally when there are no events left to deliver. </li>
<li>
Your application can take advantage of parallel processing on multiple processor hardware since UM processes asynchronously on a separate thread from your application's processing of received messages. By using multiple application threads to dispatch an event queue, or by using multiple event queues, each with its own dispatch thread, your application can further increase parallelism. </li>
</ul>
<p>You create an UM event queue in the C API by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac7ebe02319363c84bef08f34be7865ec">lbm_event_queue_create()</a>. When finished with an event queue, delete it by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a189f4c0178374d488acacf592c3015e4">lbm_event_queue_delete()</a>.</p>
<p>In the Java API and the .NET API, use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEventQueue.html">LBMEventQueue</a> class.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html">Event Queue Options</a> for configuration options related to event queues.</p>
<p><br />
 </p>
<h3><a class="anchor" id="usinganeventqueue"></a>
Using an Event Queue&nbsp;&nbsp;<small><a href="#usinganeventqueue">&lt;-</a></small></h3>
<p>To use an Event Queue, an application typically performs the following actions: </p><ol>
<li>
Create the Event Queue using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac7ebe02319363c84bef08f34be7865ec">lbm_event_queue_create()</a>. <div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6897baf281a5b4729e05c873aacac420">lbm_event_queue_t</a> *evq;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac7ebe02319363c84bef08f34be7865ec">lbm_event_queue_create</a>(&amp;evq, NULL, NULL, NULL);</div></div><!-- fragment --> </li>
<li>
Create a new thread of execution to be the dispatch thread. This new thread should call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a> in a loop. <div class="fragment"><div class="line">evq_running = 1;</div><div class="line"><span class="keywordflow">while</span> (evq_running) {</div><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch</a>(evq, LBM_EVENT_QUEUE_BLOCK);</div><div class="line">  <span class="keywordflow">if</span> (err == LBM_FAILURE) { ... handle error ... }</div><div class="line">}</div><div class="line"><span class="comment">/* Exit the thread (OS-dependent). */</span></div></div><!-- fragment --> Note that the return value should be compared to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a06fc87d81c62e9abb8790b6e5713c55baf90fd7c1c303f82795102f289988877a">LBM_FAILURE</a> (-1), and not the normal success value of 0. This is because on success, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a> returns the number of events that were dispatched during its execution. </li>
<li>
Create other UM objects whose events you want processed by the event queue. For example, creating a UM Receiver object with the Event Queue will call your message receiver callback through the event queue, using your dispatch thread. <div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *rcv;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa7491c50fefbc2b70f8035fce7ac1477">lbm_rcv_create</a>(&amp;rcv, ctx, topic, app_rcv_callback, NULL, evq);</div></div><!-- fragment --> From this point, your application receiver callback function will be called from the dispatch loop for received messages and other receiver events. </li>
<li>
When it is time to shut down the program, the UM objects that refer to the event queue must first be deleted. <div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8d5e8713f5ae776330b23a1e371f934d">lbm_rcv_delete</a>(rcv);</div></div><!-- fragment --> Remember that an event queue might be handling events for many UM objects; they must all be deleted prior to deleting the event queue. </li>
<li>
Now shut down dispatching the event queue. <div class="fragment"><div class="line">evq_running = 0;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af4b1b274cb142acefe0826673ecffdbe">lbm_event_dispatch_unblock</a>(evq);</div><div class="line"><span class="comment">/* &quot;Join&quot; the dispatch thread (OS-dependent). */</span></div></div><!-- fragment --> The unblock forces the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a> function to return. Typically at that point, the dispatch thread is "joined", which blocks until the dispatch thread exits. </li>
<li>
Delete the event queue. <div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a189f4c0178374d488acacf592c3015e4">lbm_event_queue_delete</a>(evq);</div></div><!-- fragment --> </li>
</ol>
<p>Here are some lesser used event queue APIs: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab0a5134ef39fc7054e5d164f0a1889f7">lbm_event_queue_size()</a> - number of events in the queue. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad94310754a9f685693f789a017c7bb7e">lbm_event_queue_shutdown()</a> - purge events from the queue (risky). </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aeb9ed445a630f0db48f8c9d24bf23178">lbm_event_queue_retrieve_stats()</a> - retrieve statistics counters. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1838b8382eb314eed96e6ed48c0d1f5b">lbm_event_queue_reset_stats()</a> - reset statistics counters. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="deletinganeventqueue"></a>
"Deleting an Event Queue"&nbsp;&nbsp;<small><a href="#deletinganeventqueue">&lt;-</a></small></h3>
<p>Before you can delete an event queue, you must ensure that your application's dispatch thread is no longer running it. Here is the typical order of operation for deleting an event queue: </p><ol>
<li>
<p class="startli"><b>Unblock the event queue</b> (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af4b1b274cb142acefe0826673ecffdbe">C API</a> / <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEventQueue.html#a7ab8e8a3b6cc2c82843acbd549f03b0b">Java and .NET API</a>). This causes the application's dispatch thread to return from the dispatch function (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">C API</a> / <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEventQueue.html#ae39293f006fbec45d420b8794b1b4512">Java and .NET API</a>).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Exit the application's dispatch thread</b>, typically with a thread join function.</p>
<p class="endli"></p>
</li>
<li>
<b>Delete the event queue</b> (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a189f4c0178374d488acacf592c3015e4">C API</a> / <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEventQueue.html#af7293afb0a08887009264f98c0735192">Java and .NET API</a>). </li>
</ol>
<p><br />
 </p>
<h3><a class="anchor" id="eventqueueefficiency"></a>
Event Queue Efficiency&nbsp;&nbsp;<small><a href="#eventqueueefficiency">&lt;-</a></small></h3>
<p>A UM event queue introduces a kernel call with each enqueue and dequeue. Kernel calls are considered costly for very low latency or high throughput applications.</p>
<p>Compared with a lockless, busy waiting queue like <a href="https://lmax-exchange.github.io/disruptor/disruptor.html">LMAX's "Disruptor"</a>, the UM event queue will have a lower maximum sustainable throughput and higher latency. The latency penalty will be especially apparent at low message rates where the dispatch thread is put to sleep waiting for new events.</p>
<p>The performance of the UM event queue can be improved by using <a class="el" href="index.html#receivesidebatching">Receive-Side Batching</a> and by polling the event queue in a tight loop (see <a class="el" href="index.html#eventqueuetimeout">Event Queue Timeout</a>).</p>
<p><br />
 </p>
<h3><a class="anchor" id="eventqueuetimeout"></a>
Event Queue Timeout&nbsp;&nbsp;<small><a href="#eventqueuetimeout">&lt;-</a></small></h3>
<p>The second parameter passed to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a> is a timeout. There are two special values: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2c6b535637bfd72be2905b0cd4782140">LBM_EVENT_QUEUE_BLOCK</a> - no timeout. Do not return until <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af4b1b274cb142acefe0826673ecffdbe">lbm_event_dispatch_unblock()</a> is called. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1995a85e2c983f6b38322c5c5784f32e">LBM_EVENT_QUEUE_POLL</a> - no wait. If there are one or more events in the queue, process exactly one of them and return. Otherwise, return immediately without waiting. </li>
</ul>
<p>Any other value specifies a timeout in milliseconds.</p>
<p>However, this timeout does not necessarily limit the time spent waiting inside the dispatch function. The purpose of the timeout is to set a <em>minimum</em> time that the dispatch function will process events, not a maximum.</p>
<p>The implementation of the event queue uses an unbounded wait for incoming events. When an event is delivered to the queue, the dispatch function wakes up and processes the event (calls the appropriate application callback). Then the dispatch function checks the time to see if the timeout has been exceeded. If so, the dispatch function returns. Otherwise, it waits for the next event.</p>
<p>However, suppose that no further events are delivered to the event queue. In this case, the dispatch function will wait without bound. The timeout parameter will not cause the dispatch function to stop waiting.</p>
<p>If the application needs an upper limit to the time spent dispatching, the timeout can be combined with the use of an external timer that calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af4b1b274cb142acefe0826673ecffdbe">lbm_event_dispatch_unblock()</a> when the maximum time has expired. UM's timer system may be used by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6ddbee95ee1eb4e6b98b177f84157f8a">lbm_schedule_timer()</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="eventqueuemonitor"></a>
Event Queue Monitor&nbsp;&nbsp;<small><a href="#eventqueuemonitor">&lt;-</a></small></h3>
<p>The UM event queue is unbounded, meaning that it doesn't have a fixed maximum size. Rather, if the incoming event (e.g. message) rate exceeds the callback processing rate, the event queue will grow without bound, eventually consuming the maximum available memory, usually crashing the program.</p>
<p>The only way to prevent this unbounded memory growth is to ensure that your event handler callback can keep up with the incoming event rate. However, this is usually impossible to guarantee, so it is important for applications to monitor queue growth and at least raise an alert if it exceeds some threshold.</p>
<p>The event queue size can change very quickly during traffic bursts. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#automaticmonitoring">Automatic Monitoring</a> is not a good solution for detecting these rapid spikes in queue length. UM has a special form of monitoring designed specifically for event queues: a monitoring callback.</p>
<p>You set the size threshold, in number of events, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html#queuesizewarningeventqueue">queue_size_warning (event_queue)</a>. You can also set a latency threshold, in microseconds that events are waiting in the event queue, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html#queuedelaywarningeventqueue">queue_delay_warning (event_queue)</a>. It is also possible to be notified every time an event is added to the event queue, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpeventqueue.html#queueenqueuenotificationeventqueue">queue_enqueue_notification (event_queue)</a> (no information is available about the event).</p>
<p>UM tests the queue against the thresholds during the process of dispatching events. When the dispatch thread dequeues an event, it checks the size of the queue and the amount of time the dequeued event spent in the queue. If either or both exceed their thresholds, the monitor callback is called. If there is a burst of traffic, the size threshold can be exceeded by many events. In that case, the monitor callback will be called repeatedly for each dequeued event that exceeds a threshold.</p>
<p>Informatica strongly recommends minimizing the monitor callback to perform as little work as possible. Remember that the event queue grows when the event handling callback cannot keep up with the incoming event rate. Given that the monitor callback is called by the dispatch thread, its execution time is added to your event handler, slowing it down even further. We recommend setting a "high water mark" of the maximum detected queue size, and letting a separate thread periodically check that high water mark and raise an alert.</p>
<p>Note that if an application event handling callback were to deadlock and never return, the dispatch thread would be effectively halted, and the monitor callback would never be called. The monitor callback cannot be used to detect a hung application.</p>
<p><b>C Code Example:</b> </p><div class="fragment"><div class="line"><span class="comment">/* Define monitor callback. */</span></div><div class="line"><span class="keywordtype">int</span> evq_monitor(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6897baf281a5b4729e05c873aacac420">lbm_event_queue_t</a> *evq, <span class="keywordtype">int</span> event, <span class="keywordtype">size_t</span> evq_size,</div><div class="line">                <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a72438fab15bf500af58d2a8a521e470d">lbm_ulong_t</a> evq_delay_usec, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  <span class="comment">/* The &quot;event&quot; parameter is sometimes used as a bitmap, and other times</span></div><div class="line"><span class="comment">   * used as an absolute value. */</span></div><div class="line">  <span class="keywordflow">if</span> ((event == LBM_EVENT_QUEUE_ENQUEUE_NOTIFICATION)</div><div class="line">       &amp;&amp; (evq_size == 1) &amp;&amp; (evq_delay_usec == 0)) {</div><div class="line">    <span class="comment">/* This is an ENQUEUE notification. No info available on the event. */</span></div><div class="line">    ...</div><div class="line">  }</div><div class="line">  <span class="keywordflow">else</span> {</div><div class="line">    <span class="comment">/* &quot;event&quot; is a bitmap; one or both conditions might be active. */</span></div><div class="line">    <span class="keywordflow">if</span> (event &amp; LBM_EVENT_QUEUE_SIZE_WARNING) {</div><div class="line">      <span class="comment">/* The size threshold is exceeded for the next event to be dispatched.</span></div><div class="line"><span class="comment">       * There are evq_size events in the queue. */</span></div><div class="line">      ...</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (event &amp; LBM_EVENT_QUEUE_DELAY_WARNING) {</div><div class="line">      <span class="comment">/* The delay threshold is exceeded for the next event to be dispatched.</span></div><div class="line"><span class="comment">       * The next event to be dispatched waited in the queue for evq_delay_usec */</span></div><div class="line">      ...</div><div class="line">    }</div><div class="line">  }</div><div class="line">}  <span class="comment">/* evq_monitor */</span></div><div class="line"></div><div class="line">  ...</div><div class="line">  <span class="comment">/* Initialization code, create event queue. */</span></div><div class="line">  <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6897baf281a5b4729e05c873aacac420">lbm_event_queue_t</a> *evq;</div><div class="line">  ...</div><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac7ebe02319363c84bef08f34be7865ec">lbm_event_queue_create</a>(&amp;evq, evq_monitor, NULL, NULL);</div></div><!-- fragment --><p><b>Java and .NET Code Example:</b> </p><div class="fragment"><div class="line"><span class="comment">/* Define monitor callback. */</span></div><div class="line"><span class="keyword">class </span>MyEventQueue <span class="keyword">extends</span> LBMEventQueue implements LBMEventQueueCallback</div><div class="line">{</div><div class="line">  <span class="keyword">public</span> MyEventQueue() throws LBMException</div><div class="line">  {</div><div class="line">      super();</div><div class="line">      addMonitor(<span class="keyword">this</span>);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> monitor(Object cbArg, <span class="keywordtype">int</span> event, <span class="keywordtype">int</span> evqSize, <span class="keywordtype">long</span> evqDelayUsec)</div><div class="line">  {</div><div class="line">    <span class="comment">/* The &quot;event&quot; parameter is sometimes used as a bitmap, and other times</span></div><div class="line"><span class="comment">     * used as an absolute value. */</span></div><div class="line">    <span class="keywordflow">if</span> ((event == LBM.EVENT_QUEUE_ENQUEUE_NOTIFICATION)</div><div class="line">         &amp;&amp; (evqSize == 1) &amp;&amp; (evqDelayUsec == 0)) {</div><div class="line">      <span class="comment">/* This is an ENQUEUE notification. No info available on the event. */</span></div><div class="line">      ...</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">/* &quot;event&quot; is a bitmap; one or both conditions might be active. */</span></div><div class="line">      <span class="keywordflow">if</span> (event &amp; LBM.EVENT_QUEUE_SIZE_WARNING) {</div><div class="line">        <span class="comment">/* The size threshold is exceeded for the next event to be dispatched. */</span></div><div class="line">        ...</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (event &amp; LBM.EVENT_QUEUE_DELAY_WARNING) {</div><div class="line">        <span class="comment">/* The delay threshold is exceeded for the next event to be dispatched. */</span></div><div class="line">        ...</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }  <span class="comment">/* monitor */</span></div><div class="line">}</div><div class="line">...</div><div class="line"></div><div class="line">  <span class="comment">/* Initialization, create event queue. */</span></div><div class="line">  MyEventQueue evq = <span class="keyword">new</span> MyEventQueue();</div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="messageobject"></a>
Message Object&nbsp;&nbsp;<small><a href="#messageobject">&lt;-</a></small></h2>
<p>When an application subscribes to a topic to which publishers are sending messages, the received messages are delivered to the application by an application callback function (see <a class="el" href="index.html#eventdelivery">Event Delivery</a>). One of the parameters that UM passes to the application callback is a message object. This object gives the application access to the content of the message, as well as some metadata about the message, such as the topic.</p>
<p>Unlike other objects described above, the user does not create these message objects by API call. UM creates and initializes the objects internally.</p>
<p>The default life-span of a message object is different between C and Java or .NET.</p>
<p><br />
 </p>
<h3><a class="anchor" id="messageobjectdeletion"></a>
Message Object Deletion&nbsp;&nbsp;<small><a href="#messageobjectdeletion">&lt;-</a></small></h3>
<p><b>C API</b></p>
<p>In C, by default, the message object is deleted when the receiver callback returns. No action is necessary by the application to trigger that deletion.</p>
<p>See <a class="el" href="index.html#messagereception">Message Reception</a> for details, including code examples.</p>
<p><b>Java or .NET API</b></p>
<p>In Java or .NET, the passed-in message object is <em>not</em> automatically deleted when the receiver application callback returns. Instead, the message object is fully deleted only when all references to the object are lost and the garbage collector reclaims the object.</p>
<p>However, applications which allow this kind of garbage buildup and collection usually suffer from large latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>), and while garbage collection can be tuned to minimize its impact, it is usually recommended that latency-sensitive applications manage their objects more carefully to prevent creation of garbage. See <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>.</p>
<p>Also, there are some UM features in which specific actions are triggered by the deletion of messages, and the application designer usually wants to control when those actions are performed (for example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>).</p>
<p>For these reasons, Java and .NET developers are strongly advised to explicitly dispose of a message object when the application is finished with it. It does this by calling the "dispose()" method of the message object. In the simple case, this should be done in the receiver application callback just before returning.</p>
<p>See <a class="el" href="index.html#messagereception">Message Reception</a> for details, including code examples.</p>
<p><br />
 </p>
<h3><a class="anchor" id="messageobjectretention"></a>
Message Object Retention&nbsp;&nbsp;<small><a href="#messageobjectretention">&lt;-</a></small></h3>
<p>Some applications are designed to process received messages in ways that cannot be completed by the time the receiver callback returns. In these cases, the application must extend the life span of the message object beyond the return from the receiver application callback. This is called "message retention".</p>
<p>Note that message retention prevents the recycling of the UM receive buffer in the UM library. See <a class="el" href="index.html#receivebufferrecycling">Receive Buffer Recycling</a>.</p>
<p><b>C API</b></p>
<p>To prevent automatic deletion of the message object when the receiver application callback returns, the callback must call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a>. This allows the application to transfer the message object to another thread, work queue, or control flow.</p>
<p>When a received message is retained, it becomes the application's responsibility to delete the message explicitly by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa5fc1eb324a55b8c800c31460b0f0116">lbm_msg_delete()</a>. Failure to delete retained messages can lead to unbounded memory growth.</p>
<p>See <a class="el" href="index.html#messagereception">Message Reception</a> for details, including code examples.</p>
<p><b>Java or .NET</b></p>
<p>The receiver application callback typically calls the "promote()" method of the message object prior to returning. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/index.html#retainingmessages">Retaining Messages</a>.</p>
<p>See <a class="el" href="index.html#messagereception">Message Reception</a> for details, including code examples.</p>
<p><br />
 </p>
<h2><a class="anchor" id="attributesobject"></a>
Attributes Object&nbsp;&nbsp;<small><a href="#attributesobject">&lt;-</a></small></h2>
<p>An attribute object is used to programmatically configure other UM objects. Their use is usually optional; omitting them results in default configurations (potentially overridden by configuration files). See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/index.html#configurationoverview">Configuration Overview</a> for details.</p>
<p>However, there is a class of configuration options that require the use of an attribute object: configuring application callbacks. With these options, you are setting a value that includes a pointer to a C function. This cannot be done from a configuration file. For example, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#sourcenotificationfunctionreceiver">source_notification_function (receiver)</a>.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/attributesobjects.html">Attributes Objects</a> for more details on the types, creation, use, and deletion of attributes objects.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umtimers"></a>
UM Timers&nbsp;&nbsp;<small><a href="#umtimers">&lt;-</a></small></h2>
<p>UM also provides a timer function whereby the application can schedule callbacks to be made some number of milliseconds in the future. When a given timer expires, its callback is made. A timer can also be canceled prior to expiration.</p>
<p>These timers are not designed like other UM objects. For example, in the C API, you don't "create" and "delete" them, you "schedule" and optionally "cancel" them. In the Java and .NET APIs, you do instantiate a timer object in the normal way, but you don't "close" them when done.</p>
<dl class="section warning"><dt>Warning</dt><dd>UM timers are not designed for high accuracy. For example, to improve internal efficiency, UM will sometimes expire a timer up to 3 milliseconds early. Also, depending on other work being done, a timer can expire but its callback execution can be delayed an undefined amount of time.</dd></dl>
<p>Main timer API functions: </p><ul>
<li>
<b>Schedule</b> - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6ddbee95ee1eb4e6b98b177f84157f8a">C API</a> / <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMTimer.html#ae0fab63f7bfc8a590048c47a1ef5e4c9">Java and .NET API</a>. </li>
<li>
<b>Cancel</b> - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aac8fc2f828cdcd6a44282c950ee01fb0">C API</a> / <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMTimer.html#ae12107268ca270c63bcc56ca8a5cb100">Java and .NET API</a>. </li>
</ul>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="securityconsiderations"></a>
Security Considerations&nbsp;&nbsp;<small><a href="#securityconsiderations">&lt;-</a></small></h1>
<p>UM should generally be used in secure networks where unauthorized users are unable to access UM components and applications. A UM network can be made secure through the use of certificate-based encryption (see <a class="el" href="index.html#encryptedtcp">Encrypted TCP</a>), but this increases message delivery latency and reduces maximum possible throughput.</p>
<p>In particular, the use of UDP-based protocols (LBT-RM and LBT-RU) cannot secured in the same way that TCP can. In a system that uses UDP-based protocols, there is no mechanism in UM to prevent unauthorized applications to be deployed which can then subscribe and publish topics with complete freedom.</p>
<p><br />
 </p>
<h2><a class="anchor" id="webmonsecurity"></a>
Webmon Security&nbsp;&nbsp;<small><a href="#webmonsecurity">&lt;-</a></small></h2>
<p>Of special interest is the use of simple web-based monitoring of the UM daemons: Store, DRO, SRS. UM does not provide any sort of authentication or authorization for the daemons web pages.</p>
<p>Be aware that the use of UM daemon web-based monitoring pages does place a load on the daemon being monitored. For some pages, that load can be significant. An unauthorized user who rapidly accesses pages can disrupt the normal operation of the daemon, potentially leading to message loss.</p>
<p>Users are expected to prevent unauthorized access to the web monitor through normal firewalling methods. Users who are unable to limit access to a level consistent with their overall security needs should disable the daemon web monitors. See: </p><table class="doxtable">
<tr>
<th>Daemon </th><th><p class="starttd">Configuration Element to Disable Web Monitor</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>Store </td><td><p class="starttd"><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/configurationreferenceforumestored.html#umeelementwebmonitor">&lt;web-monitor&gt;</a></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>DRO </td><td><p class="starttd"><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementwebmonitor">&lt;web-monitor&gt;</a></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>SRS </td><td><a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a> </td></tr>
</table>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="configurationintroduction"></a>
Configuration Introduction&nbsp;&nbsp;<small><a href="#configurationintroduction">&lt;-</a></small></h1>
<p>UM is designed to be highly configurable. Configuration options are generally given default values to support good performance over a wide variety of use cases, but for users who demand the highest levels of performance, many configuration options allow for optimization.</p>
<p>Where practical, UM's design philosophy is to offer new features that can be enabled via configuration only, without requiring changes to the application source code. This can provide higher performance and reliability just by upgrading, without needing to rebuild the application.</p>
<p>Broadly speaking, there are two kinds of components in a UM-based distributed system that need to be configured: </p><ol>
<li>
Application programs, linked with the UM library, </li>
<li>
Informatica daemons (service programs that run in the background), which provide services to the applications. </li>
</ol>
<p>Application programs are written by users and call UM API functions contained within the UM library. The UM library can be configured using a number of different methods described in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/index.html#configurationoverview">Configuration Overview</a>.</p>
<p>Informatica daemons include: </p><ul>
<li>
SRS (Stateful Resolver Service) - provides TCP-based topic resolution services to other components. See <a class="el" href="index.html#srsconfigurationfile">SRS Configuration File</a> for configuration details. </li>
<li>
lbmrd (Resolver Daemon) - provides unicast UDP-based topic resolution services to other components. See <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a> for configuration details. </li>
<li>
Stored - provides persistence services. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/configurationreferenceforumestored.html">Configuration Reference for Umestored</a> for configuration details. </li>
<li>
DRO - routes messages between Topic Resolution Domains. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html">DRO Configuration Reference</a> for configuration details. </li>
<li>
ActiveMQ Broker - provides general queuing services and JMS API. See <a href="https://activemq.apache.org/xml-configuration">ActiveMQ Xml Configuration</a> for configuration details. </li>
</ul>
<p>It is important to remember the different kinds of configuration. </p><ul>
<li>
Applications create UM objects (contexts, sources, receivers) using the UM library. Those objects must be configured to control their operation and behavior using <b>"LBM configuration options"</b>. An application typically uses an <b>"LBM configuration file"</b> in either XML or flat format. For full details on LBM configuration options, see <a href="../../Config/index.html">UM Configuration Guide</a> </li>
<li>
Informatica daemons (e.g. SRS, Store, DRO) are configured using program-specific configuration files in XML format. </li>
<li>
Informatica daemons (e.g. SRS, Store, DRO) also internally create UM objects (contexts, sources, receivers) using the UM library. Those objects must also be configured using one or more LBM configuration files. </li>
</ul>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="transporttypes"></a>
Transport Types&nbsp;&nbsp;<small><a href="#transporttypes">&lt;-</a></small></h1>
<p><br />
 </p>
<h2><a class="anchor" id="transporttcp"></a>
Transport TCP&nbsp;&nbsp;<small><a href="#transporttcp">&lt;-</a></small></h2>
<p>The TCP UM transport uses normal TCP connections to send messages from sources to receivers. This is the default transport when it's not explicitly set.</p>
<p>TCP is a good choice when: </p><ul>
<li>
Flow control is desired. For example, when one or more receivers cannot keep up, you wish to slow down the source. But see <a class="el" href="index.html#tcpflowcontrolrestrictions">TCP Flow Control Restrictions</a>. </li>
<li>
Equal bandwidth sharing with other TCP traffic is desired. The source will slow down when general network traffic becomes heavy. </li>
<li>
There are few receivers listening to each topic. Multiple receivers for a topic requires multiple transmissions of each message, which places a scaling burden on the source machine and the network. </li>
<li>
The application is not sensitive to latency. Use of TCP as a messaging transport can result in unbounded latency. </li>
<li>
The messages must pass through a restrictive firewall which does not pass multicast traffic. </li>
</ul>
<p>Some users choose TCP to avoid unrecoverable loss. However, be aware that network failures can result in TCP disconnects, which can lead to missed messages. Also, if the DRO is being used, messages can be dropped due to full queues in an overloaded DRO, leading to unrecoverable loss.</p>
<p>LBT-TCP's <a class="el" href="index.html#transportpacing">Transport Pacing</a> can be either source-paced or receiver-paced. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpmultiplereceiverbehaviorsource">transport_tcp_multiple_receiver_behavior (source)</a>.</p>
<p>UM's TCP transport includes a Session ID. A UM source using the TCP transport generates a unique, 32-bit non-zero random Session ID for each TCP transport (IP:port) it uses. The source also includes the Session ID in its Topic Resolution advertisement (TIR). When a receiver resolves its topic and discovers the transport information, the receiver also obtains the transport's Session ID. The receiver sends a message to the source to confirm the Session ID.</p>
<p>The TCP Session ID enables multiple receivers for a topic to connect to a source across a <a class="el" href="index.html#umrouter">DRO</a>. In the event of a DRO failure, UM establishes new topic routes which can cause cached Topic Resolution and transport information to be outdated. Receivers use this cached information to find sources. Session IDs add a unique identifier to the cached transport information. If a receiver tries to connect to a source with outdated transport information, the source recognizes an incorrect Session ID and disconnects the receiver. The receiver can then attempt to reconnect with different cached transport information.</p>
<dl class="section note"><dt>Note</dt><dd>To maintain interoperability between version pre-6.0 receivers and version 6.0 and beyond TCP sources, you can turn off TCP Session IDs with the UM configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpusesessionidsource">transport_tcp_use_session_id (source)</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="tcpflowcontrolrestrictions"></a>
TCP Flow Control Restrictions&nbsp;&nbsp;<small><a href="#tcpflowcontrolrestrictions">&lt;-</a></small></h3>
<p>The TCP transport protocol can provide a limited form of flow control. If a publisher is sending messages faster than a subscriber can process them, the publisher's "send" call will "block" to force the sender to slow down to the receiver's rate. (Alternatively, a non-blocking send will return -1 with the error code <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>.)</p>
<p>However, be aware that there are restrictions on this use case.</p>
<ul>
<li>
<b>DRO</b> - The DRO does not support end-to-end flow control. If a DRO is between a source and a slow receiver, the DRO will drop messages, resulting in unrecoverable loss in the receiver. </li>
<li>
<b>Event Queue</b> - If the receiver uses an event queue, a slow receiver can result in unbounded memory growth in the subscriber, rather than slowing down the publisher. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpmultiplereceiverbehaviorsource">transport_tcp_multiple_receiver_behavior (source)</a> - if set to "source_paced", the source will drop messages intended for a slow receiver when the socket buffers fill, resulting in unrecoverable loss in the receiver. </li>
</ul>
<p>If end-to-end application-level flow control is needed, users should implement their own handshakes.</p>
<p><br />
 </p>
<h2><a class="anchor" id="transportlbtru"></a>
Transport LBT-RU&nbsp;&nbsp;<small><a href="#transportlbtru">&lt;-</a></small></h2>
<p>The LBT-RU UM transport adds reliable delivery to unicast UDP to send messages from sources to receivers. This provides greater flexibility in the control of latency. For example, the application can further limit latency by allowing the use of arrival order delivery. See the Knowledge Base article, <a href="https://kb.informatica.com/faq/5/Pages/80043.aspx">FAQ: How do arrival-order delivery and in-order delivery affect latency?</a>. Also, LBT-RU is less sensitive to overall network load; it uses source rate controls to limit its maximum send rate.</p>
<p>LBT-RU's <a class="el" href="index.html#transportpacing">Transport Pacing</a> is source-paced.</p>
<p>Since it is based on unicast addressing, LBT-RU can pass through most firewalls. However, it has the same scaling issues as TCP when multiple receivers are present for each topic.</p>
<p>UM's LBT-RU transport includes a Session ID. A UM source using the LBT-RU transport generates a unique, 32-bit non-zero random Session ID for each transport it uses. The source also includes the Session ID in its Topic Resolution advertisement (TIR). When a receiver resolves its topic and discovers the transport information, the receiver also obtains the transport's Session ID.</p>
<p>The LBT-RU Session ID enables multiple receivers for a topic to connect to a source across a <a class="el" href="index.html#umrouter">DRO</a>. In the event of a DRO failure, UM establishes new topic routes which can cause cached Topic Resolution and transport information to be outdated. Receivers use this cached information to find sources. Session IDs add a unique identifier to the cached transport information. If a receiver tries to connect to a source with outdated transport information, the transport drops the received data and times out. The receiver can then attempt to reconnect with different cached transport information.</p>
<dl class="section note"><dt>Note</dt><dd>To maintain interoperability between version pre-3.3 receivers and version 3.3 and beyond LBT-RU sources, you can turn off LBT-RU Session IDs with the UM configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtruusesessionidsource">transport_lbtru_use_session_id (source)</a>.</dd>
<dd>
LBT-RU can benefit from hardware acceleration. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html">Transport Acceleration Options</a> for more information.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="transportlbtrm"></a>
Transport LBT-RM&nbsp;&nbsp;<small><a href="#transportlbtrm">&lt;-</a></small></h2>
<p>The LBT-RM transport adds reliable multicast to UDP to send messages. This provides the maximum flexibility in the control of latency. In addition, LBT-RM can scale effectively to large numbers of receivers per topic using network hardware to duplicate messages only when necessary at wire speed. One limitation is that multicast is often blocked by firewalls.</p>
<p>LBT-RM's <a class="el" href="index.html#transportpacing">Transport Pacing</a> is source-paced.</p>
<p>LBT-RM is a UDP-based, reliable multicast protocol designed with the use of UM and its target applications specifically in mind.</p>
<p>UM's LBT-RM transport includes a Session ID. A UM source using the LBT-RM transport generates a unique, 32-bit non-zero random Session ID for each transport it uses. The source also includes the Session ID in its Topic Resolution advertisement (TIR). When a receiver resolves its topic and discovers the transport information, the receiver also obtains the transport's Session ID.</p>
<dl class="section note"><dt>Note</dt><dd>LBT-RM can benefit from hardware acceleration. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html">Transport Acceleration Options</a> for more information.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="naksuppression"></a>
NAK Suppression&nbsp;&nbsp;<small><a href="#naksuppression">&lt;-</a></small></h3>
<p>Some reliable multicast protocols are susceptible to "NAK storms" in which a subscriber experiences loss due to overload, and the publisher sends those retransmissions, which makes the subscriber's overload <em>more severe</em>, resulting in an even greater loss rate, which triggers an even greater NAK rate, which triggers an even greater retransmission rate, and so on. This self-reinforcing feedback loop can cause healthy, non-overloaded subscribers to become so overwhelmed with retransmissions that they also experience loss and send NAKs, making the storm worse. Some users of other protocols have experienced NAK storms so severe that their entire network "melts down" and becomes unresponsive.</p>
<p>The Ultra Messaging LBT-RM protocol was designed specifically to prevent this kind of run-away feedback loop using a set of algorithms collectively known as "NAK Suppression". These algorithms are designed to repair occasional loss reasonably quickly, while preventing a <a class="el" href="index.html#crybabyreceiver">crybaby receiver</a> from degrading the overall system.</p>
<p>Note that although UM's <a class="el" href="index.html#transportlbtru">Transport LBT-RU</a> does not use Multicast, there are still dangers associated with crybaby receivers. LBT-RU implements most of the same NAK suppression algorithms.</p>
<p>Here are the major elements of UM's NAK suppression algorithms:</p>
<ul>
<li>
<p class="startli">When a receiver detects datagram loss (missing sequence number), it chooses a random amount of time to back off before sending a NAK (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakinitialbackoffintervalreceiver">transport_lbtrm_nak_initial_backoff_interval (receiver)</a>). If the receiver subsequently receives the missing datagram(s) before the timer expires, it cancels the timer and sends no NAK.</p>
<p>This reduces the load in the case of common loss patterns across multiple receivers. Whichever receiver chooses the smallest amount of time sends the NAK, and the retransmission prevents (suppresses) NAKs from the other receivers.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The source has a configurable limit on the rate of retransmissions allowed; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmretransmitratelimitcontext">transport_lbtrm_retransmit_rate_limit (context)</a>. When that rate is reached, the source rejects NAKs for the remainder of the rate limit interval and instead sends NCFs in response to the NAKs. (NCFs suppress receivers from sending NAKs for specific sequence numbers for configurable periods of time.)</p>
<p class="endli"></p>
</li>
<li>
The source has a configurable interval during which it will only send one retransmission for a given sequence number; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmignoreintervalsource">transport_lbtrm_ignore_interval (source)</a>. If a source receives multiple NAKs for the same sequence number within that interval, only the first will trigger a retransmission. Subsequent NAKs within the ignore interval are rejected, triggering one or more NCFs. </li>
</ul>
<p>Note that LBT-RM's NCF algorithm was improved in UM version 6.10. Prior to 6.10, the source responds to every rejected NAK with an NCF (if the reason for the rejection is temporary). In UM 6.10 and beyond, only the first rejected NAK within an ignore interval triggers an NCF. Any subsequent NAKs in the same ignore interval are silently discarded. This reduces the NCF rate in a wide variety of loss conditions, which reduces the stress on healthy receivers.</p>
<dl class="section warning"><dt>Warning</dt><dd>We have seen customers choose configuration values which reduce the protective characteristics of LBT-RM. For example, setting the retransmission rate too high, or the NAK backoff intervals too low. Doing so can reduce loss-induced latency, but can also risk disruptive NAK/retransmission storms which can stress otherwise healthy receivers. Users should request review of their configurations from Informatica's Ultra Messaging support organization.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="comparinglbtrmndpgm"></a>
Comparing LBT-RM and PGM&nbsp;&nbsp;<small><a href="#comparinglbtrmndpgm">&lt;-</a></small></h3>
<p>The LBT-RM protocol is very similar to <a href="http://www.ietf.org/rfc/rfc3208.txt">PGM</a>, but with changes to aid low latency messaging applications.</p>
<ul>
<li>
Topic Mapping - Several topics may map onto the same LBT-RM session. Thus a multiplexing mechanism to LBT-RM is used to distinguish topic level concerns from LBT-RM session level concerns (such as retransmissions, etc.). Each message to a topic is given a sequence number in addition to the sequence number used at the LBT-RM session level for packet retransmission. </li>
<li>
Negative Acknowledgments (NAKs) - LBT-RM uses NAKs as PGM does. NAKs are unicast to the sender. For simplicity, LBT-RM uses a similar NAK state management approach as PGM specifies. </li>
<li>
Time Bounded Recovery - LBT-RM allows receivers to specify a maximum time to wait for a lost piece of data to be retransmitted. This allows a recovery time bound to be placed on data that has a definite lifetime of usefulness. If this time limit is exceeded and no retransmission has been seen, then the piece of data is marked as an unrecoverable loss and the application is informed. The data stream may continue and the unrecoverable loss will be ordered as a discrete event in the data stream just as a normal piece of data. </li>
<li>
Flexible Delivery Ordering - LBT-RM receivers have the option to have the data for an individual topic delivered "in order" or "arrival order". Messages delivered "in order" will arrive in sequence number order to the application. Thus loss may delay messages from being delivered until the loss is recovered or unrecoverable loss is determined. With "arrival-order" delivery, messages will arrive at the application as they are received by the LBT-RM session. Duplicates are ignored and lost messages will have the same recovery methods applied, but the ordering may not be preserved. Delivery order is a topic level concern. Thus loss of messages in one topic will not interfere or delay delivery of messages in another topic. </li>
<li>
Session State Advertisements - In PGM, SPM packets are used to advertise session state and to perform PGM router assist in the routers. For LBT-RM, these advertisements are only used when data are not flowing. Once data stops on a session, advertisements are sent with an exponential back-off (to a configurable maximum interval) so that the bandwidth taken up by the session is minimal. </li>
<li>
Sender Rate Control - LBT-RM can control a sender's rate of injection of data into the network by use of a rate limiter. This rate is configurable and will back pressure the sender, not allowing the application to exceed the rate limit it has specified. In addition, LBT-RM senders have control over the rate of retransmissions separately from new data. This allows the publisher to guarantee a minimum transmission rate even in the face of massive loss at some or all receivers. </li>
<li>
Low Latency Retransmissions - LBT-RM senders do not mandate the use of NCF packets as PGM does. Because low latency retransmissions is such an important feature, LBT-RM senders by default send retransmissions immediately upon receiving a NAK. After sending a retransmission, the sender ignores additional NAKs for the same data and does not repeatedly send NCFs. The oldest data being requested in NAKs has priority over newer data so that if retransmissions are rate controlled, then LBT-RM sends the most important retransmissions as fast as possible. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="transportlbtipc"></a>
Transport LBT-IPC&nbsp;&nbsp;<small><a href="#transportlbtipc">&lt;-</a></small></h2>
<p>The LBT-IPC transport is an Interprocess Communication (IPC) UM transport that allows sources to publish topic messages to a shared memory area managed as a static ring buffer from which receivers can read topic messages. Message exchange takes place at memory access speed which can greatly improve throughput when sources and receivers can reside on the same host.</p>
<p>LBT-IPC's <a class="el" href="index.html#transportpacing">Transport Pacing</a> can be either source-paced or receiver-paced. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcbehaviorsource">transport_lbtipc_behavior (source)</a>.</p>
<p>The LBT-IPC transport uses a "lock free" design that eliminates calls to the Operating System and allows receivers quicker access to messages. An internal validation method enacted by receivers while reading messages from the Shared Memory Area ensures message data integrity. The validation method compares IPC header information at different times to ensure consistent, and therefore, valid message data. Sources can send individual messages or a batch of messages, each of which possesses an IPC header.</p>
<p>Note that while the use of <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> for network-based transports does not conflict with LBT-IPC, it does not apply to LBT-IPC. IPC data flows cannot be assigned to XSP threads.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcesandlbtipc"></a>
Sources and LBT-IPC&nbsp;&nbsp;<small><a href="#sourcesandlbtipc">&lt;-</a></small></h3>
<p>When you create a source with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8dd76271bf9df7a5f88476d431f523e">lbm_src_create()</a> and you've set the transport option to IPC, UM creates a shared memory area object. UM assigns one of the transport IDs to this area specified with the UM context configuration options, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidhighcontext">transport_lbtipc_id_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidlowcontext">transport_lbtipc_id_low (context)</a>. You can also specify a shared memory location outside of this range with a source configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidsource">transport_lbtipc_id (source)</a>, to prioritize certain topics, if needed.</p>
<p>UM names the shared memory area object according to the format, LBTIPC_x_d where x is the hexadecimal Session ID and d is the decimal Transport ID. Example names are <b>LBTIPC_42792ac_20000</b> or <b>LBTIPC_66e7c8f6_20001</b>. Receivers access a shared memory area with this object name to receive (read) topic messages.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html">Transport LBT-IPC Operation Options</a> for configuration information.</p>
<p><b>Sending over LBT-IPC</b></p>
<p>To send on a topic (write to the shared memory area) the source writes to the Shared Memory Area starting at the Oldest Message Start position. It then increments each receiver's Signal Lock if the receiver has not set this to zero.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiversandlbtipc"></a>
Receivers and LBT-IPC&nbsp;&nbsp;<small><a href="#receiversandlbtipc">&lt;-</a></small></h3>
<p>Receivers operate identically to receivers for all other UM transports. A receiver can actually receive topic messages from a source sending on its topic over TCP, LBT-RU or LBT-RM and from a second source sending on LBT-IPC with out any special configuration. The receiver learns what it needs to join the LBT-IPC session through the topic advertisement.</p>
<p>The configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcreceiverthreadbehaviorcontext">transport_lbtipc_receiver_thread_behavior (context)</a> controls the IPC receiving thread behavior when there are no messages available. The default behavior, '<b>pend</b>', has the receiving thread pend on a semaphore for a new message. When the source adds a message, it posts to each pending receiver's semaphore to wake the receiving thread up. Alternatively, <a class="el" href="index.html#glossarybusywaiting">busy_wait</a> can be used to prevent the receiving thread going to sleep. In this case, the source does not need to post to the receiver's semaphore. It simply adds the message to shared memory, which the looping receiving thread detects with the lowest possible latency.</p>
<p>Although '<b>busy_wait</b>' has the lowest latency, it has the drawback of consuming 100% of a CPU core during periods of idleness. This limits the number of IPC data flows that can be used on a given machine to the number of available cores. (If more busy looping receivers are deployed than there are cores, then receivers can suffer 10 millisecond time sharing quantum latencies.)</p>
<p>For application that cannot afford '<b>busy_wait</b>', there is another configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcpendbehaviorlingerloopcountcontext">transport_lbtipc_pend_behavior_linger_loop_count (context)</a>, which allows a middle ground between '<b>pend</b>' and '<b>busy_wait</b>'. The receiver is still be configured as '<b>pend</b>', but instead of going to sleep on the semaphore <em>immediately</em> upon emptying the shared memory, it busy waits for the configured number of times. If a new message arrives, it processes the message immediately without a sleep/wakeup. This can be very useful during bursts of high incoming message rates to reduce latency. By making the loop count large enough to cover the incoming message interval during a burst, only the first message of the burst will incur the wakeup latency.</p>
<p><b>Topic Resolution and LBT-IPC</b></p>
<p>Topic resolution operates identically with LBT-IPC as other UM transports albeit with a new advertisement type, LBMIPC. Advertisements for LBT-IPC contain the Transport ID, Session ID and Host ID. Receivers obtain LBT-IPC advertisements in the normal manner (resolver cache, advertisements received on the multicast resolver address:port and responses to queries.) Advertisements for topics from LBT-IPC sources can reach receivers on different machines if they use the same topic resolution configuration, however, those receivers silently ignore those advertisements since they cannot join the IPC transport. See <a class="el" href="index.html#sendingtobothlocalandremotereceivers">Sending to Both Local and Remote Receivers</a>.</p>
<p><b>Receiver Pacing</b></p>
<p>Although <a class="el" href="index.html#transportpacing">receiver pacing</a> is a source behavior option, some different things must happen on the receiving side to ensure that a source does not reclaim (overwrite) a message until all receivers have read it. When you use the default <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcbehaviorsource">transport_lbtipc_behavior (source)</a> (source-paced), each receiver's Oldest Message Start position in the Shared Memory Area is private to each receiver. The source writes to the Shared Memory Area independently of receivers' reading. For receiver-pacing, however, all receivers share their Oldest Message Start position with the source. The source will not reclaim a message until all receivers have successfully read that message.</p>
<p><b>Receiver Monitoring</b></p>
<p>To ensure that a source does not wait on a receiver that is not running, the source monitors a receiver via the Monitor Shared Lock allocated to each receiving context. (This lock is in addition to the semaphore already allocated for signaling new data.) A new receiver takes and holds the Monitor Shared Lock and releases the resource when it dies. If the source is able to obtain the resource, it knows the receiver has died. The source then clears the receiver's In Use flag in it's Receiver Pool Connection.</p>
<p><br />
 </p>
<h3><a class="anchor" id="similaritieswithotherumtransports"></a>
Similarities with Other UM Transports&nbsp;&nbsp;<small><a href="#similaritieswithotherumtransports">&lt;-</a></small></h3>
<p>Although no actual network transport occurs, IPC functions in much the same way as if you send packets across the network as with other UM transports.</p>
<ul>
<li>
If you use a range of LBT-IPC transport IDs, UM assigns multiple topics sent by multiple sources to all the Transport Sessions in a round robin manner just like other UM transports. </li>
<li>
Transport sessions assume the configuration option values of the first source assigned to the Transport Session. </li>
<li>
Sources are subject to message batching. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="differencesfromotherumtransports"></a>
Differences from Other UM Transports&nbsp;&nbsp;<small><a href="#differencesfromotherumtransports">&lt;-</a></small></h3>
<ul>
<li>
Unlike LBT-RM which uses a transmission window to specify a buffer size to retain messages in case they must be retransmitted, LBT-IPC uses the transmission window option to establish the size of the shared memory. </li>
<li>
LBT-IPC does not retransmit messages. Since LBT-IPC transport is essentially a memory write/read operation, messages should not be be lost in transit. However, if the shared memory area fills up, new messages overwrite old messages and the loss is absolute. No retransmission of old messages that have been overwritten occurs. (Note: while transport-level retransmission is not available, IPC is compatible with the <a class="el" href="index.html#offtransportrecoveryotr">Off-Transport Recovery (OTR)</a> feature, which allows for persistent message recovery from the Store, or streaming message recovery from the Source's <a class="el" href="index.html#latejoin">Late Join</a> buffer.) </li>
<li>
Receivers also do not send NAKs when using LBT-IPC. </li>
<li>
LBT-IPC does not support <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> options. However, if you set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> 1 or -1, LBT-IPC reassembles any large messages. </li>
<li>
LBT-IPC does not support Rate Limiting. </li>
<li>
LBT-IPC creates a separate receiver thread in the receiving context. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="sendingtobothlocalandremotereceivers"></a>
Sending to Both Local and Remote Receivers&nbsp;&nbsp;<small><a href="#sendingtobothlocalandremotereceivers">&lt;-</a></small></h3>
<p>A source application that wants to support both local and remote receivers should create two UM Contexts with different topic resolution configurations, one for IPC sends and one for sends to remote receivers. Separate contexts allows you to use the same topic for both IPC and network sources. If you simply created two source objects (one IPC, one say LBT-RM) in the same UM Context, you would have to use separate topics and suffer possible higher latency because the sending thread would be blocked for the duration of two send calls.</p>
<p>A UM source will never automatically use IPC when the receivers are local and a network transport for remote receivers because the discovery of a remote receiver would hurt the performance of local receivers. An application that wants transparent switching can implement it in a simple wrapper.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lbtipcconfigurationexample"></a>
LBT-IPC Configuration Example&nbsp;&nbsp;<small><a href="#lbtipcconfigurationexample">&lt;-</a></small></h3>
<p>The following diagram illustrates how sources and receivers interact with the shared memory area used in the LBT-IPC transport:</p>
<div class="image">
<img src="IPC_Objects.png" alt="IPC_Objects.png"/>
</div>
 <p>In the diagram above, 3 sources send (write) to two Shared Memory Areas while four receivers in two different contexts receive (read) from the areas. The assignment of sources to Shared Memory Areas demonstrate UM's round robin method. UM assigns the source sending on Topic A to Transport 20001, the source sending on Topic B to Transport 20002 and the source sending on Topic C back to the top of the transport ID range, 20001.</p>
<p>The diagram also shows the UM configuration options that set up this scenario:</p>
<ul>
<li>
The options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidhighcontext">transport_lbtipc_id_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcidlowcontext">transport_lbtipc_id_low (context)</a> establish the range of Transport IDs between 20001 and 20002. </li>
<li>
The option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsource">transport (source)</a> is used to set the source's transport to LBT-IPC. </li>
<li>
The option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipctransmissionwindowsizesource">transport_lbtipc_transmission_window_size (source)</a> sets the size of each Shared Memory Area to 24 MB. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="requiredprivileges"></a>
Required privileges&nbsp;&nbsp;<small><a href="#requiredprivileges">&lt;-</a></small></h3>
<p>LBT-IPC requires no special operating system authorities, except on Microsoft Windows Vista and Microsoft Windows Server 2008, which require Administrator privileges. In addition, on Microsoft Windows XP, applications must be started by the same user, however, the user is not required to have administrator privileges. In order for applications to communicate with a service, the service must use a user account that has Administrator privileges.</p>
<p><br />
 </p>
<h3><a class="anchor" id="hostresourceusageandlimits"></a>
Host Resource Usage and Limits&nbsp;&nbsp;<small><a href="#hostresourceusageandlimits">&lt;-</a></small></h3>
<p>LBT-IPC contexts and sources consume host resources as follows:</p>
<ul>
<li>
Per Source - 1 shared memory area, 1 shared lock (semaphore on Linux, mutex on Microsoft Windows) </li>
<li>
Per Receiving Context - 2 shared locks (semaphores on Linux, one event and one mutex on Microsoft Windows) </li>
</ul>
<p>Across most operating system platforms, these resources have the following limits. </p><ul>
<li>
4096 shared memory areas, though some platforms use different limits </li>
<li>
32,000 shared semaphores (128 shared semaphore sets * 250 semaphores per set) </li>
</ul>
<p>Consult your operating system documentation for specific limits per type of resource. Resources may be displayed and reclaimed using the <a class="el" href="index.html#lbtipcresourcemanager">LBT-IPC Resource Manager</a>. See also the KB article <a href="https://kb.informatica.com/faq/5/Pages/80201.aspx">Managing LBT-IPC Host Resources</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lbtipcresourcemanager"></a>
LBT-IPC Resource Manager&nbsp;&nbsp;<small><a href="#lbtipcresourcemanager">&lt;-</a></small></h3>
<p>Deleting an IPC source or deleting an IPC receiver reclaims the shared memory area and locks allocated by the IPC source or receiver. However, if a less than graceful exit from a process occurs, global resources remain allocated but unused. To address this possibility, the LBT-IPC Resource Manager maintains a resource allocation database with a record for each global resource (memory or semaphore) allocated or freed. You can use the LBT-IPC Resource Manager to discover and reclaim resources. See the three example outputs below.</p>
<p><b>Displaying Resources</b></p>
<pre class="fragment">$&gt; lbtipc_resource_manager
Displaying Resources (to reclaim you must type '-reclaim' exactly)

--Memory Resources--
Memory resource: Process ID: 24441 SessionID: ab569cec XportID: 20001

--Semaphore Resources-- Semaphore key: 0x68871d75
Semaphore resource Index 0: reserved

Semaphore resource: Process ID: 24441 Sem Index: 1
Semaphore resource: Process ID: 24436 Sem Index: 2
</pre><p><b>Reclaiming Unused Resources</b></p>
<pre class="fragment">$&gt; lbtipc_resource_manager -reclaim
Reclaiming Resources
Process 24441 not found: reclaiming Memory resource (SessionID: ab569cec XPortID: 20001)
Process 24441 not found: reclaiming Semaphore resource: Key: 0x68871d75 Sem Index: 1
Process 24436 not found: reclaiming Semaphore resource: Key: 0x68871d75 Sem Index: 2
</pre><p><br />
 </p>
<h2><a class="anchor" id="transportlbtsmx"></a>
Transport LBT-SMX&nbsp;&nbsp;<small><a href="#transportlbtsmx">&lt;-</a></small></h2>
<p>The LBT-SMX (shared memory acceleration) transport is an Interprocess Communication (IPC) transport you can use for the lowest latency message Streaming.</p>
<p>LBT-RU's <a class="el" href="index.html#transportpacing">Transport Pacing</a> is receiver-paced. If you need source pacing, see <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>.</p>
<p>Like LBT-IPC, sources can publish topic messages to a shared memory area from which receivers can read topic messages. LBT-SMX is slightly faster than <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>. However, SMX imposes more limitations than LBT-IPC; see <a class="el" href="index.html#differencesbetweenlbtsmxandotherumtransports">Differences Between LBT-SMX and Other UM Transports</a>.</p>
<p>To achieve the minimum possible latency and <a class="el" href="index.html#glossaryjitter">jitter</a>, the receive side uses <a class="el" href="index.html#glossarybusywaiting">busy waiting</a> exclusively. This means that while waiting for a message, the receiving context has a thread running at 100% CPU utilization. To avoid latency <a class="el" href="index.html#glossaryjitter">jitter</a>, Informatica strongly recommends <a class="el" href="index.html#glossarypinning">pinning</a> the thread to a single core to prevent the operating system from migrating the thread across cores.</p>
<p>Although busy waiting has the lowest latency, it has the drawback of consuming 100% of a CPU core, even during periods of no messages. This limits the number of SMX data flows that can be used on a given machine to the number of available cores. If this is not practical for your use case, Informatica recommends the use of <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>.</p>
<p>There are two forms of API calls available with LBT-SMX: </p><ul>
<li>
General APIs - the same APIs used with other transports, such as sending messages with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a>. </li>
<li>
SMX-specific APIs - APIs that further reduce overhead and latency but require a somewhat different code design, such as sending messages with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f857abe9088918c618cdd248ccf7d83">lbm_src_buffs_complete()</a>. </li>
</ul>
<p>Note that the SMX-specific APIs are not thread safe, and require that the calling application guarantee serialization of calls on a given <a class="el" href="index.html#transportsessions">Transport Sessions</a>.</p>
<p>LBT-SMX operates on the following Ultra Messaging platforms: </p><ul>
<li>
64-bit SunOS (X86 only) </li>
<li>
64-bit Linux </li>
<li>
64-bit Windows </li>
</ul>
<p>The "latency ping/pong" example programs demonstrate how to use the SMX-specific API.</p>
<p>For C: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmlatping_c">Example lbmlatping.c</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmlatpong_c">Example lbmlatpong.c</a>.</p>
<p>For Java: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmlatping_java">Example lbmlatping.java</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmlatpong_java">Example lbmlatpong.java</a>.</p>
<p>For .NET: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmlatping_cs">Example lbmlatping.cs</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmlatpong_cs">Example lbmlatpong.cs</a>.</p>
<p>Many other example applications can use the LBT-SMX transport by setting the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsource">transport (source)</a> configuration option to "LBT-SMX": </p><pre class="fragment">source transport LBT-SMX
</pre><p> However, you cannot use LBT-SMX with example applications for features not supported by LBT-SMX, such as <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmreq_c">Example lbmreq.c</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmresp_c">Example lbmresp.c</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmrcvq_c">Example lbmrcvq.c</a>, or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmwrcvq_c">Example lbmwrcvq.c</a>.</p>
<p>The LBT-SMX configuration options are similar to the LBT-IPC transport options. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html">Transport LBT-SMX Operation Options</a> for more information.</p>
<p>You can use Automatic Monitoring, UM API retrieve/reset calls, and LBMMON APIs to access LBT-SMX source and receiver transport statistics. To increase performance, the LBT-SMX transport does not collect statistics by default. Set the UM configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxmessagestatisticsenabledcontext">transport_lbtsmx_message_statistics_enabled (context)</a> to 1 to enable the collection of transport statistics.</p>
<p>The next few sections provide an in-depth understanding of how SMX works, using the C API as the model. Java and .NET programmers are encouraged to read these sections for the understanding of SMX. There are also sections specific to Java and .NET near the end to provide API details.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcesandlbtsmx"></a>
Sources and LBT-SMX&nbsp;&nbsp;<small><a href="#sourcesandlbtsmx">&lt;-</a></small></h3>
<p>When you create a source with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8dd76271bf9df7a5f88476d431f523e">lbm_src_create()</a> and you've set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsource">transport (source)</a> option to "LBT-SMX", UM creates a shared memory area object. UM assigns one of the transport IDs to this area from a range of transport IDs specified with the UM context configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidhighcontext">transport_lbtsmx_id_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidlowcontext">transport_lbtsmx_id_low (context)</a>. You can also specify a shared memory location inside or outside of this range with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidsource">transport_lbtsmx_id (source)</a> to group certain topics in the same shared memory area, if needed. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html">Transport LBT-SMX Operation Options</a> for configuration details.</p>
<p>UM names the shared memory area object according to the format, <b>LBTSMX_x_d</b> where <b>x</b> is the hexadecimal Session ID and <b>d</b> is the decimal Transport ID. Example names are <b>LBTSMX_42792ac_20000</b> or <b>LBTSMX_66e7c8f6_20001</b>. Receivers access a shared memory area with this object name to receive (read) topic messages.</p>
<dl class="section note"><dt>Note</dt><dd>For every context created by your application, UM creates an additional shared memory area for control information. The name for these control information memory areas ends with the suffix, _0, which is the Transport ID.</dd></dl>
<p>Here are the SMX-specific in C: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> - obtains a pointer into the source's shared buffer for a new message of the specified length. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f857abe9088918c618cdd248ccf7d83">lbm_src_buffs_complete()</a> - informs UM that one or more acquired messages are complete and ready to be delivered to receivers. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a661393cae3ab4f8c90d26ce0a27e8d33">lbm_src_buffs_complete_and_acquire()</a> - a convenience function that is the same as calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> followed immediately by <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f857abe9088918c618cdd248ccf7d83">lbm_src_buffs_complete()</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae28c5fac3f27e3d4ee50c0cbd02d1180">lbm_src_buffs_cancel()</a> - cancels all message buffers acquired but not yet completed. </li>
</ul>
<p>The SMX-specific APIs fail with an appropriate error message if a sending application uses them for a source configured to use a transport other than LBT-SMX.</p>
<dl class="section note"><dt>Note</dt><dd>The SMX-specific APIs are not thread safe at the source object or LBT-SMX Transport Session levels for performance reasons. Applications that use the SMX-specific APIs for either the same source or a group of sources that map to the same LBT-SMX Transport Session must serialize the calls either directly in the application or through their own mutex.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="sendingoverlbtsmxwithnativeapis"></a>
Sending with SMX-specific APIs&nbsp;&nbsp;<small><a href="#sendingoverlbtsmxwithnativeapis">&lt;-</a></small></h3>
<p>Sending with SMX-specific APIs is a two-step process.</p>
<ol>
<li>
<p class="startli">The publisher first calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a>, which returns a pointer into which the publisher writes the message data.</p>
<p>The pointer points directly into the shared memory area. UM guarantees that the shared memory area has at least the value specified with the len parameter of contiguous bytes available for writing when <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> returns. Note that the acquire function has the potential of blocking (spinning), if the shared memory area is full of messages that are unread by at least one subscribed receiver. If your application set the LBM_SRC_NONBLOCK flag with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a>, UM immediately returns an LBM_EWOULDBLOCK error condition if the function detects the blocking condition.</p>
<p>Because LBT-SMX does not support <a class="el" href="index.html#glossaryumfragmentation">fragmentation</a>, your application must limit message lengths to a maximum equal to the value of the source's configured <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxdatagrammaxsizesource">transport_lbtsmx_datagram_max_size (source)</a> option minus 16 bytes for headers. In a system deployment that includes the DRO, this value should be the same as the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> of other transport types. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#protocolconversion">Protocol Conversion</a>.</p>
<p>After the user acquires the pointer into shared memory and writes the message data, the application may call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> repeatedly to send a batch of messages to the shared memory area. If your application writes multiple messages in this manner, sufficient space must exist in the shared memory area. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8a56e2f08924d25caea26d205cf730c5">lbm_src_buff_acquire()</a> returns an error if the available shared memory space is less than the size of the next message.</p>
<p class="endli"></p>
</li>
<li>
The publisher calls one of the two following APIs. <ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f857abe9088918c618cdd248ccf7d83">lbm_src_buffs_complete()</a>, which publishes the message or messages to all listening receivers. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a661393cae3ab4f8c90d26ce0a27e8d33">lbm_src_buffs_complete_and_acquire()</a>, which publishes the message or messages to all listening receivers and acquires a new pointer. </li>
</ul>
</li>
</ol>
<p><br />
 </p>
<h3><a class="anchor" id="sendingoverlbtsmxwithexistingapis"></a>
Sending over LBT-SMX with General APIs&nbsp;&nbsp;<small><a href="#sendingoverlbtsmxwithexistingapis">&lt;-</a></small></h3>
<p>LBT-SMX supports the general send API functions, like <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a>. These API calls are fully thread-safe. The LBT-SMX feature restrictions still apply (see <a class="el" href="index.html#differencesbetweenlbtsmxandotherumtransports">Differences Between LBT-SMX and Other UM Transports</a>). The lbm_src_send_ex_info_t argument to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4d883eaaa22baf81abf21d495f471c8b">lbm_src_sendv_ex()</a> APIs must be NULL when using an LBT-SMX source, because LBT-SMX does not support any of the features that the lbm_src_send_ex_info_t parameter can enable.</p>
<p>Since LBT-SMX does not support an implicit batcher or corresponding implicit batch timer, UM flushes all messages for all sends on LBT-SMX transports done with general APIs, which is similar to setting the LBM_MSG_FLUSH flag. LBT-SMX also supports the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#afec0ee6822fe721f21c67536660506ea">lbm_src_flush()</a> API call, which behaves like a thread-safe version of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f857abe9088918c618cdd248ccf7d83">lbm_src_buffs_complete()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Users should not use both the SMX-specific APIs and the general API calls in the same application. Users should choose one or the other type of API for consistency and to avoid thread safety problems.</dd></dl>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1ba60407fa2bde0997aab6d5a5d2da1a">lbm_src_topic_alloc()</a> API call generates log warnings if the given attributes specify an LBT-SMX transport and enable any of the features that LBT-SMX does not support. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1ba60407fa2bde0997aab6d5a5d2da1a">lbm_src_topic_alloc()</a> returns 0 (success), but UM does not enable the unsupported features indicated in the log warnings. Other API functions that operate on lbm_src_t objects, such as <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8dd76271bf9df7a5f88476d431f523e">lbm_src_create()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a29d45db8f76835b4ae78f4568c25712f">lbm_src_delete()</a>, or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33d3ee1d815f4a51b68653d8a063f87f">lbm_src_topic_dump()</a>, operate with LBT-SMX sources normally.</p>
<p>Because LBT-SMX does not support <a class="el" href="index.html#glossaryumfragmentation">fragmentation</a>, your application must limit message lengths to a maximum equal to the value of the source's configured <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxdatagrammaxsizesource">transport_lbtsmx_datagram_max_size (source)</a> option minus 16 bytes for headers. Any send API calls with a length parameter greater than this configured value fail. In a system deployment that includes the DRO, this value should be the same as the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> of other transport types. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#protocolconversion">Protocol Conversion</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiversandlbtsmx"></a>
Receivers and LBT-SMX&nbsp;&nbsp;<small><a href="#receiversandlbtsmx">&lt;-</a></small></h3>
<p>LBT-SMX receivers can be coded the same as receivers on other UM transports. The msg-&gt;data pointer of a delivered lbm_msg_t object points directly into the shared memory area. However, Java and .NET receivers can benefit from some alternate coding techniques. See <a class="el" href="index.html#javacodeexamplesforlbtsmx">Java Coding for LBT-SMX</a> and <a class="el" href="index.html#netcodeexamplesforlbtsmx">.NET Coding for LBT-SMX</a>.</p>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a> API function operates differently for LBT-SMX. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a> creates a full copy of the message in order to access the data outside the receiver callback.</p>
<dl class="section attention"><dt>Attention</dt><dd>You application should not pass the msg-&gt;data pointer to other threads or outside the receiver callback until your application has called <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a> on the message.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Any API calls documented as not safe to call from a context thread callback are also not safe to call from an LBT-SMX receiver thread.</dd></dl>
<p><b>Topic Resolution and LBT-SMX</b></p>
<p>Topic resolution operates identically with LBT-SMX as other UM transports albeit with the advertisement type, LBMSMX. Advertisements for LBT-SMX contain the Transport ID, Session ID, and Host ID. Receivers get LBT-SMX advertisements in the normal manner, either from the resolver cache, advertisements received on the multicast resolver address:port, or responses to queries.</p>
<p><br />
 </p>
<h3><a class="anchor" id="similaritiesbetweenlbtsmxandotherumtransports"></a>
Similarities Between LBT-SMX and Other UM Transports&nbsp;&nbsp;<small><a href="#similaritiesbetweenlbtsmxandotherumtransports">&lt;-</a></small></h3>
<p>Although no actual network transport occurs, SMX functions in much the same way as if you send packets across the network as with other UM transports.</p>
<ul>
<li>
If you use a range of LBT-SMX transport IDs, UM assigns multiple topics sent by multiple sources to all the Transport Sessions in a round robin manner just like other UM transports. </li>
<li>
Transport sessions assume the configuration option values of the first source assigned to the Transport Session. </li>
<li>
Source applications and receiver applications based on any of the three available APIs can interoperate with each other. For example, sources created by a C publisher can send to receivers created by a Java receiving application. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="differencesbetweenlbtsmxandotherumtransports"></a>
Differences Between LBT-SMX and Other UM Transports&nbsp;&nbsp;<small><a href="#differencesbetweenlbtsmxandotherumtransports">&lt;-</a></small></h3>
<ul>
<li>
Unlike LBT-RM which uses a transmission window to specify a buffer size to retain messages for retransmission, LBT-SMX uses the transmission window option to establish the size of the shared memory. LBT-SMX uses transmission window sizes that are powers of 2. You can set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxtransmissionwindowsizesource">transport_lbtsmx_transmission_window_size (source)</a> to any value, but UM rounds the option value up to the nearest power of 2. </li>
<li>
The largest transmission window size for Java applications is 1 GB. </li>
<li>
The largest possible message size for Java applications is 1 GB. </li>
<li>
LBT-SMX does not retransmit messages. Since LBT-SMX transport only supports <a class="el" href="index.html#transportpacing">receiver pacing</a>, messages are never lost in transit. </li>
<li>
Receivers do not send NAKs when using LBT-SMX. </li>
</ul>
<p><b>LBT-SMX is <b>not</b> compatible with the following UM features:</b> </p><ul>
<li>
<a class="el" href="index.html#arrivalorderfragmentsnotreassembled">Arrival Order, Fragments Not Reassembled</a> (ordered_delivery 0). </li>
<li>
<a class="el" href="index.html#transportpacing">Source Pacing</a>. </li>
<li>
<a class="el" href="index.html#latejoin">Late Join</a>. </li>
<li>
<a class="el" href="index.html#offtransportrecoveryotr">Off-Transport Recovery (OTR)</a>. </li>
<li>
<a class="el" href="index.html#requestresponse">Request/Response</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsourcesidefilteringbehaviorsource">Source-side Filtering</a>. </li>
<li>
<a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>. </li>
<li>
<a class="el" href="index.html#messageproperties">Message Properties</a>. </li>
<li>
<a class="el" href="index.html#applicationheaders">Application Headers</a>. </li>
<li>
<a class="el" href="index.html#implicitbatching">Implicit Batching</a> and <a class="el" href="index.html#explicitbatching">Explicit Batching</a>. </li>
<li>
<a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a>. </li>
<li>
<a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a>. </li>
<li>
<a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>. </li>
<li>
The "pend"-style of Receiver thread behavior; SMX only supports <a class="el" href="index.html#glossarybusywaiting">busy_wait</a>-style. </li>
<li>
<a class="el" href="index.html#persistence">Persistence</a>. </li>
<li>
<a class="el" href="index.html#queuing">Queuing</a>. </li>
</ul>
<p>Note that while the use of <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> for network-based transports does not conflict with LBT-SMX, it does not apply to LBT-SMX. SMX data flows cannot be assigned to XSP threads.</p>
<p>You also cannot use LBT-SMX to send outgoing traffic from a UM daemon, such as the <a class="el" href="index.html#persistence">persistent Store</a>, <a class="el" href="index.html#umrouter">DRO</a>, or <a class="el" href="index.html#glossaryumds">UMDS</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lbtsmxconfigurationexample"></a>
LBT-SMX Configuration Example&nbsp;&nbsp;<small><a href="#lbtsmxconfigurationexample">&lt;-</a></small></h3>
<p>The following diagram illustrates how sources and receivers interact with the shared memory area used in the LBT-SMX transport.</p>
<div class="image">
<img src="SMX_Objects.png" alt="SMX_Objects.png"/>
</div>
 <p>In the diagram above, three sources send (write) to two Shared Memory Areas while four receivers in two different contexts receive (read) from the areas. The assignment of sources to Shared Memory Areas demonstrate UM's round robin method. UM assigns the source sending on Topic A to Transport 30001, the source sending on Topic B to Transport 30002 and the source sending on Topic C back to the top of the transport ID range, 30001.</p>
<p>The diagram also shows the UM configuration options that set up this scenario.</p>
<ul>
<li>
The options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidhighcontext">transport_lbtsmx_id_high (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxidlowcontext">transport_lbtsmx_id_low (context)</a> establish the range of Transport IDs between 30001 and 30002. </li>
<li>
The option "source transport lbtsmx" sets the source's transport to LBT-SMX. </li>
<li>
<p class="startli">The option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxtransmissionwindowsizesource">transport_lbtsmx_transmission_window_size (source)</a> sets the size of each Shared Memory Area to 33554432 bytes or 32 MB. This option's value must be a power of 2. If you configured the transmission window size to 25165824 bytes (24 MB) for example, UM logs a warning message and then rounds the value of this option up to the next power of 2 or 33554432 bytes or 32 MB.</p>
<p class="endli"><br />
 </p>
</li>
</ul>
<h3><a class="anchor" id="javacodeexamplesforlbtsmx"></a>
Java Coding for LBT-SMX&nbsp;&nbsp;<small><a href="#javacodeexamplesforlbtsmx">&lt;-</a></small></h3>
<p>Java-based SMX works by wrapping the shared memory area in a <a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html">ByteBuffer</a> object. This lets the sender call the put methods to build your application message directly in the shared memory, and the receiver calls the get methods to extract the message directly from the shared memory.</p>
<p>Here are the SMX-specific APIs in Java: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#aa3b22f5397febbd6b8bdabdf69c7ab76">LBMSource.getMessagesBuffer()</a> - obtains a reference to the source's ByteBuffer, which does not change for the lifetime of the source object. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a030f598cdedc72194eb7eeaa80654f48">LBMSource.acquireMessageBufferPosition()</a> - obtains an offset into the source's ByteBuffer for a new message of the specified length. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a33bd5aff25d81c59b88b679475bffb38">LBMSource.messageBuffersComplete()</a> - informs UM that one or more acquired messages are complete and ready to be delivered to receivers. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a1e36494baf4946296b674c49aeadfbae">LBMSource.messageBuffersCompleteAndAcquirePosition()</a> - a convenience function that is the same as calling messageBuffersComplete() followed immediately by acquireMessageBufferPosition(). </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a58fdb6755ddf1d2cde693defea57912b">LBMSource.messageBuffersCancel()</a> - cancels all message buffers acquired but not yet completed. </li>
</ul>
<p>Notice that while the normal source send can accept either a byte array or a ByteBuffer, the Java SMX-specific APIs only accept a ByteBuffer. Also note that the ByteBuffer does not necessarily start at position 0. You must call acquireMessageBufferPosition() to determine the offset.</p>
<p>The Java example programs <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmlatping_java">Example lbmlatping.java</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmlatpong_java">Example lbmlatpong.java</a> illustrates how a Java-based SMX source and receiver is written.</p>
<p>For message reception, see the "onReceive" function. Note that there is no SMX-specific code. However, to maintain high performance, the user should call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#aa3b22f5397febbd6b8bdabdf69c7ab76">LBMSource.getMessagesBuffer()</a> to obtain direct access to the source's ByteBuffer. The position and limit set according to the message to be read.</p>
<p>To save on some front-end latency, the "lat" ping/pong programs pre-acquire a buffer which is filled in when a messages needs to be sent (the call to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a030f598cdedc72194eb7eeaa80654f48">src.acquireMessageBufferPosition()</a>). After each send, another buffer is acquired for the next (future) message (the call to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a1e36494baf4946296b674c49aeadfbae">src.messageBuffersCompleteAndAcquirePosition()</a>). This moves the overhead of acquiring a message buffer to <em>after</em> the message was sent.</p>
<p><b>Batching</b></p>
<p>SMX does not support the normal UM feature <a class="el" href="index.html#implicitbatching">Implicit Batching</a>. However, it does support a method of <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> whereby multiple messages may be added to the source's ByteBuffer before being released to UM for delivery.</p>
<p>Note that unlike network-based transports, batching will give only minor benefits for SMX, mostly in the form of reduced memory contention.</p>
<div class="fragment"><div class="line"><span class="comment">/* Acquire a position in the buffer */</span></div><div class="line">buf.position(src.acquireMessageBufferPosition(msglen, 0));</div><div class="line">... <span class="comment">/* Construct a message in &quot;buf&quot;. */</span></div><div class="line"></div><div class="line">buf.position(src.acquireMessageBufferPosition(msglen, 0));</div><div class="line">... <span class="comment">/* Construct a second message in &quot;buf&quot;. */</span></div><div class="line"></div><div class="line"><span class="comment">/* Tell UM that all acquired message buffers are now complete. */</span></div><div class="line">src.messageBuffersComplete();</div></div><!-- fragment --><p>Notice that the same ByteBuffer "buf" is used for both messages. This is because it is backed by the entire shared memory buffer. The current position of "buf" is set to the start of the message space acquired by acquireMessageBufferPosition().</p>
<p><b>Non-blocking</b></p>
<p>In the example code presented, calls to acquireMessageBufferPosition() passed zero for flags. This means that the call has the potential to block. Blocking happens if the sender outpaces the slowest receiver and the shared buffer fills. Because of <a class="el" href="index.html#transportpacing">receiver pacing</a>, the source must not overwrite sent messages that have not been consumed by one or more subscribed receivers.</p>
<p>It is also possible to pass LBM.SRC_NONBLOCK as a flag to acquireMessageBufferPosition(). In that case, acquireMessageBufferPosition() will immediately return -1 if the shared buffer does not have enough space for the request.</p>
<div class="fragment"><div class="line">pos = src.acquireMessageBufferPosition(msgLength, flags);</div><div class="line"><span class="keywordflow">if</span> (pos == -1) {</div><div class="line">  <span class="comment">/* Can&#39;t send the message yet. Handle this error. */</span></div><div class="line">}</div><div class="line"><span class="keywordflow">else</span> {</div><div class="line">  <span class="comment">/* Successful acquisition, set up buffer. */</span></div><div class="line">  buf.position(pos);</div><div class="line">  ... <span class="comment">/* Construct a message in &quot;buf&quot;. */</span></div><div class="line">  <span class="comment">/* Tell UM that all acquired message buffers are now complete. */</span></div><div class="line">  src.messageBuffersComplete();</div><div class="line">}</div></div><!-- fragment --><p>For performance reasons, acquireMessageBufferPosition() does not throw LBMEWouldBlock exceptions, like the standard send APIs do.</p>
<p><b>Reduce Overhead</b></p>
<p>Normally, UM allows an application to add multiple receiver callbacks for the same topic receiver. This adds a small amount of overhead for a feature that is not used very often. This overhead can be eliminated by setting the "single receiver callback" attribute when creating the receiver object. This is done by calling <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMReceiverAttributes.html#ae29ba2851a3bb0f19866199390ab1ff3">LBMReceiverAttributes.enableSingleReceiverCallback()</a>.</p>
<div class="fragment"><div class="line">LBMReceiverAttributes rattr = <span class="keyword">new</span> LBMReceiverAttributes();</div><div class="line">rattr.enableSingleReceiverCallback(<span class="keyword">true</span>);</div><div class="line">LBMTopic topic = ctx.lookupTopic(<span class="stringliteral">&quot;lbmpong/pong&quot;</span>, rattr);</div><div class="line"></div><div class="line">rcv = <span class="keyword">new</span> LBMReceiver(ctx, topic, <span class="keyword">new</span> LBMReceiverCallback(onReceive), null);</div></div><!-- fragment --><p><br />
 </p>
<h3><a class="anchor" id="netcodeexamplesforlbtsmx"></a>
.NET Coding for LBT-SMX&nbsp;&nbsp;<small><a href="#netcodeexamplesforlbtsmx">&lt;-</a></small></h3>
<p>For most of UM functionality, the Java and .NET APIs are used almost identically. However, given SMX's latency requirements, we took advantage of some .NET capabilities that don't exist in Java, resulting in a different set of functions. In particular, instead of wrapping the shared memory area in a ByteBuffer, the .NET SMX API uses a simple IntPtr to provide a pointer directly into the shared memory area.</p>
<p>Here are the SMX-specific APIs in .NET: </p><ul>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#aca4f01b286e57aa59a0d5f97f64c8fa3">LBMSource.buffAcquire()</a> - obtains a pointer into the source's shared buffer for a new message of the specified length. </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a0a09f48d1e0087425dbca93432998304">LBMSource.buffsComplete()</a> - informs UM that one or more acquired messages are complete and ready to be delivered to receivers. </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#acf5a0d7ecdc818a071cd38fb0e3d0aed">LBMSource.buffsCompleteAndAcquire()</a> - a convenience function that is the same as calling buffsComplete() followed immediately by acquireMessageBufferPosition(). </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMSource.html#a3afd1b714f0922e27db7f9cf8ed244fc">LBMSource.buffsCancel()</a> - cancels all message buffers acquired but not yet completed. </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a174e6f4f8ec8c8ab7e6c316263d645c3">LBMMessage.dataPointerSafe()</a> - Returns an IntPtr into the shared memory at the start of the message. </li>
</ul>
<p>Notice that while the normal source send can accept either a byte array or a ByteBuffer, the .NET SMX-specific APIs only work with an IntPtr. This is because the application builds the message directly in the shared memory.</p>
<p>The .NET example programs <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmlatping_cs">Example lbmlatping.cs</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmlatpong_cs">Example lbmlatpong.cs</a> illustrates how a .NET-based SMX source and receiver is written.</p>
<p>For message reception, see the "onReceive" function in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmpong_cs">Example lbmpong.cs</a>. Note that there doesn't need to be any SMX-specific code. However, to maintain high performance, the user should call <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a174e6f4f8ec8c8ab7e6c316263d645c3">LBMMessage.dataPointerSafe()</a> - to obtain direct access to the source's shared memory.</p>
<p>To save on some front-end latency, the "lat" ping/pong programs pre-acquire a buffer which is filled in when a messages needs to be sent (the call to source.buffAcquire()). After each send, another buffer is acquired for the next (future) message (the call to source.buffsCompleteAndAcquire()). This moves the overhead of acquiring a message buffer to <em>after</em> the message was sent.</p>
<p><b>Batching</b></p>
<p>SMX does not support the normal UM feature <a class="el" href="index.html#implicitbatching">Implicit Batching</a>. However, it does support a method of <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> whereby multiple messages may be added to the source's shared memory before being released to UM for delivery.</p>
<p>Note that unlike network-based transports, batching will give only minor benefits for SMX, mostly in the form of reduced memory contention.</p>
<div class="fragment"><div class="line"><span class="comment">/* bufferAcquired was already set up earlier. */</span></div><div class="line">... <span class="comment">/* Construct first message at &quot;bufferAcquired&quot;. */</span></div><div class="line"></div><div class="line">source.buffAcquire(out bufferAcquired, (uint)buffer.Length, 0);</div><div class="line">... <span class="comment">/* Construct second message at &quot;bufferAcquired&quot;. */</span></div><div class="line"></div><div class="line"><span class="comment">/* Send both messages, and set up &quot;bufferAcquired&quot; for next message. */</span></div><div class="line">source.buffsCompleteAndAcquire(out bufferAcquired, (uint)buffer.Length, 0);</div><div class="line"></div><div class="line"><span class="comment">/* Tell UM that all acquired message buffers are now complete. */</span></div><div class="line">src.buffsComplete();</div></div><!-- fragment --><p><b>Non-blocking</b></p>
<p>In the example code presented, calls to buffAcquire() and buffsCompleteAndAcquire() are passed zero for flags. This means that the call has the potential to block. Blocking happens if the sender outpaces the slowest receiver and the shared buffer fills. Because of <a class="el" href="index.html#transportpacing">receiver pacing</a>, the source must not overwrite sent messages that have not been consumed by one or more subscribed receivers.</p>
<p>It is also possible to pass LBM.SRC_NONBLOCK as a flag to buffAcquire(). In that case, buffAcquire() will immediately return -1 if the shared buffer does not have enough space for the request.</p>
<div class="fragment"><div class="line">err = src.buffAcquire(out writeBuff, (uint)msglen, LBM.SRC_NONBLOCK);</div><div class="line"><span class="keywordflow">if</span> (err == -1) {</div><div class="line">  <span class="comment">/* Can&#39;t send the message yet. Handle this error. */</span></div><div class="line">}</div><div class="line"><span class="keywordflow">else</span> {</div><div class="line">  <span class="comment">/* Successful acquisition, set up buffer. */</span></div><div class="line">  ... <span class="comment">/* Construct a message in &quot;writeBuff&quot;. */</span></div><div class="line">  <span class="comment">/* Tell UM that all acquired message buffers are now complete. */</span></div><div class="line">  src.buffsComplete();</div><div class="line">}</div></div><!-- fragment --><p>For performance reasons, buffsComplete() does not throw LBMEWouldBlock exceptions, like the standard send APIs do.</p>
<p><b>Reduce Overhead</b></p>
<p>Normally, UM allows an application to add multiple receiver callbacks for the same topic receiver. This adds a small amount of overhead for a feature that is not used very often. This overhead can be eliminated by setting the "single receiver callback" attribute when creating the receiver object. This is done by calling <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMReceiverAttributes.html#ae29ba2851a3bb0f19866199390ab1ff3">LBMReceiverAttributes.enableSingleReceiverCallback()</a>.</p>
<div class="fragment"><div class="line">LBMReceiverAttributes rattr = <span class="keyword">new</span> LBMReceiverAttributes();</div><div class="line">rattr.enableSingleReceiverCallback(<span class="keyword">true</span>);</div><div class="line">LBMTopic topic = ctx.lookupTopic(<span class="stringliteral">&quot;lbmpong/pong&quot;</span>, rattr);</div><div class="line"></div><div class="line">rcv = <span class="keyword">new</span> LBMReceiver(ctx, topic, <span class="keyword">new</span> LBMReceiverCallback(onReceive), null);</div></div><!-- fragment --><p><br />
 </p>
<h3><a class="anchor" id="lbtsmxresourcemanager"></a>
LBT-SMX Resource Manager&nbsp;&nbsp;<small><a href="#lbtsmxresourcemanager">&lt;-</a></small></h3>
<p>Deleting an SMX source or deleting an SMX receiver reclaims the shared memory area and locks allocated by the SMX source or receiver. However, if an ungraceful exit from a process occurs, global resources remain allocated but unused. To address this possibility, the LBT-SMX Resource Manager maintains a resource allocation database with a record for each global resource (memory or semaphore) allocated or freed. You can use the LBT-SMX Resource Manager to discover and reclaim resources. See the three example outputs below.</p>
<p><b>Displaying Resources</b></p>
<pre class="fragment">$&gt; lbtsmx_resource_manager
Displaying Resources (to reclaim you must type '-reclaim' exactly)

--Memory Resources--
Memory resource: Process ID: 24441 SessionID: ab569cec XportID: 20001

--Semaphore Resources-- Semaphore key: 0x68871d75
Semaphore resource Index 0: reserved

Semaphore resource: Process ID: 24441 Sem Index: 1
Semaphore resource: Process ID: 24436 Sem Index: 2
</pre><p><b>Reclaiming Unused Resources</b></p>
<dl class="section warning"><dt>Warning</dt><dd>This operation should never be done while SMX-enabled applications or daemons are running. If you have lost or unused resources that need to be reclaimed, you should exit all SMX applications prior to running this command.</dd></dl>
<pre class="fragment">$&gt; lbtsmx_resource_manager -reclaim
Reclaiming Resources
Process 24441 not found: reclaiming Memory resource (SessionID: ab569cec XPortID: 20001)
Process 24441 not found: reclaiming Semaphore resource: Key: 0x68871d75 Sem Index: 1
Process 24436 not found: reclaiming Semaphore resource: Key: 0x68871d75 Sem Index: 2
</pre><p><br />
 </p>
<h2><a class="anchor" id="transportbroker"></a>
Transport Broker&nbsp;&nbsp;<small><a href="#transportbroker">&lt;-</a></small></h2>
<p>With the UMQ product, you use the '<b>broker</b>' transport to send messages from a source to a Queuing Broker, or from a Queuing Broker to a receiver.</p>
<p>The broker's <a class="el" href="index.html#transportpacing">Transport Pacing</a> is receiver-paced, but only between the source and the broker. There is no end-to-end pacing with queuing.</p>
<p>When sources or receivers connect to a Queuing Broker, you must use the '<b>broker</b>' transport. You cannot use the '<b>broker</b>' transport with UMS or UMP products.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="topicresolutiondescription"></a>
Topic Resolution Description&nbsp;&nbsp;<small><a href="#topicresolutiondescription">&lt;-</a></small></h1>
<p>Topic Resolution ("TR") is a set of protocols and algorithms used internally by Ultra Messaging to establish and maintain shared state. Here are the basic functions of TR:</p>
<ul>
<li>
Receiver discovery of sources. </li>
<li>
DRO route maintenance and distribution. </li>
<li>
Persistent Store name resolution. </li>
<li>
Redundancy. </li>
</ul>
<p>UM performs TR automatically; there are no API functions specific to normal TR operation. However, you can influence topic resolution by configuration. Moreover, you can set configuration options differently for individual topics, either by using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html">XML Configuration Files</a> (the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html#umelementtopic">&lt;topic&gt;</a> element), or by using the API functions for setting configuration options programmatically (e.g. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1afc75f0fb3601d072b3463e7acf16a6">lbm_rcv_topic_attr_setopt()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a96ea052dce2e6376684cbf2003407cbf">lbm_src_topic_attr_setopt()</a>). See <a class="el" href="index.html#udptopicresolutionconfigurationoptions">UDP Topic Resolution Configuration Options</a> for details.</p>
<p>An important design point of Topic Resolution is that information related to sources is distributed to all contexts in a UM network. This is done so that when a receiver object is created within a context, it can discover sources for the topic and join those sources. In support of this discovery process, each context maintains a memory-based <em>"resolver cache"</em>, which stores source information. The TR protocols and algorithms are largely in support of maintaining each context's resolver cache.</p>
<p>Topic Resolution also occurs across a <a class="el" href="index.html#umrouter">DRO</a>, which means between <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs). A receiver in one TRD will discover a source in a different TRD, potentially across many DRO hops. In this case, the DROs actively assist in TR. The sources and receivers in different TRDs do not exchange TR with each other directly, but rather with the assistance of the DRO.</p>
<dl class="section note"><dt>Note</dt><dd>With the UMQ product, Topic Resolution does not apply to brokered queuing sources, receivers, or the brokers themselves. However, ULB queuing does make use of topic resolution.</dd></dl>
<p>There are three different possible protocols used to provide Topic Resolution: </p><ul>
<li>
<a class="el" href="index.html#multicastudptr">Multicast UDP TR</a>, </li>
<li>
<a class="el" href="index.html#unicastudptr">Unicast UDP TR</a> (with "lbmrd" service), </li>
<li>
<a class="el" href="index.html#tcptr">TCP TR</a> (with "SRS" service). </li>
</ul>
<p>Of those three, Multicast UDP and Unicast UDP are mutually exclusive. It is not possible to configure UM to use both within a single TRD. Multicast is generally preferred over Unicast, with Unicast being selected when there are policy or environment reasons to avoid Multicast (e.g. cloud computing).</p>
<p>TCP-based TR (with "SRS" service) is a more recent addition to UM. It supports source discovery, and tracking of receivers.</p>
<p>TCP-based TR is often paired with one of the UDP-based TR protocols (multicast or unicast). This is done to support interoperability with pre-6.12 versions of UM, and supply TR functionality not yet available in TCP TR. The TCP-based and UDP-based TR protocols run in parallel, with the UDP-based TR protocol supporting interoperability with pre-6.12 components, and supplying the functionality missing from TCP TR.</p>
<p>When all of your UM components are upgraded to UM 6.14 or beyond, you can use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverdisableudptopicresolutioncontext">resolver_disable_udp_topic_resolution (context)</a> configuration option to turn off UDP-based TR.</p>
<p>The advantage of TCP-based TR is greater reliability and reduced network and CPU load. UDP-based TR is susceptible to <a class="el" href="index.html#glossarydeafness">deafness</a> issues due to transient network failures. Avoiding those deafness issues requires configuring UDP-based TR to use significant network and CPU resources. In contrast, TCP-based TR is designed to be reliable with much less network and CPU load, even in the face of transient network failures.</p>
<p><br />
 </p>
<h2><a class="anchor" id="resolvercaches"></a>
Resolver Caches&nbsp;&nbsp;<small><a href="#resolvercaches">&lt;-</a></small></h2>
<p>Independent of the TR protocol used, a context maintains two resolver caches: a source-side cache and a receiver-side cache.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourceresolvercache"></a>
Source Resolver Cache&nbsp;&nbsp;<small><a href="#sourceresolvercache">&lt;-</a></small></h3>
<p>The source-side cache holds information about sources that the application created. It is used primarily by the context to respond to TR Queries.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiverresolvercache"></a>
Receiver Resolver Cache&nbsp;&nbsp;<small><a href="#receiverresolvercache">&lt;-</a></small></h3>
<p>The receiver-side cache holds information about <em>all</em> sources in the UM network: </p><ul>
<li>
Sources in the current application. For example, if <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html">Monitoring</a> is turned on and configured for the same TRD as the context being monitored, the source used to publish the monitoring data is included. </li>
<li>
Sources in local applications, in the same TRD. </li>
<li>
Sources in remote applications that are reachable by a DRO network. </li>
</ul>
<p>Thus, the receiver-side cache can become large. In very large deployments, it may be necessary to increase the size of the receiver cache using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverreceivermaptableszcontext">resolver_receiver_map_tablesz (context)</a>.</p>
<p>A context's receiver-side cache also holds information about receivers created by the current application. This is used by the context when TR Advertisements are received to assist in completing subscriptions.</p>
<p>Be aware that with <a class="el" href="index.html#udpbasedtopicresolutiondetails">UDP-based Topic Resolution</a>, receiver-side cache entries are typically not removed when the corresponding sources are deleted, unless they are subscribed. If a source is created (but not subscribe) and then deleted and then re-created, there will be two entries in the cache: one for the old source and one for the new. For system designs that feature short-lived sources, the topic cache can grow over time without bound. In contrast, with <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-based Topic Resolution</a>, receiver-side cache entries typically are removed when the sources are deleted, even if not subscribed.</p>
<p><br />
 </p>
<h2><a class="anchor" id="trprotocolcomparison"></a>
TR Protocol Comparison&nbsp;&nbsp;<small><a href="#trprotocolcomparison">&lt;-</a></small></h2>
<p><br />
 </p>
<h3><a class="anchor" id="multicastudptr"></a>
Multicast UDP TR&nbsp;&nbsp;<small><a href="#multicastudptr">&lt;-</a></small></h3>
<p>Multicast UDP-based Topic Resolution is the default protocol.</p>
<p>Advantages: </p><ul>
<li>
Very fast source discovery for small deployments. </li>
<li>
Simplicity &ndash; no independent service (daemon) required. </li>
<li>
Highly fault tolerant. </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
As the number of topics grows, the speed of source discovery degrades and resource consumption increases (network bandwidth and CPU load). This resource consumption can introduce significant latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). </li>
<li>
Since UDP is not a reliable protocol, Multicast UDP TR relies on repetition to ensure delivery of TR information. </li>
<li>
To effectively avoid <a class="el" href="index.html#glossarydeafness">deafness</a> issues, resources must be consumed over the long term (TR must be configured to run "forever"). Jitter can be a long-term problem. </li>
<li>
As deployments change and grow, TR performance should be monitored and analyzed for possible reconfiguration to strike the right balance between speed of source discovery vs. resource consumption. </li>
<li>
By default, when sources are deleted, receivers are not informed unless <em>all</em> sources on a given transport session are deleted. Even if "final advertisements" are enabled, their delivery is best effort and not guaranteed. </li>
</ul>
<p>See <a class="el" href="index.html#udpbasedtopicresolutiondetails">UDP-Based Topic Resolution Details</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="unicastudptr"></a>
Unicast UDP TR&nbsp;&nbsp;<small><a href="#unicastudptr">&lt;-</a></small></h3>
<p>Unicast UDP-based Topic Resolution is functionally identical to Multicast UDP. It is used as a replacement for Multicast UDP in environments where the use of multicast is not possible (e.g. the cloud) or is against policy. The "lbmrd" service <em>simulates</em> multicast by simply forwarding all TR traffic to all contexts registered in a <a class="el" href="index.html#topicresolutiondomain">TRD</a>. Note that the "lbmrd" service does not maintain state about the sources and receivers. It simply fans out Unicast TR.</p>
<p>Advantages: </p><ul>
<li>
Does not use multicast (an advantage if multicast cannot be used). </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
All the same disadvantages of Multicast UDP. </li>
<li>
Requires one or more independent "lbmrd" services, which should be monitored for failure and restarted. </li>
<li>
Due to fan-out, puts a greater load on network hardware. </li>
<li>
By default, when sources are deleted, receivers are not informed unless <em>all</em> sources on a given transport session are deleted. Even if "final advertisements" are enabled, their delivery is best effort and not guaranteed. </li>
</ul>
<p>See <a class="el" href="index.html#udpbasedtopicresolutiondetails">UDP-Based Topic Resolution Details</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tcptr"></a>
TCP TR&nbsp;&nbsp;<small><a href="#tcptr">&lt;-</a></small></h3>
<p>TCP-based Topic Resolution is a newer implementation of a service-based distribution of source and receiver information. It is available as of UM version 6.12, in which it provides a subset of the total TR functionality. In a future UM version, TCP-based TR will provide <em>all</em> TR functionality, at which point it can be used to the exclusion of UDP-based TR. Until that time, TCP-based TR is typically paired with UDP-based TR (either Multicast or Unicast).</p>
<p>Advantages: </p><ul>
<li>
Can allow UDP-based TR to be disabled or "dialed-back". Its configuration can be adjusted to consume fewer CPU and network resources. See <a class="el" href="index.html#tcpbasedtrversioninteroperability">TCP-Based TR Version Interoperability</a>. </li>
<li>
Since TCP is a reliable protocol, TCP-based TR does not need to repeatedly send the same information to ensure its reception. </li>
<li>
It is not necessary to consume resources over the long term to avoid <a class="el" href="index.html#glossarydeafness">deafness</a> issues. </li>
<li>
If a source is deleted, that deletion is reliably communicated to all contexts in the TRD. </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
For TRDs containing UM versions both before and after UM 6.12, TCP-based TR must be combined with UDP-based TR to support inter-version interoperability. </li>
<li>
For UM version 6.12 and 6.13, TCP-based TR does not fulfill the TR functions of DRO route maintenance or persistent Store name resolution. Users who require one or more of those functions should upgrade to UM version 6.14 or beyond. </li>
</ul>
<p>Most users who combine UDP and TCP TR should be able to gradually reduce the CPU and Network load from UDP-based TR as the applications are upgraded to UM 6.12 or beyond.</p>
<p>When all of your UM components are upgraded to UM 6.14 or beyond, you can use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverdisableudptopicresolutioncontext">resolver_disable_udp_topic_resolution (context)</a> configuration option to turn off UDP-based TR.</p>
<p>See <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-Based Topic Resolution Details</a> for more information.</p>
<p><br />
 </p>
<h2><a class="anchor" id="tcpbasedtopicresolutiondetails"></a>
TCP-Based Topic Resolution Details&nbsp;&nbsp;<small><a href="#tcpbasedtopicresolutiondetails">&lt;-</a></small></h2>
<p>TCP-based TR was introduced in UM version 6.12 to address shortcomings in UDP-based TR: </p><ul>
<li>
<b>Limit on scaling.</b> It is difficult to configure UDP-based TR to scale to many hundreds of thousands of topics. Too many topics typically results in unacceptable CPU and network load, and latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). Intense TR bursts can cause packet loss, retransmissions, and <a class="el" href="index.html#glossarydeafness">deafness</a>. As deployments grow in size and complexity, UDP-based TR typically requires greatly extended Sustaining Phases, often to infinity. This results in significant CPU and network resources over the long term, and introduces latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). </li>
<li>
<b>High time to resolve.</b> To reduce the CPU and network load, and to avoid packet loss, UDP-based TR is usually strongly rate limited. This can greatly extend the time required to resolve topics, sometimes into the tens of minutes. </li>
</ul>
<p>TCP-based TR differs from UDP-based TR in two important ways: </p><ul>
<li>
With TCP-based TR, the TCP protocol ensures reliable transmission of information. TCP also makes use of congestion control algorithms to avoid packet loss. </li>
<li>
With TCP-based TR, topic information is maintained in the Stateful Resolution Service (SRS). </li>
</ul>
<p>The basic approach used by TCP-based TR is as follows: Each context in a TRD is configured with the address of one or more SRS instances (up to 5). For fault-tolerance, two or three is typical. When the context is created, it connects to the configured SRSes. When the connection is successful, the context and SRSes exchange TR information. They normally do this without involving the other contexts in the TRD.</p>
<p>Then, as an application creates or deletes sources, its context informs the SRSes of the change, which in turn inform the other contexts in the TRD. In addition (as of UM 6.13), as an application creates or deletes receivers, the SRSes track that receiver interest. The SRSes do not distribute receiver interest to other applications, but rather use it to optimize the distribution of source information. An SRS only informs a context of sources that the context is interested in (has receiver for).</p>
<p>There are periodic handshakes between each context and the SRSes to ensure that connectivity is maintained and that state is valid. This removes the need to re-send TR information that has already been sent.</p>
<p>If an application loses connection with an SRS (perhaps due an extended network outage, or due to failure of the SRS), the context will repeatedly try to reconnect. Once successful, the process of exchanging TR information is repeated.</p>
<p>Note that much of the difficulty of configuring UDP-based TR is related to controlling the repeated transmission of the same TIRs and TQRs. With TCP-based TR, that repetition is eliminated, making both the configuration and the operation more straight-forward.</p>
<p>A note about the term "stateful" in relation to the SRS. Even though Unicast UDP TR uses a service called "lbmrd", that service does not maintain the topic information. The "lbmrd" is not "stateful". Instead, it merely forwards TR datagrams it receives, essentially simulating Multicast.</p>
<p>In contrast, the SRS maintains knowledge of all sources and receivers in the TRD (hence the "Stateful" in SRS). For a newly-started receiving application to discover an existing source, the SRS can send the information without the source getting involved.</p>
<p>With TCP-based TR, source advertisement messages are called "SIRs" (Source Information Records). This term is used elsewhere in the documentation.</p>
<p>For configuration information, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html">TCP-Based Resolver Operation Options</a>.</p>
<dl class="section attention"><dt>Attention</dt><dd>It is important to configure the SRS with <a class="el" href="index.html#srselementinterface">SRS Element "&lt;interface&gt;"</a>, even if the SRS is running on a single-homed host (one network connection). Also, applications that connect to the SRS must configure their interfaces properly. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#defaultinterfacecontext">default_interface (context)</a>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> functionality provided by the <a class="el" href="index.html#unicastudptr">lbmrd</a> is not available with the SRS. If you want to mix SRS and lbmrd operation on the same network, <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="tcpbasedtrandfaulttolerance"></a>
TCP-Based TR and Fault Tolerance&nbsp;&nbsp;<small><a href="#tcpbasedtrandfaulttolerance">&lt;-</a></small></h3>
<p>Starting with UM version 6.13, TCP-based TR supports redundancy. This is accomplished by starting two or more instances of the Stateful Resolver Service (SRS), typically on separate physical hosts, and configuring application and daemon contexts to connect to all of them. Although up to 5 SRSes can be configured, 2 or 3 are typical.</p>
<p>A context uses the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a> option to configure the desired SRSes. Each context will establish TCP connections to all of the configured SRSes. The SRSes are used "hot/hot", with all information being sent to all configured SRSes, so there is no loss of Topic Resolution service if an SRS fails.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tcpbasedtrinterest"></a>
TCP-Based TR Interest&nbsp;&nbsp;<small><a href="#tcpbasedtrinterest">&lt;-</a></small></h3>
<p>Starting with UM version 6.13, the SRS tracks topic interest of contexts. If an application creates a receiver for topic "XYZ", the context informs the SRS that it is interested in that topic. This allows the SRS to filter the TR traffic it sends to contexts, which greatly increases the scalability of TR.</p>
<p>The SRS only sends source advertisements to contexts that are interested in that source's topic. Contexts also inform the SRS of wildcard receivers, in which case the SRS will send source advertisements for all sources that match the topic pattern.</p>
<dl class="section warning"><dt>Warning</dt><dd>While SRS filtering has the benefit of TR reducing traffic to a context, it can interfere with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#resolversourcenotificationfunctioncontext">resolver_source_notification_function (context)</a> and resolver_event_function features. Some applications use those features to inform the application of the availability of sources <em>before</em> receivers are created. But the SRS will normally not inform the context of sources for which the context has no receiver. For applications that require these features, filtering must be turned off by setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverserviceinterestmodecontext">resolver_service_interest_mode (context)</a> to "flood".</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="tcpbasedtrversioninteroperability"></a>
TCP-Based TR Version Interoperability&nbsp;&nbsp;<small><a href="#tcpbasedtrversioninteroperability">&lt;-</a></small></h3>
<p>TCP-based TR was first introduced in UM version 6.12. To maintain interoperability with pre-6.12, applications can be configured to use both TCP and UDP-based TR, in parallel.</p>
<p>This can make it difficult to gain all the benefits of TCP-based TR. Since pre-6.12 applications still need to avoid the problems of <a class="el" href="index.html#glossarydeafness">deafness</a>, even applications that have upgraded to 6.12 or beyond need to enable UDP-based TR, usually with extended sustaining phases, often to infinity.</p>
<p>Ideally, all applications within a TRD can be upgraded to 6.14 and beyond, eliminating the need for UDP-based TR, but this is often not practical. How can the TR load be reduced in a step-wise fashion while an organization is upgrading applications gradually, over a long period of time?</p>
<p>Fortunately, You can set configuration options differently for individual topics, either by using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html">XML Configuration Files</a> (the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html#umelementtopic">&lt;topic&gt;</a> element), or by using the API functions for setting configuration options programmatically (e.g. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1afc75f0fb3601d072b3463e7acf16a6">lbm_rcv_topic_attr_setopt()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a96ea052dce2e6376684cbf2003407cbf">lbm_src_topic_attr_setopt()</a>).</p>
<p>Some helpful strategies might be: </p><ul>
<li>
Identify those topics or classes of topics that have limited application interest. If topic X has sources and receivers in upgraded applications, the UDP-based TR for that topic can be reduced (e.g. sustaining phase greatly reduced). </li>
<li>
Identify those TRDs that have small numbers of applications. When a given TRD's applications have all been upgraded, the UDP-based TR for <em>all</em> topics in that TRD can be reduced. If practical, applications can be moved between TRDs to enable some TRDs to be populated by UM version 6.12 and beyond. Also, a TRD can be sub-divided, separating pre-upgraded from post-upgraded. </li>
</ul>
<p>When all of your UM components are upgraded to UM 6.14 or beyond, you can use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverdisableudptopicresolutioncontext">resolver_disable_udp_topic_resolution (context)</a> configuration option to turn off UDP-based TR.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tcpbasedtrconfiguration"></a>
TCP-Based TR Configuration&nbsp;&nbsp;<small><a href="#tcpbasedtrconfiguration">&lt;-</a></small></h3>
<p>A UM context is configured to use TCP-based TR with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>, which tells how to connect to the SRS. For example: </p><pre class="fragment">context resolver_service 10.29.3.41:12000
</pre><p>A DNS host name can be used instead of an IP address: </p><pre class="fragment">context resolver_service test1.informatica.com:12000
</pre><p>For fault tolerance, more than one running SRS instance can be configured: </p><pre class="fragment">context resolver_service test1.informatica.com:12000,test2.informatica.com:12000
</pre><p>This assumes that an SRS service is running at that address:port.</p>
<p>If interoperability with UDP-based TR is not needed, UM should be configured to use ONLY the SRS for topic resolution using the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverdisableudptopicresolutioncontext">resolver_disable_udp_topic_resolution (context)</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="srsservice"></a>
SRS Service&nbsp;&nbsp;<small><a href="#srsservice">&lt;-</a></small></h3>
<p>The SRS service is a daemon process which must be run to provide TCP-based TR for a TRD.</p>
<p>See <a class="el" href="index.html#manpagesforsrs">Man Pages for SRS</a> for details on running the SRS service.</p>
<p>All the contexts in the TRD must be configured to connect to the SRS with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>. After connecting, each context exchanges TR information with the SRS.</p>
<dl class="section attention"><dt>Attention</dt><dd>Applications that connect to the SRS must configure their interfaces properly. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#defaultinterfacecontext">default_interface (context)</a>.</dd></dl>
<p>As applications create and delete sources, the SRS is informed, and the SRS informs all connected contexts. This includes proxy sources from a <a class="el" href="index.html#umrouter">DRO</a>. In addition, a periodic "keepalive" handshake is performed between the SRS and all connected contexts.</p>
<p>If a network failure causes the context's connection to the SRS to be broken, the context will periodically retry the connection. Since most network failures are brief, the context will soon successfully re-establish a connection to the SRS. Even though this is a resumption of the same context's earlier connection, the context and SRS still exchange full TR information to make sure that any changes during the disconnected period are reflected.</p>
<p>The SRS also supports the publishing of operational and status information via the <a class="el" href="index.html#daemonstatistics">daemonstatistics</a> feature. For full details on the SRS Daemon Statistics details, see <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a>.</p>
<p><a class="anchor" id="srsstatelifetime"></a><b>SRS State Lifetime</b></p>
<p>If an application exits abnormally, the SRS will detect that the TCP connection is broken. However, the SRS must not <em>assume</em> that the application has failed; it might be a network problem that forced the disconnection.</p>
<p>So the SRS flags all sources owned by that context as "potentially down", and starts a "source state lifetime" timer (see <a class="el" href="index.html#srselementsourcestatelifetime">&lt;source-state-lifetime&gt;</a>). If the context has <em>not</em> failed, and reconnects within that period, during the initial exchange of TR information, the SRS will unflag any "potentially down" sources. However, in the case of application failure, when the state lifetime expires, all "potentially down" sources are deleted. All connected contexts are informed of those deletions.</p>
<p>Note that as of UM version 6.13, the SRS also tracks application interest (topics for which the context has receivers). This interest is also remembered by the SRS if the connection is broken, and also has an "interest state lifetime" timer (see <a class="el" href="index.html#srselementintereststatelifetime">&lt;interest-state-lifetime&gt;</a>). If the context has <em>not</em> failed, and reconnects within that period, during the initial exchange of TR information, the SRS will unflag any "potentially down" receiver interest. However, in the case of application failure, when the state lifetime expires, all "potentially down" receiver interest is deleted.</p>
<p>To maintain compatibility with 6.12 configurations, the <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a> is maintained, and is used as the default value for both source and interest state lifetimes.</p>
<p>Note that if an application fails and then restarts, its connection to the SRS is <em>not</em> considered to be a resumption of the previous connection. It is considered to be a new context, and any sources created are new sources. The previous application instance's sources will remain in the "potentially down" state, and will time out with the state lifetime.</p>
<p>If a network outage lasts longer than the configured state lifetime, the SRS gives up on the context and deletes sources and interest. These deletions are communicated to all connected contexts. When the network outage is repaired and the context reconnects, the exchange of TR information with the SRS will re-create the context's sources and interest in the SRS, and communicate them to other contexts. This restores normal operation.</p>
<p>Starting with UM version 6.14, the SRS also tracks routing information sent by the <a class="el" href="index.html#umrouter">DRO</a>. That information is handled in much the same way as client information.</p>
<p><a class="anchor" id="srslogfile"></a><b>SRS Log File</b></p>
<p>The SRS generates log messages that are used to monitor its health and operation. You can configure these to be directed to "console" (standard output) or a specified log "file", via the <a class="el" href="index.html#srselementlog">&lt;log&gt;</a> configuration element. Normally "console" is only used during testing; a persistent log file should be used for production. The SRS does not over-write its log files on startup, but instead appends to it.</p>
<p><a class="anchor" id="srsrollinglogs"></a><b>SRS Rolling Logs</b></p>
<p>To prevent unbounded disk file growth, the SRS supports rolling log files. When the log file rolls, the file is renamed according to the model: <br />
&#160;&#160;<em>CONFIGUREDNAME</em><code>_</code><em>PID</em><code>.</code><em>DATE</em><code>.</code><em>SEQNUM</em> <br />
where: </p><ul>
<li>
<em>CONFIGUREDNAME</em> - Root name of log file, as configured by user. </li>
<li>
<em>PID</em> - Process ID of the SRS daemon process. </li>
<li>
<em>DATE</em> - Date that the log file was rolled, in YYYY-MM-DD format. </li>
<li>
<em>SEQNUM</em> - Sequence number, starting at 1 when the process starts, and incrementing each time the log file rolls. </li>
</ul>
<p>For example: <code>srs.log_9867.2017-08-20.2</code></p>
<p>The user can configure when the log file is eligible to roll over by either or both of two criteria: size and frequency. The size criterion is in millions of bytes. The frequency criterion can be daily or hourly. Once one or both criteria are met, the next message written to the log will trigger a roll operation. These criteria are supplied as attributes to the <a class="el" href="index.html#srselementlog">&lt;log&gt;</a> configuration element.</p>
<p>If both criteria are supplied, then the first one to be reached will trigger a roll. For example, consider the setting: </p><div class="fragment"><div class="line">&lt;log type=<span class="stringliteral">&quot;file&quot;</span> size=<span class="stringliteral">&quot;23&quot;</span> frequency=<span class="stringliteral">&quot;daily&quot;</span>&gt;srs.log&lt;/log&gt;</div></div><!-- fragment --><p> Let's say that the log file grows at 1 million bytes per hour (VERY unlikely for an SRS, but let's assume for illustration purposes). At 11:00 pm, the log file will reach 23 million bytes, and will roll. Then, at 12:00 midnight, the log file will roll again, even though it is only 1 million bytes in size.</p>
<p>In addition, the SRS supports automatic deletion of log files based on either or both of two criteria: max history, and total size cap. The max history refers to the number of archived log files, and the total size cap refers to the sum of the sizes of the archived files in millions of bytes. When either or both criteria are met, one or more of the oldest log files are removed until the criteria no longer apply.</p>
<p>For more information, see the <a class="el" href="index.html#srselementlog">&lt;log&gt;</a> configuration element.</p>
<p><br />
 </p>
<h2><a class="anchor" id="srsmonitoring"></a>
SRS Monitoring&nbsp;&nbsp;<small><a href="#srsmonitoring">&lt;-</a></small></h2>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html">Monitoring</a> for an overview of monitoring an Ultra Messaging network.</p>
<p>It is important to the health and stability of a UM network to monitor the operation of SRSes. This monitoring should include real-time automated detection of problems that will produce a timely alert to operations staff.</p>
<p>Two types of data should be monitored: </p><ul>
<li>
Log file. </li>
<li>
Daemon statistics. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="srsmonitoringlogs"></a>
SRS Monitoring: Logs&nbsp;&nbsp;<small><a href="#srsmonitoringlogs">&lt;-</a></small></h3>
<p>Ideally, log file monitoring would support the following: </p><ul>
<li>
Archive all log messages for all SRSes for at least a week, preferably a month. </li>
<li>
Provide rapid access to operations staff to view the latest log messages from a SRS. </li>
<li>
Periodic scans of the log file to detect errors and raise alerts to operations staff. </li>
</ul>
<p>Regarding log file scanning, messages in the SRS's log file contain a severity indicator in square brackets. For example: </p><pre class="fragment">Tue Nov 1 13:29:37 CDT 2022 [INFO]: SRS-10385-99: TCP Disconnect received for client[10.29.3.101:47205] sessionID[0x8295ab9a]
</pre><p> Informatica recommends alerting operations staff for messages of severity [WARNING], [ERROR], [CRITICAL], [ALERT], and [EMERGENCY].</p>
<p>It would also be useful to have a set of exceptions for specific messages you wish to ignore.</p>
<p>There are many third party real-time log file analysis tools available. A discussion of possible tools is beyond the scope of UM documentation.</p>
<p><br />
 </p>
<h3><a class="anchor" id="srsmonitoringdaemonstats"></a>
SRS Monitoring: Daemon Stats&nbsp;&nbsp;<small><a href="#srsmonitoringdaemonstats">&lt;-</a></small></h3>
<p>There are two data formats for the SRS to send its daemon stats: </p><ul>
<li>
Protobufs - recommended. </li>
<li>
JSON - deprecated. Informatica recommends migrating to protobufs. </li>
</ul>
<p>For information on the deprecated JSON formatted daemon stats, see <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a>.</p>
<p>The protobufs format is accepted by the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringcollectorservicemcs">Monitoring Collector Service (MCS)</a> and the "lbmmon" example applications: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmmon_c">Example lbmmon.c</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmmon_java">Example lbmmon.java</a>.</p>
<p>For example, here is an excerpt from a sample SRS configuration file that shows how its daemon stats can be published: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  ...</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;ping-interval&gt;600000&lt;/ping-interval&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;<span class="keywordflow">default</span>&gt;600000&lt;/<span class="keywordflow">default</span>&gt;</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    &lt;lbm-attributes&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;resolver_unicast_daemon&quot;</span> value=<span class="stringliteral">&quot;10.29.3.101:12801&quot;</span>/&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;default_interface&quot;</span> value=<span class="stringliteral">&quot;10.29.3.0/24&quot;</span>/&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;mim_incoming_address&quot;</span> value=<span class="stringliteral">&quot;0.0.0.0&quot;</span>/&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;source&quot;</span> name=<span class="stringliteral">&quot;transport&quot;</span> value=<span class="stringliteral">&quot;tcp&quot;</span>/&gt;</div><div class="line">      ...</div><div class="line">    &lt;/lbm-attributes&gt;</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div></div><!-- fragment --><p><b>Notes:</b></p>
<ol>
<li>
<p class="startli">The <a class="el" href="index.html#srselementmonitorformat">SRS Element "&lt;monitor-format&gt;"</a> value "pb" selects the protobuf format and is available for the SRS in UM version 6.15 and beyond.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">For a list of possible protobuf messages for the SRS, see the "srs_mon.proto" file at <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplesrs_mon_proto">Example srs_mon.proto</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The <a class="el" href="index.html#srselementpinginterval">SRS Element "&lt;ping-interval&gt;"</a> and <a class="el" href="index.html#srselementdefault">SRS Element "&lt;default&gt;"</a> define the statistics sampling period. In the above example, 600 seconds (10 minutes) is chosen somewhat arbitrarily. Shorter times produce more data, but not much additional benefit. However, UM networks with many thousands of applications may need a longer interval (perhaps 30 or 60 minutes) to maintain a reasonable load on the network and monitoring data storage.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The LBM attributes included in the above example within the <a class="el" href="index.html#srselementdaemonmonitor">SRS Element "&lt;daemon-monitor&gt;"</a> element sets options for the monitoring data TRD. (Alternatively, you can configure the monitoring context using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpautomaticmonitoring.html#monitortransportoptscontext">monitor_transport_opts (context)</a>.) When possible, Informatica recommends directing monitoring data to an administrative network, separate from the application data network. This prevents monitoring data from interfering with application data latency or throughput. In this example, the monitoring context is configured to use an interface matching <code>10.29.3.0/24</code>. There are other ways to specify the interface; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/generalconfigurationguidelines.html#specifyinginterfaces">Specifying Interfaces</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">In this example, the monitoring data <a class="el" href="index.html#topicresolutiondescription">TRD</a> uses <a class="el" href="index.html#unicasttopicresolution">Unicast UDP Topic Resolution</a>. The <a class="el" href="index.html#lbmrdmanpage">lbmrd</a> daemon is running on host 10.29.3.101, port 12001.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The monitoring data is sent out via UM using the <a class="el" href="index.html#transporttcp">TCP transport</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">These settings were chosen to conform to the recommendations in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#automaticmonitoring">Automatic Monitoring</a>.</p>
<p class="endli"></p>
</li>
</ol>
<p>For a full demonstration of monitoring, see: <a href="https://github.com/UltraMessaging/mcs_demo">https://github.com/UltraMessaging/mcs_demo</a></p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="architecture"></a>
Architecture&nbsp;&nbsp;<small><a href="#architecture">&lt;-</a></small></h1>
<p>UM is designed to be a flexible architecture. Unlike many messaging systems, UM does not require an intermediate daemon to handle routing issues or protocol processing. This increases the performance of UM and returns valuable computation time and memory back to applications that would normally be consumed by messaging daemons.</p>
<p><br />
 </p>
<h2><a class="anchor" id="udpbasedtopicresolutiondetails"></a>
UDP-Based Topic Resolution Details&nbsp;&nbsp;<small><a href="#udpbasedtopicresolutiondetails">&lt;-</a></small></h2>
<p>The following diagram illustrates UDP-based Topic Resolution. The diagram references multicast configuration options, but the concepts apply equally to unicast.</p>
<div class="image">
<img src="TopicResolution.png" alt="TopicResolution.png"/>
</div>
 <p>By default, Ultra Messaging relies on UDP-based Topic Resolution. UDP-based TR uses <em>queries</em> (TQRs) and <em>advertisements</em> (TIRs) to resolve topics. These TQRs and TIRs are sent in UDP datagrams, typically with more than one TIR or TQR in a given datagram.</p>
<p>UDP-based topic resolution traffic can benefit from hardware acceleration. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html">Transport Acceleration Options</a> for more information.</p>
<p>For Multicast UDP, TR datagrams are sent to an IP multicast group and UDP port configured with the Ultra Messaging configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastresolvernetwork.html#resolvermulticastaddresscontext">resolver_multicast_address (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastresolvernetwork.html#resolvermulticastportcontext">resolver_multicast_port (context)</a>).</p>
<p>For Unicast UDP, TR datagrams are sent to the IP address and port of the "lbmrd" daemon. See the UM configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastresolvernetwork.html#resolverunicastdaemoncontext">resolver_unicast_daemon (context)</a>.</p>
<p>Note that if both Multicast and Unicast are configured, the Unicast has higher precedence, and Multicast will not be used.</p>
<p>UDP-based Topic Resolution occurs in the following phases:</p>
<ul>
<li>
Initial Phase - Period that allows you to resolve a topic aggressively. This phase can be configured to run differently from the defaults or completely disabled. </li>
<li>
Sustaining Phase - Period that allows new receivers to resolve a topic after the Initial Phase. Can also be the primary period of topic resolution if you disable the Initial Phase. This phase can also be configured to run differently from the defaults or completely disabled. </li>
<li>
Quiescent Phase - The quiet phase where Topic Resolution datagrams are no longer sent in an unsolicited way. This reduces the CPU and network resources consumed by TR, and also reduces latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). However, in large deployments, especially those that include wide-area networks, the Quiescent Phase is sometimes disabled, by configuring the Sustaining Phase to continue forever. This is done to avoid <a class="el" href="index.html#glossarydeafness">deafness</a> issues. </li>
</ul>
<p>The phases of topic resolution are specific to individual topics. A single context can have some topics in each of the three phases running concurrently.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcesadvertise"></a>
Sources Advertise&nbsp;&nbsp;<small><a href="#sourcesadvertise">&lt;-</a></small></h3>
<p>For UDP-based TR, Sources use Topic Resolution in the following ways:</p>
<ul>
<li>
<p class="startli">Unsolicited advertisement of active sources. When a source is first created, it enters the Initial Phase of TR. During the Initial, and subsequent Sustaining phases, the source sends Topic Information Record datagrams (TIRs) to all the other contexts in the <a class="el" href="index.html#topicresolutiondomain">TRD</a>. The source does this in an unsolicited manner; it advertises even if there are no receivers for its topic.</p>
<p class="endli"></p>
</li>
<li>
Respond to Topic Queries. When a receiver is first created, it enters the Initial phase of TR. During the Initial, and subsequent Sustaining phases, the receiver sends Topic Query Records (TQRs) to all other contexts in the TRD. When a source receives a TQR for its topic, it will restart its Sustaining Phase of advertising to ensure that the receiver discovers the source. </li>
</ul>
<p>A TIR contains all the information that the receiver needs to join the topic's <a class="el" href="index.html#transportsessions">Transport Session</a>. The TIR datagram sent unsolicited is identical to the TIR sent in response to a TQR. Depending on the transport type, a TIR will contain one of the following groups of information:</p>
<ul>
<li>
For transporttcp, the source address, TCP port and Session ID. </li>
<li>
For <a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a>, the source address, the multicast group address, the UDP destination port, LBT-RM Session ID, and the unicast UDP port to which NAKs are sent. </li>
<li>
For <a class="el" href="index.html#transportlbtru">Transport LBT-RU</a>, the source address, UDP port and Session ID. </li>
<li>
For <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>, the Host ID, LBT-IPC Session ID and Transport ID. </li>
<li>
For transportlbtsmx, the Host ID, LBT-SMX Session ID and Transport ID. </li>
</ul>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html">UDP-Based Resolver Operation Options</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receiversquery"></a>
Receivers Query&nbsp;&nbsp;<small><a href="#receiversquery">&lt;-</a></small></h3>
<p>For UDP-based TR, when an application creates a receiver within a context, the new receiver first checks the context's resolver cache for any matching sources that the context has already discovered. Those will be joined immediately.</p>
<p>In addition, the receiver normally initiates a process of sending Topic Query Records (TQRs). This triggers sources for the receiver's topic to advertise, if they are not already. This allows sources which are in their Quiescent Phase to be discovered by new receivers.</p>
<p>A TQR consists primarily of the topic string.</p>
<p><br />
 </p>
<h3><a class="anchor" id="wildcardreceivertopicresolution"></a>
Wildcard Receiver Topic Resolution&nbsp;&nbsp;<small><a href="#wildcardreceivertopicresolution">&lt;-</a></small></h3>
<p>For UDP-based TR, <a class="el" href="index.html#umwildcardreceivers">UM Wildcard Receivers</a> use Topic Resolution in conceptually the same ways as a single-topic receiver, although some of the details are different. Instead of searching the resolver cache for a specific topic, a new wildcard receiver object searches for all sources that match the wildcard pattern.</p>
<p>Also, the TQRs contain the wildcard pattern, and all sources matching the pattern will advertise.</p>
<p>Finally, wildcard receivers omit the Sustaining Phase for sending Queries. They only support Initial and Quiescent Phases.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpwildcardreceiver.html">Wildcard Receiver Options</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="initialphase"></a>
Initial Phase&nbsp;&nbsp;<small><a href="#initialphase">&lt;-</a></small></h3>
<p>For UDP-based TR, the initial topic resolution phase for a topic is an aggressive phase that can be used to resolve all topics before sending any messages. During the initial phase, network traffic and CPU utilization might actually be higher. You can completely disable this phase, if desired. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/exampleconfigurationscenarios.html#disablingaspectsoftopicresolution">Disabling Aspects of Topic Resolution</a> for more information.</p>
<p><b>Advertising in the Initial Phase</b></p>
<p>For the initial phase default settings, the resolver issues the first advertisement as soon as the scheduler can process it. The resolver issues the second advertisement 10 ms later, or at the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementminimuminitialintervalsource">resolver_advertisement_minimum_initial_interval (source)</a>. For each subsequent advertisement, UM doubles the interval between advertisements. The source sends an advertisement at 20 ms, 40 ms, 80 ms, 160 ms, 320 ms and finally at 500 ms, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementmaximuminitialintervalsource">resolver_advertisement_maximum_initial_interval (source)</a>. These 8 advertisements require a total of 1130 ms. The interval between advertisements remains at the maximum 500 ms, resulting in 7 more advertisements before the total duration of the initial phase reaches 5000 ms, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementminimuminitialdurationsource">resolver_advertisement_minimum_initial_duration (source)</a>. This concludes the initial advertisement phase for the topic.</p>
<div class="image">
<img src="Resolver_Initial_Phase_TIR.png" alt="Resolver_Initial_Phase_TIR.png"/>
</div>
 <p>The initial phase for a topic can take longer than the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementminimuminitialdurationsource">resolver_advertisement_minimum_initial_duration (source)</a> if many topics are in resolution at the same time. The configuration options, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverinitialadvertisementspersecondcontext">resolver_initial_advertisements_per_second (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverinitialadvertisementbpscontext">resolver_initial_advertisement_bps (context)</a> enforce a rate limit on topic advertisements for the entire UM context. A large number of topics in resolution - in any phase - or long topic names may exceed these limits.</p>
<p>If a source advertising in the initial phase receives a topic query, it responds with a topic advertisement. UM recalculates the next advertisement interval from that point forward as if the advertisement was sent at the nearest interval.</p>
<p><b>Querying in the Initial Phase</b></p>
<p>Querying activity by receivers in the initial phase operates in similar fashion to advertising activity, although with different interval defaults. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverqueryminimuminitialintervalreceiver">resolver_query_minimum_initial_interval (receiver)</a> default is 20 ms. Subsequent intervals double in length until the interval reaches 200 ms, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverquerymaximuminitialintervalreceiver">resolver_query_maximum_initial_interval (receiver)</a>. The query interval remains at 200 ms until the initial querying phase reaches 5000 ms, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverqueryminimuminitialdurationreceiver">resolver_query_minimum_initial_duration (receiver)</a>.</p>
<div class="image">
<img src="Resolver_Initial_Phase_TQR.png" alt="Resolver_Initial_Phase_TQR.png"/>
</div>
 <p>The initial query phase completes when it reaches the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverqueryminimuminitialdurationreceiver">resolver_query_minimum_initial_duration (receiver)</a>. The initial query phase also has UM context-wide rate limit controls (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverinitialqueriespersecondcontext">resolver_initial_queries_per_second (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverinitialquerybpscontext">resolver_initial_query_bps (context)</a>) that can result in the extension of a phase's duration in the case of a large number of topics or long topic names.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sustainingphase"></a>
Sustaining Phase&nbsp;&nbsp;<small><a href="#sustainingphase">&lt;-</a></small></h3>
<p>For UDP-based TR, the sustaining topic resolution phase follows the initial phase and can be a less active phase in which a new receiver resolves its topic. It can also act as the sole topic resolution phase if you disable the initial phase. The sustaining phase defaults use less network resources than the initial phase and can also be modified or disabled completely. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/exampleconfigurationscenarios.html#disablingaspectsoftopicresolution">Disabling Aspects of Topic Resolution</a> for details.</p>
<p><b>Advertising in the Sustaining Phase</b></p>
<p>For the sustaining phase defaults, a source sends an advertisement every second (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementsustainintervalsource">resolver_advertisement_sustain_interval (source)</a>) for 1 minute (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolveradvertisementminimumsustaindurationsource">resolver_advertisement_minimum_sustain_duration (source)</a>). When this duration expires, the sustaining phase of advertisement for a topic ends. If a source receives a topic query, the sustaining phase resumes for the topic and the source completes another duration of advertisements.</p>
<div class="image">
<img src="Resolver_Sustain_Phase_TIR.png" alt="Resolver_Sustain_Phase_TIR.png"/>
</div>
 <p>The sustaining advertisement phase has UM context-wide rate limit controls (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversustainadvertisementspersecondcontext">resolver_sustain_advertisements_per_second (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversustainadvertisementbpscontext">resolver_sustain_advertisement_bps (context)</a>) that can result in the extension of a phase's duration in the case of a large number of topics or long topic names.</p>
<p><b>Querying in the Sustaining Phase</b></p>
<p>Default sustaining phase querying operates the same as advertising. Unresolved receivers query every second (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverquerysustainintervalreceiver">resolver_query_sustain_interval (receiver)</a>) for 1 minute (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverqueryminimumsustaindurationreceiver">resolver_query_minimum_sustain_duration (receiver)</a>). When this duration expires, the sustaining phase of querying for a topic ends.</p>
<div class="image">
<img src="Resolver_Sustain_Phase_TQR.png" alt="Resolver_Sustain_Phase_TQR.png"/>
</div>
 <p>Sustaining phase queries stop when one of the following events occurs:</p>
<ul>
<li>
The receiver discovers multiple sources that equal <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolutionnumberofsourcesquerythresholdreceiver">resolution_number_of_sources_query_threshold (receiver)</a>. </li>
<li>
The sustaining query phase reaches the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverqueryminimumsustaindurationreceiver">resolver_query_minimum_sustain_duration (receiver)</a>. </li>
</ul>
<p>The sustaining query phase also has UM context-wide rate limit controls (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversustainqueriespersecondcontext">resolver_sustain_queries_per_second (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversustainquerybpscontext">resolver_sustain_query_bps (context)</a>) that can result in the extension of a phase's duration in the case of a large number of topics or long topic names.</p>
<p><br />
 </p>
<h3><a class="anchor" id="quiescentphase"></a>
Quiescent Phase&nbsp;&nbsp;<small><a href="#quiescentphase">&lt;-</a></small></h3>
<p>For UDP-based TR, this phase is the absence of topic resolution activity for a given topic. It is possible that some topics may be in the quiescent phase at the same time other topics are in initial or sustaining phases of topic resolution.</p>
<p>This phase ends if either of the following occurs.</p>
<ul>
<li>
A new receiver sends a query. </li>
<li>
Your application calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae6dd7c56acf916ef66658cc1ebc7a525">lbm_context_topic_resolution_request()</a> that provokes the sending of topic queries for any receiver or wildcard receiver in this state. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="storecontextnameresolution"></a>
Store (context) Name Resolution&nbsp;&nbsp;<small><a href="#storecontextnameresolution">&lt;-</a></small></h3>
<p>For UDP-based TR, with the UMP/UMQ products, topic resolution facilitates the resolution of persistent Store names to a DomainID:IPAddress:Port.</p>
<p>Topic Resolution resolves Store (or context) names by sending context name queries and context name advertisements over the topic resolution channel. A Store name resolves to the Store's DomainID:IPAddress:Port. You configure the Store's name and IPAddress:Port in the Store's XML configuration file. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/persistencearchitecture.html#identifyingpersistentstores">Identifying Persistent Stores</a> for more information.</p>
<p>If you do not use the <a class="el" href="index.html#umrouter">DRO</a>, the DomainID is zero. Otherwise, the DomainID represents the Topic Resolution Domain where the Store resides. Stores learn their DomainID by listening to Topic Resolution traffic.</p>
<p>Via the Topic Resolution channel, sources query for Store names and Stores respond with an advertisement when they see a query for their own Store name. The advertisement contains the Store's DomainID:IPAddress:Port.</p>
<p>For a new source configured to use Store names (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umestorenamesource">ume_store_name (source)</a>), the resolver issues the first context name query as soon as the scheduler can process it. The resolver issues the second advertisement 100 ms later, or at the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolvercontextnamequeryminimumintervalcontext">resolver_context_name_query_minimum_interval (context)</a>. For each subsequent query, UM doubles the interval between queries. The source sends a query at 200 ms, 400 ms, 800 ms and finally at 1000 ms, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolvercontextnamequerymaximumintervalcontext">resolver_context_name_query_maximum_interval (context)</a>. The interval between queries remains at the maximum 1000 ms until the total time querying for a Store (context) name equals <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolvercontextnamequerydurationcontext">resolver_context_name_query_duration (context)</a>. The default for this duration is 0 (zero) which means the resolver continues to send queries until the name resolves. After a Store name resolves, the resolver stops sending queries.</p>
<p>If a source sees advertisements from multiple Stores with the same name, or a Store sees an advertisement that matches its own Store name, the source issues a warning log message. The source also issues an informational log message whenever it detects that a resolved Store (context) name changes to a different DomainID:IPAddress:Port.</p>
<p><br />
 </p>
<h3><a class="anchor" id="udptopicresolutionconfigurationoptions"></a>
UDP Topic Resolution Configuration Options&nbsp;&nbsp;<small><a href="#udptopicresolutionconfigurationoptions">&lt;-</a></small></h3>
<p>See the following sections in <a href="../../../Config/index.html">UM Configuration Guide</a> for more information:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html">UDP-Based Resolver Operation Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastresolvernetwork.html">Multicast Resolver Network Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastresolvernetwork.html">Unicast Resolver Network Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpwildcardreceiver.html">Wildcard Receiver Options</a> </li>
</ul>
<p><b>Assigning Different Configuration Options to Individual Topics</b></p>
<p>You can set configuration options differently for individual topics, either by using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html">XML Configuration Files</a> (the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/xmlconfigurationfiles.html#umelementtopic">&lt;topic&gt;</a> element), or by using the API functions for setting configuration options programmatically (e.g. <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1afc75f0fb3601d072b3463e7acf16a6">lbm_rcv_topic_attr_setopt()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a96ea052dce2e6376684cbf2003407cbf">lbm_src_topic_attr_setopt()</a>).</p>
<p><br />
 </p>
<h3><a class="anchor" id="unicasttopicresolution"></a>
Unicast UDP Topic Resolution&nbsp;&nbsp;<small><a href="#unicasttopicresolution">&lt;-</a></small></h3>
<p>By default UM expects multicast connectivity between all sources and receivers. When only unicast connectivity is available, you may configure all sources and receivers to use unicast topic resolution. This requires that you run one or more instances of the UM unicast topic resolution daemon (lbmrd), which perform the same topic resolution activities as multicast topic resolution. You configure your applications to use the lbmrd daemons with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastresolvernetwork.html#resolverunicastdaemoncontext">resolver_unicast_daemon (context)</a>.</p>
<p>See <a class="el" href="index.html#lbmrdmanpage">Lbmrd Man Page</a> for details on running the lbmrd daemon.</p>
<p>The lbmrd can run on any machine, including the source or receiver. Of course, sources will also have to select a transport protocol that uses unicast addressing (e.g. TCP, TCP-LB, or LBT-RU). The lbmrd maintains a table of clients (address and port pairs) from which it has received a topic resolution message, which can be any of the following:</p>
<ul>
<li>
Topic Information Records (TIR) - also known as topic advertisements </li>
<li>
Topic Query Records (TQR) </li>
<li>
keepalive messages, which are only used in unicast topic resolution </li>
</ul>
<p>After lbmrd receives a TQR or TIR, it forwards it to all known clients. If a client (source or receiver) is not sending either TIRs or TQRs, it sends a keepalive message to lbmrd according to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverunicastkeepaliveintervalcontext">resolver_unicast_keepalive_interval (context)</a>. This registration with the lbmrd allows the client to receive advertisements or queries from lbmrd. lbmrd maintains no state about topics, only about clients.</p>
<p><b>LBMRD with the DRO Best Practice</b></p>
<p>If you're using the lbmrd for topic resolution across a <a class="el" href="index.html#umrouter">DRO</a>, you may want all of your domains discovered and all routes to be known before creating any topics. If so, change the UM configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverunicastforcealivecontext">resolver_unicast_force_alive (context)</a>, from the default setting to 1 so your contexts start sending keepalives to lbmrd immediately. This makes your startup process cleaner by allowing your contexts to discover the other Topic Resolution Domains and establish the best routes. The trade-off is a little more network traffic every 5 seconds.</p>
<p><b>Unicast Topic Resolution Resilience</b></p>
<p>Running multiple instances of lbmrd allows your applications to continue operation in the face of a lbmrd failure. Your applications' sources and receivers send topic resolution messages as usual, however, rather than sending every message to each lbmrd instance, UM directs messages to lbmrd instances in a round-robin fashion. Since the lbmrd does not maintain any resolver state, as long as one lbmrd instance is running, UM continues to forward LBMR packets to all connected clients. UM switches to the next active lbmrd instance every 250-750 ms.</p>
<p><br />
 </p>
<h3><a class="anchor" id="networkaddresstranslationnat"></a>
LBMRD NAT Transit&nbsp;&nbsp;<small><a href="#networkaddresstranslationnat">&lt;-</a></small></h3>
<p>Some networks make use of a <a class="el" href="index.html#glossarynat">glossarynat</a> NAT router to map one IP address space onto another. If your network architecture includes LANs that are bridged with a NAT device, UM receivers will usually not be able to connect directly to UM sources across the NAT. Sources send Topic Resolution advertisements containing their local IP addresses and ports, but receivers on the other side of the NAT cannot access those sources using those local addresses/ports. They must use alternate addresses/ports, which the NAT forwards according to the NAT's configuration.</p>
<p>The recommended method of establishing UM connectivity across a NAT is to run a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterimplementation.html#dronattransit">pair of DROs</a> connected with a single TCP peer link. In this usage, the LANs on each side of the NAT are distinct Topic Resolution Domains.</p>
<p>Alternatively, if the NAT can be configured to allow two-way UDP traffic between the networks, the lbmrd can be configured to modify Topic Resolution advertisements according to a set of rules defined in an XML configuration file. Those rules allow a source's advertisements forwarded to local receivers to be sent as-is, while advertisements forwarded to remote receivers are modified with the IP addresses and ports that the NAT expects. In this usage, the LANs on each side of the NAT are combined into a single Topic Resolution domain.</p>
<p>This is a lower-latency solution than <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterimplementation.html#dronattransit">dual DROs</a>, but has <a class="el" href="index.html#lbmrdnatrestrictions">significant restrictions</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="examplenatconfiguration"></a>
Example NAT Configuration&nbsp;&nbsp;<small><a href="#examplenatconfiguration">&lt;-</a></small></h3>
<p>In this example, there are two networks, A and B, that are interconnected via a NAT firewall. Network A has IP addresses in the 10.1.0.0/16 range, and B has IP addresses in the 192.168.1/24 range. The NAT is configured such that hosts in network B have no visibility into network A, and can send TCP and UDP packets to only a single host in A (10.1.1.50) via the NAT's external IP address 192.168.1.1, ports 12000 and 12001. Packets sent from B to 192.168.1.1:12000 are forwarded to 10.1.1.50:12000, and packets from B to 192.168.1.1:12001 are forwarded to 10.1.1.50:12001. Hosts in network A have full visibility of network B and can send TCP and UDP packets to hosts in B by their local 192 addresses and ports. Those packets have their source addresses changed to 192.168.1.1.</p>
<p>Since hosts in network A have full visibility into network B, receivers in network A should be able to use source advertisements from network B without any changes. However, receivers in network B will not be able to use source advertisements from network A unless those advertisements' IP addresses are transformed.</p>
<p>The lbmrd is configured for NAT using its XML configuration file:</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;interface&gt;10.1.1.50&lt;/interface&gt;</div><div class="line">    &lt;port&gt;12000&lt;/port&gt;</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  &lt;domains&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NYC&quot;</span>&gt;</div><div class="line">      &lt;network&gt;10.1.0.0/16&lt;/network&gt;</div><div class="line">    &lt;/domain&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;network&gt;192.168.1/24&lt;/network&gt;</div><div class="line">    &lt;/domain&gt;</div><div class="line">  &lt;/domains&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;Net-NYC&quot;</span> destination=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;rule&gt;</div><div class="line">        &lt;match address=<span class="stringliteral">&quot;10.1.1.50&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">        &lt;replace address=<span class="stringliteral">&quot;192.168.1.1&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">      &lt;/rule&gt;</div><div class="line">    &lt;/transform&gt;</div><div class="line">  &lt;/transformations&gt;</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>The lbmrd must be run on 10.1.1.50.</p>
<p>The application on 10.1.1.50 should be configured with:</p>
<pre class="fragment">context resolver_unicast_daemon 10.1.1.50:12000
source transport_tcp_port 12001
</pre><p>The applications in the 192 network should be configured with:</p>
<pre class="fragment">context resolver_unicast_daemon 192.168.1.1:12000
source transport_tcp_port 12100
</pre><p>With this, the application on 10.1.1.50 is able to create sources and receivers that communicate with applications in the 192 network.</p>
<p>See <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a> for full details of the XML configuration file.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lbmrdnatrestrictions"></a>
Lbmrd NAT Restrictions&nbsp;&nbsp;<small><a href="#lbmrdnatrestrictions">&lt;-</a></small></h3>
<ul>
<li>
<a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-based Topic Resolution</a> using the SRS does not support this form of NAT operation. If you want to mix SRS and lbmrd operation on the same network, <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>. </li>
<li>
<a class="el" href="index.html#persistence">Persistence</a> - not supported. </li>
<li>
<a class="el" href="index.html#queuing">Queuing</a> - not supported. </li>
<li>
<a class="el" href="index.html#requestresponse">Request/Response</a> - not supported. </li>
<li>
<a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> (UIM) - not supported. </li>
<li>
<a class="el" href="index.html#latejoin">Late Join</a> - limited supported. </li>
<li>
<a class="el" href="index.html#offtransportrecoveryotr">Off-Transport Recovery (OTR)</a> - limited supported. </li>
<li>
<a class="el" href="index.html#sendingtosources">Sending to Sources</a> - limited supported. </li>
</ul>
<p>Late Join, sending to sources, and OTR can be made to work if applications are configured to use the default value (0.0.0.0) for <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpinterfacecontext">request_tcp_interface (context)</a>. This means that you cannot use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#defaultinterfacecontext">default_interface (context)</a>. Be aware that the <a class="el" href="index.html#umrouter">DRO</a> requires a valid interface be specified for <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpinterfacecontext">request_tcp_interface (context)</a>. Thus, <b>lbmrd NAT support for Late Join, Request/Response, and OTR is not compatible with UM topologies that contain the DRO</b>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="udpbasedtopicresolutionstrategies"></a>
UDP-Based Topic Resolution Strategies&nbsp;&nbsp;<small><a href="#udpbasedtopicresolutionstrategies">&lt;-</a></small></h2>
<p>Configuring UDP-based TR frequently involves a process of weighing the costs and benefits of different goals. The most common goals involved are:</p>
<ul>
<li>
<b>Avoid "deafness".</b> <a class="el" href="index.html#glossarydeafness">deafness</a> is when there is a source and a receiver for a topic, but the receiver does not discover the source. This is usually a very high priority goal. </li>
<li>
<b>Minimize the delay before a transport session is joined.</b> This is especially important when a new source is created and the application wants to wait until all existing receivers have fully joined the transport session before sending messages. </li>
<li>
<b>Minimizing impact on the system.</b> Sending and receiving TR datagrams consumes CPU, network bandwidth, and can introduce latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>) on active data transports. </li>
<li>
<b>Maximizing scalability and flexibility.</b> Some deployments are tightly-coupled, carefully controlled, and well-defined. In those cases, scalability and flexibility might not be high-priority goals. Other deployments are loosely-coupled, and consist of many different application groups that do not necessarily coordinate their use of UM with each other. In those cases, scalability and flexibility can be important. </li>
<li>
<b>Fault tolerance.</b> Some environments, especially those that include Wide Area Networks, can have periodic degradation or loss of network connectivity. It is desired that after a given network problem is resolved, UM will quickly and automatically reestablish normal operation without <a class="el" href="index.html#glossarydeafness">deafness</a>. </li>
</ul>
<p>The right TR strategy for a given deployment can depend heavily on the relative importance of these and other goals. It is impossible to give a "one size fits all" solution. Most users work with Informatica engineers to design a custom configuration.</p>
<p>Most users employ a variation on a few basic strategies. Note for the most part, these strategies do not depend on the specific UDP protocol (Multicast vs. Unicast). Normally Multicast is chosen, except where network or policy restrictions forbid it.</p>
<p><br />
 </p>
<h3><a class="anchor" id="defaulttr"></a>
Default TR&nbsp;&nbsp;<small><a href="#defaulttr">&lt;-</a></small></h3>
<p>The main characteristics of UM's default TR settings are: </p><ul>
<li>
Multicast UDP. </li>
<li>
Three phases enabled (Initial, Sustaining, Quiescent). Unsolicited TIRs and TQRs nominally last for 65 seconds, although that number can grow as the number of sources or receivers in a context increases. </li>
</ul>
<p>The default settings can be fine for reasonably small, static deployments, typically not including Wide Area Networks. (A "static" deployment is one where sources, and receivers are, for the most part, created during system startup, and deleted during system shutdown. Contrast with a "dynamic" system where applications come and go during normal operation, with sources and receivers being created and deleted at unpredictable times.)</p>
<p>Advantages: </p><ul>
<li>
Simplicity. </li>
<li>
In a network where sources and receivers are relatively static, the consumption of resources by TR stops reasonably quickly. </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
As the numbers of contexts, sources, and receivers grow, the traffic load during the initial phase can be very intense, leading to packet loss and potential <a class="el" href="index.html#glossarydeafness">deafness</a> issues. In these cases, the initial phase can be configured to be less aggressive, or disabled altogether. </li>
<li>
If a network outage lasts longer than 65 seconds, it is possible for new sources and receivers to be deaf to each other, due to entering their quiescent phases. In these cases, the sustaining phase can be configured for longer durations. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="querycentrictr"></a>
Query-Centric TR&nbsp;&nbsp;<small><a href="#querycentrictr">&lt;-</a></small></h3>
<p>The main characteristics of Query-centric TR are: </p><ul>
<li>
Unsolicited TIRs are severely limited or disabled. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/exampleconfigurationscenarios.html#disablingaspectsoftopicresolution">Disabling Aspects of Topic Resolution</a>. </li>
<li>
TQRs are extended, often to infinity. </li>
</ul>
<p>Query-centric TR can be useful for large-scale, dynamic systems, especially those that may have many sources for which there are no receivers during normal operation. For example, in some market data distribution architectures, many tens of thousands of sources are created, but a fairly small percentage of them have receivers at any given time. In that case, it is unnecessary to advertise sources on topics that have no receivers.</p>
<p>Note that this strategy does not prevent advertisements. Each TQR will trigger one or more sources to send a TIR in response.</p>
<p>Advantages: </p><ul>
<li>
For some deployments, can result in significantly reduced TR loading due to removal of TIRs for topics with no receivers. </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
To avoid <a class="el" href="index.html#glossarydeafness">deafness</a> issues, the Query sustaining phase is usually extended, often to infinity. This consumes CPU and Network bandwidth, and can introduce latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). </li>
<li>
For topics that have receivers, both TQR and TIR traffic are present. (In contrast, a <a class="el" href="index.html#advertisecentrictr">Advertise-Centric TR</a> strategy removes the TQRs, but at the expense of advertising <em>all</em> sources, even those that have no receivers.) </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="knownquerythresholdtr"></a>
Known Query Threshold TR&nbsp;&nbsp;<small><a href="#knownquerythresholdtr">&lt;-</a></small></h3>
<p>In a special case of Query-centric TR, certain classes of topics have a specific number of sources. For example, in point-to-point use cases, a particular topic has exactly one source. As another example, some market data distribution architectures have two sources for each topic, a primary and a warm standby.</p>
<p>For those topics where it is known how many sources there should be, the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolutionnumberofsourcesquerythresholdreceiver">resolution_number_of_sources_query_threshold (receiver)</a> can be combined with Query-centric TR to great benefit. Configure the receiver to query forever, and configure the query threshold to the number of expected sources. When the receiver discovers at least that many sources for the topic, it suppresses queries. Note that if a source exits and the receiver detects <a class="el" href="index.html#receiverbosandeosevents">EOS</a>, the number of known sources decreases. If the number drops below the threshold, queries resume.</p>
<p>For example, consider a market data system with a primary and warm standby source for each topic. Unsolicited advertisements are disabled (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/exampleconfigurationscenarios.html#disablingaspectsoftopicresolution">Disabling Aspects of Topic Resolution</a>), and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolutionnumberofsourcesquerythresholdreceiver">resolution_number_of_sources_query_threshold (receiver)</a> is set to 2. The receiver will query until it has discovered two sources, at which point it will stop sending queries. If a source fails, the receiver resumes sending queries until it again has two sources.</p>
<p>The advantage here is that it is no longer necessary to extend the Sustaining phase forever to avoid deafness.</p>
<p>NOTE: wildcard receivers do not fit well with this model of TR. Wildcard receivers have their own query mechanism; see <a class="el" href="index.html#wildcardreceivertopicresolution">Wildcard Receiver Topic Resolution</a>. In particular, there is no wildcard equivalent to the number of sources query threshold. In a query-centric model, wildcard queries must be extended to avoid potential deafness issues. However, in most deployments, the number of wildcard receiver objects is small compared to the number of regular single-topic receivers, so using the Known Query Threshold TR model can still be beneficial.</p>
<p><br />
 </p>
<h3><a class="anchor" id="advertisecentrictr"></a>
Advertise-Centric TR&nbsp;&nbsp;<small><a href="#advertisecentrictr">&lt;-</a></small></h3>
<p>The main characteristics of Advertise-centric TR are: </p><ul>
<li>
Unsolicited TQRs are severely limited or disabled. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/exampleconfigurationscenarios.html#disablingaspectsoftopicresolution">Disabling Aspects of Topic Resolution</a>. </li>
<li>
TIRs are extended, often to infinity. </li>
</ul>
<p>Advertise-centric TR can be useful for large-scale, dynamic systems, especially those that may have very few sources for which there are no receivers. For example, most order management and routing systems use messaging in a point-to-point fashion, and every source should have a receiver. In that case, it is unnecessary to extend queries.</p>
<p>Advantages: </p><ul>
<li>
For some deployments, can result in moderate reduced TR loading due to reduction of TQRs. </li>
</ul>
<p>Disadvantages: </p><ul>
<li>
To avoid <a class="el" href="index.html#glossarydeafness">deafness</a> issues, the Advertising sustaining phase is usually extended, often to infinity. This consumes CPU and Network bandwidth, and can introduce latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>). </li>
<li>
For topics that have no receivers, TIR traffic is present. (In contrast, a <a class="el" href="index.html#querycentrictr">Query-Centric TR</a> strategy removes the TIRs for topics that have no receivers, but at the expense of introducing both TQRs and TIRs.) </li>
<li>
In a deployment that includes the <a class="el" href="index.html#umrouter">DRO</a>, some number of TQRs are necessary to inform the Router that the context is interested in the topic. To avoid deafness issues, it is recommended to extend the Querying Sustaining Phase, although at a reduced rate. </li>
<li>
If the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolutionnosourcenotificationthresholdreceiver">resolution_no_source_notification_threshold (receiver)</a> feature is used, some number of TQRs are necessary. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="messagebatching"></a>
Message Batching&nbsp;&nbsp;<small><a href="#messagebatching">&lt;-</a></small></h2>
<p>This section is about source-side batching - publishers batching messages when sending. See also <a class="el" href="index.html#receivesidebatching">Receive-Side Batching</a>.</p>
<p>Batching many small messages into fewer network packets decreases the per-message CPU load, thereby increasing throughput. Let's say it costs 2 microseconds of CPU to fully process a message. If you process 10 messages per second, you won't notice the load. If you process half a million messages per second, you saturate the CPU. So to achieve high message rates, you have to reduce the per-message CPU cost with some form of message batching. These per-message costs apply to both the sender and the receiver.</p>
<p>Many people are under the impression that while batching reduces CPU load, it increases message latency. There are circumstances where this can happen, but it is also true that careful use of batching can result in small latency increases or none at all. In fact, there are common circumstances where <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> will reduce average latency.</p>
<p>The most common forms of source-side batching employed with UM are: </p><ul>
<li>
<a class="el" href="index.html#implicitbatching">Implicit Batching</a> </li>
<li>
<a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> </li>
<li>
<a class="el" href="index.html#applicationbatching">Application Batching</a> </li>
</ul>
<p>Note that implicit and intelligent batching are not supported for UMQ Brokered Queuing, <a class="el" href="index.html#smartsources">Smart Sources</a>, or <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a>.</p>
<p>When using a kernel-bypass network driver (e.g. Solarflare's Onload), there are special considerations when batching. See <a class="el" href="index.html#datagrammaxsizeandnetworkmtu">Datagram Max Size and Network MTU</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="implicitbatching"></a>
Implicit Batching&nbsp;&nbsp;<small><a href="#implicitbatching">&lt;-</a></small></h3>
<p>With implicit batching, UM automatically batches smaller messages into <a class="el" href="index.html#transportsessions">Transport Session</a> datagrams. The implicit batching configuration options, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> (default = 200 milliseconds) and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> (default = 2048 bytes) govern UM implicit message batching. Although these are source options, they actually apply to the Transport Session to which the source was assigned.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html">Implicit Batching Options</a>.</p>
<p>See also <a class="el" href="index.html#sourceconfigurationandtransportsessions">Source Configuration and Transport Sessions</a>.</p>
<p>UM establishes the implicit batching parameters when it creates the Transport Session. Any sources assigned to that Transport Session use the implicit batching limits set for that Transport Session, and the limits apply to any and all sources subsequently assigned to that Transport Session. This means that batched transport datagrams can contain messages on multiple topics.</p>
<p><b>Implicit Batching Operation</b></p>
<p>Implicit Batching buffers messages until:</p>
<ul>
<li>
the buffer size exceeds the configured <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a>, or </li>
<li>
the oldest message in the buffer has been in the buffer for <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> milliseconds, or </li>
<li>
adding another message would cause the buffer to exceed the configured <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> for the underlying transport type. </li>
</ul>
<p>When at least one condition is met, UM flushes the buffer, pushing the messages onto the network.</p>
<p>Note that the two size-related parameters operate somewhat differently. When the application sends a message, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> option will trigger a flush <em>after</em> the message is sent. A sent datagram will typically be larger than the value specified by <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> (hence the use of the word "minimum"). In contrast, the transport_*_datagram_max_size option will trigger a flush <em>before</em> the message is sent. A sent datagram will never be larger than the transport_*_datagram_max_size option. If both size conditions apply, the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> takes priority.</p>
<p>It may appear this design introduces significant latencies for low-rate topics. However, remember that Implicit Batching operates on a Transport Session basis. Typically many low-rate topics map to the same Transport Session, providing a high aggregate rate. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> option is a last resort to prevent messages from becoming stuck in the Implicit Batching buffer. If your UM deployment frequently uses the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> to push out the data (if the entire Transport Session has periods of inactivity longer than the value of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> (defaults to 200 ms), then either the implicit batching options need to be fine-tuned (reducing one or both), or you should consider an alternate form of batching. See <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a>.</p>
<p>The minimum value for the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> is 3 milliseconds. The actual minimum amount of time that data stays in the buffer depends on your Operating System and its scheduling clock interval. For example, on a Solaris 8 machine, the actual time is can be as much as 20 milliseconds. On older Microsoft Windows machines, the time can be as much as 16 milliseconds. On a Linux 2.6 kernel, the actual time is 3 milliseconds (+/- 1).</p>
<p><b>Implicit Batching Example</b></p>
<p>The following example demonstrates how the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> is actually a trigger or floor, for sending batched messages. It is sometimes misconstrued as a ceiling or upper limit.</p>
<pre class="fragment">source implicit_batching_minimum_length 2000
</pre><ol>
<li>
The first send by your application puts 1900 bytes into the batching buffer, which is below the minimum, so UM holds it. </li>
<li>
The second send fills the batching buffer to 3800 bytes, well over the minimum. UM sends it down to the transport layer, which builds a 3800-byte (plus overhead) datagram and sends it. </li>
<li>
The sender's Operating System performs <a class="el" href="index.html#glossaryipfragmentation">IP fragmentation</a> on the datagram to produce packets, and the receiving Operating System reassembles the datagram. </li>
<li>
UM reads the datagram from the socket at the receiver. </li>
<li>
UM parses out the two messages and delivers them to the appropriate topic levels, which deliver the data. </li>
</ol>
<p>The proper setting of the implicit batching parameters often represents a trade-off between latency and efficiency, where efficiency affects the highest throughput attainable. In general, a large minimum length setting increases efficiency and allows a higher peak message rate, but at low message rates a large minimum length can increase latency. A small minimum length can lower latency at low message rates, but does not allow the message rate to reach the same peak levels due to inefficiency. An intelligent use of implicit batching and application-level flushing can be used to implement an adaptive form of batching known as <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> which can provide low latency and high throughput with a single setting.</p>
<p><b>Implicit Batching Restrictions</b></p>
<ul>
<li>
The <a class="el" href="index.html#smartsources">Smart Sources</a> feature does not support implicit batching. </li>
<li>
The <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> and <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a> APIs don't support implicit batching. </li>
<li>
The response APIs associated with the <a class="el" href="index.html#requestresponsemodel">Request/Response Model</a> do not support implicit batching. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="intelligentbatching"></a>
Intelligent Batching&nbsp;&nbsp;<small><a href="#intelligentbatching">&lt;-</a></small></h3>
<p>Intelligent Batching uses Implicit Batching along with your application's knowledge of the messages it must send. It is a form of dynamic adaptive batching that automatically adjusts for different message rates. Intelligent Batching can provide significant savings of CPU resources without adding any noticeable latency.</p>
<p>For example, your application might receive input events in a batch, and therefore know that it must produce a corresponding batch of output messages. Or the message producer works off of an input queue, and it can detect messages in the queue. In any case, if the application knows that it has more messages to send without going to sleep, it simply does normal sends to UM, letting Implicit Batching send only when the buffer meets the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> threshold.</p>
<p>However, when the application detects that it has no more messages to send after it sends the current message, it sets the FLUSH flag (LBM_MSG_FLUSH) when sending the message which instructs UM to flush the implicit batching buffer immediately by sending all messages to the transport layer. Refer to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> in the UM API documentation (UM C API, UM Java API, or UM .NET API) for all the available send flags.</p>
<p>When using Intelligent Batching, it is usually advisable to increase the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> option to 10 times the size of the average message, to a maximum value of 8196. This tends to strike a good balance between batching length and flushing frequency, giving you low latencies across a wide variation of message rates.</p>
<p><br />
 </p>
<h3><a class="anchor" id="applicationbatching"></a>
Application Batching&nbsp;&nbsp;<small><a href="#applicationbatching">&lt;-</a></small></h3>
<p>In all of the above situations, your application sends individual messages to UM and lets UM decide when to push the data onto the wire (often with application help). With application batching, your application buffers messages itself and sends a group of messages to UM with a single send. Thus, UM treats the send as a single message. On the receiving side, your application needs to know how to dissect the UM message into individual application messages.</p>
<p>This approach is most useful for Java or .NET applications where there is a higher per-message cost in delivering an UM message to the application. It can also be helpful when using an <a class="el" href="index.html#eventqueueobject">event queue</a> to deliver received messages. This imposes a thread switch cost for each UM message. At low message rates, this extra overhead is not noticeable. However, at high message rates, application batching can significantly reduce CPU overhead.</p>
<p><br />
 </p>
<h3><a class="anchor" id="explicitbatching"></a>
Explicit Batching&nbsp;&nbsp;<small><a href="#explicitbatching">&lt;-</a></small></h3>
<dl class="section warning"><dt>Warning</dt><dd><b>The Explicit Batching feature is deprecated and may be removed in a future release</b>. Users are advised to use <a class="el" href="index.html#implicitbatching">Implicit Batching</a> or <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a>.</dd></dl>
<p>UM allows you to group messages for a particular topic with explicit batching. The purpose of grouping messages with explicit batching is to allow the receiving application to detect the first and last messages of a group without needing to examine the message contents.</p>
<dl class="section note"><dt>Note</dt><dd>Explicit Batching does not guarantee that all the messages of a group will be sent in a single datagram.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Explicit Batching does not provide any kind of transactional guarantee. It is possible to receive some messages of a group while others are unrecoverably lost. If the first and/or last messages of a group are unrecoverably lost, then the receiving application will not have an indication of start and/or end of the group.</dd></dl>
<p>When your application sends a message (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a>) it may flag the message as being the start of a batch (LBM_MSG_START_BATCH) or the end of a batch (LBM_MSG_END_BATCH). All messages sent between the start and end are grouped together. The flag used to indicate the end of a batch also signals UM to send the message immediately to the implicit batching buffer. At this point, <a class="el" href="index.html#implicitbatching">Implicit Batching</a> completes the batching operation. UM includes the start and end flags in the message so receivers can process the batched messages effectively.</p>
<p>Unlike Intelligent Batching which allows intermediate messages to trigger flushing according to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> option, explicit batching holds all messages until the batch is completed. This feature is useful if you configure a relatively small <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> and your application has a batch of messages to send that exceeds the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a>. By releasing all the messages at once, Implicit Batching maximizes the size of the network datagrams.</p>
<p><b>Explicit Batching Example</b></p>
<p>The following example demonstrates explicit batching.</p>
<pre class="fragment">source implicit_batching_minimum_length 8000
</pre><ol>
<li>
Your application performs 10 sends of 100 bytes each as a single explicit batch. </li>
<li>
At the 10th send (which completes the batch), UM delivers the 1000 bytes of messages to the implicit batch buffer. </li>
<li>
Let's assume that the buffer already has 7899 bytes of data in it from other topics on the same Transport Session </li>
<li>
UM adds the first 100-byte message to the buffer, bringing it to 7999. </li>
<li>
UM adds the second 100-byte message, bringing it up to 8099 bytes, which exceeds <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> but is below the 8192 <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a>. </li>
<li>
UM sends the 8099 bytes (plus overhead) datagram. </li>
<li>
UM adds the third through tenth messages to the implicit batch buffer. These messages will be sent when either <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingminimumlengthsource">implicit_batching_minimum_length (source)</a> is again exceeded, or the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpimplicitbatching.html#implicitbatchingintervalsource">implicit_batching_interval (source)</a> is met, or a message arrives in the buffer with the flush flag (LBM_MSG_FLUSH) set. </li>
</ol>
<p><br />
 </p>
<h3><a class="anchor" id="adaptivebatching"></a>
Adaptive Batching&nbsp;&nbsp;<small><a href="#adaptivebatching">&lt;-</a></small></h3>
<dl class="section warning"><dt>Warning</dt><dd><b>The Adaptive Batching feature is deprecated and may be removed in a future release</b>. Users are advised to use <a class="el" href="index.html#implicitbatching">Implicit Batching</a> or <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="messagefragmentationandreassembly"></a>
Message Fragmentation and Reassembly&nbsp;&nbsp;<small><a href="#messagefragmentationandreassembly">&lt;-</a></small></h2>
<p>Message fragmentation is the process by which an arbitrarily large message is split into a series of smaller pieces or <em>fragments</em>. Reassembly is the process of putting the pieces back together into a single contiguous message. Ultra Messaging performs <a class="el" href="index.html#glossaryumfragmentation">UM fragmentation</a> and reassembly on large user messages. When a user message is small enough, it fits into a single fragment.</p>
<p>Note that there is another layer of fragmentation and reassembly that happens in the TCP/IP network stack, usually by the host operating system. This <a class="el" href="index.html#glossaryipfragmentation">IP fragmentation</a> of datagrams into packets happens when sending datagrams larger than the <a href="https://en.wikipedia.org/wiki/Maximum_transmission_unit">MTU</a> of the network medium, usually 1500 bytes. However, this fragmentation and reassembly happens transparently to and independently of Ultra Messaging. In the UM documentation, "fragmentation" generally refers to the higher-level <a class="el" href="index.html#glossaryumfragmentation">UM fragmentation</a>.</p>
<p>Some users of UM have configured their network and systems for "jumbo frames", which provides an MTU of up to 9000 bytes. This can provide efficiency benefits, but is not practical for most users. This document assumes an MTU of 1500.</p>
<p>Another term that Ultra Messaging borrows from networking is "datagram". In the UM documentation, a <em>datagram</em> is a unit of data which is sent to the transport (network socket or shared memory). In the case of network-based transport types, this refers to a buffer which is sent to the network socket in a single system call.</p>
<p>(Be aware that for UDP-based transport types (LBT-RM and LBT-RU), the UM datagrams are in fact sent as UDP datagrams. For non-UDP-based transports, the use of the term "datagram" is retained for consistency.)</p>
<p>The mapping of message fragments to datagrams depends on three factors: </p><ol>
<li>
User message size, </li>
<li>
Configured <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> for the source's transport type, and </li>
<li>
Use of the <a class="el" href="index.html#implicitbatching">Implicit Batching</a> feature. </li>
</ol>
<p>When configured, the source implicit batching feature combines multiple small user messages into a single datagram no greater than the size of the transport type's configured <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a>.</p>
<p>Large user messages can be split into N fragments, the first N-1 of which are approximately the size of the transport type's configured <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a>, and the Nth fragment containing the left-over bytes.</p>
<p>A subscriber's receiver callback can get information about a message's fragments by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#afa760960c21f502a8cb4c5ec5d97f91b">lbm_msg_retrieve_fragment_info()</a>.</p>
<p>A publisher can test an individual sent message to see if UM fragmented it via the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a350c2cab7f6f029276ebc323b7d73795">LBM_SRC_EVENT_SEQUENCE_NUMBER_INFO</a> source event, which is enabled by sending the message using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a> function and setting the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab99586b3f3b469aa6f2e2da632fa5be0">LBM_SRC_SEND_EX_FLAG_SEQUENCE_NUMBER_INFO</a> flag or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae2b7b029ca6a3fcfc2cd67d809930a95">LBM_SRC_SEND_EX_FLAG_SEQUENCE_NUMBER_INFO_FRAGONLY</a> flag.</p>
<dl class="section note"><dt>Note</dt><dd>The SMX transport type does not support fragmentation.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="datagrammaxsizes"></a>
Datagram Max Sizes&nbsp;&nbsp;<small><a href="#datagrammaxsizes">&lt;-</a></small></h3>
<p>Each transport type has its own default maximum datagram size. For example, LBT-RM and LBT-RU have 8K as their default maximum datagram sizes, while TCP and IPC have 64K as their default maximums. These different defaults represent optimal values for the different transport types, and in a simple UM network, it is usually not necessary to change them.</p>
<p>The configuration options are: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpdatagrammaxsizecontext">transport_tcp_datagram_max_size (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdatagrammaxsizecontext">transport_lbtrm_datagram_max_size (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrudatagrammaxsizecontext">transport_lbtru_datagram_max_size (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcdatagrammaxsizecontext">transport_lbtipc_datagram_max_size (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtsmxoperation.html#transportlbtsmxdatagrammaxsizesource">transport_lbtsmx_datagram_max_size (source)</a> - note this is a source-scoped option; the others are context-scoped. </li>
</ul>
<p>Note that the transport's datagram max size option limits the size of the UM <em>payload</em>, and does not include overhead specific to the underlying transport type. For example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdatagrammaxsizecontext">transport_lbtrm_datagram_max_size (context)</a> does not include the UDP, IP, or packet overhead. The actual network frame can be larger than than the configured datagram max size.</p>
<dl class="section attention"><dt>Attention</dt><dd>When a DRO is being used in a UM network, it is usually advisable to override the different transports' datagram max sizes to make them all the same. This should be done for all applications and UM daemons, in all <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs). See DRO <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#protocolconversion">Protocol Conversion</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="datagrammaxsizeandnetworkmtu"></a>
Datagram Max Size and Network MTU&nbsp;&nbsp;<small><a href="#datagrammaxsizeandnetworkmtu">&lt;-</a></small></h3>
<p>By default, when a UM source is building an outgoing message, it reserves space for the largest possible UM header. This fixed-size reservation is subtracted from the configured datagram max size to determine how much user data can be added to the datagram. Since most UM messages do not need a large UM header, there can be cases where a user message that <em>could</em> fit in a single datagram without exceeding the configured datagram limit will instead be split into two fragments, each carried in a datagram that is significantly below the configured datagram limit.</p>
<p>When UM is configured with a datagram max size of 8K or more, this space inefficiency does not pose a noticeable problem since the header reservation is a small percentage of the full 8K. However, for users who want to avoid <a class="el" href="index.html#glossaryipfragmentation">IP fragmentation</a>, the datagrams should be limited to 1472 bytes. In this case, the space inefficiency becomes objectionable; packets will often not be as full as they should be.</p>
<p>For most networks, Informatica recommends setting the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> to a minimum of 8K, and allowing the operating system to perform IP fragmentation. Some network engineers have learned that IP fragmentation can place a burden on network hardware (routers and switches), but this is true only if the network network hardware has to perform the fragmentation. For most modern networks, the entire fabric is designed to handle a common MTU, typically of 1500 bytes. Thus, a UDP datagram larger than 1500 bytes is fragmented once by the sending host's operating system, and the switches and routers only need to forward the already-fragmented packets. Switches and routers can forward fragmented packets without burden.</p>
<p>There are typically two circumstances where users should set UM's <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> to a smaller value: </p><ul>
<li>
If <a class="el" href="index.html#glossarykernelbypass">kernel bypass</a> network drivers are being used which either don't handle IP fragments at all, or does handle them but only via the "slow path" (not accelerated). </li>
<li>
If the smallest MTU across a network path is smaller than the MTU of a host's network interface. For example, your hosts typically have an Ethernet connection with a 1500-byte MTU. But a WAN link might have a much smaller MTU. In that case, UM's <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> should be set to a value that keeps all packets within the WAN link's MTU. Note that in modern networks, it is rare to find links with an MTU below 1500. </li>
</ul>
<p>In both cases, the space inefficiency caused by reserving space for the largest possible UM header is objectionable.</p>
<p>The preferred solution is to use UM version 6.14 or beyond and enable the <a class="el" href="index.html#dynamicfragmentationreduction">Dynamic Fragmentation Reduction</a> feature.</p>
<p>For pre-6.14 UM, it can be possible to artificially increase the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> to a value above the desired limit. See <a class="el" href="index.html#datagramsandkernelbypassnetworkdrivers">Setting Datagram Max Sizes High</a>.</p>
<dl class="section note"><dt>Note</dt><dd>UM version 6.12 changed the amount of space that Smart Sources reserve for the UM header. This can mean that pre-6.12 smart source users upgrading to 6.12 or beyond may need to change their configuration. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/changelog.tag:../../ChangeLog/" href="../../ChangeLog/umversion6_12.html#smartsourceheadersizechange">Smart Source Header Size Change</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="datagramsandkernelbypassnetworkdrivers"></a>
Setting Datagram Max Sizes High&nbsp;&nbsp;<small><a href="#datagramsandkernelbypassnetworkdrivers">&lt;-</a></small></h3>
<p>There are cases when the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> must be set to a relatively small value to prevent IP fragmentation. However, as described in <a class="el" href="index.html#datagrammaxsizeandnetworkmtu">Datagram Max Size and Network MTU</a>, this is space inefficient and can result in more UM fragmentation than is necessary.</p>
<p>Some users set their datagram max size to a value <em>above</em> the desired limit, knowing that LBT-RM and LBT-RU will reserve a large number of bytes for the largest possible UM header. This allows traffic to more-efficiently fill packets, and therefore avoid unnecessary UM fragmentation. However, this technique is imperfect.</p>
<p>Setting the datagram max size above the desired limit technically gives UM permission to send a datagram up to that size. You cannot always count on the largest possible header space being reserved. In practice with a restricted use case (e.g. flushing every message), LBT-RM data messages may never go above the desired limit. But <a class="el" href="index.html#glossarytsni">TSNI</a> messages can reach the full datagram max size, and so can <a class="el" href="index.html#implicitbatching">implicitly batched messages</a>.</p>
<p>Also, keep in mind that UM does not publish the internal reserved size, and does not guarantee that the reserved size will stay the same. Users who use this technique must determine their optimal datagram max size <em>empirically</em> through extensive testing within the constraints of their use cases.</p>
<p>Starting with UM version 6.14, Informatica recommends that kernel bypass users make use of the <a class="el" href="index.html#dynamicfragmentationreduction">Dynamic Fragmentation Reduction</a> feature. This allows setting the datagram max size to 1472 to prevent IP fragmentation, while ensuring that data messages are not unnecessarily fragmented.</p>
<p><br />
 </p>
<h3><a class="anchor" id="changingdatagrammaxsize"></a>
Changing Datagram Max Size&nbsp;&nbsp;<small><a href="#changingdatagrammaxsize">&lt;-</a></small></h3>
<p>For UM versions prior to 6.17, changing a UM network's datagram max size required changing all UM-based components (applications and UM daemons) at the same time. You couldn't gradually change some components to a different size while leaving other components are their original size. This is because if a component with a larger datagram max size sends a datagram larger than a subscriber's datagram max size, the subscriber's receive buffer will be insufficient to hold the datagram, resulting in unrecoverable loss. By changing all components at the same time, a sender will fragment large messages to the proper size for subscribers' receive buffers.</p>
<p>This "all at once" requirement for changing the datagram max size presents a challenge to larger organizations that desire to migrate towards <a class="el" href="index.html#glossarykernelbypass">kernel bypass technology</a> (like Solarflare's Onload driver).</p>
<p>Starting with UM version 6.17, a component can be configured for different datagram max sizes for sending and receiving. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmreceiverdatagrammaxsizecontext">transport_lbtrm_receiver_datagram_max_size (context)</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmsourcedatagrammaxsizecontext">transport_lbtrm_source_datagram_max_size (context)</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrureceiverdatagrammaxsizecontext">transport_lbtru_receiver_datagram_max_size (context)</a>, and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrusourcedatagrammaxsizecontext">transport_lbtru_source_datagram_max_size (context)</a>. Note that a receiver's datagram max size can be set larger than a source's; it is reliable to have a larger receive size, although it does use more memory.</p>
<p>So, for example, in the case of wanting to reduce the datagram max size to accommodate kernel bypass drivers, you would first reduce all publishers' "source" datagram max size to 1472 (<a class="el" href="index.html#dynamicfragmentationreduction">Dynamic Fragmentation Reduction</a> is recommended). This can be done gradually, small groups of publishers at a time, concentrating first on those publishers that need kernel bypass as a high priority.</p>
<p>Once all components have their source datagram max sizes reduced, then the receiver datagram max size can be reduced to the same value.</p>
<p>It is less common, though still supported, to increase the datagram max size using the opposite process: first increase the receivers datagram max size, then increase the source.</p>
<p>Many users choose not to accelerate UDP-based topic resolution, so it may not be necessary to change the TR datagram max size. But should it be necessary, the same principles apply: change the TR receiver's datagram size with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolverreceiverdatagrammaxsizecontext">resolver_receiver_datagram_max_size (context)</a> and the sender's with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpudpbasedresolveroperation.html#resolversourcedatagrammaxsizecontext">resolver_source_datagram_max_size (context)</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="dynamicfragmentationreduction"></a>
Dynamic Fragmentation Reduction&nbsp;&nbsp;<small><a href="#dynamicfragmentationreduction">&lt;-</a></small></h3>
<p>As described in <a class="el" href="index.html#datagrammaxsizeandnetworkmtu">Datagram Max Size and Network MTU</a>, UM versions prior to 6.14 reserved an unnecessarily large size in each datagram for a worst-case header, resulting in the LBT-RM and LBT-RU protocols performing UM fragmentation at message sizes where they should not have to. In an effort to more-fully fill data packets, some users set their <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> above an MTU, but this can result in IP fragmentation.</p>
<p>Starting with UM version 6.14, enabling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#dynamicfragmentationreductioncontext">dynamic_fragmentation_reduction (context)</a> lets UM's transport protocols more-fully utilize the configured datagram max size, thus avoiding unnecessary UM and IP fragmentation. This option is typically only of interest to users of LBT-RM and/or LBT-RU who need to avoid IP fragmentation, such as users of a <a class="el" href="index.html#glossarykernelbypass">kernel-bypass driver</a>.</p>
<p>This allows the user to set the desired transport's datagram max size option to 1472, which prevents IP fragmentation on the transport session, while still efficiently filling the packets to close to the MTU.</p>
<p><b>Enabling Dynamic Fragmentation Reduction</b></p>
<p>Users of kernel bypass drivers sometimes set their datagram max sizes well above 1472. This avoids inefficient filling of packets, but still carries the risk that some messages will trigger IP fragmentation.</p>
<p>To use the Dynamic Fragmentation Reduction feature: </p><pre class="fragment">context dynamic_fragmentation_reduction 1
context transport_lbtrm_datagram_max_size 1472
context transport_lbtru_datagram_max_size 1472
# Technically, only RM and RU matter. But when DROs are present, allow
# protocol conversion by making all transports the same.
context transport_tcp_datagram_max_size 1472
context transport_lbtipc_datagram_max_size 1472
source transport_lbtsmx_datagram_max_size 1472
</pre><p> DRO users see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#protocolconversion">Protocol Conversion</a>.</p>
<p><b>Upgrade Path</b></p>
<p>The Dynamic Fragmentation Reduction feature is designed to allow a gradual upgrade. Older versions of UM can interoperate with 6.14 and beyond using Dynamic Fragmentation Reduction, but certain requirements must be met.</p>
<p>Users interested in Dynamic Fragmentation Reduction are typically users of kernel-bypass drivers who want to set their datagram max sizes to 1 MTU. For efficiency purposes, they've empirically determined an optimal value which is noticeably higher than a network MTU. A typical value might be between 1800 and 1900.</p>
<p>During the upgrade period, you will be running upgraded UM programs (version 6.14 or beyond) with Dynamic Fragmentation Reduction enabled, and datagram max sizes set to 1472. These will successfully interoperate with older UM versions running with datagram max sizes between 1800 and 1900.</p>
<p>The exception to this rule is the DRO. In a mixed-version environment, the DRO should always be configured with the largest datagram max size values used in your network. If an older version application is set to 1800, a DRO running 6.14 or beyond should also be configured for 1800.</p>
<p>See also <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#protocolconversion">Protocol Conversion</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="ordereddelivery"></a>
Ordered Delivery&nbsp;&nbsp;<small><a href="#ordereddelivery">&lt;-</a></small></h2>
<p>With the Ordered Delivery feature, a receiver's <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> can deliver messages to your application in sequence number order or arrival order. This feature can also reassemble fragmented messages or leave reassembly to the application. You can set Ordered Delivery via UM configuration option to one of three modes:</p>
<ul>
<li>
Sequence Number Order, Fragments Reassembled </li>
<li>
Arrival Order, Fragments Reassembled </li>
<li>
Arrival Order, Fragments Not Reassembled (deprecated) </li>
</ul>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a></p>
<p>Note that these ordering modes only apply to a specific topic from a single publisher. UM does not ensure ordering across different topics, or on a single topic across different publishers. See <a class="el" href="index.html#messageordering">Message Ordering</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sequencenumberorderfragmentsreassembleddefaultmode"></a>
Sequence Number Order, Fragments Reassembled (Default Mode)&nbsp;&nbsp;<small><a href="#sequencenumberorderfragmentsreassembleddefaultmode">&lt;-</a></small></h3>
<p>In this mode, a receiver's <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> delivers messages in sequence number order (the same order in which they are sent). This feature also guarantees reassembly of fragmented large messages. To enable sequence number ordered delivery, set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> configuration option as shown:</p>
<pre class="fragment">receiver ordered_delivery 1
</pre><p>Please note that ordered delivery can introduce latency when packets are lost (new messages are buffered waiting for retransmission of lost packets).</p>
<p><br />
 </p>
<h3><a class="anchor" id="arrivalorderfragmentsreassembled"></a>
Arrival Order, Fragments Reassembled&nbsp;&nbsp;<small><a href="#arrivalorderfragmentsreassembled">&lt;-</a></small></h3>
<p>This mode delivers messages immediately upon reception, in the order the datagrams are received, except for fragmented messages, which UM holds and reassembles before delivering to your application. Be aware that messages can be delivered out of order, either because of message loss and retransmission, or because the networking hardware re-orders UDP packets. Your application can then use the sequence_number field of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> objects to order or discard messages. But be aware that the sequence number may not always increase by 1; application messages larger than the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> will be split into fragments, and each fragment gets its own sequence number. With the "Arrival Order, Fragments Reassembled" mode of delivery, UM will reassemble the fragments into the original large application message and deliver it with a single call to the application receiver callback. But that message's sequence_number will reflect the final fragment.</p>
<p>To enable this arrival-order-with-reassembly mode, set the following configuration option as shown:</p>
<pre class="fragment">receiver ordered_delivery -1
</pre><p><br />
 </p>
<h3><a class="anchor" id="arrivalorderfragmentsnotreassembled"></a>
Arrival Order, Fragments Not Reassembled&nbsp;&nbsp;<small><a href="#arrivalorderfragmentsnotreassembled">&lt;-</a></small></h3>
<dl class="section warning"><dt>Warning</dt><dd>This mode of delivery is deprecated and may be removed in a future version. The user is advised to use mode -1.</dd></dl>
<p>This mode allows messages to be delivered to the application immediately upon reception, in the order the datagrams are received. If a message is lost, UM will retransmit the message. In the meantime, any subsequent messages received are delivered immediately to the application, followed by the dropped packet when its retransmission is received. This mode has the lowest latency.</p>
<p>With this mode, the receiver delivers messages larger than the transport's <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> as individual fragments. The C API function, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#afa760960c21f502a8cb4c5ec5d97f91b">lbm_msg_retrieve_fragment_info()</a> returns fragmentation information for the message you pass to it, and can be used to reassemble large messages. (In Java and .NET, LBMMessage provides methods to return the same fragment information.) Note that reassembly is not required for small messages.</p>
<p>To enable this no-reassemble arrival-order mode, set the following configuration option as shown:</p>
<pre class="fragment">receiver ordered_delivery 0
</pre><p>When developing message reassembly code, consider the following:</p>
<ul>
<li>
Message fragments don't necessarily arrive in sequence number order. </li>
<li>
Some message fragments may never arrive (unrecoverable loss), so you must time out partial messages. </li>
</ul>
<p><b>Arrival order delivery without reassembly is not compatible with the following UM features:</b> </p><ul>
<li>
<a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> </li>
<li>
<a class="el" href="index.html#messageproperties">Message Properties</a> </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="lossdetectionusingtsnis"></a>
Loss Detection Using TSNIs&nbsp;&nbsp;<small><a href="#lossdetectionusingtsnis">&lt;-</a></small></h2>
<p>A TSNI (Topic Sequence Number Information) message is an internal UM message sent by a source to inform receivers of the topic-level sequence number of the last message sent.</p>
<p>When a source enters an idle period during which it has no data traffic to send (5 seconds by default), that source will send one or more TSNI messages. The TSNI lets receivers know that the source is still active and also reminds receivers of the sequence number of the last message. This helps receivers become aware of any lost messages prior to the TSNI.</p>
<p>Sources send TSNIs over the same transport and on the same topic as normal data messages. You can set a time value of the TSNI interval with configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transporttopicsequencenumberinfointervalsource">transport_topic_sequence_number_info_interval (source)</a>. You can also set a time value for the duration that the source sends contiguous TSNIs with configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transporttopicsequencenumberinfoactivethresholdsource">transport_topic_sequence_number_info_active_threshold (source)</a>, after which time the source stops issuing TSNIs.</p>
<p><br />
 </p>
<h2><a class="anchor" id="receiverkeepaliveusingsesssionmessages"></a>
Receiver Keepalive Using Session Messages&nbsp;&nbsp;<small><a href="#receiverkeepaliveusingsesssionmessages">&lt;-</a></small></h2>
<p>When an LBT-RM, LBT-RU, or LBT-IPC <a class="el" href="index.html#transportsessions">Transport Session</a> enters an inactive period during which it has no messages to send, the UM context sends Session Messages (SMs). The first SM is sent after 200 milliseconds of inactivity (by default). If the period of inactivity continues additional SMs will be sent at increasing intervals, up to a maximum interval of 10 seconds (by default).</p>
<p>SMs serve three functions: </p><ol>
<li>
<b>Keepalive</b> - SMs inform receivers that transport sessions are still alive. If a receiver stops getting any kind of traffic for a transport session, after a configurable period of inactivity the receiver will time out the transport session and will assume that it has died. </li>
<li>
<b>Tail loss</b> - for UDP-based transport sessions (LBT-RM and LBT-RU), SMs are used to detect packet loss, specifically "tail loss", and trigger recovery. </li>
<li>
<b>Multicast Flows</b> - for multicast-based transport sessions (LBT-RM), SMs serve to keep the network hardware multicast flows "hot", so that replication and forwarding of multicast packets is done in hardware at line speed. </li>
</ol>
<p>Any other UM message on a transport session will suppress the sending of SMs, including data messages and TSNIs. (Topic Resolution messages are not sent on the transport session, and will not suppress sending SMs.) You can set time values for SM interval and duration with configuration options specific to their transport type.</p>
<div class="image">
<img src="SMs.png" alt="SMs.png"/>
</div>
 <p><br />
 </p>
<h2><a class="anchor" id="extendedmessagingexample"></a>
Extended Messaging Example&nbsp;&nbsp;<small><a href="#extendedmessagingexample">&lt;-</a></small></h2>
<p>This section illustrates many of the preceding concepts using an extended example of message passing. This example uses <a class="el" href="index.html#transportlbtrm">LBT-RM</a>, but for the purposes of this example, <a class="el" href="index.html#transportlbtru">LBT-RU</a> operates in a similar manner.</p>
<p>The example starts out with two applications, Publisher and Subscriber:</p>
<div class="image">
<img src="Ext_examp.png" alt="Ext_examp.png"/>
</div>
 <p>The publisher has created three source objects, for topics "A", "B", and "C" respectively. All three sources are mapped to a single LBT-RM <a class="el" href="index.html#transportsessions">Transport Session</a> by configuring them for the same <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmmulticastaddresssource">multicast group address</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmnetwork.html#transportlbtrmdestinationportsource">destination port</a>.</p>
<p>The Subscriber application creates two receivers, for topics "A" and "B".</p>
<p>The creation of sources and receivers triggers <a class="el" href="index.html#topicresolutionoverview">Topic Resolution</a>, and the subscriber joins the Transport Session once the topics are resolved. To be precise, the first receiver to discover a source triggers joining the Transport Session and creating a <a class="el" href="index.html#deliverycontroller">Delivery Controller</a>; subsequent source discoveries on the same Transport Session don't need to join; they only create Delivery Controllers. However, until such time as one or more publishing sources send their first <a class="el" href="index.html#umsoftwarestack">topic-layer</a> message, the source Transport Session sends no datagrams. The Transport Session is created, but has not yet "started".</p>
<p><br />
 </p>
<h3><a class="anchor" id="examplefirstmessage"></a>
Example: First Message&nbsp;&nbsp;<small><a href="#examplefirstmessage">&lt;-</a></small></h3>
<p>In this example, the first message on the Transport Session is generated by the publishing application sending an application message, in this case for topic "A".</p>
<div class="image">
<img src="Ext_examp_msg0.png" alt="Ext_examp_msg0.png"/>
</div>
 <p>The send function is passed the "flush" flag so that the message is sent immediately. The message is assigned a topic-level sequence number of 0, since it is the application's first message for that topic. The source-side transport layer wraps the application message in a datagram and gives it transport sequence number 0, since it is the first datagram sent on the Transport Session.</p>
<p>On the receive side, the first datagram (of any kind) on the Transport Session informs the transport layer that the Transport Session is active. The transport layer informs all mapped <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> instances that the Transport Session has begun. Each Delivery Controller delivers a Beginning Of Session event (BOS) to the application callback for each receiver. The passed-in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> structure has event <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a> equal to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab5489080adc7157549a9930b30c68425">LBM_MSG_BOS</a>.</p>
<p>Note that the receiver for topic B gets a BOS even though no messages were received for it; the BOS event informs the receivers that the <em>Transport Session</em> is active, not the topic.</p>
<p>Finally, the transport layer passes the received datagram to the topic-A Delivery Controller, which passes the application message to the receiver callback. The passed-in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> structure has event <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a> equal to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a>, and a topic-level <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#a414eaced619e9dfafbcb2c7608af8e7e">sequence_number</a> of 0. (The transport sequence number is not available to the application.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="examplebatching"></a>
Example: Batching&nbsp;&nbsp;<small><a href="#examplebatching">&lt;-</a></small></h3>
<p>The publishing application now has two more messages to send. To maximize efficiency, it chooses to <a class="el" href="index.html#messagebatching">batch</a> the messages together:</p>
<div class="image">
<img src="Ext_examp_batch.png" alt="Ext_examp_batch.png"/>
</div>
 <p>The publishing application sends a message to topic "B", this time <em>without</em> the "flush" flag. The source-side topic layer buffers the message. Then the publishing application sends a message to topic "C", <em>with</em> the "flush" flag. The source-side transport layer wraps both application messages into a single datagram and gives it transport sequence number 1, since it is the second datagram sent on the Transport Session. But the two topic level sequence numbers are 0, since these are the first messages sent to those topics.</p>
<p>Note that almost no latency is added by batching, so long as the second message is ready to send immediately after the first. This method of low-latency batching is called <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a>, and can greatly increase the maximum sustainable throughput of UM.</p>
<p>The subscriber gets the datagram and delivers the topic "B" message to the application receiver callback. It's topic-level <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#a414eaced619e9dfafbcb2c7608af8e7e">sequence_number</a> is 0 since it was the first message sent to the "B" source. However, the subscriber application has no receiver for topic "C", so the message "C" is simply discarded.</p>
<p><br />
 </p>
<h3><a class="anchor" id="exampleumfragmentation"></a>
Example: UM Fragmentation&nbsp;&nbsp;<small><a href="#exampleumfragmentation">&lt;-</a></small></h3>
<p>The publishing application now has a topic "A" message to send that is larger than the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdatagrammaxsizecontext">maximum allowable datagram</a>.</p>
<div class="image">
<img src="Ext_examp_frag.png" alt="Ext_examp_frag.png"/>
</div>
 <p>The source-side topic layer splits the application message into two fragments and assigns each fragment its own topic-level sequence number (1 for the first, 2 for the second). The topic-layer gives each fragment separately to the transport layer, which wraps each fragment into its own datagram, consuming two transport sequence numbers (2 and 3). Note that the transport layer does not interpret these fragments as parts of a single larger message; from the transport's point of view, this simply two datagrams being sent.</p>
<p>The receive-side transport layer gets the datagrams and hands them to the Topic-A <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> (receiver-side topic layer). The Delivery Controller reassembles the fragments in the correct order, and delivers the message to the application's receiver callback in a single call. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#a414eaced619e9dfafbcb2c7608af8e7e">sequence_number</a> visible to the application is the topic-level sequence number of the <em>last</em> fragment (2 in this example).</p>
<p>Note that the application receiver callback never sees a topic sequence_number of 1 for topic "A". It saw 0 then 2, with 1 seemingly missing. However, the application can call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#afa760960c21f502a8cb4c5ec5d97f91b">lbm_msg_retrieve_fragment_info()</a> to find out the range of topic sequence numbers consumed by a message.</p>
<p>The behavior described above is for the default <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> equal to 1. see <a class="el" href="index.html#ordereddelivery">Ordered Delivery</a> for alternative behaviors.</p>
<p><br />
 </p>
<h3><a class="anchor" id="examplelossrecovery"></a>
Example: Loss Recovery&nbsp;&nbsp;<small><a href="#examplelossrecovery">&lt;-</a></small></h3>
<p>Now the publishing application sends a message to topic C. But the datagram is lost, so the receiver does not see it. Also, right after the send to topic C, the application deletes the sources for topics B and C.</p>
<div class="image">
<img src="Ext_examp_loss1.png" alt="Ext_examp_loss1.png"/>
</div>
 <p>Deleting a source shortly after sending a message to it is contrary to best practice. Applications should pause between the last send to a topic and the deletion of the topic, preferable a delay of between 5 and 10 seconds. This gives receivers an opportunity to attempt recovery if the last message sent was lost. We delete the sources here to illustrate an important point.</p>
<p>Note that although the datagram was lost and two topics were deleted, nothing happens. The receiver does not request a retransmission because the receiver has no idea that the source sent a message. Also, the source-side topic layer does not explicitly inform the receiver that the topics are deleted.</p>
<p>Continuing the example, the publishing application sends another message, this time a message for topic A ("Topic-A, topic sqn=3"):</p>
<div class="image">
<img src="Ext_examp_recover1.png" alt="Ext_examp_recover1.png"/>
</div>
 <p>There are two notable events here: </p><ol>
<li>
<p class="startli">The "A" message is delivered immediately to the topic "A" receiver, even though earlier data was lost and not yet retransmitted. If this were TCP, the kernel would buffer and prevent delivery of subsequent data until the lost data is recovered.</p>
<p class="endli"></p>
</li>
<li>
The reception of that "A" message with transport sequence number 5 informs the receive-side transport layer that transport datagram #4 was lost. So it initiates a NAK/retransmission cycle. When the lost datagram is retransmitted, the receiver throws it away since it is for an unsubscribed topic. </li>
</ol>
<p>You might wonder: why NAK and retransmit datagram 4 if the subscriber is just going to throw it away? The subscriber NAKs it because it has no way of knowing which topic it contains; if it were topic B, then it would need that datagram. The publisher retransmits it because it does not know which topics the subscriber is interested in. It has no way of knowing that the subscriber will throw it away.</p>
<p>Regarding message "Topic-A, sqn=3", what if the publisher did not have that message to send? For example, what if that "Topic-C, sqn=1" message were the last one for a while? This is called "tail loss" since the lost datagram is not immediately followed by a successful datagram. The subscriber has no idea that messages were sent but lost. In this case, the source-side transport layer would have sent a transport-level "session message" after about 200 ms of inactivity on the Transport Session. That session message would inform the receiver-side transport layer that datagram #5 was lost, and would trigger the NAK/retransmission.</p>
<p>Finally, note that the message for topic-C was retransmitted, even though the topic-C source was deleted. This is because the deletion of a source does not purge the transport layer's retransmission buffer of datagrams from that source. However, higher-level recovery mechanisms, such as late join and OTR, are no longer possible after the source is deleted. Also, if <em>all</em> sources on a Transport Session are deleted, the Transport Session itself is deleted, which makes even transport-level retransmission impossible. (Only <a class="el" href="index.html#persistence">Persistence</a> allows recovery after the transport session is deleted.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="exampleunrecoverableloss"></a>
Example: Unrecoverable Loss&nbsp;&nbsp;<small><a href="#exampleunrecoverableloss">&lt;-</a></small></h3>
<p>The previous examples assume that events are happening in fairly rapid succession. In this example of unrecoverable loss, significantly longer time periods are involved.</p>
<p>Unrecoverable loss is what happens when UM tries to recover the lost data but it is unable to. There are many possible scenarios which can cause recovery efforts fail, most of which involve a massive overload of one or more components in the data flow.</p>
<p>To simplify this example, let's assume that, starting now, all NAKs are blocked by the network switch. If the publisher never sees the NAKs, it assumes that all datagrams were received successfully and does not retransmit anything.</p>
<div class="image">
<img src="Ext_examp_unrec.png" alt="Ext_examp_unrec.png"/>
</div>
 <p>At T=0, the message "Topic-A, sqn=4" is sent, but not received. Let's assume that the publisher has no more application messages to send for a while. With every application message sent, the source starts two activity timers: a transport-level "session" timer, and a topic-level "TSNI" timer. The session timer is for .2 seconds (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmsmminimumintervalsource">transport_lbtrm_sm_minimum_interval (source)</a>), and the TSNI timer is for 5 seconds (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transporttopicsequencenumberinfointervalsource">transport_topic_sequence_number_info_interval (source)</a>).</p>
<p>At T=0.2, the session timer expires and the source-side transport layer sends a session message. When the receive-side transport layer sees the session message, it learns that transport datagram #6 was lost. So it starts two receive-side transport-level timers: "NAK backoff" and "NAK generation". NAK backoff is shown here as .05 seconds, but is actually randomized between .025 and .075 (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakinitialbackoffintervalreceiver">transport_lbtrm_nak_initial_backoff_interval (receiver)</a>. The NAK generation is 10 seconds (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakgenerationintervalreceiver">transport_lbtrm_nak_generation_interval (receiver)</a>).</p>
<p>At T=0.25, the NAK backoff timer expires. Since the transport receiver still has not seen datagram #6, it sends a NAK. However, we are assuming that all NAKs are blocked, so the transport source never sees it. Over the next ~5 seconds, the source will send several more session messages and the receiver will send several more NAKs (not shown).</p>
<p>At T=5, the TSNI timer set by the source at T=0 expires. Since no application messages have been sent since then, the source sends a TSNI message for topic "A". This informs the Delivery Controller that it lost the message "Topic-A, sqn=4". However, the receive-side Delivery Controller (topic layer) does not initiate any recovery activity. It only sets a <em>topic-level</em> timer for the same amount of time as the transport's NAK generation timer, 10 seconds. The Delivery Controller assumes that the transport layer will do the actual data recovery.</p>
<p>At T=10.2, the receive-side transport layer's NAK generation timer (set at T=0.2) finally expires; the <em>transport layer</em> now considers datagram #6 as unrecoverable loss. The transport layer stops sending NAKs for that datagram, and it increments the receive-side transport statistic <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__transport__stats__lbtrm__t__stct.html#aec81f344ce20a3485bbf2f5a65b5c61e">lbm_rcv_transport_stats_lbtrm_t_stct::unrecovered_tmo</a>. Note that it does <em>not</em> deliver an unrecoverable loss event to the application.</p>
<p>Over the next ~5 seconds, the Delivery Controller continues to wait for the missing message to be recovered by the transport receiver, but the transport receiver has already given up. You might wonder why the transport layer doesn't inform the Delivery Controller that the lost datagram was unrecoverable loss. The problem is that the transport layer does not know the contents of the lost datagram, and therefore does not know which topic to inform. That is why the Delivery Controller needs to set its own NAK generation timer at the point where it detects topic-level loss (at T=5).</p>
<p>Note that had sources src-B and src-C not been deleted earlier, messages sent to them could have been successfully received and processed during this entire 15-second period. However, any subsequent messages for topic "A" would need to be buffered until T=15. After the unrecoverable loss event is delivered for topic A sequence_number 4, subsequently received and buffered messages for topic "A" are delivered.</p>
<p><br />
 </p>
<h3><a class="anchor" id="exampletransportdeletion"></a>
Example: Transport Deletion&nbsp;&nbsp;<small><a href="#exampletransportdeletion">&lt;-</a></small></h3>
<p>During the previous 15 seconds, the source-side had sent a number of topic-level TSNI (for topic A) and transport-level session messages. At this point, the publishing application deletes source "A". Since sources "B" and "C" were deleted earlier, "A" was the last source mapped to the Transport Session. So UM deletes the Transport Session.</p>
<div class="image">
<img src="Ext_examp_del.png" alt="Ext_examp_del.png"/>
</div>
 <p>Note that no indication is sent from the source side to inform receivers of the removal of the sources, nor the Transport Session. So the receive-side transport layer has to time out the Transport Session after 60 seconds of inactivity (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmactivitytimeoutreceiver">transport_lbtrm_activity_timeout (receiver)</a>).</p>
<p>The receive-side transport layer then informs both Delivery Controllers of the End Of Session event, which the Delivery Controllers pass onto the application receiver callback for each topic. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> structure has an event <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a> of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2647b87f92adb5a34ea129fbfeeed5a3">LBM_MSG_EOS</a>. The delivery controllers and the receive-side transport layer instance are then deleted.</p>
<p>However, note that the receiver objects will continue to exist. They are ready in case another publishing application starts up and creates sources for topics A and/or B.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="applicationdesignprinciples"></a>
Application Design Principles&nbsp;&nbsp;<small><a href="#applicationdesignprinciples">&lt;-</a></small></h1>
<p><br />
 </p>
<h2><a class="anchor" id="ummonitoring"></a>
UM Monitoring&nbsp;&nbsp;<small><a href="#ummonitoring">&lt;-</a></small></h2>
<p>For an Ultra Messaging deployment, "monitoring" is the process of overseeing the operation of UM and the resources it uses to determine its health and performance.</p>
<p><b>Informatica strongly recommends that users of Ultra Messaging actively monitor its operation.</b></p>
<p>Monitoring is addressed in depth in the Operations Guide; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringintroduction">Monitoring Introduction</a>. From an application design point of view, you should decide on a monitoring approach before you start coding your applications.</p>
<p>In particular, implement the recommendations related to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#applicationlogfile">Application Log File</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="messagereception"></a>
Message Reception&nbsp;&nbsp;<small><a href="#messagereception">&lt;-</a></small></h2>
<p>Applications receive messages from UM via application callback. The application registers its callback function with UM during the creation of the <a class="el" href="index.html#receiverobject">Receiver Object</a>. As messages are received, the application's receiver callback function is called, passing in the received message.</p>
<p>Note: there are events other than message reception that can trigger calls to the application's receiver callback. Those other event types are not covered in this section (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">lbm_msg_t_stct::type</a>).</p>
<p>At a high level, there are three common approaches to handling received messages: </p><ol>
<li>
Message is fully processed by the application's receiver callback, called by a context or <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> thread. This is typically the most efficient approach. </li>
<li>
Message is fully processed by the application's receiver callback, called by an <a class="el" href="index.html#eventqueueobject">event queue</a> dispatch thread. This is a simple method to move message processing to a different thread. </li>
<li>
Message is retained by the receiver callback for further processing by a different application thread. </li>
</ol>
<p>For example code demonstrating message reception best practices, see the API language: </p><ul>
<li>
<a class="el" href="index.html#cmessagereception">C Message Reception</a> </li>
<li>
<a class="el" href="index.html#javamessagereception">Java Message Reception</a> </li>
<li>
<a class="el" href="index.html#netmessagereception">.NET Message Reception</a> </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="cmessagereception"></a>
C Message Reception&nbsp;&nbsp;<small><a href="#cmessagereception">&lt;-</a></small></h3>
<p><b>C: Message Is Fully Processed by the Application's Receiver Callback, Called by a Context or <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> Thread</b></p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> my_receiver_callback(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *rcv, <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> *msg, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  <span class="keywordflow">switch</span> (msg-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a>) {</div><div class="line">    <span class="keywordflow">case</span> <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a>:</div><div class="line"></div><div class="line">      <span class="comment">/* Process &quot;msg-&gt;len&quot; bytes in &quot;msg-&gt;data&quot;. */</span></div><div class="line">      ...</div><div class="line"></div><div class="line">      <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Handle other receiver events. */</span></div><div class="line">  }  <span class="comment">/* switch */</span></div><div class="line"></div><div class="line">  <span class="comment">/* No need to delete message (C API deletes by default). */</span></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* my_receiver_callback */</span></div></div><!-- fragment --><p>Important rules regarding the receiver callback function when called by a context/XSP thread: </p><ul>
<li>
The function must return 0. </li>
<li>
The passed-in message must not be modified. </li>
<li>
The function should not perform any operation that might be time consuming or put the thread to sleep (block). This is because any delays in your callback prevents the context thread from servicing its sockets, increasing the risk of packet loss. </li>
<li>
If the receiver callback sends a message, non-blocking sends must be used (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8a470f02029480f179cc4872b7fa713">LBM_SRC_NONBLOCK</a>). The code should be written to handle a send failure of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a75f0f83b8684df30d9816210cc20b4b0">LBM_EWOULDBLOCK</a>. </li>
<li>
It is not allowed to create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel from a callback function executed by a context/XSP thread. </li>
<li>
You may schedule UM timers. </li>
</ul>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>C: Message Is Fully Processed by the Application's Receiver Callback, Called by an <a class="el" href="index.html#eventqueueobject">Event Queue</a> Dispatch Thread</b></p>
<p>The code is identical to the context/XSP thread case above.</p>
<p>The rules are similar, with some important differences (in bold): </p><ul>
<li>
The function must return 0. </li>
<li>
The passed-in message must not be modified. </li>
<li>
<b>The application is permitted to perform operations that are time consuming and/or blocking, as long as the average message processing rate is greater than the average message sending rate. Any temporary delays will buffer messages in the event queue.</b> </li>
<li>
<b>Blocking or non-blocking sends may be used, according to the application's preferences.</b> </li>
<li>
<b>You may create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel. However, the receiver which is delivering the current message must not be deleted.</b> </li>
<li>
You may schedule UM timers. </li>
<li>
Informatica strongly recommends monitoring event queue length. See <a class="el" href="index.html#eventqueuemonitor">Event Queue Monitor</a> for more information. </li>
</ul>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>C: Message Is Retained by the Receiver Callback for Further Processing by a Different Application Thread</b></p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> my_receiver_callback(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *rcv, <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> *msg, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> err, more_processing_needed;</div><div class="line"></div><div class="line">  <span class="keywordflow">switch</span> (msg-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a>) {</div><div class="line">    <span class="keywordflow">case</span> <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a>:</div><div class="line">      more_processing_needed = my_process_received_message(msg);</div><div class="line">      <span class="keywordflow">if</span> (more_processing_needed) {</div><div class="line">        err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain</a>(msg);  <span class="comment">/* Check and handle errors. */</span></div><div class="line">        my_save_message_for_more_processing(msg);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Handle other receiver events. */</span></div><div class="line">  }  <span class="comment">/* switch */</span></div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* my_receiver_callback */</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">void my_additional_processing(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> *msg)</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> err;</div><div class="line"></div><div class="line">  <span class="comment">/* Process &quot;msg-&gt;len&quot; bytes in &quot;msg-&gt;data&quot;. */</span></div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="comment">/* Tell UM: finished with &quot;msg&quot;. */</span></div><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa5fc1eb324a55b8c800c31460b0f0116">lbm_msg_delete</a>(msg);</div><div class="line">  <span class="comment">/* Check and handle errors. */</span></div><div class="line">}  <span class="comment">/* my_additional_processing */</span></div></div><!-- fragment --><p>This demonstrates the use of: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa5fc1eb324a55b8c800c31460b0f0116">lbm_msg_delete()</a> </li>
</ul>
<p>By default, when a receiver callback returns, the UM message is implicitly deleted. To prevent that from happening, the message must be "retained". The application must ensure that every message retained is eventually deleted.</p>
<p>The my_save_message_for_more_processing() function is just whatever you use to transfer the message to your processing thread. The my_additional_processing() function is typically called by your thread to process the message.</p>
<p>The rules for the message processing code are the same as the event queue case (above).</p>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="javamessagereception"></a>
Java Message Reception&nbsp;&nbsp;<small><a href="#javamessagereception">&lt;-</a></small></h3>
<p><b>Java: Message Is Fully Processed by the Application's Receiver Callback, Called by a Context or <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> Thread</b></p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">int</span> onReceive(Object cbArg, LBMMessage msg)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    <span class="keywordflow">switch</span> (msg.type())</div><div class="line">    {</div><div class="line">      <span class="keywordflow">case</span> LBM.MSG_DATA:</div><div class="line">        ByteBuffer message = msg.dataBuffer();</div><div class="line">        <span class="keywordtype">long</span> msgLen = msg.dataLength();</div><div class="line"></div><div class="line">        <span class="comment">// Process &quot;msgLen&quot; bytes in &quot;message&quot;.</span></div><div class="line">        ...</div><div class="line"></div><div class="line">        <span class="comment">// Tell UM: finished with &quot;msg&quot;.</span></div><div class="line">        msg.dispose();</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="comment">/* Handle other receiver events. */</span></div><div class="line">    }  <span class="comment">/* switch */</span></div><div class="line">  } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line">    <span class="comment">/* Handle exception. */</span></div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* onReceive */</span></div></div><!-- fragment --><p>This demonstrates the use of: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a66588284dc0a60fdd0267f397f36c3c6">com.latencybusters.lbm.LBMMessage.dataBuffer()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a8480fa58f107456108732af3940efd59">com.latencybusters.lbm.LBMMessage.dataLength()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a963d0f07751ed176a97f3eff84740fb9">com.latencybusters.lbm.LBMMessage.dispose()</a> </li>
</ul>
<p>These functions prevent unnecessary garbage and are strongly recommended by Informatica (see <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>).</p>
<p>Important rules regarding the receiver callback function when called by the context thread: </p><ul>
<li>
The function must return 0. </li>
<li>
The function must not be allowed to pass an unhandled exception back into UM. For example, you could have your entire callback function enclosed in a large try/catch. (This is true of all UM callbacks, not just receiver.) </li>
<li>
The passed-in message must not be modified. </li>
<li>
The passed-in message must be disposed. In Java, every message must explicitly be disposed, to properly clean up the native memory. Do not assume that GC will clean it up. </li>
<li>
The function should not perform any operation that might be time consuming or put the thread to sleep (block). This is because any delays in your callback prevents the context thread from servicing its sockets, increasing the risk of packet loss. </li>
<li>
If the receiver callback sends a message, non-blocking sends must be used (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBM.html#afbb8a9ee8f1b5c98917feef2fd4e1fb0">com::latencybusters::lbm::LBM::SRC_NONBLOCK</a>). And the code should be written to handle a send failure of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEWouldBlockException.html">com::latencybusters::lbm::LBMEWouldBlockException</a>. </li>
<li>
It is not allowed to create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel from a callback function executed by the context thread. </li>
<li>
You may schedule UM timers. </li>
</ul>
<p>Note the requirement to call <code>msg.dispose()</code> on every message. Prior to UM version 6.7, calling dispose() on every message was considered best practice, but was only <em>required</em> for certain use cases. UM version 6.7 introduced significant performance improvements with Java, but these improvements made calling <code>msg.dispose()</code> mandatory.</p>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>Java: Message Is Fully Processed by the Application's Receiver Callback, Called by an <a class="el" href="index.html#eventqueueobject">Event Queue</a> Dispatch Thread</b></p>
<p>The code is identical to the context thread case above.</p>
<p>The rules are similar, with some important differences (in bold): </p><ul>
<li>
The function must return 0. </li>
<li>
The function must not be allowed to pass an unhandled exception back into UM. For example, you could have your entire callback function enclosed in a large try/catch. (This is true of all UM callbacks, not just receiver.) </li>
<li>
The passed-in message must not be modified. </li>
<li>
The passed-in message must be disposed. In Java, every message must explicitly be disposed, to properly clean up the native memory. Do not assume that GC will clean it up. </li>
<li>
<b>The application is permitted to perform operations that are time consuming and/or blocking, as long as the average message processing rate is greater than the average message sending rate. Any temporary delays will buffer messages in the event queue.</b> </li>
<li>
<b>Blocking or non-blocking sends may be used, according to the application's preferences.</b> </li>
<li>
<b>You may create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel. However, the receiver which is delivering the current message should not be deleted.</b> </li>
<li>
You may schedule UM timers. </li>
<li>
Informatica strongly recommends monitoring event queue length. See <a class="el" href="index.html#eventqueuemonitor">Event Queue Monitor</a> for more information. </li>
</ul>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>Java: Message Is Retained by the Receiver Callback for Further Processing by a Different Application Thread</b></p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> init_UM()</div><div class="line">{</div><div class="line">  <span class="comment">// During initialization, the UM context and receiver(s) are</span></div><div class="line">  <span class="comment">// configured to use a recycler.</span></div><div class="line">  LBMObjectRecycler objRec = <span class="keyword">new</span> LBMObjectRecycler();</div><div class="line">...</div><div class="line">  <span class="comment">// Preparing to create context - set up attribute.</span></div><div class="line">  LBMContextAttributes ctx_attr = <span class="keyword">new</span> LBMContextAttributes();</div><div class="line">  ctx_attr.setObjectRecycler(objRec, null);</div><div class="line">  <span class="comment">// Proceed with creating context, using ctx_attr.</span></div><div class="line">...</div><div class="line">  <span class="comment">// Preparing to create receiver - set up attribute.</span></div><div class="line">  LBMReceiverAttributes rcv_attr = <span class="keyword">new</span> LBMReceiverAttributes();</div><div class="line">  rcv_attr.setObjectRecycler(objRec, null);</div><div class="line">  <span class="comment">// Proceed with creating receiver, using rcv_attr.</span></div><div class="line">...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">int</span> onReceive(Object cbArg, LBMMessage msg)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    <span class="keywordflow">switch</span> (msg.type())</div><div class="line">    {</div><div class="line">      <span class="keywordflow">case</span> LBM.MSG_DATA:</div><div class="line">        msg.promote();  <span class="comment">// Tell UM: not finished with &quot;msg&quot;.</span></div><div class="line">        saveMessageForMoreProcessing(msg);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="comment">/* Handle other receiver events. */</span></div><div class="line">    }  <span class="comment">/* switch */</span></div><div class="line">  } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line">    <span class="comment">/* Handle exception. */</span></div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* onReceive */</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">int</span> myAdditionalProcessing(LBMMessage msg)</div><div class="line">{</div><div class="line">  ByteBuffer message = msg.dataBuffer();</div><div class="line">  <span class="keywordtype">long</span> msgLen = msg.dataLength();</div><div class="line"></div><div class="line">  <span class="comment">// Process &quot;msgLen&quot; bytes in &quot;message&quot;.</span></div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="comment">// Tell UM: finished with &quot;msg&quot;.</span></div><div class="line">  msg.dispose();</div><div class="line">  objRec.doneWithMessage(msg);</div><div class="line">}  <span class="comment">/* myAdditionalProcessing */</span></div></div><!-- fragment --><p>This demonstrates the use of: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a2cda69ee0b33fe294d46761401e451ca">com.latencybusters.lbm.LBMMessage.promote()</a><ul>
<li>informs UM that the message is retained after the return of the receiver callback. </li>
</ul>
</li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a66588284dc0a60fdd0267f397f36c3c6">com.latencybusters.lbm.LBMMessage.dataBuffer()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a8480fa58f107456108732af3940efd59">com.latencybusters.lbm.LBMMessage.dataLength()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a963d0f07751ed176a97f3eff84740fb9">com.latencybusters.lbm.LBMMessage.dispose()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMObjectRecycler.html">com.latencybusters.lbm.LBMObjectRecycler</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMObjectRecycler.html#aa9e6a3f6604e64ea2d88f190f650baa1">com.latencybusters.lbm.LBMObjectRecycler.doneWithMessage()</a> </li>
</ul>
<p>These functions prevent unnecessary garbage and are strongly recommended by Informatica (see <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>).</p>
<p>The mySaveMessageForMoreProcessing() function is just whatever you use to transfer the message to your processing thread. The myAdditionalProcessing() function is typically called by you when you are ready to complete processing of the message.</p>
<p>The rules for the message processing code are the same as the event queue case. However, the application must ensure that every message promoted is eventually disposed.</p>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="netmessagereception"></a>
.NET Message Reception&nbsp;&nbsp;<small><a href="#netmessagereception">&lt;-</a></small></h3>
<p>Except where indicated, .NET coding for message reception is identical to that of Java.</p>
<dl class="section note"><dt>Note</dt><dd>Historically, .NET programs that receive UM messages were not required to call the message object's <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a963d0f07751ed176a97f3eff84740fb9">dispose()</a> method. However, it is now strongly recommended. Not calling dispose() will introduce significant latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>) when GC runs, and also makes persistence acknowledgements to the Store non-deterministic. Finally, in the future, performance improvements for .NET might require the use of "dispose()". <b>Informatica strongly recommends that .NET subscribers call "dispose()" for every message.</b></dd></dl>
<p><b>.NET: Message Is Fully Processed by the Application's Receiver Callback, Called by a Context or <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> Thread</b></p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">int</span> onReceive(Object cbArg, LBMMessage msg)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    <span class="keywordflow">switch</span> (msg.type())</div><div class="line">    {</div><div class="line">      <span class="keywordflow">case</span> LBM.MSG_DATA:</div><div class="line">        byte * message = msg.dataPointer();  <span class="comment">// Different from java!</span></div><div class="line">        uint msgLen = msg.length();          <span class="comment">// Different from java!</span></div><div class="line"></div><div class="line">        <span class="comment">// Process &quot;msgLen&quot; bytes in &quot;message&quot;.</span></div><div class="line">        ...</div><div class="line"></div><div class="line">        <span class="comment">// Tell UM: finished with &quot;msg&quot;.</span></div><div class="line">        msg.dispose();</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="comment">/* Handle other receiver events. */</span></div><div class="line">    }  <span class="comment">/* switch */</span></div><div class="line">  } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line">    <span class="comment">/* Handle exception. */</span></div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* onReceive */</span></div></div><!-- fragment --><p>This demonstrates the use of: </p><ul>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a98f034f21af3ac96cc48cd90df73b48b">dataPointer()</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a26ee9e9a8fa76302a91bcf77a60a9d26">length()</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a963d0f07751ed176a97f3eff84740fb9">dispose()</a> </li>
</ul>
<p>These functions prevent unnecessary garbage and are strongly recommended by Informatica (see <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>).</p>
<p>Important rules regarding the receiver callback function when called by the context thread: </p><ul>
<li>
The function must return 0. </li>
<li>
The function must not be allowed to pass an unhandled exception back into UM. For example, you could have your entire callback function enclosed in a large try/catch. (This is true of all UM callbacks, not just receiver.) </li>
<li>
The passed-in message must not be modified. </li>
<li>
The passed-in message must be disposed. In .NET, every message should explicitly be disposed, to properly clean up the native memory. Do not assume that GC will clean it up. </li>
<li>
The function should not perform any operation that might be time consuming or put the thread to sleep (block). This is because any delays in your callback prevents the context thread from servicing its sockets, increasing the risk of packet loss. </li>
<li>
If the receiver callback sends a message, non-blocking sends must be used (see <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBM.html#ac90cdb59c9d78fcbf2f5a127df5381a7">SRC_NONBLOCK()</a>). And the code should be written to handle a send failure of <a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMEWouldBlockException.html">LBMEWouldBlockException()</a>. </li>
<li>
It is not allowed to create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel from a callback function executed by the context thread. </li>
<li>
You may schedule UM timers. </li>
</ul>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>.NET: Message Is Fully Processed by the Application's Receiver Callback, Called by an <a class="el" href="index.html#eventqueueobject">Event Queue</a> Dispatch Thread</b></p>
<p>The code is identical to the context thread case above.</p>
<p>The rules are similar, with some important differences (in bold): </p><ul>
<li>
The function must return 0. </li>
<li>
The function must not be allowed to pass an unhandled exception back into UM. For example, you could have your entire callback function enclosed in a large try/catch. (This is true of all UM callbacks, not just receiver.) </li>
<li>
The passed-in message must not be modified. </li>
<li>
The passed-in message must be disposed. In .NET, every message should explicitly be disposed, to properly clean up the native memory. Do not assume that GC will clean it up. </li>
<li>
<b>The application is permitted to perform operations that are time consuming and/or blocking, as long as the average message processing rate is greater than the average message sending rate. Any temporary delays will buffer messages in the event queue.</b> </li>
<li>
<b>Blocking or non-blocking sends may be used, according to the application's preferences.</b> </li>
<li>
<b>You may create/delete sources or receivers, or subscribe/unsubscribe from a <a class="el" href="index.html#spectrum">Spectrum</a> channel. However, the receiver which is delivering the current message should not be deleted.</b> </li>
<li>
You may schedule UM timers. </li>
<li>
Informatica strongly recommends monitoring event queue length. See <a class="el" href="index.html#eventqueuemonitor">Event Queue Monitor</a> for more information. </li>
</ul>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><b>.NET: Message Is Retained by the Receiver Callback for Further Processing by a Different Application Thread</b></p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> init_UM()</div><div class="line">{</div><div class="line">  <span class="comment">// During initialization, the UM context and receiver(s) must be</span></div><div class="line">  <span class="comment">// configured to use a recycler.</span></div><div class="line">  LBMObjectRecycler objRec = <span class="keyword">new</span> LBMObjectRecycler();</div><div class="line">...</div><div class="line">  <span class="comment">// Preparing to create context - set up attribute.</span></div><div class="line">  LBMContextAttributes ctx_attr = <span class="keyword">new</span> LBMContextAttributes();</div><div class="line">  ctx_attr.setObjectRecycler(objRec, null);</div><div class="line">  <span class="comment">// Proceed with creating context, using ctx_attr.</span></div><div class="line">...</div><div class="line">  <span class="comment">// Preparing to create receiver - set up attribute.</span></div><div class="line">  LBMReceiverAttributes rcv_attr = <span class="keyword">new</span> LBMReceiverAttributes();</div><div class="line">  rcv_attr.setObjectRecycler(objRec, null);</div><div class="line">  <span class="comment">// Proceed with creating receiver, using rcv_attr.</span></div><div class="line">...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">int</span> onReceive(Object cbArg, LBMMessage msg)</div><div class="line">{</div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    <span class="keywordflow">switch</span> (msg.type())</div><div class="line">    {</div><div class="line">      <span class="keywordflow">case</span> LBM.MSG_DATA:</div><div class="line">        msg.promote();</div><div class="line">        <span class="comment">// Tell UM: not finished with &quot;msg&quot;.</span></div><div class="line">        saveMessageForMoreProcessing(msg);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="comment">/* Handle other receiver events. */</span></div><div class="line">    }  <span class="comment">/* switch */</span></div><div class="line">  } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line">    <span class="comment">/* Handle exception. */</span></div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* onReceive */</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">int</span> myAdditionalProcessing(LBMMessage msg)</div><div class="line">{</div><div class="line">  byte * message = msg.dataPointer();  <span class="comment">// Different from java!</span></div><div class="line">  uint msgLen = msg.length();          <span class="comment">// Different from java!</span></div><div class="line"></div><div class="line">  <span class="comment">// Process &quot;msgLen&quot; bytes in &quot;message&quot;.</span></div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="comment">// Tell UM: finished with &quot;msg&quot;.</span></div><div class="line">  msg.dispose();</div><div class="line">  objRec.doneWithMessage(msg);</div><div class="line">}  <span class="comment">/* myAdditionalProcessing */</span></div></div><!-- fragment --><p>This demonstrates the use of: </p><ul>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a2cda69ee0b33fe294d46761401e451ca">promote()</a><ul>
<li>informs UM that the message is retained after the return of the receiver callback. </li>
</ul>
</li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a98f034f21af3ac96cc48cd90df73b48b">dataPointer()</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a26ee9e9a8fa76302a91bcf77a60a9d26">length()</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a963d0f07751ed176a97f3eff84740fb9">dispose()</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMObjectRecycler.html">LBMObjectRecycler</a> </li>
<li>
<a href="../../DotNetAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMObjectRecycler.html#ac9ad6974e2c0f094b7e2662ecc3e9157">LBMObjectRecycler.doneWithMessage()</a> </li>
</ul>
<p>These functions prevent unnecessary garbage and are strongly recommended by Informatica (see <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>).</p>
<p>The mySaveMessageForMoreProcessing() function is just whatever you use to transfer the message to your processing thread. The myAdditionalProcessing() function is typically called by you when you are ready to complete processing of the message.</p>
<p>The rules for the message processing code are the same as the event queue case. However, the application must ensure that every message promoted is eventually disposed.</p>
<p>If this is a Persistent receiver, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#persistencemessageconsumption">Persistence Message Consumption</a>.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="umfeatures"></a>
UM Features&nbsp;&nbsp;<small><a href="#umfeatures">&lt;-</a></small></h1>
<p>Except where otherwise indicated, the features described in this section are available in the UMS, UMP, and UMQ products.</p>
<p><br />
 </p>
<h2><a class="anchor" id="transportservicesproviderxsp"></a>
Transport Services Provider (XSP)&nbsp;&nbsp;<small><a href="#transportservicesproviderxsp">&lt;-</a></small></h2>
<p>Starting with UM version 6.11, a new receive-side object is available to the user: the <a class="el" href="index.html#transportservicesproviderobject">Transport Services Provider Object</a>.</p>
<p>The earlier feature, Multi-Transport Threads (MTT), is removed from UM in favor of XSP.</p>
<p>By default, a UM context combines all network data reception into a single <em>context thread</em>. This thread is responsible for reception and processing of application messages, topic resolution, and immediate message traffic (UIM and MIM). The context thread is also used for processing timers. This single-threaded model conserves CPU core resources, and can simplify application design. However, it can also introduce significant latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>) if a time-sensitive user message is waiting behind, say, a topic resolution message, or a timer callback.</p>
<p>Using an XSP object, an application can reassign the processing of a subscribed <a class="el" href="index.html#transportsessions">Transport Session</a> to an independent thread. This allows concurrent processing of received messages with topic resolution and timers, and even allows different groups Transport Sessions to be processed concurrently with each other.</p>
<p>An application creates one or more XSP objects, owned by a parent context object. By default, when an XSP object is created, UM creates a new thread associated with the XSP. Alternatively, the XSP can be created with <a class="el" href="index.html#sequentialmode">Sequential Mode</a>, which gives the responsibility of thread creation to the application. Either way, the XSP uses its independent thread to read data from the sockets associated with one or more subscribed Transport Sessions. That thread then delivers received messages to the application via a normal receive application callback function.</p>
<p>Creation of an XSP does not by itself cause any receiver Transport Sessions to be assigned to it. Central to the use of XSPs is an application-supplied mapping callback function which tells UM which XSP to associate with subscribed Transport Sessions as they are discovered and joined. This callback allows the application to examine the newly-joined Transport Session, if desired. Then the callback returns, informing UM which XSP, if any, to assign the receiver Transport Session to.</p>
<p><br />
 </p>
<h3><a class="anchor" id="xsphandlestransportsessionsnottopics"></a>
XSP Handles Transport Sessions, Not Topics&nbsp;&nbsp;<small><a href="#xsphandlestransportsessionsnottopics">&lt;-</a></small></h3>
<p>Conceptually, an application designer might want to assign the reception and processing of received data to XSPs on a topic basis. This is not always possible. The XSP thread must process received data on a socket basis, and sockets map to <em>Transport Sessions</em>. As mentioned in <a class="el" href="index.html#umtransports">UM Transports</a>, a publishing application maps one or more topic-based sources to a Transport Session.</p>
<p>Consider the following example:</p>
<div class="image">
<img src="xsp_1.png" alt="xsp_1.png"/>
</div>
 <p>Publisher A and B are two separate application instances, both of which create a source for topic "X". A subscriber application might create two XSPs and assign one Transport Session to each. In this case, you have two independent threads delivering messages to the subscriber's receiver callback, which may not be what the developer wanted. If the developer wants topic X to be serialized, a single XSP should be created and mapped to both Transport Sessions:</p>
<div class="image">
<img src="xsp_2.png" alt="xsp_2.png"/>
</div>
 <p>Now let's introduce a second topic. The developer might want to create two XSPs so that each topic will be handled by an independent thread. However, this is not possible, given the way that the topics are mapped to Transport Sessions in the following example:</p>
<div class="image">
<img src="xsp_3.png" alt="xsp_3.png"/>
</div>
 <p>In this case, XSP 1 is delivering both topics X and Y from Publisher A, and XSP 2 is delivering topics X and Y from Publisher B. Once again, the receiver callback for topic X will be called by two independent threads, which is not desired.</p>
<p>The only way to achieve independent processing of topics is to design the publishers to map their topics to Transport Sessions carefully. For example:</p>
<div class="image">
<img src="xsp_4.png" alt="xsp_4.png"/>
</div>
 <p><br />
 </p>
<h3><a class="anchor" id="xspthreadingconsiderations"></a>
XSP Threading Considerations&nbsp;&nbsp;<small><a href="#xspthreadingconsiderations">&lt;-</a></small></h3>
<p>When contexts are used single-threaded, the application programmer can assume serialization of event delivery to the application callbacks. This can greatly simplify the design of applications, at the cost of added latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>).</p>
<p>When XSPs are used to provide multi-threaded receivers, care must be taken in application design to account for potential concurrent calls to application callbacks. This is especially true if multiple subscribed Transport Sessions are assigned different XSPs, as demonstrated in <a class="el" href="index.html#xsphandlestransportsessionsnottopics">XSP Handles Transport Sessions, Not Topics</a>.</p>
<p>Even in the most simple case, where a single XSP is created and used for all subscribed Transport Sessions, there are still events generated by the main context thread which can be called concurrently with XSP callbacks. Reception of MIM or UIM messages, scheduled timers, and some topic resolution-related callbacks all come from the main context thread, and can all be invoked concurrently with XSP callbacks.</p>
<dl class="section warning"><dt>Warning</dt><dd>Remember that MIM and UIM messages can be sent to a topic. If you have regular sources for a topic assigned to an XSP, and somebody sends MIM or UIM messages to the same topic, your receiver callback function can be called concurrently by both the XSP and the main context. Informatica recommends having a given topic sent to by only one type of sender (UIM, MIM, Source).</dd></dl>
<p><b>Threading Example: Message Timeout</b></p>
<p>Consider as an example a common timer use case: message timeout. Application A expects to receive messages for topic "X" every 5 seconds. If 10 seconds pass without a message, the application assumes that the publisher for "X" has exited, so it cleans up internal state and deletes the UM receiver object. Each time a message is received, the current timer is cancelled and re-created for 10 seconds.</p>
<p>Without XSPs, this can be easily coded since message reception and timer expiration events are serialized. The timer callback can clean up and delete the receiver, confident that no receiver events might get delivered while this is in progress.</p>
<p>However, if the Transport Session carrying topic "X" is assigned to an independent XSP thread, message reception and timer expiration events are no longer serialized. Publisher of "X" might send it's message on-time, but a temporary network outage could delay its delivery, introducing a race condition between message delivery and timer expiration. Consider the case where the timer expiration is a little ahead of the message callback. The timer callback might clean up application state which the message callback will attempt to use. This could lead to unexpected behavior, possibly including segmentation faults.</p>
<p>In this case, proper sequencing of operations is critical. The timer should delete the receiver first. While inside the receiver delete API, the XSP might deliver messages to the application. However, once the receiver delete API returns, it is guaranteed that the XSP is finished making receiver callbacks.</p>
<p>Note that in this example case, if the message receiver callback attempts to cancel the timer, the cancel API will return an error. This is because the timer has already expired and the execution of the callback has begun, and is inside the receiver delete API. The message receiver callback needs to be able to handle this sequence, presumably by not re-scheduling the timer.</p>
<p><br />
 </p>
<h3><a class="anchor" id="xspusage"></a>
XSP Usage&nbsp;&nbsp;<small><a href="#xspusage">&lt;-</a></small></h3>
<p>This section provides simplified C code fragments that demonstrate some of the XSP-related API calls. For full examples of XSP usage, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmrcvxsp_c">Example lbmrcvxsp.c</a> (for C) and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmrcvxsp_java">Example lbmrcvxsp.java</a> (for Java).</p>
<dl class="section note"><dt>Note</dt><dd>Each XSP thread has its own Unicast Listener (request) port. You may need to expand the range <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpportlowcontext">request_tcp_port_low (context)</a> - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpporthighcontext">request_tcp_port_high (context)</a>.</dd></dl>
<p>The common sequence of operations during application initialization is minimally shown below. In the code fragments below, error detection and handling are omitted for clarity.</p>
<ol>
<li>
<p class="startli">Create a context attribute object and set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportmappingfunctioncontext">transport_mapping_function (context)</a> option to point at the application's XSP mapping callback function using the structure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a90dde1ea00f12038cff7195c76d47a46">lbm_transport_mapping_func_t</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acf249ec7a22d6a0eb9fc42d6375bda5a">lbm_context_attr_t</a> *ctx_attr;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a04d99cc97d32f359888c5befcc50512e">lbm_context_attr_create_from_xml</a>(&amp;ctx_attr, <span class="stringliteral">&quot;MyCtx&quot;</span>);</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__transport__mapping__func__t__stct.html">lbm_transport_mapping_func_t</a> mapping_func;</div><div class="line">mapping_func.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__transport__mapping__func__t__stct.html#a7b570d25543dd4e60be8b7f5107e6ad6">mapping_func</a> = app_xsp_mapper_callback;</div><div class="line">mapping_func.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__transport__mapping__func__t__stct.html#a0f67d0ef3770dc1414c7ccbb72752f61">clientd</a> = NULL;             <span class="comment">/* Can include app state pointer. */</span></div><div class="line"></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab67f641d5a0ad1a9fe53d415da58d961">lbm_context_attr_setopt</a>(ctx_attr, <span class="stringliteral">&quot;transport_mapping_function&quot;</span>,</div><div class="line">        &amp;mapping_func, <span class="keyword">sizeof</span>(mapping_func));</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Create the context.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create</a>(&amp;ctx, ctx_attr, NULL, NULL);</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9c0a3c1f4a8854d8ec5585392c817c85">lbm_context_attr_delete</a>(ctx_attr);  <span class="comment">/* No longer needed. */</span></div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Create XSPs using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae38035c6036a84f07f9ba7cee1747dbf">lbm_xsp_create()</a>. In this example, only a single XSP is created.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a300cf24a22429649a1477358ca65bf78">lbm_xsp_t</a> *xsp;  <span class="comment">/* app_xsp_mapper_callback() needs this; see below. */</span></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae38035c6036a84f07f9ba7cee1747dbf">lbm_xsp_create</a>(&amp;xsp, ctx, NULL, NULL);</div></div><!-- fragment --><p>Note that the application can optionally pass in a context attribute object and an XSP attribute object. The context attribute is because XSP is implemented as a sort of reduced-function sub-context, and so it is possible to modify context options for the XSP. However, this is rarely needed since the default action is for the XSP to inherit all the configuration of the main context.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Create a receiver for topic "X".</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3f0c8cba0e6f00fe7ae0ed717405e46d">lbm_topic_t</a> *topic;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3de8a6a659896f76475c453683db4e18">lbm_rcv_topic_lookup</a>(&amp;topic, ctx, <span class="stringliteral">&quot;X&quot;</span>, NULL);</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *rcv;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa7491c50fefbc2b70f8035fce7ac1477">lbm_rcv_create</a>(&amp;rcv, ctx, topic, app_rcv_callback, NULL, NULL);</div></div><!-- fragment --><p><a class="el" href="index.html#eventqueueobject">Event queues</a> may also be used with XSP-assigned Transport Sessions.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">At this point, when the main context discovers a source for topic "X", it will proceed to join the Transport Session. It will call the application's app_xsp_mapper_callback() function, which is minimally this:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a300cf24a22429649a1477358ca65bf78">lbm_xsp_t</a> *app_xsp_mapper_callback(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9f6ec97839a8f264eb4059de01174f3c">lbm_context_t</a> *ctx,</div><div class="line">        <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__new__transport__info__t__stct.html">lbm_new_transport_info_t</a> *transp_info, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  <span class="comment">/* Retrieve the XSP object created in step 3. */</span></div><div class="line">  <span class="keywordflow">return</span> xsp;</div><div class="line">}</div></div><!-- fragment --><p>This minimal callback simply returns the XSP that was created during initialization (the "clientd" can be helpful for that). By assigning all receiver Transport Sessions to the same XSP, you have effectively separated message processing from UM housekeeping tasks, like processing of topic resolution and timers. This can greatly reduce latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>).</p>
<p class="endli">As described in <a class="el" href="index.html#xsphandlestransportsessionsnottopics">XSP Handles Transport Sessions, Not Topics</a>, some users want to have multiple XSPs and assign the Transport Sessions to XSPs according to application logic. Note that the passed-in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac611697e7263b4b5ea5a3b35eb26dc99">lbm_new_transport_info_t</a> structure contains information about the Transport Session, such as the IP address of the sender. However, this structure does not contain topic information. Applications can use the resolver's source notification callback via the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#resolversourcenotificationfunctioncontext">resolver_source_notification_function (context)</a> option to associate topics with source strings. </p>
</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>Most of the time, the application mapping callback will be invoked each time a Transport Session is joined. However, there is one exception to this rule. If a context is already joined to a Transport Session carried on a multicast group and destination port, joining another Transport Session on the same multicast group and destination port does not invoke the mapping callback again. This is because the same socket is used for all Transport Sessions that use the same group:port.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="otherxspoperations"></a>
Other XSP Operations&nbsp;&nbsp;<small><a href="#otherxspoperations">&lt;-</a></small></h3>
<p>Starting with UM 6.12, XSP supports persistent receivers.</p>
<p>XSP supports <a class="el" href="index.html#registeredfiledescriptors">Registered File Descriptors</a>.</p>
<p>When an XSP object is created, an XSP attribute object can be supplied to set XSP options. The XSP options are: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#operationalmodexsp">operational_mode (xsp)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#zerotransportsfunctionxsp">zero_transports_function (xsp)</a> </li>
</ul>
<p>To create and manipulate an XSP attribute object, see: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae52cbac6a22b495a3b48a70bf23fc118">lbm_xsp_attr_setopt()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a62363973a939a8555eac38846492dbb2">lbm_xsp_attr_getopt()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adfc416faf8fbc79cfd16a1485341f469">lbm_xsp_attr_delete()</a> </li>
</ul>
<p>Before deleting an XSP, all UM objects that reference that XSP must first be delete. Bear in mind that XSPs are generally associated with transport sessions, and a transport session can have many topics associated with it. Conversely, a single topic can have multiple transport sessions associated with it. There can also be higher-level associations related to receivers that maintain non-obvious associations with an XSP, even if that XSP is no longer handling active transport sessions.</p>
<p>Informatica recommends maintaining all created XSPs until the parent context object is ready to be deleted. See <a class="el" href="index.html#deletingumobjects">Deleting UM Objects</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="xsplimitations"></a>
XSP Restrictions&nbsp;&nbsp;<small><a href="#xsplimitations">&lt;-</a></small></h3>
<p>There are some restrictions and limitations on the XSP feature.</p>
<ul>
<li>
<p class="startli">The only transport types currently supported are LBT-RM, LBT-RU, and TCP. The XSP feature is not compatible with transport types IPC, SMX, or DBL.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">An application receiver callback must not create a new XSP.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">For a persistent receiver assigned to an XSP, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpultramessagingpersistence.html#umeproactivekeepaliveintervalcontext">ume_proactive_keepalive_interval (context)</a> must be enabled.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">XSP is not currently compatible with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/ultraloadbalancingulb.html">Ultra Load Balancing (ULB)</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">XSP is not currently compatible with <a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">XSP is not currently compatible with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#drohotlinks">DRO Hotlinks</a>.</p>
<p class="endli"></p>
</li>
<li>
XSP is not currently compatible with <a class="el" href="index.html#receivesidebatching">Receive-Side Batching</a>. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="usinglatejoin"></a>
Using Late Join&nbsp;&nbsp;<small><a href="#usinglatejoin">&lt;-</a></small></h2>
<p>This section introduces the use of Ultra Messaging Late Join in default and specialized configurations. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html">Late Join Options</a> for more information.</p>
<dl class="section note"><dt>Note</dt><dd>If your application is running within a Ultra Messaging context with configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpbindrequestportcontext">request_tcp_bind_request_port (context)</a> set to zero, then UIM port binding has been turned off, which also disables the Late Join feature.</dd>
<dd>
With the UMQ product, you cannot use Late Join with Queuing (both Brokered and ULB).</dd></dl>
<p>The Late Join feature enables newly created receivers to receive previously transmitted messages. Sources configured for Late Join maintain a retention buffer (not to be confused with a transport retransmission window), which holds transmitted messages for late-joining receivers.</p>
<p>A Late Join operation follows the following sequence:</p>
<ol>
<li>
A new receiver configured for Late Join with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#uselatejoinreceiver">use_late_join (receiver)</a> completes topic resolution. Topic advertisements from the source contain a flag that indicates the source is configured for Late Join with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoinsource">late_join (source)</a>. </li>
<li>
The new receiver sends a Late Join Information Request (LJIR) to request a previously transmitted messages. The receiver configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestoutstandingmaximumreceiver">retransmit_request_outstanding_maximum (receiver)</a>, determines the number of messages the receiver requests. </li>
<li>
The source responds with a Late Join Information (LJI) message containing the sequence numbers for the retained messages that are available for retransmission. </li>
<li>
The source unicasts the messages. </li>
<li>
When <a class="el" href="index.html#configuringlatejoinforlargenumbersofmessages">Configuring Late Join for Large Numbers of Messages</a>, the receiver issues additional requests, and the source retransmits these additional groups of older messages, oldest first. </li>
</ol>
<div class="image">
<img src="LateJoin.png" alt="LateJoin.png"/>
</div>
 <p>The source's retention buffer's is not pre-allocated and occupies an increasing amount of memory as the source sends messages and adds them to the buffer. If a retention buffer grows to a size equal to the value of the source configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a>, the source deletes older messages as it adds new ones. The source configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a>, controls message deletion based on message age.</p>
<p>UM uses control-structure overhead memory on a per-message basis for messages held in the retention buffer, in addition to the retention buffer's memory. Such memory usage can become significantly higher when retained messages are smaller in size, since more of them can then fit in the retention buffer.</p>
<dl class="section note"><dt>Note</dt><dd>If you set the receiver configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> to 1, the receiver must deliver messages to your application in sequence number order. The receiver holds out-of-order messages in an ordered list cache until messages arrive to fill the sequence number gaps. If an out-of-order message arrives with a sequence number that creates a message gap greater than the value of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a>, the receiver creates a burst loss event and terminates the Late Join recovery operation. You can increase the value of the proximity option and restart the receiver, but a burst loss is a significant event and you should investigate your network and message system components for failures.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="latejoinwithump"></a>
Late Join With Persistence&nbsp;&nbsp;<small><a href="#latejoinwithump">&lt;-</a></small></h3>
<p>With the UMP/UMQ products, late Join can be implemented in conjunction with the persistent Store, however in this configuration, it functions somewhat differently from Streaming. After a late-Join-enabled receiver has been created, resolved a topic, and become registered with a Store, it may then request older messages. The Store unicasts the retransmission messages. If the Store does not have these messages, it requests them of the source (assuming option retransmission-request-forwarding is enabled), thus initiating Late Join.</p>
<p><br />
 </p>
<h3><a class="anchor" id="latejoinoptionssummary"></a>
Late Join Options Summary&nbsp;&nbsp;<small><a href="#latejoinoptionssummary">&lt;-</a></small></h3>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoinsource">late_join (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#uselatejoinreceiver">use_late_join (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitinitialsequencenumberrequestreceiver">retransmit_initial_sequence_number_request (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestmessagetimeoutreceiver">retransmit_request_message_timeout (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestintervalreceiver">retransmit_request_interval (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestmaximumreceiver">retransmit_request_maximum (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestoutstandingmaximumreceiver">retransmit_request_outstanding_maximum (receiver)</a> </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="usingdefaultlatejoinoptions"></a>
Using Default Late Join Options&nbsp;&nbsp;<small><a href="#usingdefaultlatejoinoptions">&lt;-</a></small></h3>
<p>To implement Late Join with default options, set the Late Join configuration options to activate the feature on both a source and receiver in the following manner.</p>
<ol>
<li>
<p class="startli">Create a configuration file with source and receiver Late Join activation options set to 1. For example, file cfg1.cfg containing the two lines:</p>
<pre class="fragment">source late_join 1
receiver use_late_join 1
</pre><p class="endli"></p>
</li>
<li>
<p class="startli">Run an application that starts a Late-Join-enabled source. For example:</p>
<pre class="fragment">lbmsrc -c cfg1.cfg -P 1000 topicName
</pre><p class="endli"></p>
</li>
<li>
<p class="startli">Wait a few seconds, then run an application that starts a Late-Join-enabled receiver. For example:</p>
<pre class="fragment">lbmrcv -c cfg1.cfg -v topicName
</pre> </li>
</ol>
<p>The output for each should closely resemble the following:</p>
<p><b>LBMSRC</b></p>
<pre class="fragment">$ lbmsrc -c cfg1.cfg -P 1000 topicName
LOG Level 5: NOTICE: Source "topicName" has no retention settings (1 message retained max)
Sending 10000000 messages of size 25 bytes to topic [topicName]
Receiver connect [TCP:10.29.3.77:34200]
</pre><p><b>LBMRCV</b></p>
<pre class="fragment">$ lbmrcv -c cfg1.cfg -v topicName
Immediate messaging target: TCP:10.29.3.77:4391
[topicName][TCP:10.29.3.76:4371][2]-RX-, 25 bytes
1.001 secs. 0.0009988 Kmsgs/sec. 0.1998 Kbps
[topicName][TCP:10.29.3.76:4371][3], 25 bytes
1.002 secs. 0.0009982 Kmsgs/sec. 0.1996 Kbps
[topicName][TCP:10.29.3.76:4371][4], 25 bytes
1.003 secs. 0.0009972 Kmsgs/sec. 0.1994 Kbps
[topicName][TCP:10.29.3.76:4371][5], 25 bytes
1.003 secs. 0.0009972 Kmsgs/sec. 0.1994 Kbps
...
</pre><p>Note that the source only retained 1 Late Join message (due to default retention settings) and that this message appears as a retransmit (-RX-). Also note that it is possible to sometimes receive 2 RX messages in this scenario (see <a class="el" href="index.html#retransmittingonlyrecentmessages">Retransmitting Only Recent Messages</a>.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="specifyingarangeofmessagestoretransmit"></a>
Specifying a Range of Messages to Retransmit&nbsp;&nbsp;<small><a href="#specifyingarangeofmessagestoretransmit">&lt;-</a></small></h3>
<p>To receive more than one or two Late Join messages, increase the source's <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> from its default value of 0. Once the buffer exceeds this threshold, the source allows the next new message entering the retention buffer to bump out the oldest one. Note that this threshold's units are bytes (which includes a small overhead per message).</p>
<p>While the retention threshold endeavors to keep the buffer size close to its value, it does not set hard upper limit for retention buffer size. For this, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> configuration option (also in bytes) sets this boundary.</p>
<p>Follow the steps below to demonstrate how a source can retain about 50MB of messages, but no more than 60MB:</p>
<ol>
<li>
<p class="startli">Create a second configuration file (cfg2.cfg) with the following options:</p>
<pre class="fragment">source late_join 1
source retransmit_retention_size_threshold 50000000
source retransmit_retention_size_limit 60000000
receiver use_late_join 1
</pre> </li>
<li>
Run lbmsrc -c cfg2.cfg -P 1000 topicName. </li>
<li>
Wait a few seconds and run <code>lbmrcv -c cfg2.cfg -v topicName</code>. The output for each should closely resemble the following: </li>
</ol>
<p><b>LBMSRC</b></p>
<pre class="fragment">$ lbmsrc -c cfg2.cfg -P 1000 topicName
Sending 10000000 messages of size 25 bytes to topic [topicName]
Receiver connect [TCP:10.29.3.76:34444]
</pre><p><b>LBMRCV</b></p>
<pre class="fragment">$ lbmrcv -c cfg2.cfg -v topicName
Immediate messaging target: TCP:10.29.3.76:4391
[topicName][TCP:10.29.3.77:4371][0]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][1]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][2]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][3]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][4]-RX-, 25 bytes
1.002 secs. 0.004991 Kmsgs/sec. 0.9981 Kbps
[topicName][TCP:10.29.3.77:4371][5], 25 bytes
1.002 secs. 0.0009984 Kmsgs/sec. 0.1997 Kbps
[topicName][TCP:10.29.3.77:4371][6], 25 bytes
1.002 secs. 0.0009983 Kmsgs/sec. 0.1997 Kbps
[topicName][TCP:10.29.3.77:4371][7], 25 bytes
...
</pre><p>Note that lbmrcv received live messages with sequence numbers 7, 6, and 5, and RX messages going from 4 all the way back to Sequence Number 0.</p>
<p><br />
 </p>
<h3><a class="anchor" id="retransmittingonlyrecentmessages"></a>
Retransmitting Only Recent Messages&nbsp;&nbsp;<small><a href="#retransmittingonlyrecentmessages">&lt;-</a></small></h3>
<p>Thus far we have worked with only source late join settings, but suppose that you want to receive only the last 10 messages. To do this, configure the receiver option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestmaximumreceiver">retransmit_request_maximum (receiver)</a> to set how many messages to request backwards from the latest message.</p>
<p>Follow the steps below to set this option to 10.</p>
<ol>
<li>
<p class="startli">Add the following line to cfg2.cfg and rename it cfg3.cfg:</p>
<pre class="fragment">receiver retransmitrequestmaximumreceiver 10
</pre><p class="endli"></p>
</li>
<li>
<p class="startli">Run:</p>
<pre class="fragment">lbmsrc -c cfg3.cfg -P 1000 topicName
</pre><p class="endli"></p>
</li>
<li>
Wait a few seconds and run <code>lbmrcv -c cfg3.cfg -v topicName</code>. The output for each should closely resemble the following. </li>
</ol>
<p><b>LBMSRC</b></p>
<pre class="fragment">$ lbmsrc -c cfg3.cfg -P 1000 topicName
Sending 10000000 messages of size 25 bytes to topic [topicName]
Receiver connect [TCP:10.29.3.76:34448]
</pre><p><b>LBMRCV</b></p>
<pre class="fragment">$ lbmrcv -c cfg3.cfg -v topicName
Immediate messaging target: TCP:10.29.3.76:4391
[topicName][TCP:10.29.3.77:4371][13]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][14]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][15]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][16]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][17]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][18]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][19]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][20]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][21]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][22]-RX-, 25 bytes
[topicName][TCP:10.29.3.77:4371][23]-RX-, 25 bytes
1.002 secs. 0.01097 Kmsgs/sec. 2.195 Kbps
[topicName][TCP:10.29.3.77:4371][24], 25 bytes
1.002 secs. 0.0009984 Kmsgs/sec. 0.1997 Kbps
[topicName][TCP:10.29.3.77:4371][25], 25 bytes
1.002 secs. 0.0009984 Kmsgs/sec. 0.1997 Kbps
[topicName][TCP:10.29.3.77:4371][26], 25 bytes
...
</pre><p>Note that 11, not 10, retransmits were actually received. This can happen because network and timing circumstances may have one RX already in transit while the specific RX amount is being processed. (Hence, it is not possible to guarantee one and only one RX message for every possible Late Join recovery.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="configuringlatejoinforlargenumbersofmessages"></a>
Configuring Late Join for Large Numbers of Messages&nbsp;&nbsp;<small><a href="#configuringlatejoinforlargenumbersofmessages">&lt;-</a></small></h3>
<p>Suppose you have a persistent receiver that comes up at midday and must gracefully catch up on the large number of messages it has missed. The following discussion explains the relevant Late Join options and how to use them. (The discussion also applies to streaming-based late join, but since streaming sources must hold all retained messages in memory, there are typically far fewer messages available.)</p>
<p><b>Option:</b> <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestoutstandingmaximumreceiver">retransmit_request_outstanding_maximum (receiver)</a></p>
<p>When a receiver comes up and begins requesting Late Join messages, it does not simply request messages starting at Sequence Number 0 through 1000000. Rather, it requests the messages a little at a time, depending upon how option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestoutstandingmaximumreceiver">retransmit_request_outstanding_maximum (receiver)</a> is set. For example, when set to the default of 10, the receiver sends requests the first 10 messages (Sequence Number 0 - 9). Upon receiving Sequence Number 0, it then requests the next message (10), and so on, limiting the number of outstanding unfulfilled requests to 10.</p>
<p>Note that higher for values retransmit_request_outstanding_maximum can increase the rate of RXs received, which can reduce the time required for receiver recovery. However, this can lead to heavy loading of the Store, potentially making it unable to sustain the incoming data rate.</p>
<p>Also, be aware that increasing retransmit_request_outstanding_maximum may require a corresponding increase to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitrequestintervalreceiver">retransmit_request_interval (receiver)</a>. Otherwise you can have a situation where messages time out because it takes a Store longer than retransmit_request_interval to process all retransmit_request_outstanding_maximum requests. When this happens, you can see messages needlessly requested and sent many times (generates warnings to the receiver application log file).</p>
<p><b>Option:</b> <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a></p>
<p>When sequence number delivery order is used, long recoveries of active sources can create receiver memory cache problems due to the processing of both new and retransmitted messages. This option provides a method to control caching and cache size during recovery.</p>
<p>It does this by comparing the option value (default 2147483647) to the difference between the newest (live) received sequence number and the latest received RX sequence number. If the difference is less than the option's value, the receiver caches incoming live new messages. Otherwise, new messages are dropped and not cached (with the assumption that they can be requested later as retransmissions).</p>
<p>For example, as shown in the diagram below, a receiver may be receiving both live streaming messages (latest, #200) and catch-up retransmissions (latest, #100). The difference here is 100. If <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a> is 75, the receiver caches the live messages and will deliver them when it is all caught up with the retransmissions. However, if this option is 150, streamed messages are dropped and later picked up again as a retransmission.</p>
<div class="image">
<img src="proximity_option.png" alt="proximity_option.png"/>
</div>
 <p>The default value of this option is high enough to still encourage caching most of the time, and should be optimal for most receivers.</p>
<p>If your source streams faster than it retransmits, caching is beneficial, as it ensures new data are received only once, thus reducing recovery time. If the source retransmits faster than it streams, which is the optimal condition, you can lower the value of this option to use less memory during recovery, with little performance impact.</p>
<p><br />
 </p>
<h2><a class="anchor" id="offtransportrecoveryotr"></a>
Off-Transport Recovery (OTR)&nbsp;&nbsp;<small><a href="#offtransportrecoveryotr">&lt;-</a></small></h2>
<p>Off-Transport Recovery (OTR) is a lost-message-recovery feature that provides a level of hedging against the possibility of brief and incidental unrecoverable loss at the transport level or from a <a class="el" href="index.html#umrouter">DRO</a>. This section describes the OTR feature.</p>
<dl class="section note"><dt>Note</dt><dd>With the UMQ product, you cannot use OTR with Queuing (both Brokered and ULB).</dd></dl>
<p>When a transport cannot recover lost messages, OTR engages and looks to the source for message recovery. It does this by accessing the source's retention buffer (used also by the Late Join feature) to re-request messages that no longer exist in a transport's transmission window, or other places such as a persistent Store or redundant source.</p>
<p>OTR functions in a manner very similar to that of Late Join, but differs mainly in that it activates in message loss situations rather than following the creation of a receiver, and shares only the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoinsource">late_join (source)</a> option setting.</p>
<p>Upon detecting loss, a receiver initiates OTR by sending repeated, spaced, OTR requests to the source, until it recovers lost messages or a timeout period elapses.</p>
<p>OTR operates independently from transport-level recovery mechanisms such as NAKs for LBT-RU or LBT-RM. When you enable OTR for a receiver with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#useotrreceiver">use_otr (receiver)</a>, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestinitialdelayreceiver">otr_request_initial_delay (receiver)</a> period starts as soon as the <a class="el" href="index.html#deliverycontroller">Delivery Controller</a> detects a sequence gap. If the gap is not resolved by the end of the delay interval, OTR recovery initiates. OTR recovery can occur before, during or after transport-level recovery attempts.</p>
<p>When a receiver initiates OTR, the intervals between OTR requests increases twofold after each request, until the maximum interval is reached (assuming the receiver is still waiting to receive the retransmission). You use configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestminimumintervalreceiver">otr_request_minimum_interval (receiver)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestmaximumintervalreceiver">otr_request_maximum_interval (receiver)</a> to set the initial (minimum) and maximum intervals, respectively.</p>
<p>The source retransmits lost messages to the recovered receiver via unicast.</p>
<p><br />
 </p>
<h3><a class="anchor" id="otrwithsequencenumberordereddelivery"></a>
OTR with Sequence Number Ordered Delivery&nbsp;&nbsp;<small><a href="#otrwithsequencenumberordereddelivery">&lt;-</a></small></h3>
<p>When sequence number delivery order is used and a gap of missing messages occurs, a receiver buffers the new incoming messages while it attempts to recover the earlier missing ones. Long recoveries of actively streaming sources can cause excessive receiver cache memory growth due to the processing of both new and retransmitted messages. You can control caching and cache size during recovery with options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrmessagecachingthresholdreceiver">otr_message_caching_threshold (receiver)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a>.</p>
<p>The option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrmessagecachingthresholdreceiver">otr_message_caching_threshold (receiver)</a> sets the maximum number of messages a receiver can buffer. When the number of cached messages hits this threshold, new streamed messages are dropped and not cached, with the assumption that they can be requested later as retransmissions.</p>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a>, which is also used by Late Join (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a>), turns off this caching if there are too many messages to buffer between the last delivered message and the currently streaming messages.</p>
<p>Both of these option thresholds must be satisfied before caching resumes.</p>
<p><br />
 </p>
<h3><a class="anchor" id="otrwithump"></a>
OTR With Persistence&nbsp;&nbsp;<small><a href="#otrwithump">&lt;-</a></small></h3>
<p>With the UMP/UMQ products, you can implement OTR in conjunction with the persistent Store, however in this configuration, it functions somewhat differently from Streaming. If an OTR-enabled receiver registered with a Store detects a sequence gap in the live stream and that gap is not resolved by other means within the next <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestinitialdelayreceiver">otr_request_initial_delay (receiver)</a> period, the receiver requests those messages from the Store(s). If the Store does not have some of the requested messages, the receiver requests them from the source. Regardless of whether the messages are recovered from a Store or from the source, OTR delivers all recovered messages with the LBM_MSG_OTR flag, unlike Late Join, which uses the LBM_MSG_RETRANSMIT flag.</p>
<p><br />
 </p>
<h3><a class="anchor" id="otroptionssummary"></a>
OTR Options Summary&nbsp;&nbsp;<small><a href="#otroptionssummary">&lt;-</a></small></h3>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#latejoinsource">late_join (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#useotrreceiver">use_otr (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestmessagetimeoutreceiver">otr_request_message_timeout (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestinitialdelayreceiver">otr_request_initial_delay (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestlogalertcooldownreceiver">otr_request_log_alert_cooldown (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestmaximumintervalreceiver">otr_request_maximum_interval (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestminimumintervalreceiver">otr_request_minimum_interval (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestoutstandingmaximumreceiver">otr_request_outstanding_maximum (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrmessagecachingthresholdreceiver">otr_message_caching_threshold (receiver)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitmessagecachingproximityreceiver">retransmit_message_caching_proximity (receiver)</a> </li>
</ul>
<dl class="section note"><dt>Note</dt><dd>With <a class="el" href="index.html#smartsources">Smart Sources</a>, the following configuration options have limited or no support: <ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizethresholdsource">retransmit_retention_size_threshold (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionsizelimitsource">retransmit_retention_size_limit (source)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grplatejoin.html#retransmitretentionagethresholdsource">retransmit_retention_age_threshold (source)</a> </li>
</ul>
</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="encryptedtcp"></a>
Encrypted TCP&nbsp;&nbsp;<small><a href="#encryptedtcp">&lt;-</a></small></h2>
<p>This section introduces the use of Transport Layer Security (TLS), sometimes known by its older designation Secure Sockets Layer (SSL).</p>
<p>The goal of the Ultra Messaging (UM) TLS feature is to provide encrypted transport of application data. TLS supports authentication (through certificates), data confidentiality (through encryption), and data integrity (ensuring data are not changed, removed, or added-to). UM can be configured to apply TLS security measures to all Streaming and/or Persisted TCP communication, including <a class="el" href="index.html#umrouter">DRO</a> peer links. Non-TCP communication is not encrypted (e.g. topic resolution).</p>
<p>TLS is a family of standard protocols and algorithms for securing TCP communication between a client and a server. It is sometimes referred as "SSL", which technically is the name of an older (less secure) version of the protocol. Over the years, security researchers (and hackers) have discovered flaws in SSL/TLS. However, the vast majority of the widely publicized security vulnerabilities have been flaws in the implementations of TLS, not in the recent TLS protocols or algorithms themselves. Starting with UM version 6.9, there are no known security weaknesses in TLS version 1.2, the version used by UM.</p>
<p>TLS is generally implemented by several different software packages. UM makes use of OpenSSL, a widely deployed and actively maintained open-source project.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsauthentication"></a>
TLS Authentication&nbsp;&nbsp;<small><a href="#tlsauthentication">&lt;-</a></small></h3>
<p>TLS authentication uses X.509 digital certificates. Certificate creation and management is the responsibility of the user. Ultra Messaging's usage of OpenSSL expects PEM encoded certificates. There are a variety of generally available tools for converting certificates between different encodings. Since user infrastructures vary widely, the UM package does not include tools for creation, formatting, or management of certificates.</p>
<p>Although UM is designed as a peer-to-peer messaging system, TLS has the concept of client and server. The client initiates the TCP connection and the server accepts it. In the case of a TCP source, the receiver initiates and is therefore the client, with the source (sender of data) being the server. However, with unicast immediate messages, the sender of data is the client, and the recipient is the server. Due to the fact that unicast immediate messages are used by UM for internal control and coordination, it is typically not possible to constrain a given application to only operate as a pure client or pure server. For this reason, UM requires all applications participating in encryption to have a certificate. Server-only authentication (anonymous client, as is used by web browsers) is not supported. It is permissible for groups of processes, or even all processes, to share the same certificate.</p>
<p>A detailed discussion of certificate usage is beyond the scope of the Ultra Messaging documentation. However, you can find a step-by-step procedure for creating a self-signed X.509 security certificate here: <a href="https://kb.informatica.com/howto/6/Pages/18/432752.aspx">https://kb.informatica.com/howto/6/Pages/18/432752.aspx</a></p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsbackwardscompatibility"></a>
TLS Backwards Compatibility&nbsp;&nbsp;<small><a href="#tlsbackwardscompatibility">&lt;-</a></small></h3>
<p>The TLS protocol was designed to allow for a high degree of backwards compatibility. During the connection establishment phase, the client and server perform a negotiation handshake in which they identify the highest common versions of various security options. For example, an old web browser might pre-date the introduction of TLS and only support the older SSL protocol. OpenSSL is often configured to allow clients and servers to "negotiate down" to those older, less-secure protocols or algorithms.</p>
<p>Ultra Messaging has the advantage of not needing to communicate with old versions of SSL or TLS. UM's default configuration directs OpenSSL to require both the client and the server to use protocols and algorithms which were highly regarded, as of UM's release date. If vulnerabilities are discovered in the future, the user can override UM's defaults and chose other protocols or algorithms.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsefficiency"></a>
TLS Efficiency&nbsp;&nbsp;<small><a href="#tlsefficiency">&lt;-</a></small></h3>
<p>When a TLS connection is initiated, a handshake takes place prior to application data encryption. Once the handshake is completed, the CPU effort required to encrypt and decrypt application data is minimal. However, the handshake phase involves the use of much less efficient algorithms.</p>
<p>There are two factors under the user's control, which greatly affect the handshake efficiency: the choice of cipher suite and the key length. We have seen an RSA key of 8192 bits take 4 seconds of CPU time on a 1.3GHz SparcV9 processor just to complete the handshake for a single TLS connection.</p>
<p>Users should make their choices with an understanding of the threat profiles they are protecting against. For example, it is estimated that a 1024-bit RSA key can be broken in about a year by brute force using specialized hardware (see <a href="http://www.tau.ac.il/~tromer/papers/cbtwirl.pdf">http://www.tau.ac.il/~tromer/papers/cbtwirl.pdf</a>). This may be beyond the means of the average hacker, but well within the means of a large government. RSA keys of 2048 bits are generally considered secure for the foreseeable future.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsconfiguration"></a>
TLS Configuration&nbsp;&nbsp;<small><a href="#tlsconfiguration">&lt;-</a></small></h3>
<p>TLS is enabled on a context basis. When enabled, all Streaming and Persistence related TCP-based communication into or out of the context is encrypted by TLS. A context with TLS enabled will not accept source creation with transports other than TCP.</p>
<p>Subscribers will only successfully receive data if the receiver's context and the source's context share the same encryption settings. A receiver created in an encrypted enabled context will ignore topic resolution source advertisements for non-encrypted sources, and will therefore not subscribe. Similarly, a receiver created in a non-encrypted context will ignore topic resolution source advertisements for encrypted sources. Topic resolution queries are also ignored by mismatched contexts. No warning will be logged when these topic resolution datagrams are ignored, but each time this happens, the context-level statistic tr_dgrams_dropped_type is incremented.</p>
<p>TLS is applied to unicast immediate messages as well, as invoked either directly by the user, or internally by functions like late join, request/response, and Persistence-related communication between sources, receivers, and Stores.</p>
<p>Brokered Queuing using AMQP does not use the UM TLS feature. A UM brokered context does not allow TLS to be enabled.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsoptionssummary"></a>
TLS Options Summary&nbsp;&nbsp;<small><a href="#tlsoptionssummary">&lt;-</a></small></h3>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#usetlscontext">use_tls (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlsciphersuitescontext">tls_cipher_suites (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscertificatecontext">tls_certificate (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscertificatekeycontext">tls_certificate_key (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscertificatekeypasswordcontext">tls_certificate_key_password (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlstrustedcertificatescontext">tls_trusted_certificates (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscompressionnegotiationtimeoutcontext">tls_compression_negotiation_timeout (context)</a> </li>
</ul>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlsciphersuitescontext">tls_cipher_suites (context)</a> configuration option defines the list of one or more (comma separated) cipher suites that are acceptable to this context. If more than one is supplied, they should be in descending order of preference. When a remote context negotiates encrypted TCP, the two sides must find a cipher suite in common, otherwise the connection will be canceled.</p>
<p>OpenSSL uses the cipher suite to define the algorithms and key lengths for encrypting the data stream. The choice of cipher suite is critical for ensuring the security of the connection. To achieve a high degree of backwards compatibility, OpenSSL supports old cipher suites which are no longer considered secure. The user is advised to use UM's default suite.</p>
<p>OpenSSL follows its own naming convention for cipher suites. See OpenSSL's <a href="https://www.openssl.org/docs/manmaster/man1/openssl-ciphers.html#CIPHER-SUITE-NAMES">Cipher Suite Names</a> for the full list of suite names. When configuring UM, use the OpenSSL names (with dashes), not* the IANA names (with underscores).</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsandpersistence"></a>
TLS and Persistence&nbsp;&nbsp;<small><a href="#tlsandpersistence">&lt;-</a></small></h3>
<p>TLS is designed to encrypt a TCP connection, and works with TCP-based persisted data <a class="el" href="index.html#transportsessions">Transport Sessions</a> and control traffic. However, TLS is not intended to encrypt data at rest. When a persistent Store is used with the UM TLS feature, the user messages are written to disk in plaintext form, not encrypted.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsandqueuing"></a>
TLS and Queuing&nbsp;&nbsp;<small><a href="#tlsandqueuing">&lt;-</a></small></h3>
<p>The UM TLS feature does not apply to the AMQP connection to the brokered queue. UM does not currently support security on the AMQP connection.</p>
<p>However, the ULB form of queuing does not use a broker. For ULB sources that are configured for TCP, the UM TLS feature will encrypt the application data.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsandthedynamicroutingoptiondro"></a>
TLS and the DRO&nbsp;&nbsp;<small><a href="#tlsandthedynamicroutingoptiondro">&lt;-</a></small></h3>
<p>When a <a class="el" href="index.html#umrouter">DRO</a> is used to route messages across <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs), be aware that the TLS session is terminated at the DRO's proxy receiver/source. Because each endpoint portal on a DRO is implemented with its own context, care must be taken to ensure end-to-end security. It is possible to have a TLS source publishing in one TRD, received by a DRO (via an endpoint portal also configured for TLS), and re-published to a different TRD via an endpoint portal configured with a non-encrypted context. This would allow a non-encrypted receiver to access messages that the source intended to be encrypted. As a message is forwarded through a DRO network, it does not propagate the security settings of the originator, so each portal needs to be appropriately encrypted. The user is strongly encouraged to configure ALL portals on an interconnected network of DROs with the same encryption settings.</p>
<p>The encryption feature is extended to DRO peer links, however peer links are not context-based and are not configured the same way. The following XML elements are used by the DRO to configure a peer link:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementtls">Router Element "&lt;tls&gt;"</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementciphersuites">Router Element "&lt;cipher-suites&gt;"</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementcertificate">Router Element "&lt;certificate&gt;"</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementcertificatekey">Router Element "&lt;certificate-key&gt;"</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementcertificatekeypassword">Router Element "&lt;certificate-key-password&gt;"</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementtrustedcertificates">Router Element "&lt;trusted-certificates&gt;"</a> </li>
</ul>
<p>As with sources and receivers, the portals on both sides of a peer link must be configured for compatible encryption settings.</p>
<p>Notice that there is no DRO element corresponding to the context option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscompressionnegotiationtimeoutcontext">tls_compression_negotiation_timeout (context)</a>. The DRO peer link's negotiation timeout is hard-coded to 5 seconds.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#umrouterconfigurationdtd">DRO Configuration DTD</a> for details.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tlsandcompression"></a>
TLS and Compression&nbsp;&nbsp;<small><a href="#tlsandcompression">&lt;-</a></small></h3>
<p>Many users have advanced network equipment (switches/routers), which transparently compress packets as they traverse the network. This compression is especially valued to conserve bandwidth over long-haul WAN links. However, when packets are encrypted, the network compressors are typically not able to reduce the size of the data. If the user desires UM messages to be compressed and encrypted, the data needs to be compressed before it is encrypted.</p>
<p>The UM compression feature (see <a class="el" href="index.html#compressedtcp">Compressed TCP</a>) accomplishes this. When both TLS and compression are enabled, the compression is applied to user data first, then encryption.</p>
<p>Be aware that there can be information leakage when compression is applied and an attacker is able to inject data of known content over a compressed and encrypted session. For example, this leakage is exploited by the <a href="https://en.wikipedia.org/wiki/CRIME">CRIME</a> attack, albeit primarily for web browsers. Users must weigh the benefits of compression against the potential risk of information leakage.</p>
<p><b>Version Interoperability</b></p>
<p>It is not recommended to mix pre-6.9 contexts with encrypted contexts on topics of shared interest. If a process with a pre-6.9 version of UM creates a receiver, and another process with UM 6.9 or beyond creates a TLS source, the pre-6.9 receiver will attempt to join the TLS source. After a timeout, the handshake will fail and the source will disconnect. The pre-6.9 receiver will retry the connection, leading to flapping.</p>
<p>Note that in the reverse situation, a 6.9 TLS receiver will simply ignore a pre-6.9 source. No attempt will be made to join, and no flapping will occur.</p>
<p><br />
 </p>
<h3><a class="anchor" id="openssldependency"></a>
OpenSSL Dependency&nbsp;&nbsp;<small><a href="#openssldependency">&lt;-</a></small></h3>
<p>For UM versions 6.9 through 6.12, the UM dynamic library was linked with OpenSSL in such a way as to require its presence in order for UM to load and initialize. It was a load-time dependency.</p>
<p>Starting with UM version 6.12.1, the linkage with OpenSSL is made at run-time. If encryption features are not used, the OpenSSL libraries do not need to be present on the system. UM is able to initialize without OpenSSL.</p>
<p>There are two UM features which utilize encryption provided by OpenSSL: </p><ul>
<li>
<a class="el" href="index.html#encryptedtcp">Encrypted TCP</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umm.tag:../../UMM/" href="../../UMM/index.html#ummanageroverview">UM Manager (UMM)</a> with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umm.tag:../../UMM/" href="../../UMM/ummdaemonoverview.html#securingummdaemoncommunicationwithssl">secure communication</a> enabled. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="compressedtcp"></a>
Compressed TCP&nbsp;&nbsp;<small><a href="#compressedtcp">&lt;-</a></small></h2>
<p>This section introduces the use of Compression with TCP connections.</p>
<p>The goal of the Ultra Messaging (UM) compression feature is to decrease the size of transmitted application data. UM can be configured to apply compression to all Streaming and/or Persisted TCP communication.</p>
<p>Non-TCP communication is not compressed (e.g. topic resolution).</p>
<p>Compression is generally implemented by any of several different software packages. UM makes use of LZ4, a widely deployed open-source project.</p>
<p>While the UM compression feature is usable for TCP-based sources and receivers, it is possibly most useful when applied to <a class="el" href="index.html#umrouter">DRO</a> peer links.</p>
<p><br />
 </p>
<h3><a class="anchor" id="compressionconfiguration"></a>
Compression Configuration&nbsp;&nbsp;<small><a href="#compressionconfiguration">&lt;-</a></small></h3>
<p>Compression is enabled on a context basis. When enabled, all Streaming and Persistence related TCP-based communication into or out of the context is compressed by LZ4. A context with compression enabled will not accept source creation with transports other than TCP.</p>
<p>Subscribers will only successfully receive data if the receiver's context and the source's context share the same compression settings. A receiver created in a compression-enabled context will ignore topic resolution source advertisements for non-compressed sources, and will therefore not subscribe. Similarly, a receiver created in an non-compressed context will ignore topic resolution source advertisements for compressed sources. Topic resolution queries are also ignored by mismatched contexts. No warning will be logged when these topic resolution datagrams are ignored, but each time this happens, the context-level statistic tr_dgrams_dropped_type is incremented.</p>
<p>Compression is applied to unicast immediate messages as well, as invoked either directly by the user, or internally by functions like late join, request/response, and Persistence-related communication between sources, receivers, and Stores.</p>
<p>Brokered Queuing using AMQP does not use the UM compression feature. A UM brokered context does not allow compression to be enabled.</p>
<p>The compression-related configuration options used by the Ultra Messaging library are:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpcompressedtcp.html#compressioncontext">compression (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscompressionnegotiationtimeoutcontext">tls_compression_negotiation_timeout (context)</a> </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="compressionandpersistence"></a>
Compression and Persistence&nbsp;&nbsp;<small><a href="#compressionandpersistence">&lt;-</a></small></h3>
<p>Compression is designed to compress a data Transport Session. It is not intended to compress data at rest. When a persistent Store is used with the UM compression feature, the user messages are written to disk in uncompressed form.</p>
<p><br />
 </p>
<h3><a class="anchor" id="compressionandqueuing"></a>
Compression and Queuing&nbsp;&nbsp;<small><a href="#compressionandqueuing">&lt;-</a></small></h3>
<p>The UM compression feature does not apply to the AMQP connection to the brokered queue. UM does not currently support compression on the AMQP connection.</p>
<p>However, the ULB form of queuing does not use a broker. For ULB sources that are configured for TCP, the UM compression feature will compress the application data.</p>
<p><br />
 </p>
<h3><a class="anchor" id="compressionandthedynamicroutingoptiondro"></a>
Compression and the DRO&nbsp;&nbsp;<small><a href="#compressionandthedynamicroutingoptiondro">&lt;-</a></small></h3>
<p>When a DRO is used to route messages across <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs), be aware that the compression session is terminated at the DRO's proxy receiver/source. Because each endpoint portal on a DRO is implemented with its own context, care must be taken to ensure end-to-end compression (if desired). As a message is forwarded through a DRO network, it does not propagate the compression setting of the originator, so each portal needs to be appropriately compressed.</p>
<p>Possibly the most-useful application of the UM compression feature is not TCP sources, but rather DRO peer links. The compression feature is extended to DRO peer links, however peer links are not context-based and are not configured the same way. The following XML elements are used by the DRO to configure a peer link:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementcompression">Router Element "&lt;compression&gt;"</a> </li>
</ul>
<p>As with sources and receivers, the portals on both sides of a peer link must be configured for the same compression setting.</p>
<p>Notice that there is no DRO element corresponding to the context option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#tlscompressionnegotiationtimeoutcontext">tls_compression_negotiation_timeout (context)</a>. The DRO peer link's negotiation timeout is hard-coded to 5 seconds.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#umrouterconfigurationdtd">DRO Configuration DTD</a> for details.</p>
<p><br />
 </p>
<h3><a class="anchor" id="compressionandencryption"></a>
Compression and Encryption&nbsp;&nbsp;<small><a href="#compressionandencryption">&lt;-</a></small></h3>
<p>See <a class="el" href="index.html#tlsandcompression">TLS and Compression</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="versioninteroperability"></a>
Version Interoperability&nbsp;&nbsp;<small><a href="#versioninteroperability">&lt;-</a></small></h3>
<p>It is not recommended to mix pre-6.9 contexts with compressed contexts on topics of shared interest. As mentioned above, if a compressed and an uncompressed context connect via TCP, the connection will fail and retry, resulting in flapping.</p>
<p><br />
 </p>
<h2><a class="anchor" id="highresolutiontimestamps"></a>
High-resolution Timestamps&nbsp;&nbsp;<small><a href="#highresolutiontimestamps">&lt;-</a></small></h2>
<p>This section introduces the use of high-resolution timestamps with LBT-RM.</p>
<p>The Ultra Messaging (UM) high-resolution message timestamp feature leverages the hardware timestamping function of certain Solarflare network interface cards (NICs) to measure sub-microsecond times that packets are transmitted and received. Solarflare's NICs and Onload kernel-bypass driver implement PTP to synchronize timestamps across the network, allowing very accurate one-way latency measurements. The UM timestamp feature requires Onload version 201509 or later.</p>
<p>For subscribers, each message's receive timestamp is delivered in the message's header structure (for C programs, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aaa7a945411e63884f12918417e8d117c">lbm_msg_t</a> field <b>hr_timestamp</b>, of type <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a60ce419ca9bccc4d2b61b9acb70fe30e">lbm_timespec_t</a>). Each timestamp is a structure of 32 bits worth of seconds and 32 bits worth of nanoseconds. When both values are zero, the timestamp is not available.</p>
<p>For publishers, each message's transmit timestamp is delivered via the source event callback (for C programs, event type LBM_SRC_EVENT_TIMESTAMP). The same timestamp structure as above is delivered with the event, as well as the message's sequence number. Sending applications can be informed of the outgoing sequence number range of each message by using the extended form of the send function and supplying the LBM_SRC_SEND_EX_FLAG_SEQUENCE_NUMBER_INFO flag. This causes the LBM_SRC_EVENT_SEQUENCE_NUMBER_INFO event to be delivered to the source event handler.</p>
<p><br />
 </p>
<h3><a class="anchor" id="timestamprestrictions"></a>
Timestamp Restrictions&nbsp;&nbsp;<small><a href="#timestamprestrictions">&lt;-</a></small></h3>
<p>Due to the specialized nature of this feature, there are several restrictions in its use.</p>
<ul>
<li>
<b>Operating system</b>: Linux only. No timestamps will be delivered on other operating systems. Also, since the feature makes use of the rcvmmsg() function, no timestamps will be delivered on Linux kernels prior to 2.6.33 and glibc libraries prior to 2.12 (which was released in 2010). </li>
<li>
<b>Transport</b>: Source-based LBT-RM (multicast) Transport Sessions only. No timestamps will be delivered for MIM or other transport types. </li>
<li>
<b>Queuing</b>: Timestamps are not supported for broker-based queuing. If a ULB source is configured for LBT-RM, send-side timestamps are not supported and will not be delivered if one or more receivers are registered. However, on the receive side, ULB messages are time stamped. </li>
<li>
<b>Loss</b>: If packet loss triggers LBT-RM's NAK/retransmit sequence, the send side will have multiple timestamps delivered, one for each multicast transmission. On the receive side, the timestamp of the first successfully received multicast datagram will be delivered. </li>
<li>
<b>Recovery</b>: For missed messages which are recovered via Late Join, Off-Transport Recovery (OTR), or the persistent Store, no timestamp will be delivered, either on the send side or the receive side. </li>
<li>
<b>Implicit batching</b>: If implicit batching is being used, only the first message in a batch will have a send-side timestamp delivered. When implicit batching is used, the sender must be prepared for some messages to not have timestamps delivered. On the receive side, all messages in a batch will have the same timestamp. </li>
<li>
<b>UM Fragmentation, send-side</b>: If user messages are too large to be contained in a single datagram, UM will fragment the message into multiple datagrams. On the send side, each datagram will trigger delivery of a timestamp. <ul>
<li>
UM Fragmentation, receive-side with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> set to 0 (arrival): Arrival-order delivery will result in each fragment being delivered separately, as it is received. Each fragment's message header will contain a timestamp. Arrival order delivery provides an accurate timestamp of when the complete message is received (although, as mentioned above, any fragment recovered via OTR or the persistent Store will not have a timestamp). </li>
<li>
UM Fragmentation, receive-side with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> set to 1 or -1, (reassembly): Delivery with reassembly results in a single timestamp included in the message header. That timestamp corresponds to the arrival of the last fragment of the message (although, as mentioned above, any fragment recovered via OTR or the persistent Store will not have a timestamp). Note that this is not necessarily the last fragment received; if an intermediate datagram is lost and subsequently re-transmitted after a delay, that intermediate datagram will be the last one received, but its timestamp will not be used for the message. For example, if a three-fragment message is received in the order of F0, F2, F1, the timestamp for the message will correspond to F2, the last fragment of the message. If fragmented messages are being sent, and an accurate time of message completion is needed, arrival order delivery must be used. </li>
</ul>
</li>
<li>
<b>UM Fragmentation plus implicit batching</b>: If user messages vary widely in size, some requiring fragmentation, and implicit batching is used be aware that a full fragment does not completely fill a datagram. For example, if a small message (less than 300 bytes) is sent followed by a large message requiring fragmentation, the first fragment of the large message will fit in the same datagram as the small message. In that case, on the send side, a timestamp will not be delivered for that first fragment. However, a timestamp will be delivered for the second fragment. On the receive side, the same restrictions apply as described with UM fragmentation. </li>
<li>
<b>Local loopback</b>: If an LBT-RM source and receiver share the same physical machine, the receive side will not have timestamps delivered. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="timestampconfigurationsummary"></a>
Timestamp Configuration Summary&nbsp;&nbsp;<small><a href="#timestampconfigurationsummary">&lt;-</a></small></h3>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmsourcetimestampcontext">transport_lbtrm_source_timestamp (context)</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmreceivertimestampcontext">transport_lbtrm_receiver_timestamp (context)</a> </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="unicastimmediatemessaging"></a>
Unicast Immediate Messaging&nbsp;&nbsp;<small><a href="#unicastimmediatemessaging">&lt;-</a></small></h2>
<p>Unicast Immediate Messaging (UIM) deviates from the normal publish/subscribe paradigm by allowing the publisher to send messages to a specific destination application context. Various features within UM make use of UIMs transparently to the application. For example, a persistent receiver sends consumption acknowledgements to the Store using UIM messages.</p>
<p>The application can make direct use of UIM in two ways: </p><ul>
<li>
Calling a UIM send API function. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a>. </li>
<li>
Sending a response to a message using the <a class="el" href="index.html#requestresponse">Request/Response</a> feature. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a>. </li>
</ul>
<p>A UIM message can be associated with a topic string, but that topic is not used to determine where the message is sent to. Instead, the topic string is included in the message header, and the application must specify the destination of the desired context in the UIM send call.</p>
<p>Alternatively, an application can send a UIM message without a topic string. This so-called "topicless" message is not delivered to the receiving application via the normal receiver callback. Instead it is delivered by an optional context callback. See <a class="el" href="index.html#receivingauim">Receiving a UIM</a>.</p>
<p>UIM messages are sent using the TCP protocol; no other protocol is supported for UIM. The TCP connection is created dynamically as-needed, when a message is sent. That is, when an application sends its first UIM message to a particular destination context, the sender's context holds the message and initiates the TCP connection. When the connection is accepted by the destination context, the sender sends the message. When the message is fully sent, the sender will keep the TCP connection open for a period of time in case more UIMs are sent to the same destination context. See <a class="el" href="index.html#uimconnectionmanagement">UIM Connection Management</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="uimreliability"></a>
UIM Reliability&nbsp;&nbsp;<small><a href="#uimreliability">&lt;-</a></small></h3>
<p>Although UIM is implemented using TCP, it should not be considered "reliable" in the same way that UM sources are. There are a variety of ways that a UIM message can fail to be delivered to the destination. For example, if an overloaded DRO must forward the message to the destination TRD, the DRO might have to drop the message.</p>
<p>Note that the success or failure of delivery of a UIM cannot be determined by the sender. For example, calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a> might return a successful status, but the message might have been queued internally for later transmission. So the success status only means that it was queued successfully. A subsequent failure may or may not trigger an error log; it depends on what the nature of the failure is.</p>
<p>As a result, applications are responsible for detecting failures (typically using timeouts) and implementing retry logic. If a higher degree of messaging reliability is required, normal UM sources should be used.</p>
<p>(For UIM messages that are sent transparently by UM features, various timeout/retry mechanisms are implemented internally.)</p>
<p>UIMs can also be lost as a result of TCP disconnections. See <a class="el" href="index.html#tcpdisconnections">TCP Disconnections</a> for more information.</p>
<p><br />
 </p>
<h3><a class="anchor" id="uimaddressing"></a>
UIM Addressing&nbsp;&nbsp;<small><a href="#uimaddressing">&lt;-</a></small></h3>
<p>There are three ways to specify the destination address of a UIM: </p><ul>
<li>
Implicit &ndash; this method is used when a response is sent using the <a class="el" href="index.html#requestresponse">Request/Response</a> feature. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a> for details. </li>
<li>
Explicit &ndash; this method uses a string of the form: "TCP:ip:port" (no DRO) or "TCP:domain:ip:port" (DRO in use). See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> for details. </li>
<li>
Source &ndash; this method uses a source string to send messages to the context which hosts a given source. See <a class="el" href="index.html#sendingtosources">Sending to Sources</a> for details. </li>
</ul>
<p>In the Explicit addressing method, the "ip" and "port" refer to the binding of the destination context's UIM port (also called "request port"). By default, when a context is created, UM will select values from a range of possibilities for ip and port. However, this makes it difficult for a sender to construct an explicit address since the ip and port are not deterministic.</p>
<p>One solution is to explicitly set the ip and port for the context's UIM port using the configuration options: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpportcontext">request_tcp_port (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpinterfacecontext">request_tcp_interface (context)</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receivingauim"></a>
Receiving a UIM&nbsp;&nbsp;<small><a href="#receivingauim">&lt;-</a></small></h3>
<p>There are two kinds of UIM messages: </p><ul>
<li>
UIMs with a topic. </li>
<li>
UIMs with no topic (topicless). </li>
</ul>
<p>To receive UIM messages with a topic, an application simply creates a normal receiver for that topic. Alternatively, it can create a wildcard receiver for a matching topic pattern. Finally, the application can also register a callback specifically for UIM messages that contain a topic but for which no matching receiver exists, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagetopicreceiverfunctioncontext">immediate_message_topic_receiver_function (context)</a>. Alternatively, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abdefbb3bd3ff3a3b2ec6e20ca2f5dc19">lbm_context_rcv_immediate_topic_msgs()</a> can be used.</p>
<p>To receive UIM messages with no topic (topicless), the application must register a callback with the context for topicless messages, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagereceiverfunctioncontext">immediate_message_receiver_function (context)</a>). Alternatively, the API <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a374f135dddf7794130509f97b1e96cf8">lbm_context_rcv_immediate_msgs()</a> can be used to register that callback.</p>
<p>Note that only the specified destination context will deliver the message. If other applications have a receiver for that same topic, they will not receive a copy of that UIM message.</p>
<p><b>UIM Port</b></p>
<p>To receive UIMs, a context must bind to and listen on the "UIM Port", also known as the "Request Port". See <a class="el" href="index.html#uimaddressing">UIM Addressing</a> for details.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sendingauim"></a>
Sending a UIM&nbsp;&nbsp;<small><a href="#sendingauim">&lt;-</a></small></h3>
<p>The following APIs are used to send application UIM messages: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a> &ndash; see <a class="el" href="index.html#requestresponse">Request/Response</a> for more information. </li>
<li>
</li>
</ul>
<p>For the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a> APIs, the user has a choice between sending messages with a topic or without a topic (topicless). With the C API, passing a NULL pointer for the topic string sends a topicless message.</p>
<p><br />
 </p>
<h3><a class="anchor" id="uimconnectionmanagement"></a>
UIM Connection Management&nbsp;&nbsp;<small><a href="#uimconnectionmanagement">&lt;-</a></small></h3>
<p>The act of sending a UIM message will check to see if the context already has a TCP connection open to the destination context. If so, the existing connection is used to send the UIM. Otherwise, UM will initiate a new TCP connection to the destination context.</p>
<p>Once the message is sent, an activity deletion timer is started for the connection; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#responsetcpdeletiontimeoutcontext">response_tcp_deletion_timeout (context)</a>. If another UIM message is sent to the same destination, the activity deletion timer is canceled and restarted. Thus, if messages are sent periodically with a shorter period than the activity deletion timer, the TCP connection will remain established.</p>
<p>However, if no messages are sent for more time than the activity deletion timer, the timer will expire and the TCP connection will be deleted and resources cleaned up.</p>
<p>An exception to this workflow exists for the <a class="el" href="index.html#requestresponse">Request/Response</a> feature. When a request message is received by a context, the context automatically initiates a connection to the requester, even though the application has not yet sent its response UIM. The activity deletion timer is not started at this time. When the application's receiver callback is invoked with the request message, the message contains a reference to a response object. This response object is used for sending response UIMs back to the requester. However, the act of sending these responses also does not start the activity deletion timer for the TCP connection. The activity deletion timer is only started when the response object is deleted (usually implicitly when the message itself is deleted, usually as a result of returning from the receiver callback).</p>
<p>Note that the application that receives a request has the option of retaining the message, which delays deletion of the message until the application explicitly decides to delete it. In this case, the TCP connection is held open for as long as the application retains the response object. When the application has finished sending any and all of its responses to the request and does not need the request object any more, it deletes the request object. This starts the activity deletion timer running.</p>
<p>Finally, note that there is a queue in front of the UIM connection which holds messages when the connection is slow. It is possible that messages are still held in the queue for transmission after the response object is deleted, and if the response message is very large and/or the destination application is slow processing responses, it is possible for data to still be queued when the activity deletion timer expires. In that case, UM does <em>not</em> delete the TCP connection, and instead restarts the activity deletion timer for the connection.</p>
<p><br />
 </p>
<h2><a class="anchor" id="multicastimmediatemessaging"></a>
Multicast Immediate Messaging&nbsp;&nbsp;<small><a href="#multicastimmediatemessaging">&lt;-</a></small></h2>
<dl class="section warning"><dt>Warning</dt><dd>Multicast Immediate Messaging (MIM) is not recommended for general use. It is inefficient and can affect the operation of all applications on a UM network. This is partly because every message sent via the MIM protocol is distributed to <em>every</em> other application on the network, regardless of that application's interest in such messages.</dd></dl>
<p>MIM uses the same reliable multicast protocol as normal LBT-RM sources. MIM messages can be sent to a topic, in which case each receiving context will filter that message, discarding it if no receiver exists for that topic. MIM avoids using Topic Resolution by including the full topic string in the message, and sending it to a multicast group that all application contexts are configured to use.</p>
<dl class="section attention"><dt>Attention</dt><dd>MIM reception is disabled by default. If you want an application to be able to receive MIM messages, you must set the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingnetwork.html#mimaddresscontext">mim_address (context)</a> to the desired multicast group address.</dd></dl>
<p>A receiving context will receive the message and check to see if the application created a receiver for the topic. If so, then the message is delivered. However, if no receiver exists for that topic, the context checks to see if <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagetopicreceiverfunctioncontext">immediate_message_topic_receiver_function (context)</a> is configured. If so, then the message is delivered. But if neither exists, then the receiving context discards the message.</p>
<p>It is also possible to send a "topicless" message via MIM. The recipient context must have configured a topicless receiver using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagereceiverfunctioncontext">immediate_message_receiver_function (context)</a>; otherwise the message is discarded.</p>
<p>A valid use case for MIM might be an application that starts running, sends a request message, gets back a response, and then exits. With this kind of short-lived application, it can be a burden to create a source and wait for it to resolve. With MIM, topic resolution is skipped, so no delay is needed prior to sending.</p>
<p>MIM is typically not used for normal Streaming data because messages are somewhat less efficiently handled than source-based messages. Inefficiencies derive from larger message sizes due to the inclusion of the topic name, and on the receiving side, the MIM Delivery Controller hashing of topic names to find receivers, which consumes some extra CPU. If you have a high-message-rate stream, you should use a source-based method and not MIM. If head-loss is a concern and delay before sending is not feasible, then consider using late join (although this replaces head-loss with some head latency).</p>
<p>Multicast Immediate Messaging can benefit from hardware acceleration. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html">Transport Acceleration Options</a> for more information</p>
<dl class="section note"><dt>Note</dt><dd>MIM is not compatible with Queuing, including ULB.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="temporarytransportsession"></a>
Temporary Transport Session&nbsp;&nbsp;<small><a href="#temporarytransportsession">&lt;-</a></small></h3>
<p>MIM uses the same reliable multicast algorithms as LBT-RM. When a publisher sends a message with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a24e5bff3a70e571bb12024af67b47cbb">lbm_multicast_immediate_message()</a>, MIM creates a temporary Transport Session. Note that no topic-level source object is created.</p>
<p>MIM automatically deletes the temporary Transport Session after a period of inactivity defined by <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#mimsrcdeletiontimeoutcontext">mim_src_deletion_timeout (context)</a> which defaults to 30 seconds. A subsequent send creates a new Transport Session. Due to the possibility of head-loss in the switch, it is recommended that publisher use a long deletion timeout if they continue to use MIM after significant periods of inactivity.</p>
<p>MIM forces all topics across all publishers to be concentrated onto a single multicast address to which ALL applications listen, even if they aren't interested in any of the topics. Thus, all topic filtering must happen in UM.</p>
<p>MIM can also be used to send an UM request message with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a54f3933e4dd154a9c7bb72598d0d9ef1">lbm_multicast_immediate_request()</a>. For example, an application can use MIM to request initialization information right when it starts up. MIM sends the response directly to the initializing application, avoiding the topic resolution delay inherent in the normal source-based <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad4d06f66b8404684e191ca178e0cc09b">lbm_send_request()</a> function.</p>
<p><br />
 </p>
<h3><a class="anchor" id="mimnotifications"></a>
MIM Notifications&nbsp;&nbsp;<small><a href="#mimnotifications">&lt;-</a></small></h3>
<p>MIM notifications differ in the following ways from normal UM source-based sending.</p>
<ul>
<li>
When a publisher's MIM Transport Session times out and is deleted, the receiving applications do not receive an EOS notification. </li>
<li>
Applications with a source notification callback (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#resolversourcenotificationfunctioncontext">resolver_source_notification_function (context)</a>) are not informed of a MIM sender. This is because source notification is based on Topic Resolution, and MIM does not use it. </li>
<li>
MIM sending supports the non-blocking flag. However, it does not provide an <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa905cb268bbee255c71b74694370fe61">LBM_SRC_EVENT_WAKEUP</a> notification when the MIM session becomes writable again. </li>
<li>
MIM sends unrecoverable loss notifications to a context callback, not to a receiver callback. See <a class="el" href="index.html#mimlosshandling">MIM Loss Handling</a>. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="receivingimmediatemessages"></a>
Receiving Immediate Messages&nbsp;&nbsp;<small><a href="#receivingimmediatemessages">&lt;-</a></small></h3>
<p>To receive MIM messages with a topic, an application simply creates a normal receiver for that topic. Alternatively, it can create a wildcard receiver for a matching topic pattern. Finally, the application can also register a callback specifically for UIM messages that contain a topic but for which no matching receiver exists, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagetopicreceiverfunctioncontext">immediate_message_topic_receiver_function (context)</a>. Alternatively, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abdefbb3bd3ff3a3b2ec6e20ca2f5dc19">lbm_context_rcv_immediate_topic_msgs()</a> can be used.</p>
<p>To receive MIM messages with no topic (topicless), the application must register a callback for topicless messages, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagereceiverfunctioncontext">immediate_message_receiver_function (context)</a>). Alternatively, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a374f135dddf7794130509f97b1e96cf8">lbm_context_rcv_immediate_msgs()</a> can be used.</p>
<p>If needed, an application can send topicless messages using MIM. A MIM sender passes in a NULL string instead of a topic name. The message goes out on the MIM multicast address and is received by all other receivers. A receiving application can use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a374f135dddf7794130509f97b1e96cf8">lbm_context_rcv_immediate_msgs()</a> to set the callback procedure and delivery method for topicless immediate messages.</p>
<p><br />
 </p>
<h3><a class="anchor" id="mimandwildcardreceivers"></a>
MIM and Wildcard Receivers&nbsp;&nbsp;<small><a href="#mimandwildcardreceivers">&lt;-</a></small></h3>
<p>When an application receives an immediate message, it's topic is hashed to see if there is at least one regular (non-wildcard) receiver object listening to the topic. If so, then MIM delivers the message data to the list of receivers.</p>
<p>However, if there are no regular receivers for that topic in the receive hash, MIM runs the message topic through all existing wildcard patterns and delivers matches to the appropriate wildcard receiver objects without creating sub-receivers. The next MIM message received for the same topic will again be run through all existing wildcard patterns. This can consume significant CPU resources since it is done on a per-message basis.</p>
<p><br />
 </p>
<h3><a class="anchor" id="mimlosshandling"></a>
MIM Loss Handling&nbsp;&nbsp;<small><a href="#mimlosshandling">&lt;-</a></small></h3>
<p>The receiving application can set up a context callback to be notified of MIM unrecoverable loss (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a7129f39b95974676e0ca74d88f58c498">lbm_mim_unrecloss_function_cb()</a>). It is not possible to do this notification on a topic basis because the receiving UM has no way of knowing which topics were affected by the loss.</p>
<p><br />
 </p>
<h3><a class="anchor" id="mimconfiguration"></a>
MIM Configuration&nbsp;&nbsp;<small><a href="#mimconfiguration">&lt;-</a></small></h3>
<ul>
<li>
Starting with UM 3.1, MIM supports ordered delivery. </li>
<li>
Starting with UM 3.3.2, the MIM configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#mimordereddeliverycontext">mim_ordered_delivery (context)</a> defaults to ordered delivery. </li>
<li>
<b>IMPORTANT:</b> Starting with UM 6.8, MIM reception is disabled by default. If you want an application to be able to receive MIM messages, you must set the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingnetwork.html#mimaddresscontext">mim_address (context)</a> to the desired multicast group address. </li>
</ul>
<p>The configuration options for MIM are described here:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingnetwork.html">Multicast Immediate Messaging Network Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingreliability.html">Multicast Immediate Messaging Reliability Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html">Multicast Immediate Messaging Operation Options</a> </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="mimexampleapplications"></a>
MIM Example Applications&nbsp;&nbsp;<small><a href="#mimexampleapplications">&lt;-</a></small></h3>
<p>UM includes two example applications that illustrate MIM.</p>
<ul>
<li>
<p class="startli"><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmimsg_c">Example lbmimsg.c</a> - application that sends immediate messages as fast as it can to a given topic (single source). See also the Java example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmimsg_java">Example lbmimsg.java</a>, and the .NET example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmimsg_cs">Example lbmimsg.cs</a>.</p>
<p class="endli"></p>
</li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmireq_c">Example lbmireq.c</a> - application that sends immediate requests to a given topic (single source) and waits for responses. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="hypertopics"></a>
HyperTopics&nbsp;&nbsp;<small><a href="#hypertopics">&lt;-</a></small></h2>
<dl class="section warning"><dt>Warning</dt><dd><b>The HyperTopics feature is deprecated and may be removed in a future release</b>. Users should use normal wildcard receivers with "PCRE" regular expression pattern matching. See <a class="el" href="index.html#umwildcardreceivers">UM Wildcard Receivers</a>.</dd></dl>
<p>For information regarding HyperTopics, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/chypertopicsdetails.html">C HyperTopics Details</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="applicationheaders"></a>
Application Headers&nbsp;&nbsp;<small><a href="#applicationheaders">&lt;-</a></small></h2>
<p>The Application Headers feature is an older method of adding untyped, unstructured metadata to messages.</p>
<dl class="section warning"><dt>Warning</dt><dd>The Application Headers feature is deprecated and may be removed in a future version. Informatica recommends using <a class="el" href="index.html#messageproperties">Message Properties</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="applicationheadersusage"></a>
Application Headers Usage&nbsp;&nbsp;<small><a href="#applicationheadersusage">&lt;-</a></small></h3>
<p><b>Send Message with Application Headers</b></p>
<p>To send a message with one or more application headers attached, follow these steps: </p><ol>
<li>
<p class="startli">Create an application header chain object using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40a3fe706dc6cf4a6bd23ebe721ce636">lbm_apphdr_chain_create()</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8b5f5e773cf27c0b55f7685c3b8c223f">lbm_apphdr_chain_t</a> *chain_obj;</div><div class="line">...</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40a3fe706dc6cf4a6bd23ebe721ce636">lbm_apphdr_chain_create</a>(&amp;chain_obj);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Declare a chain element structure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5ea92c8be5a30771d27a5c5ba7ba9cd3">lbm_apphdr_chain_elem_t</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html">lbm_apphdr_chain_elem_t</a> chain_el;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#adc95068fade7a25378777e4fed6d2c00">lbm_apphdr_chain_elem_t_stct::type</a> to LBM_CHAIN_ELEM_USER_DATA. </li>
<li>
Set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a1bac3b4b4c8736d83037489b39fd6a26">lbm_apphdr_chain_elem_t_stct::subtype</a> to a desired integer. </li>
<li>
Set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a819089b2849cb394d8e3e16a03bcf83d">lbm_apphdr_chain_elem_t_stct::data</a> to point to the desired bytes of data. </li>
<li>
<p class="startli">Set <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#ae10daab41bc205bb5c596f8479e0b3c4">lbm_apphdr_chain_elem_t_stct::len</a> to the number of bytes of data.</p>
<div class="fragment"><div class="line">chain_el.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#adc95068fade7a25378777e4fed6d2c00">type</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a37233effa75b0b79c0ad518010a96646">LBM_CHAIN_ELEM_USER_DATA</a>;</div><div class="line">chain_el.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a1bac3b4b4c8736d83037489b39fd6a26">subtype</a> = MY_SUBTYPE;</div><div class="line">chain_el.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a819089b2849cb394d8e3e16a03bcf83d">data</a> = <span class="stringliteral">&quot;abc&quot;</span>;</div><div class="line">chain_el.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#ae10daab41bc205bb5c596f8479e0b3c4">len</a> = 4;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Declare an extended send information structure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a21504de56612c7c6e4be655402b47a37">lbm_src_send_ex_info_t</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html">lbm_src_send_ex_info_t</a> ex_info;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a71368905028cc0d6480c239a0228b49c">LBM_SRC_SEND_EX_FLAG_APPHDR_CHAIN</a> bit in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#aa450a079510ebdc97b19625d10bd18ea">lbm_src_send_ex_info_t_stct::flags</a> field. </li>
<li>
<p class="startli">Set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#ab5d177886b035d3cbbb730c522bee207">lbm_src_send_ex_info_t_stct::apphdr_chain</a> field with the application header chain object created in step 1.</p>
<div class="fragment"><div class="line">memset(&amp;ex_info, 0, <span class="keyword">sizeof</span>(ex_info));</div><div class="line">ex_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#aa450a079510ebdc97b19625d10bd18ea">flags</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a71368905028cc0d6480c239a0228b49c">LBM_SRC_SEND_EX_FLAG_APPHDR_CHAIN</a>;</div><div class="line">ex_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#ab5d177886b035d3cbbb730c522bee207">apphdr_chain</a> = chain_obj;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a> passing the extended send information structure.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex</a>(src, my_buffer, my_len, LBM_MSG_FLUSH, &amp;ex_info)</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Delete the application header chain object using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f468c363d3d1735507be95fe4638d09">lbm_apphdr_chain_delete()</a>.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4f468c363d3d1735507be95fe4638d09">lbm_apphdr_chain_delete</a>(chain_obj);</div></div><!-- fragment --> </li>
</ol>
<p>Instead of creating and deleting the application header chain with each message, it may be retained and re-used. However, it may not be modified.</p>
<p><b>Receive Message with Application Headers</b></p>
<p>To handle a received message that may contain application headers, follow these steps:</p>
<ol>
<li>
<p class="startli">In the receiver callback, create an application header iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a316dcfdb28460ee670cc6399d6d94b9f">lbm_apphdr_chain_iter_create_from_msg()</a>. If it returns LBM_FAILURE then the message has no application headers.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a73c7309003ea3c7588b7997e325b35f4">lbm_apphdr_chain_iter_t</a> *apphdr_itr;</div><div class="line">...</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a316dcfdb28460ee670cc6399d6d94b9f">lbm_apphdr_chain_iter_create_from_msg</a>(&amp;apphdr_itr, msg);</div><div class="line"><span class="keywordflow">if</span> (err == LBM_OK) {  <span class="comment">/* App header exists. */</span></div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">If <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a316dcfdb28460ee670cc6399d6d94b9f">lbm_apphdr_chain_iter_create_from_msg()</a> returns LBM_OK, declare a chain element structure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5ea92c8be5a30771d27a5c5ba7ba9cd3">lbm_apphdr_chain_elem_t</a> pointer and set it using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adb432d65e72c04a7d5866bed9961e673">lbm_apphdr_chain_iter_current()</a>.</p>
<div class="fragment"><div class="line"><span class="keywordflow">do</span> {  <span class="comment">/* Loop through each app header. */</span></div><div class="line">  <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html">lbm_apphdr_chain_elem_t</a> *chain_el;</div><div class="line">  chain_el = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adb432d65e72c04a7d5866bed9961e673">lbm_apphdr_chain_iter_current</a>(&amp;apphdr_itr);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Access the chain element subtype through the chain element structure using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a1bac3b4b4c8736d83037489b39fd6a26">lbm_apphdr_chain_elem_t_stct::subtype</a>. </li>
<li>
Access the chain element length through the chain element structure using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#ae10daab41bc205bb5c596f8479e0b3c4">lbm_apphdr_chain_elem_t_stct::len</a>. </li>
<li>
<p class="startli">Access the chain element data through the chain element structure using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a819089b2849cb394d8e3e16a03bcf83d">lbm_apphdr_chain_elem_t_stct::data</a>.</p>
<div class="fragment"><div class="line">printf(<span class="stringliteral">&quot;  chain_el.type=%d, chain_el.len=%lu, chain_el.data=&#39;%s&#39;\n&quot;</span>,</div><div class="line">       chain_el-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#adc95068fade7a25378777e4fed6d2c00">type</a>, chain_el-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#ae10daab41bc205bb5c596f8479e0b3c4">len</a>, (<span class="keywordtype">char</span> *)chain_el-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__apphdr__chain__elem__t__stct.html#a819089b2849cb394d8e3e16a03bcf83d">data</a>);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">To step to the next application header (if any), call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6729d5b35c12874bc82be08ce708339a">lbm_apphdr_chain_iter_next()</a>. This function returns LBM_OK if there is another application header; go to step 3.</p>
<div class="fragment"><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6729d5b35c12874bc82be08ce708339a">lbm_apphdr_chain_iter_next</a>(&amp;apphdr_itr);</div><div class="line"><span class="keywordflow">while</span> (err == LBM_OK);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
If there are no more application headers, it returns LBM_FAILURE. </li>
<li>
<p class="startli">Delete the iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2fe460bfd35bf3d9f492dae02a08e77c">lbm_apphdr_chain_iter_delete()</a>.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2fe460bfd35bf3d9f492dae02a08e77c">lbm_apphdr_chain_iter_delete</a>(apphdr_itr);</div></div><!-- fragment --> </li>
</ol>
<p>Application Headers are not compatible with the following UM features: </p><ul>
<li>
<a class="el" href="index.html#smartsources">Smart Sources</a>. </li>
<li>
<a class="el" href="index.html#requestresponse">Request/Response</a> </li>
<li>
<a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> </li>
<li>
<a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a> </li>
</ul>
<p>Note that the user data provided for the application header is not typed. UM cannot reformat messages for architectural differences in a heterogeneous environment. For example, UM does not do byte-swapping between big and little endian CPUs.</p>
<p><br />
 </p>
<h2><a class="anchor" id="messageproperties"></a>
Message Properties&nbsp;&nbsp;<small><a href="#messageproperties">&lt;-</a></small></h2>
<p>The Message Properties feature allows your application to add typed metadata to messages as name/value pairs. UM allows eight property types: boolean, byte, short, int, long, float, double, and string. See <a class="el" href="index.html#messagepropertiesdatatypes">Message Properties Data Types</a>.</p>
<p>With the UMQ product, the UM message property object supports the standard JMS message properties specification.</p>
<p><b>Message properties are not compatible with the following UM features:</b> </p><ul>
<li>
<a class="el" href="index.html#arrivalorderfragmentsnotreassembled">Arrival Order, Fragments Not Reassembled</a> (ordered_delivery 0). </li>
<li>
<a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a>. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="messagepropertiesusage"></a>
Message Properties Usage&nbsp;&nbsp;<small><a href="#messagepropertiesusage">&lt;-</a></small></h3>
<p><b>Send Message with Message Properties</b></p>
<p>For sending messages with message properties using Smart Sources, see <a class="el" href="index.html#smartsourcesandmessageproperties">Smart Sources and Message Properties</a>.</p>
<p>To send a message with one or more message properties attached using normal sources (not Smart Sources), follow these steps:</p>
<ol>
<li>
<p class="startli">Create a message properties object using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abda1a4224f1c3e94b10b74051be3dd53">lbm_msg_properties_create()</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9155c3d6d70b67c426089d53b3eacaac">lbm_msg_properties_t</a> *prop_obj;</div><div class="line">...</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abda1a4224f1c3e94b10b74051be3dd53">lbm_msg_properties_create</a>(&amp;prop_obj);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Add one or more properties using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acec18484fc06996fe3b61e76a593d5fb">lbm_msg_properties_set()</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5dfd61ade99cd24213125c293b15ef4a">lbm_uint32_t</a> int_prop_val = MY_VAL;</div><div class="line">...</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acec18484fc06996fe3b61e76a593d5fb">lbm_msg_properties_set</a>(prop_obj, <span class="stringliteral">&quot;My Prop 1&quot;</span>, &amp;int_prop_val,</div><div class="line">                             LBM_MSG_PROPERTY_INT, <span class="keyword">sizeof</span>(int_prop_val));</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Declare an extended send information structure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a21504de56612c7c6e4be655402b47a37">lbm_src_send_ex_info_t</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html">lbm_src_send_ex_info_t</a> ex_info;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a169eb19b58d383875b718117b2def6e5">LBM_SRC_SEND_EX_FLAG_PROPERTIES</a> bit in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#aa450a079510ebdc97b19625d10bd18ea">lbm_src_send_ex_info_t_stct::flags</a> field. </li>
<li>
<p class="startli">Set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#a69ae228b9501f0466bfec8da2a479cbf">lbm_src_send_ex_info_t_stct::properties</a> field with the properties object created in step 1.</p>
<div class="fragment"><div class="line">memset(&amp;ex_info, 0, <span class="keyword">sizeof</span>(ex_info));</div><div class="line">ex_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#aa450a079510ebdc97b19625d10bd18ea">flags</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a169eb19b58d383875b718117b2def6e5">LBM_SRC_SEND_EX_FLAG_PROPERTIES</a>;</div><div class="line">ex_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#a69ae228b9501f0466bfec8da2a479cbf">properties</a> = prop_obj;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a> passing the extended send information structure.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex</a>(src, my_buffer, my_len, LBM_MSG_FLUSH, &amp;ex_info);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Delete the message properties object using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a80152f12d64394821a61287e99c5db33">lbm_msg_properties_delete()</a>.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a80152f12d64394821a61287e99c5db33">lbm_msg_properties_delete</a>(prop_obj);</div></div><!-- fragment --> </li>
</ol>
<p>Instead of creating and deleting the properties object with each message, it may be retained and re-used. It can also be modified using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aaea0bf981a9fe47287db442026ca13ca">lbm_msg_properties_clear()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acec18484fc06996fe3b61e76a593d5fb">lbm_msg_properties_set()</a>.</p>
<p><b>Receive Message with Message Properties</b></p>
<p>To handle a received message that may contain message properties, follow these steps:</p>
<ol>
<li>
<p class="startli">In the receiver callback, check the message's properties field <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ae494fd38e1139a128d58616fa9d2e439">lbm_msg_t_stct::properties</a>. If it is NULL, the message has no properties.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (msg-&gt;properties != NULL) {</div><div class="line">  <span class="comment">/* Handle message properties. */</span></div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">If <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ae494fd38e1139a128d58616fa9d2e439">lbm_msg_t_stct::properties</a> is non-null, create a property iterator object using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa08b2aa8f00b1b97c6d496834a4432dd">lbm_msg_properties_iter_create()</a>.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html">lbm_msg_properties_iter_t</a> *prop_itr;</div><div class="line">...</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa08b2aa8f00b1b97c6d496834a4432dd">lbm_msg_properties_iter_create</a>(&amp;prop_itr);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Set the iterator to the first property in the message using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acfa02c8316e97baeb9894daa991ef1fb">lbm_msg_properties_iter_first()</a>.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acfa02c8316e97baeb9894daa991ef1fb">lbm_msg_properties_iter_first</a>(prop_itr, msg-&gt;properties);</div><div class="line"><span class="keywordflow">do</span> {  <span class="comment">/* Loop through the properties. */</span></div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Access that property's name through the iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html#ab65ef874c567498e4b7c574d25fb6b64">lbm_msg_properties_iter_t_stct::name</a>. </li>
<li>
Access that property's type through the iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html#a0b96a99d0c7a3ffe64a8607f9497abb8">lbm_msg_properties_iter_t_stct::type</a>. </li>
<li>
<p class="startli">Access that property's value through the iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html#ab69a16304cbd0e23b3da0bb7c5312b97">lbm_msg_properties_iter_t_stct::data</a> (must be cast to the appropriate data type).</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (prop_itr-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html#a0b96a99d0c7a3ffe64a8607f9497abb8">type</a> == LBM_MSG_PROPERTY_INT) {</div><div class="line">  printf(<span class="stringliteral">&quot;  prop_itr.data=%d\n&quot;</span>, *((<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5dfd61ade99cd24213125c293b15ef4a">lbm_uint32_t</a> *)(prop_itr-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__properties__iter__t__stct.html#ab69a16304cbd0e23b3da0bb7c5312b97">data</a>)));</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">To step to the next property (if any), call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2876985a82c92ade238b8196a1ec3da7">lbm_msg_properties_iter_next()</a>. This function returns LBM_OK if there is another property; go to step 4. If there are no more properties, it returns LBM_FAILURE.</p>
<div class="fragment"><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2876985a82c92ade238b8196a1ec3da7">lbm_msg_properties_iter_next</a>(prop_itr);</div><div class="line">} <span class="keywordflow">while</span> (err == LBM_OK);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Delete the iterator using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a79db125bc40762da0b462c70f9e8c4b4">lbm_msg_properties_iter_delete()</a>.</p>
<div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a79db125bc40762da0b462c70f9e8c4b4">lbm_msg_properties_iter_delete</a>(prop_itr);</div></div><!-- fragment --> </li>
</ol>
<p>Instead of iterating through the properties, it is also possible to access properties by name using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aac0dc50537a458d2a2ca418a394fd21b">lbm_msg_properties_get()</a>. However, this can be less efficient.</p>
<p>For a C example on how to iterate received message properties, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmrcv_c">Example lbmrcv.c</a>.</p>
<p>Note that if a publisher sends a message with no properties set, best practice is to not pass the property object to the send function. It is permissible to pass a property object with no properties set, but it adds latency and overhead. Also, it causes the receiver to get a non-null msg-&gt;properties field. When the receiver calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acfa02c8316e97baeb9894daa991ef1fb">lbm_msg_properties_iter_first()</a>, it will return an error because there isn't a "first" property. It is better for the publisher to not pass an empty properties object so that the receiver will get a NULL msg-&gt;properties field.</p>
<p><br />
 </p>
<h3><a class="anchor" id="messagepropertiesdatatypes"></a>
Message Properties Data Types&nbsp;&nbsp;<small><a href="#messagepropertiesdatatypes">&lt;-</a></small></h3>
<p>Due to differences in the integer variable sizes on different compilers on different platforms, Informatica recommends using the following C data types for the corresponding message property data types:</p>
<table class="doxtable">
<tr>
<th>Property Type </th><th>C Type </th></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ade4e8a8380aead4cecd99d34074febd2">LBM_MSG_PROPERTY_BOOLEAN</a> </td><td>char </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3bc28e91b1571e511d7bf5f8c101cc43">LBM_MSG_PROPERTY_BYTE</a> </td><td>char </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acac3a9e4b1dc7d3d9f1d42acabbcd514">LBM_MSG_PROPERTY_SHORT</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a86897f2fdd66aa7021683a4e72a4537b">lbm_uint16_t</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a77a1d3090e2e8e1dce799ae56859ce47">LBM_MSG_PROPERTY_INT</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9b7c2c2a29915efc7ead2ff7f58f6f59">lbm_int32_t</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aac5202e17486cd42934756b8be785ad4">LBM_MSG_PROPERTY_LONG</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac80aef6c36b7e5ae0984d81ab4af062a">lbm_int64_t</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a179ee6d46f98f273b358bba2bdfba75c">LBM_MSG_PROPERTY_FLOAT</a> </td><td>float </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4bbd5d39680d349384d4e80079d602b2">LBM_MSG_PROPERTY_DOUBLE</a> </td><td>double </td></tr>
<tr>
<td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abd04d3a94da9cc86cf2886b3f0849bb7">LBM_MSG_PROPERTY_STRING</a> </td><td>char array </td></tr>
</table>
<p><br />
 </p>
<h3><a class="anchor" id="messagepropertiesperformanceconsiderations"></a>
Message Properties Performance Considerations&nbsp;&nbsp;<small><a href="#messagepropertiesperformanceconsiderations">&lt;-</a></small></h3>
<p>Ultra Messaging sends property names on the wire with every message. To reduce bandwidth requirements, minimize the length and number of properties. When coding sources, consider the following sequence of guidelines:</p>
<ol>
<li>
Allocate a data structure to store message properties objects. This can be a thread-local structure if you use a relatively small number of threads, or a thread-safe pool of objects. </li>
<li>
Before sending, retrieve a message properties object from the pool. If an object is not available, create a new object. </li>
<li>
Set properties for the message. </li>
<li>
Send the message using the appropriate API call, passing in the properties object. </li>
<li>
After the send completes, clear the message properties object and return it to the pool. </li>
</ol>
<p>When coding receivers in Java or .NET, call Dispose() on messages before returning from the application callback. This allows Ultra Messaging to internally recycle objects, and limits object allocation.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcesandmessageproperties"></a>
Smart Sources and Message Properties&nbsp;&nbsp;<small><a href="#smartsourcesandmessageproperties">&lt;-</a></small></h3>
<p><a class="el" href="index.html#smartsources">Smart Sources</a> support a limited form of message properties. Only 32-bit integer property types are allowed with Smart Sources. Also, property names are limited to 7 ASCII characters. Finally, the normal message properties object <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9155c3d6d70b67c426089d53b3eacaac">lbm_msg_properties_t</a> and its APIs <em>are not used</em> on the sending side. Rather a streamlined method of specifying message properties for sending is used.</p>
<p>As with most of Smart Source's internal design, the message header for message properties must be pre-allocated with the maximum number of desired message properties. This is done at creation time for the Smart Source using the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmessagepropertyintcountsource">smart_src_message_property_int_count (source)</a>.</p>
<p>Sending messages with message properties must be done using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex()</a> API, passing it the desired properties with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> structure. The first call to send with message properties will serialize the supplied properties and encode them into the pre-allocated message header.</p>
<p>Subsequent calls to send with message properties will ignore the passed-in properties and simply re-send the previously-serialized header.</p>
<p>If an application needs to change the message property values after that initial send, the "update" flag flag can be used, which will trigger modification of the property values. This "update" flag cannot be used to change the number of properties, or the key names of the properties.</p>
<p>If an application needs messages with different numbers of properties and/or different key names of properties, the most efficient way to accomplish this is with multiple message buffers. Each buffer should be associated with a desired set of properties. When a message needs to be sent, the proper buffer is selected for building the message. This avoid the overhead of serializing the properties with each send call.</p>
<p>However, if the application requires dynamic construction of properties, a single buffer can be used along with the "rebuild" flag to trigger a full serialization of the properties.</p>
<dl class="section note"><dt>Note</dt><dd>If using both message properties and <a class="el" href="index.html#spectrum">Spectrum</a> with a single Smart Source, there is an added restriction: it is not possible to send a message omitting only one of those features. If both are enabled when the Smart Source is created, it is not possible to send a message with a message property and not a channel, and it is not possible to send a message with a channel and not a property. This is because the message header is defined at Smart Source creation, and the header either must contain both or neither.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcemessagepropertiesusage"></a>
Smart Source Message Properties Usage&nbsp;&nbsp;<small><a href="#smartsourcemessagepropertiesusage">&lt;-</a></small></h3>
<p>For a full example of message property usage with Smart Source, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmssrc_c">Example lbmssrc.c</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmssrc_java">Example lbmssrc.java</a>.</p>
<p>The first message with a message property sent to a Smart Source follows a specific sequence:</p>
<ol>
<li>
<p class="startli">Create the topic object with the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmessagepropertyintcountsource">smart_src_message_property_int_count (source)</a> set to the maximum number of properties desired on a message.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Create the Smart Source with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9a8d169a8c2a90b8442d4eb3e3711c9c">lbm_ssrc_create()</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Allocate one or more message buffers with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a98c5450e9fb93f30bd80fa33a2380dfc">lbm_ssrc_buff_get()</a>. You might allocate one for messages that have properties, and another for messages that don't.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">When preparing the first message with message properties to be sent, define the properties using a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> structure: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> *prop_name_array[3]; <span class="comment">/* Array of property names. */</span></div><div class="line">prop_name_array[0] = <span class="stringliteral">&quot;abc&quot;</span>; <span class="comment">/* 7 ascii characters or less. */</span></div><div class="line">prop_name_array[1] = <span class="stringliteral">&quot;XYZ&quot;</span>;</div><div class="line">prop_name_array[2] = <span class="stringliteral">&quot;123&quot;</span>;</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9b7c2c2a29915efc7ead2ff7f58f6f59">lbm_int32_t</a> prop_value_array[3]; <span class="comment">/* Array of property values. */</span></div><div class="line">prop_value_array[0] = 29;</div><div class="line">prop_value_array[1] = -300;</div><div class="line">prop_value_array[2] = 0;</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html">lbm_ssrc_send_ex_info_t</a> ss_send_info;</div><div class="line">memset((<span class="keywordtype">char</span> *)&amp;ss_send_info, 0, <span class="keyword">sizeof</span>(ss_send_info));</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a26e6f73e26bd532ad9ea5c6ceb18c943">mprop_int_cnt</a> = 3;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#ad8ba521d9bfb2125401f7106b34055ad">mprop_int_keys</a> = prop_name_array;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#ac81546a02860998dd8d751a01edb3b42">mprop_int_vals</a> = prop_value_array;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Send the message using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex()</a> and the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af00465b8e9c560959351ec92f62a190e">LBM_SSRC_SEND_EX_FLAG_PROPERTIES</a> flag: </p><div class="fragment"><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af00465b8e9c560959351ec92f62a190e">LBM_SSRC_SEND_EX_FLAG_PROPERTIES</a>;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div></div><!-- fragment --><p class="endli">Since this is the first send with message properties, UM will serialize the properties and set up the message header. (It is not valid to set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40748fccf40f69c2029d68c16f923704">LBM_SSRC_SEND_EX_FLAG_UPDATE_PROPERTY_VALUES</a> flag on this first send with message properties.) </p>
</li>
</ol>
<p>For subsequent sends, there are different use cases: </p><ul>
<li>
<p class="startli">Send the message with the same properties and values. You can re-use the same message buffer and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> structure: </p><div class="fragment"><div class="line"><span class="comment">/* The ss_send_info.flags still has LBM_SSRC_SEND_EX_FLAG_PROPERTIES set */</span></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Send with message properties after having made changes to the property values (but not the keys or the number of properties) by setting the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40748fccf40f69c2029d68c16f923704">LBM_SSRC_SEND_EX_FLAG_UPDATE_PROPERTY_VALUES</a> flag: </p><div class="fragment"><div class="line">prop_value_array[0] = 28;  <span class="comment">/* Change property value. */</span></div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> |= <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40748fccf40f69c2029d68c16f923704">LBM_SSRC_SEND_EX_FLAG_UPDATE_PROPERTY_VALUES</a>;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> &amp;= ~<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a40748fccf40f69c2029d68c16f923704">LBM_SSRC_SEND_EX_FLAG_UPDATE_PROPERTY_VALUES</a>;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Send a message with either a different number of properties, and/or different key names by setting the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a> flag: </p><div class="fragment"><div class="line"><span class="comment">/* Send with only the first 2 properties. */</span></div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a26e6f73e26bd532ad9ea5c6ceb18c943">mprop_int_cnt</a> = 2;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> |= <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a>;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> &amp;= ~ LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER;</div></div><!-- fragment --><p class="endli"></p>
</li>
<li>
Send a message without any message properties. This is a subset of the previous case (changing the number of properties). Use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a> flag and clear the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af00465b8e9c560959351ec92f62a190e">LBM_SSRC_SEND_EX_FLAG_PROPERTIES</a> flag: <div class="fragment"><div class="line"><span class="comment">/* Clear the properties flag so no properties will be sent. */</span></div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> &amp;= ~ LBM_SSRC_SEND_EX_FLAG_PROPERTIES;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> |= <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a>;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> &amp;= ~ LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER;</div></div><!-- fragment --> </li>
</ul>
<p>To be more efficient, instead of using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a> flag, you can use different message buffers (allocated with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a98c5450e9fb93f30bd80fa33a2380dfc">lbm_ssrc_buff_get()</a>) for each message property structure. This saves the time required to re-serialize the message properties each time you want to use a different property structure.</p>
<p><br />
 </p>
<h2><a class="anchor" id="requestresponsemodel"></a>
Request/Response Model&nbsp;&nbsp;<small><a href="#requestresponsemodel">&lt;-</a></small></h2>
<p>Request/response is a very common messaging model whereby a client sends a "request" message to a server and expects a response. The server processes the request and return a response message to the originating client.</p>
<p>The UM request/response feature simplifies implementation of this model in the following ways: </p><ul>
<li>
Handling the request's "return address", eliminating the need for the client to create an artificial guaranteed-unique topic for the response. </li>
<li>
Establishing a linkage between a request and its response(s), allowing multiple requests to be outstanding, and associating each response message with its corresponding request message. </li>
<li>
Supporting multiple responses per request, both by allowing multiple servers to receive the request and each one responding, and by allowing a given server to respond with multiple messages. </li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>Although the response messages are sent by TCP, there are still failure scenarios where a response can be lost. The use of <a class="el" href="index.html#umrouter">DROs</a> can make it even more likely. Informatica recommends applications that use request/response implement timeout/retry logic. See <a class="el" href="index.html#uimreliability">UIM Reliability</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="requestmessage"></a>
Request Message&nbsp;&nbsp;<small><a href="#requestmessage">&lt;-</a></small></h3>
<p>UM provides three ways to send a request message.</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad4d06f66b8404684e191ca178e0cc09b">lbm_send_request()</a> to send a request to a topic via a source object. Uses the standard source-based transports (TCP, LBT-RM, LBT-RU). </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a54f3933e4dd154a9c7bb72598d0d9ef1">lbm_multicast_immediate_request()</a> to send a request to a topic as a multicast immediate message. See <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a> to send a request to a topic as a unicast immediate message. </li>
</ul>
<p>When the client application sends a request message, it references an application callback function for responses and a client data pointer for application state. The send call returns a "request object". As one or more responses are returned, the callback is invoked to deliver the response messages, associated with the request's client data pointer. The requesting application decides when its request is satisfied (perhaps by completeness of a response, or by timeout), and it calls <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0abaa1c2ba62bba7a5eaf1f7f2abbac0">lbm_request_delete()</a> to delete the request object. Even if the server chooses to send additional responses, they will not be delivered to the requesting application after it has deleted the corresponding request object.</p>
<p><br />
 </p>
<h3><a class="anchor" id="responsemessage"></a>
Response Message&nbsp;&nbsp;<small><a href="#responsemessage">&lt;-</a></small></h3>
<p>The server application receives a request via the normal message receive mechanism, but the message is identified as type "request". Contained within that request message's header is a response object, which serves as a return address to the requester. The server application responds to an UM request message by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a>. The response message is sent unicast via a dynamic TCP connection managed by UM.</p>
<dl class="section warning"><dt>Warning</dt><dd>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a> function may not be called from a context thread callback. If the application needs to send the response from the receiver callback (or any other UM callback), it must associate that callback with an <a class="el" href="index.html#eventqueueobject">event queue</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="responsesize"></a>
Response Size&nbsp;&nbsp;<small><a href="#responsesize">&lt;-</a></small></h3>
<p>A UM response message can be of any arbitrary size. However, given that responses are sent as <a class="el" href="index.html#unicastimmediatemessaging">UIMs</a>, and UIMs are not guaranteed, UM responses can be lost. This is especially true if <a class="el" href="index.html#umrouter">DROs</a> are being used. Larger UM responses have a higher probability of being lost than smaller UM responses. In particular, UM responses larger than 65,000 bytes can be lost even if network packets are simply delivered out of order, as might happen if the DROs are configured to use a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/droarchitecture.html#udppeerlink">UDP Peer Link</a>.</p>
<p>This does not mean that you must avoid sending large response messages. Rather it emphasizes the importance of using an application-level timeout/retry algorithm for request/response. In practice, even multi-megabyte responses would be lost only rarely, but it can happen.</p>
<p><br />
 </p>
<h3><a class="anchor" id="responsedeletion"></a>
Response Deletion&nbsp;&nbsp;<small><a href="#responsedeletion">&lt;-</a></small></h3>
<p>Since the response object is part of the message header, it is normally deleted at the same time that the message is deleted, which typically happens automatically when the receiver callback returns. However, there are times when the application needs the scope of the response object to extend beyond the execution of the receiver callback. One method of extending the lifetime of the response object is to "retain" the request message, using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2b7788ff58f9e78bc89ea890dad0cccf">lbm_msg_retain()</a>.</p>
<p>However, there are times when the size of the request message makes retention of the entire message undesirable. In those cases, the response object itself can be extracted and retained separately by saving a copy of the response object pointer and setting the message header's response pointer to NULL (to prevent UM from deleting the response object when the message is deleted).</p>
<p>There are even occasions when an application needs to transfer the responsibility of responding to a request message to a different process entirely. The server which receives the request is not itself able to respond, and needs to send a message (not necessarily the original request message) to a different server. In that case, the first server which receives the request must serialize the response object to type <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a54cfbb23ab41a8d22968f68df015e246">lbm_serialized_response_t</a> by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a7595677bf01cb9397d1fd174bd095e9f">lbm_serialize_response()</a>. It includes the serialized response object in the message forwarded to the second server. That server de-serializes the response object by calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad74f47a1e021b2422b80c0bf8d03f7a9">lbm_deserialize_response()</a>, allowing it to send a response message to the original requesting client.</p>
<p><br />
 </p>
<h3><a class="anchor" id="tcpmanagement"></a>
TCP Management&nbsp;&nbsp;<small><a href="#tcpmanagement">&lt;-</a></small></h3>
<p>UM creates and manages the special TCP connections for responses, maintaining a list of active response connections. When an application sends a response, UM scans that list for an active connection to the destination. If it doesn't find a connection for the response, it creates a new connection and adds it to the list. After the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a> function returns, UM schedules the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#responsetcpdeletiontimeoutcontext">response_tcp_deletion_timeout (context)</a>, which defaults to 2 seconds. If a second request comes in from the same application before the timer expires, the responding application simply uses the existing connection and restarts the deletion timer.</p>
<p>It is conceivable that a very large response could take more than the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#responsetcpdeletiontimeoutcontext">response_tcp_deletion_timeout (context)</a> default (2 seconds) to send to a slow-running receiver. In this case, UM automatically increases the deletion timer as needed to ensure the last message completes.</p>
<p><br />
 </p>
<h3><a class="anchor" id="requestresponseconfiguration"></a>
Request/Response Configuration&nbsp;&nbsp;<small><a href="#requestresponseconfiguration">&lt;-</a></small></h3>
<p>See the <a href="../../Config/index.html">UM Configuration Guide</a> for the descriptions of the Request/Response configuration options:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html">Unicast Immediate Messaging Network Options</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html">Unicast Immediate Messaging Operation Options</a> </li>
</ul>
<dl class="section note"><dt>Note</dt><dd>If your application is running within an UM context where the configuration option, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpbindrequestportcontext">request_tcp_bind_request_port (context)</a> has been set to zero, UIM port binding has been turned off, which also disables the Request/Response feature.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="requestresponseexampleapplications"></a>
Request/Response Example Applications&nbsp;&nbsp;<small><a href="#requestresponseexampleapplications">&lt;-</a></small></h3>
<p>UM includes two example applications that illustrate Request/Response.</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmreq_c">Example lbmreq.c</a> - application that sends requests on a given topic (single source) and waits for responses. See also the Java example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmreq_java">Example lbmreq.java</a> and the .NET example <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmreq_cs">Example lbmreq.cs</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmresp_c">Example lbmresp.c</a> - application that waits for requests and sends responses back on a given topic (single receiver). See also the Java example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmresp_java">Example lbmresp.java</a> and the .NET example <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/dotnet_example.tag:../../dotnet_example/" href="../../dotnet_example/index.html#examplelbmresp_cs">Example lbmresp.cs</a>. </li>
</ul>
<p>We can demonstrate a series of 5 requests and responses with the following procedure:</p>
<ul>
<li>
Run <b>lbmresp -v topicname</b> </li>
<li>
Run <b>lbmreq -R 5 -v topicname</b> </li>
</ul>
<p><b>LBMREQ</b></p>
<p>Output for lbmreq should resemble the following:</p>
<pre class="fragment">$ lbmreq -R 5 -q topicname
Event queue in use
Using TCP port 4392 for responses
Delaying requests for 1000 milliseconds
Sending request 0
Starting event pump for 5 seconds.
Receiver connect [TCP:10.29.1.78:4958]
Done waiting for responses. 1 responses (25 bytes) received. Deleting request. Sending request 1
Starting event pump for 5 seconds.
Done waiting for responses. 1 responses (25 bytes) received. Deleting request. Sending request 2
Starting event pump for 5 seconds.
Done waiting for responses. 1 responses (25 bytes) received. Deleting request. Sending request 3
Starting event pump for 5 seconds.
Done waiting for responses. 1 responses (25 bytes) received. Deleting request. Sending request 4
Starting event pump for 5 seconds.
Done waiting for responses. 1 responses (25 bytes) received. Deleting request.
Quitting...
</pre><p><b>LBMRESP</b></p>
<p>Output for lbmresp should resemble the following:</p>
<pre class="fragment">$ lbmresp -v topicname
Request [topicname][TCP:10.29.1.78:14371][0], 25 bytes
Sending response. 1 responses of 25 bytes each (25 total bytes).
Done sending responses. Deleting response.
Request [topicname][TCP:10.29.1.78:14371][1], 25 bytes
Sending response. 1 responses of 25 bytes each (25 total bytes).
Done sending responses. Deleting response.
Request [topicname][TCP:10.29.1.78:14371][2], 25 bytes
Sending response. 1 responses of 25 bytes each (25 total bytes).
Done sending responses. Deleting response.
Request [topicname][TCP:10.29.1.78:14371][3], 25 bytes
Sending response. 1 responses of 25 bytes each (25 total bytes).
Done sending responses. Deleting response.
Request [topicname][TCP:10.29.1.78:14371][4], 25 bytes
Sending response. 1 responses of 25 bytes each (25 total bytes).
Done sending responses. Deleting response.
[topicname][TCP:10.29.1.78:14371], End of Transport Session
</pre><p><br />
 </p>
<h2><a class="anchor" id="selfdescribingmessaging"></a>
Self Describing Messaging&nbsp;&nbsp;<small><a href="#selfdescribingmessaging">&lt;-</a></small></h2>
<p>The UM Self-Describing Messaging (SDM) feature provides an API that simplifies the creation and use of messages by your applications. An SDM message contains one or more fields and each field consists of the following:</p>
<ul>
<li>
A name </li>
<li>
A type </li>
<li>
A value </li>
</ul>
<p>Each named field may appear only once in a message. If multiple fields of the same name and type are needed, array fields are available. A field in a nested message may have the same name as a field in the outer message.</p>
<p>SDM is particularly helpful for creating messages sent across platforms by simplifying the creation of data formats. SDM automatically performs platform-specific data translations, eliminating endian conflicts.</p>
<p>Using SDM also simplifies message maintenance because the message format or structure can be independent of the source and receiver applications. For example, if your receivers query SDM messages for particular fields and ignore the order of the fields within the message, a source can change the field order if necessary with no modification of the receivers needed.</p>
<p>See the <a href="../../API/lbmsdm_8h.html">C</a>, <a href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1sdm_1_1LBMSDM.html">Java</a>, and <a href="../../DotNetAPI/namespacecom_1_1latencybusters_1_1lbm_1_1sdm.html">.NET</a> API references for details.</p>
<p>Informatica generally recommends the use of <a class="el" href="index.html#predefinedmessages">Pre-Defined Messages</a>, which is more efficient than self-describing messages.</p>
<p><br />
 </p>
<h2><a class="anchor" id="predefinedmessages"></a>
Pre-Defined Messages&nbsp;&nbsp;<small><a href="#predefinedmessages">&lt;-</a></small></h2>
<p>The UM Pre-Defined Messages (PDM) feature provides an API similar to the SDM API, but allows you to define messages once and then use the definition to create messages that may contain self-describing data. Eliminating the need to repeatedly send a message definition increases the speed of PDM over SDM. The ability to use arrays created in a different programming language also improves performance.</p>
<p>The PDM library lets you create, serialize, and deserialize messages using pre-defined knowledge about the possible fields that may be used. You can create a definition that a) describes the fields to be sent and received in a message, b) creates the corresponding message, and c) adds field values to the message. This approach offers several performance advantages over SDM, as the definition is known in advance. However, the usage pattern is slightly different from the SDM library, where fields are added directly to a message without any type of definition.</p>
<p>A PDM message contains one or more fields and each field consists of the following:</p>
<ul>
<li>
A name </li>
<li>
A type </li>
<li>
A value </li>
</ul>
<p>Each named field may appear only once in a message. If multiple fields of the same name and type are needed, array fields are available. A field in a nested message may have the same name as a field in the outer message.</p>
<p>See the <a href="../../API/lbmpdm_8h.html">C</a>, <a href="../../JavaAPI/classcom_1_1latencybusters_1_1pdm_1_1PDMMessage.html">Java</a>, and <a href="../../DotNetAPI/namespacecom_1_1latencybusters_1_1pdm.html">.NET</a> API references for details.</p>
<p>The C API also has information and code samples about how to create definitions and messages, set field values in a message, set the value of array fields in a message, serialize, deserialize and dispose of messages, and fetch values from a message.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/cpdmdetails.html">C PDM Details</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="typicalpdmusagepatterns"></a>
Typical PDM Usage Patterns&nbsp;&nbsp;<small><a href="#typicalpdmusagepatterns">&lt;-</a></small></h3>
<p>The typical PDM usage patterns can usually be broken down into two categories: sources (which need to serialize a message for sending) and receivers (which need to deserialize a message to extract field values). However, for optimum performance for both sources and receivers, first set up the definition and a single instance of the message only once during a setup or initialization phase, as in the following example workflow:</p>
<ol>
<li>
Create a definition and set its id and version. </li>
<li>
Add field information to the definition to describe the types of fields to be in the message. </li>
<li>
Create a single instance of a message based on the definition. </li>
<li>
Set up a source to do the following: <ul>
<li>
Add field values to the message instance. </li>
<li>
Serialize the message so that it can be sent. </li>
</ul>
</li>
<li>
Likewise, set up a receiver to do the following: <ul>
<li>
Deserialize the received bytes into the message instance. </li>
<li>
Extract the field values from the message. </li>
</ul>
</li>
</ol>
<p><br />
 </p>
<h3><a class="anchor" id="gettingstartedwithpdm"></a>
Getting Started with PDM&nbsp;&nbsp;<small><a href="#gettingstartedwithpdm">&lt;-</a></small></h3>
<p>PDM APIs are provided in C, Java, and C#, however, the examples in this section are Java based.</p>
<p><b>PDM Code Example, Source</b></p>
<p>Translating the Typical PDM Usage Patterns to Java for a source produces the following:</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMDefinition defn;</div><div class="line"><span class="keyword">private</span> PDMMessage msg;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo100;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo101;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo102;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Create the definition with 3 fields and using int field names</span></div><div class="line">  defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  <span class="comment">//Set the definition id and version</span></div><div class="line">  defn.setId(1001);</div><div class="line">  defn.setMsgVersMajor((byte)1);</div><div class="line">  defn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float fields (all required)</span></div><div class="line">  fldInfo100 = defn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  fldInfo101 = defn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  fldInfo102 = defn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  <span class="comment">//Finalize the definition and create the message defn.finalizeDef();</span></div><div class="line">  msg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> sourceUsePDM() {</div><div class="line">  <span class="comment">//Call the function to setup the definition and message</span></div><div class="line">  setupPDM();</div><div class="line"></div><div class="line">  <span class="comment">//Example values for the message boolean</span></div><div class="line">  fld100Val = <span class="keyword">true</span>;</div><div class="line">  <span class="keywordtype">int</span> fld101Val = 7;</div><div class="line">  <span class="keywordtype">float</span> fld102Val = 3.14F;</div><div class="line"></div><div class="line">  <span class="comment">//Set each field value in the message</span></div><div class="line">  msg.setFieldValue(fldInfo100, fld100Val);</div><div class="line">  msg.setFieldValue(fldInfo101, fld101Val);</div><div class="line">  msg.setFieldValue(fldInfo102, fld102Val);</div><div class="line"></div><div class="line">  <span class="comment">//Serialize the message to bytes</span></div><div class="line">  byte[] buffer = msg.toBytes();</div><div class="line">}</div></div><!-- fragment --><p><b>PDM Code Example, Receiver</b></p>
<p>Translating the Typical PDM Usage Patterns to Java for a receiver produces the following:</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMDefinition defn;</div><div class="line"><span class="keyword">private</span> PDMMessage msg;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo100;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo101;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo102;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Create the definition with 3 fields and using int field names</span></div><div class="line">  defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  <span class="comment">//Set the definition id and version</span></div><div class="line">  defn.setId(1001);</div><div class="line">  defn.setMsgVersMajor((byte)1);</div><div class="line">  defn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  fldInfo100 = defn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  fldInfo101 = defn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  fldInfo102 = defn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  <span class="comment">//Finalize the definition and create the message</span></div><div class="line">  defn.finalizeDef();</div><div class="line">  msg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  <span class="comment">//Call the function to setup the definition and message</span></div><div class="line">  setupPDM();</div><div class="line"></div><div class="line">  <span class="comment">//Values to be retrieved from the message</span></div><div class="line">  <span class="keywordtype">boolean</span> fld100Val;</div><div class="line">  <span class="keywordtype">int</span> fld101Val;</div><div class="line">  <span class="keywordtype">float</span> fld102Val;</div><div class="line"></div><div class="line">  <span class="comment">//Deserialize the bytes into a message</span></div><div class="line">  msg.parse(buffer);</div><div class="line"></div><div class="line">  <span class="comment">//Get each field value from the message</span></div><div class="line">  fld100Val = msg.getFieldValueAsBoolean(fldInfo100);</div><div class="line">  fld101Val = msg.getFieldValueAsInt32(fldInfo101);</div><div class="line">  fld102Val = msg.getFieldValueAsFloat(fldInfo102);</div><div class="line">}</div></div><!-- fragment --><p><b>PDM Code Example Notes</b></p>
<p>In the examples above, the setupPDM() function is called once to set up the PDM definition and message. It is identical in both the source and receiver cases and simply sets up a definition that contains three required fields with integer names (100, 101, 102). Once finalized, it can create a message that leverages its pre-defined knowledge about these three required fields. The source example adds the three sample field values (a boolean, int32, and float) to the message, which is then serialized to a byte array. In the receiver example, the message parses a byte array into the message and then extracts the three field values.</p>
<p><br />
 </p>
<h3><a class="anchor" id="usingthepdmapi"></a>
Using the PDM API&nbsp;&nbsp;<small><a href="#usingthepdmapi">&lt;-</a></small></h3>
<p>The following code snippets expand upon the previous examples to demonstrate the usage of additional PDM functionality (but use "..." to eliminate redundant code).</p>
<p><b>Reusing the Message Object</b></p>
<p>Although the examples use a single message object (which provides performance benefits due to reduced message creation and garbage collection), it is not explicitly required to reuse a single instance. However, multiple threads should not access a single message instance.</p>
<p><b>Number of Fields</b></p>
<p>Although the number of fields above is initially set to 3 in the PDMDefinition constructor, if you add more fields to the definition with the addFieldInfo method, the definition grows to accommodate each field. Once the definition is finalized, you cannot add additional field information because the definition is now locked and ready for use in a message.</p>
<p><b>String Field Names</b></p>
<p>The examples above use integer field names in the setupPDM() function when creating the definition. You can also use string field names when setting up the definition. However, you still must use a FieldInfo object to set or get a field value from a message, regardless of field name type. Notice that false is passed to the PDMDefinition constructor to indicate string field names should be used. Also, the overloaded addFieldInfo function uses string field names (.Field100.) instead of the integer field names.</p>
<div class="fragment"><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Create the definition with 3 fields and using string field names</span></div><div class="line">  defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">false</span>);</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  fldInfo100 = defn.addFieldInfo(<span class="stringliteral">&quot;Field100&quot;</span>, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  fldInfo101 = defn.addFieldInfo(<span class="stringliteral">&quot;Field101&quot;</span>, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  fldInfo102 = defn.addFieldInfo(<span class="stringliteral">&quot;Field102&quot;</span>, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line">...</div></div><!-- fragment --><p><b>Retrieving FieldInfo from the Definition</b></p>
<p>At times, it may be easier to lookup the FieldInfo from the definition using the integer name (or string name if used). This eliminates the need to store the reference to the FieldInfo when getting or setting a field value in a message, but it does incur a performance penalty due to the lookup in the definition to retrieve the FieldInfo. Notice that there are no longer FieldInfo objects being used when calling addFieldInfo and a lookup is being done for each call to msg.getFieldValueAs* to retrieve the FieldInfo by integer name.</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMDefinition defn;</div><div class="line"><span class="keyword">private</span> PDMMessage msg;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  defn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  defn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  defn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Get each field value from the message</span></div><div class="line">  fld100Val = msg.getFieldValueAsBoolean(defn.getFieldInfo(100));</div><div class="line">  fld101Val = msg.getFieldValueAsInt32(defn.getFieldInfo(101));</div><div class="line">  fld102Val = msg.getFieldValueAsFloat(defn.getFieldInfo(102));</div><div class="line">}</div></div><!-- fragment --><p><b>Required and Optional Fields</b></p>
<p>When adding field information to a definition, you can indicate that the field is optional and may not be set for every message that uses the definition. Do this by passing false as the third parameter to the addFieldInfo function. Using required fields (fixed-required fields specifically) produces the best performance when serializing and deserializing messages, but causes an exception if all required fields are not set before serializing the message. Optional fields allow the concept of sending "null" as a value for a field by simply not setting that field value on the source side before serializing the message. However, after parsing a message, a receiver should check the isFieldValueSet function for an optional field before attempting to read the value from the field to avoid the exception mentioned above.</p>
<div class="fragment"><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo103;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  <span class="comment">// as well as an optional int8 field</span></div><div class="line">  fldInfo100 = defn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  fldInfo101 = defn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  fldInfo102 = defn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line">  fldInfo103 = defn.addFieldInfo(103, PDMFieldType.INT8, <span class="keyword">false</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> sourceUsePDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Set each field value in the message</span></div><div class="line">  <span class="comment">// except do not set the optional field</span></div><div class="line">  msg.setFieldValue(fldInfo100, fld100Val);</div><div class="line">  msg.setFieldValue(fldInfo101, fld101Val);</div><div class="line">  msg.setFieldValue(fldInfo102, fld102Val);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo103;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  <span class="comment">// as well as an optional int8 field</span></div><div class="line">  fldInfo103 = defn.addFieldInfo(103, PDMFieldType.INT8, <span class="keyword">false</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  ...</div><div class="line">  byte fld103Val;</div><div class="line">  ...</div><div class="line">  <span class="keywordflow">if</span>(msg.isFieldValueSet(fldInfo103)) {</div><div class="line">    fld103Val = msg.getFieldValueAsInt8(fldInfo103);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p><b>Fixed String and Fixed Unicode Field Types</b></p>
<p>A variable length string typically does not have the performance optimizations of fixed-required fields. However, by indicating "required", as well as the field type FIX_STRING or FIX_UNICODE and specifying an integer number of fixed characters, PDM sets aside an appropriate fixed amount of space in the message for that field and treats it as an optimized fixed-required field. Strings of a smaller length can still be set as the value for the field, but the message allocates the specified fixed number of bytes for the string. Specify Unicode strings in the same manner (with FIX_UNICODE as the type) and in "UTF-8" format.</p>
<div class="fragment"><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo104;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  fldInfo104 = defn.addFieldInfo(104, PDMFieldType.FIX_STRING, 12, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> sourceUsePDM() {</div><div class="line">  ...</div><div class="line">  String fld104Val = <span class="stringliteral">&quot;Hello World!&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">//Set each field value in the message</span></div><div class="line">  <span class="comment">// except do not set the optional field</span></div><div class="line">  msg.setFieldValue(fldInfo100, fld100Val);</div><div class="line">  msg.setFieldValue(fldInfo101, fld101Val);</div><div class="line">  msg.setFieldValue(fldInfo102, fld102Val);</div><div class="line">  msg.setFieldValue(fldInfo104, fld104Val);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo104;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  fldInfo104 = defn.addFieldInfo(104, PDMFieldType.FIX_STRING, 12, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  ...</div><div class="line">  String fld104Val;</div><div class="line">  ...</div><div class="line"></div><div class="line">  fld104Val = msg.getFieldValueAsString(fldInfo104);</div><div class="line">}</div></div><!-- fragment --><p><b>Variable Field Types</b></p>
<p>The field types of STRING, UNICODE, BLOB, and MESSAGE are all variable length field types. They do not require a length to be specified when adding field info to the definition. You can use a BLOB field to store an arbitrary binary objects (in Java as an array of bytes) and a MESSAGE field to store a PDMMessage object,</p>
<p>which enables "nesting" PDMMessages inside other PDMMessages. Creating and using a variable length string field is nearly identical to the previous fixed string example.</p>
<div class="fragment"><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo105;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  fldInfo105 = defn.addFieldInfo(105, PDMFieldType.STRING, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> sourceUsePDM() {</div><div class="line">  ...</div><div class="line">  String fld105Val = <span class="stringliteral">&quot;variable length value&quot;</span>;</div><div class="line">  ...</div><div class="line">  msg.setFieldValue(fldInfo105, fld105Val);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo105;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  fldInfo105 = defn.addFieldInfo(105, PDMFieldType.STRING, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">}</div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  ...</div><div class="line">  String fld105Val;</div><div class="line">  ...</div><div class="line"></div><div class="line">  fld105Val = msg.getFieldValueAsString(fldInfo105);</div><div class="line">}</div></div><!-- fragment --><p>Retrieve the BLOB field values with the getFieldValueAsBlob function, and the MESSAGE field values with the getFieldValueAsMessage function.</p>
<p><b>Array Field Types</b></p>
<p>For each of the scalar field types (fixed and variable length), a corresponding array field type uses the convention *_ARR for the type name (ex: BOOLEAN_ARR, INT32_ARR, STRING_ARR, etc.). This lets you set and get Java values such as an int[] or string[] directly into a single field. In addition, all of the array field types can specify a fixed number of elements for the size of the array when they are defined, or if not specified, behave as variable size arrays. Do this by passing an extra parameter to the addFieldInfo function of the definition.</p>
<p>To be treated as a fixed-required field, an array type field must be required as well as be specified as a fixed size array of fixed length elements. For instance, a required BOOLEAN_ARR field defined with a size of 3 would be treated as a fixed-required field. Also, a required FIX_STRING_ARR field defined with a size of 5 and fixed string length of 7 would be treated as a fixed-required field. However, neither a STRING_ARR field nor a BLOB_ARR field are treated as a fixed length field even if the size of the array is specified, since each element of the array can be variable in length. In the example below, field 106 and field 108 are both treated as fixed-required fields, but field 107 is not because it is a variable size array field type.</p>
<div class="fragment"><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo106;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo107;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo108;</div><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  <span class="comment">// as well as an optional int8 field</span></div><div class="line">  ...</div><div class="line">  <span class="comment">//A required, fixed size array of 3 boolean elements</span></div><div class="line">  fldInfo106 = defn.addFieldInfo(106, PDMFieldType.BOOLEAN_ARR, <span class="keyword">true</span>, 3);</div><div class="line">  <span class="comment">//An optional, variable size array of int32 elements</span></div><div class="line">  fldInfo107 = defn.addFieldInfo(107, PDMFieldType.INT32_ARR, <span class="keyword">false</span>);</div><div class="line">  <span class="comment">//A required, fixed size array of 2 element which are each 5 character strings</span></div><div class="line">  fldInfo108 = defn.addFieldInfo(108, PDMFieldType.FIX_STRING_ARR, 5, <span class="keyword">true</span>, 2);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> sourceUsePDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Example values for the message</span></div><div class="line">  ...</div><div class="line">  <span class="keywordtype">boolean</span> fld106Val[] = {<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>};</div><div class="line">  <span class="keywordtype">int</span> fld107Val[] = {1, 2, 3, 4, 5};</div><div class="line">  String fld108Val[] = {<span class="stringliteral">&quot;aaaaa&quot;</span>, <span class="stringliteral">&quot;bbbbb&quot;</span>};</div><div class="line"></div><div class="line">  <span class="comment">//Set each field value in the message</span></div><div class="line">  ...</div><div class="line">  msg.setFieldValue(fldInfo106, fld106Val);</div><div class="line">  msg.setFieldValue(fldInfo107, fld107Val);</div><div class="line">  msg.setFieldValue(fldInfo108, fld108Val);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line">...</div><div class="line">private PDMFieldInfo fldInfo106;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo107;</div><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo108;</div><div class="line">...</div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  <span class="comment">// as well as an optional int8 field</span></div><div class="line">  ...</div><div class="line">  <span class="comment">//A required, fixed size array of 3 boolean elements</span></div><div class="line">  fldInfo106 = defn.addFieldInfo(106, PDMFieldType.BOOLEAN_ARR, <span class="keyword">true</span>, 3);</div><div class="line">  <span class="comment">//An optional, variable size array of int32 elements</span></div><div class="line">  fldInfo107 = defn.addFieldInfo(107, PDMFieldType.INT32_ARR, <span class="keyword">false</span>);</div><div class="line">  <span class="comment">//A required, fixed size array of 2 element which are each 5 character strings</span></div><div class="line">  fldInfo108 = defn.addFieldInfo(108, PDMFieldType.FIX_STRING_ARR, 5, <span class="keyword">true</span>, 2);</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiverUsePDM(byte[] buffer) {</div><div class="line">  ...</div><div class="line">  <span class="comment">//Values to be retrieved from the message</span></div><div class="line">  ...</div><div class="line">  <span class="keywordtype">boolean</span> fld106Val[];</div><div class="line">  <span class="keywordtype">int</span> fld107Val[];</div><div class="line">  String fld108Val[];</div><div class="line"></div><div class="line">  <span class="comment">//Deserialize the bytes into a message</span></div><div class="line">  msg.parse(buffer);</div><div class="line"></div><div class="line">  <span class="comment">//Get each field value from the message</span></div><div class="line">  ...</div><div class="line">  fld106Val = msg.getFieldValueAsBooleanArray(fldInfo106);</div><div class="line">  <span class="keywordflow">if</span>(msg.isFieldValueSet(fldInfo107)) {</div><div class="line">    fld107Val = msg.getFieldValueAsInt32Array(fldInfo107);</div><div class="line">  }</div><div class="line"></div><div class="line">  fld108Val = msg.getFieldValueAsStringArray(fldInfo108);</div><div class="line">}</div></div><!-- fragment --><p><b>Definition Included In Message</b></p>
<p>Optionally, a PDM message can also include the definition when it is serialized to bytes. This enables receivers to parse a PDM message without having pre-defined knowledge of the message, although including the definition with the message affects message size and performance of message deserialization. Notice that the setIncludeDefinition function is called with an argument of true for a source that serializes the definition as part of the message.</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMDefinition defn;</div><div class="line"><span class="keyword">private</span> PDMMessage msg;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Create the definition with 3 fields and using int field names</span></div><div class="line">  defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="comment">//Finalize the definition and create the message</span></div><div class="line">  defn.finalizeDef();</div><div class="line">  msg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line"></div><div class="line">  <span class="comment">//Set the flag to indicate that the definition should also be serialized</span></div><div class="line">  msg.setIncludeDefinition(<span class="keyword">true</span>);</div><div class="line">}</div><div class="line">...</div></div><!-- fragment --><p>For a receiver, the setupPDM function does not need to set any flags for the message but rather should define a message without a definition, since we assume the source provides the definition. If a definition is set for a message, it will attempt to use that definition instead of the definition on the incoming message (unless the ids are different).</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMDefinition defn;</div><div class="line"><span class="keyword">private</span> PDMMessage msg;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Don&#39;t define a definition</span></div><div class="line"></div><div class="line">  <span class="comment">//Create a message without a definition since the incoming message will have it</span></div><div class="line">  msg = <span class="keyword">new</span> PDMMessage();</div><div class="line">}</div><div class="line">...</div></div><!-- fragment --><p><b>The PDM Field Iterator</b></p>
<p>You can use the PDM Field Iterator to check all defined message fields to see if set, or to extract their values. You can extract a field value as an Object using this method, but due to the casting involved, we recommend you use the type specific get method to extract the exact value. Notice the use of field.isValueSet to check to see if the field value is set and the type specific get methods such as getBooleanValue and getFloatValue.</p>
<div class="fragment"><div class="line">...</div><div class="line"></div><div class="line">public <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  <span class="comment">//Create the definition with 3 fields and using int field names</span></div><div class="line">  defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  <span class="comment">//Set the definition id and version</span></div><div class="line">  defn.setId(1001);</div><div class="line">  defn.setMsgVersMajor((byte)1);</div><div class="line">  defn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  <span class="comment">// as well as an optional int8 field</span></div><div class="line">  fldInfo100 = defn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  fldInfo101 = defn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  fldInfo102 = defn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line">  fldInfo103 = defn.addFieldInfo(103, PDMFieldType.INT8, <span class="keyword">false</span>);</div><div class="line">  fldInfo104 = defn.addFieldInfo(104, PDMFieldType.FIX_STRING, 12, <span class="keyword">true</span>);</div><div class="line">  fldInfo105 = defn.addFieldInfo(105, PDMFieldType.STRING, <span class="keyword">true</span>);</div><div class="line">  <span class="comment">//A required, fixed size array of 3 boolean elements</span></div><div class="line">  fldInfo106 = defn.addFieldInfo(106, PDMFieldType.BOOLEAN_ARR, <span class="keyword">true</span>, 3);</div><div class="line">  <span class="comment">//An optional, variable size array of int32 elements</span></div><div class="line">  fldInfo107 = defn.addFieldInfo(107, PDMFieldType.INT32_ARR, <span class="keyword">false</span>);</div><div class="line">  <span class="comment">//A required, fixed size array of 2 element which are each 5 character strings</span></div><div class="line">  fldInfo108 = defn.addFieldInfo(108, PDMFieldType.FIX_STRING_ARR, 5, <span class="keyword">true</span>, 2);</div><div class="line"></div><div class="line">  <span class="comment">//Finalize the definition and create the message</span></div><div class="line">  defn.finalizeDef();</div><div class="line">  msg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiveAndIterateMessage(byte[] buffer) {</div><div class="line">  msg.parse(buffer);</div><div class="line">  PDMFieldIterator iterator = msg.createFieldIterator();</div><div class="line">  PDMField field = null;</div><div class="line">  <span class="keywordflow">while</span>(iterator.hasNext()) {</div><div class="line">    field = iterator.next();</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Field set? &quot;</span> +field.isValueSet());</div><div class="line">    <span class="keywordflow">switch</span>(field.getIntName()) {</div><div class="line">      <span class="keywordflow">case</span> 100:</div><div class="line">        <span class="keywordtype">boolean</span> val100 = field.getBooleanValue();</div><div class="line">        System.out.println(<span class="stringliteral">&quot;Field 100&#39;s value is: &quot;</span> + val100);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> 101:</div><div class="line">        <span class="keywordtype">int</span> val101 = field.getInt32Value();</div><div class="line">        System.out.println(<span class="stringliteral">&quot;Field 101&#39;s value is: &quot;</span> + val101);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> 102:</div><div class="line">        <span class="keywordtype">float</span> val102 = field.getFloatValue();</div><div class="line">        System.out.println(<span class="stringliteral">&quot;Field 102&#39;s value is: &quot;</span> + val102);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">default</span>:</div><div class="line">        <span class="comment">//Casting to object is possible but not recommended</span></div><div class="line">        Object value = field.getValue();</div><div class="line">        <span class="keywordtype">int</span> name = field.getIntName();</div><div class="line">        System.out.println(<span class="stringliteral">&quot;Field &quot;</span> + name + <span class="stringliteral">&quot;&#39;s value is: &quot;</span> + value);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>Sample Output (106, 107, 108 are array objects as expected):</p>
<pre class="fragment">Field set? true
Field 100's value is: true
Field set? true
Field 101's value is: 7
Field set? true
Field 102's value is: 3.14
Field set? false
Field 103's value is: null
Field set? true
Field 104's value is: Hello World!
Field set? true
Field 105's value is: Variable
Field set? true
Field 106's value is: [Z@527736bd
Field set? true
Field 107's value is: [I@10aadc97
Field set? true
Field 108's value is: [Ljava.lang.String;@4178460d
</pre><p><b>Using the Definition Cache</b></p>
<p>The PDM Definition Cache assists with storing and looking up definitions by their id and version. In some scenarios, it may not be desirable to maintain the references to the message and the definition from a setup phase by the application. A source could optionally create the definition during the setup phase and store it in the definition cache. At a later point in time, it could retrieve the definition from the cache and use it to create the message without needing to maintain any references to the objects.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> createAndStoreDefinition() {</div><div class="line">  PDMDefinition myDefn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line">  <span class="comment">//Set the definition id and version</span></div><div class="line">  myDefn.setId(2001);</div><div class="line">  myDefn.setMsgVersMajor((byte)1);</div><div class="line">  myDefn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  myDefn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  myDefn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  myDefn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  myDefn.finalizeDef();</div><div class="line"></div><div class="line">  PDMDefinitionCache.getInstance().put(myDefn);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> createMessageUsingCache() {</div><div class="line">  PDMDefinition myFoundDefn = PDMDefinitionCache.getInstance().get(2001, 1, 0);</div><div class="line">  <span class="keywordflow">if</span>(myFoundDefn != null) {</div><div class="line">    PDMMessage myMsg = <span class="keyword">new</span> PDMMessage(myFoundDefn);</div><div class="line">    <span class="comment">//Get FieldInfo from defn and then set field values in myMsg</span></div><div class="line">    <span class="comment">//...</span></div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>A more advanced use of the PDM Definition Cache is by a receiver which may need to receive messages with different definitions and the definitions are not being included with the messages. The receiver can create the definitions in advance and then set a flag that allows automatic lookup into the definition cache when parsing a message (which is not on by default). Before receiving messages, the receiver should do something similar to createAndStoreDefinition (shown below) to set up definitions and put them in the definition cache. Then the flag to allow automatic lookup should be set as shown below in the call to setTryToLoadDefFromCache(true). This allows the PDMMessage to be created without a definition and still successfully parse a message by leveraging the definition cache.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> createAndStoreDefinition() {</div><div class="line">  PDMDefinition myDefn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">true</span>);</div><div class="line">  <span class="comment">//Set the definition id and version</span></div><div class="line">  myDefn.setId(2001);</div><div class="line">  myDefn.setMsgVersMajor((byte)1);</div><div class="line">  myDefn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">  <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">  myDefn.addFieldInfo(100, PDMFieldType.BOOLEAN, <span class="keyword">true</span>);</div><div class="line">  myDefn.addFieldInfo(101, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line">  myDefn.addFieldInfo(102, PDMFieldType.FLOAT, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">  myDefn.finalizeDef();</div><div class="line">  PDMDefinitionCache.getInstance().put(myDefn);</div><div class="line"></div><div class="line">  <span class="comment">//Create and store other definitions</span></div><div class="line">  <span class="comment">//...</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> receiveKnownMessages(byte[] buffer) {</div><div class="line">  PDMMessage myMsg = <span class="keyword">new</span> PDMMessage();</div><div class="line">  <span class="comment">//Set the flag that enables messages to try</span></div><div class="line">  <span class="comment">// looking up the definition in the cache automatically</span></div><div class="line">  <span class="comment">// when parsing a byte buffer</span></div><div class="line">  myMsg.setTryToLoadDefFromCache(<span class="keyword">true</span>);</div><div class="line">  myMsg.parse(buffer);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (myMsg.getDefinition().getId() == 2001</div><div class="line">      &amp;&amp; myMsg.getDefinition().getMsgVersMajor() == 1</div><div class="line">      &amp;&amp; myMsg.getDefinition().getMsgVersMinor() == 0) {</div><div class="line">    PDMDefinition myDefn = PDMDefinitionCache.getInstance().get(2001, 1, 0);</div><div class="line">    PDMFieldInfo fldInfo100 = myDefn.getFieldInfo(100);</div><div class="line">    PDMFieldInfo fldInfo101 = myDefn.getFieldInfo(101);</div><div class="line">    PDMFieldInfo fldInfo102 = myDefn.getFieldInfo(102);</div><div class="line"></div><div class="line">    <span class="keywordtype">boolean</span> fld100Val;</div><div class="line">    <span class="keywordtype">int</span> fld101Val;</div><div class="line">    <span class="keywordtype">float</span> fld102Val;</div><div class="line"></div><div class="line">    <span class="comment">//Get each field value from the message</span></div><div class="line">    fld100Val = myMsg.getFieldValueAsBoolean(fldInfo100);</div><div class="line">    fld101Val = myMsg.getFieldValueAsInt32(fldInfo101);</div><div class="line">    fld102Val = myMsg.getFieldValueAsFloat(fldInfo102);</div><div class="line"></div><div class="line">    System.out.println(fld100Val + <span class="stringliteral">&quot; &quot;</span> + fld101Val + <span class="stringliteral">&quot; &quot;</span> + fld102Val);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p><br />
 </p>
<h3><a class="anchor" id="migratingfromsdm"></a>
Migrating from SDM&nbsp;&nbsp;<small><a href="#migratingfromsdm">&lt;-</a></small></h3>
<p>Applications using SDM with a known set of message fields are good candidates for migrating from SDM to PDM. With SDM, the source typically adds fields to an SDM message without a definition. But, as shown above in the PDM examples, creating/adding a PDM definition before adding field values is fairly straightforward.</p>
<p>However, certain applications may be incapable of building a definition in advance due to the ad-hoc nature of their messaging needs, in which case a self-describing format like SDM may be preferred.</p>
<p><b>Simple Migration Example</b></p>
<p>The following source code shows a basic application that serializes and deserializes three fields using SDM and PDM. The setup method in both cases initializes the object instances so they can be reused by the source and receiver methods.</p>
<p>The goal of the sourceCreateMessageWith functions is to produce a byte array by setting field values in a message object. With SDM, actual Field classes are created, values are set, the Field classes are added to a</p>
<p>Fields class, and then the Fields class is added to the SDMessage. With PDM, FieldInfo objects are created during the setup phase and then used to set specific values in the PDMMessage.</p>
<p>The goal of the receiverParseMessageWith functions is to produce a message object by parsing the byte array and then extract the field values from the message. With SDM, the specific field is located and casted to the correct field class before getting the field value. With PDM, the appropriate getFieldValueAs function is called with the corresponding FieldInfo object created during the setup phase to extract the field value.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Migration {</div><div class="line">  <span class="comment">//SDM Variables</span></div><div class="line">  <span class="keyword">private</span> LBMSDMessage srcSDMMsg;</div><div class="line">  <span class="keyword">private</span> LBMSDMessage rcvSDMMsg;</div><div class="line"></div><div class="line">  <span class="comment">//PDM Variables</span></div><div class="line">  <span class="keyword">private</span> PDMDefinition defn;</div><div class="line">  <span class="keyword">private</span> PDMFieldInfo fldInfo100;</div><div class="line">  <span class="keyword">private</span> PDMFieldInfo fldInfo101;</div><div class="line">  <span class="keyword">private</span> PDMFieldInfo fldInfo102;</div><div class="line">  <span class="keyword">private</span> PDMMessage srcPDMMsg;</div><div class="line">  <span class="keyword">private</span> PDMMessage rcvPDMMsg;</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> main(String[] args) {</div><div class="line">    Migration app = <span class="keyword">new</span> Migration();</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Setting up PDM Definition and Message&quot;</span>);</div><div class="line">    app.setupPDM();</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Setting up SDM Messages&quot;</span>);</div><div class="line">    app.setupSDM();</div><div class="line"></div><div class="line">    byte[] sdmBuffer;</div><div class="line">    sdmBuffer = app.sourceCreateMessageWithSDM();</div><div class="line">    app.receiverParseMessageWithSDM(sdmBuffer);</div><div class="line"></div><div class="line">    byte[] pdmBuffer;</div><div class="line">    pdmBuffer = app.sourceCreateMessageWithPDM();</div><div class="line">    app.receiverParseMessageWithPDM(pdmBuffer);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> setupSDM() {</div><div class="line">    rcvSDMMsg = <span class="keyword">new</span> LBMSDMessage();</div><div class="line">    srcSDMMsg = <span class="keyword">new</span> LBMSDMessage();</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">    <span class="comment">//Create the definition with 3 fields and using int field names</span></div><div class="line">    defn = <span class="keyword">new</span> PDMDefinition(3, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">//Set the definition id and version</span></div><div class="line">    defn.setId(1001);</div><div class="line">    defn.setMsgVersMajor((byte)1);</div><div class="line">    defn.setMsgVersMinor((byte)0);</div><div class="line"></div><div class="line">    <span class="comment">//Create information for a boolean, int32, and float field (all required)</span></div><div class="line">    <span class="comment">// as well as an optional int8 field</span></div><div class="line">    fldInfo100 = defn.addFieldInfo(<span class="stringliteral">&quot;Field100&quot;</span>, PDMFieldType.INT8, <span class="keyword">true</span>);</div><div class="line">    fldInfo101 = defn.addFieldInfo(<span class="stringliteral">&quot;Field101&quot;</span>, PDMFieldType.INT16, <span class="keyword">true</span>);</div><div class="line">    fldInfo102 = defn.addFieldInfo(<span class="stringliteral">&quot;Field102&quot;</span>, PDMFieldType.INT32, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="comment">//Finalize the definition and create the message defn.finalizeDef();</span></div><div class="line">    srcPDMMsg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line">    rcvPDMMsg = <span class="keyword">new</span> PDMMessage(defn);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> byte[] sourceCreateMessageWithSDM() {</div><div class="line">    byte[] buffer = null;</div><div class="line"></div><div class="line">    LBMSDMField fld100 = <span class="keyword">new</span> LBMSDMFieldInt8(<span class="stringliteral">&quot;Field100&quot;</span>, (byte)0x42);</div><div class="line">    LBMSDMField fld101 = <span class="keyword">new</span> LBMSDMFieldInt16(<span class="stringliteral">&quot;Field101&quot;</span>, (<span class="keywordtype">short</span>)0x1ead);</div><div class="line">    LBMSDMField fld102 = <span class="keyword">new</span> LBMSDMFieldInt32(<span class="stringliteral">&quot;Field102&quot;</span>, 12345);</div><div class="line">    LBMSDMFields fset = <span class="keyword">new</span> LBMSDMFields();</div><div class="line"></div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line">      fset.add(fld100);</div><div class="line">      fset.add(fld101);</div><div class="line">      fset.add(fld102);</div><div class="line">    } <span class="keywordflow">catch</span> (LBMSDMException e) {</div><div class="line">      System.out.println ( e );</div><div class="line">    }</div><div class="line"></div><div class="line">    srcSDMMsg.set(fset);</div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line">      buffer = srcSDMMsg.data();</div><div class="line">    } <span class="keywordflow">catch</span> (IndexOutOfBoundsException e) {</div><div class="line">      System.out.println ( <span class="stringliteral">&quot;SDM Exception occurred during build of message:&quot;</span> );</div><div class="line">      System.out.println ( e.toString() );</div><div class="line">    } <span class="keywordflow">catch</span> (LBMSDMException e) {</div><div class="line">      System.out.println ( e.toString() );</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> buffer;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> byte[] sourceCreateMessageWithPDM() {</div><div class="line">    <span class="comment">//Set each field value in the message</span></div><div class="line">    srcPDMMsg.setFieldValue(fldInfo100, (byte)0x42);</div><div class="line">    srcPDMMsg.setFieldValue(fldInfo101, (<span class="keywordtype">short</span>)0x1ead);</div><div class="line">    srcPDMMsg.setFieldValue(fldInfo102, 12345);</div><div class="line"></div><div class="line">    <span class="comment">//Serialize the message to bytes</span></div><div class="line">    byte[] buffer = srcPDMMsg.toBytes();</div><div class="line">    <span class="keywordflow">return</span> buffer;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> receiverParseMessageWithSDM(byte[] buffer) {</div><div class="line">    <span class="comment">//Values to be retrieved from the message byte fld100Val;</span></div><div class="line">    <span class="keywordtype">short</span> fld101Val;</div><div class="line">    <span class="keywordtype">int</span> fld102Val;</div><div class="line"></div><div class="line">    <span class="comment">//Deserialize the bytes into a message</span></div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line">      rcvSDMMsg.parse(buffer);</div><div class="line">    } <span class="keywordflow">catch</span> (LBMSDMException e) {</div><div class="line">      System.out.println(e.toString());</div><div class="line">    }</div><div class="line"></div><div class="line">    LBMSDMField fld100 = rcvSDMMsg.locate(<span class="stringliteral">&quot;Field100&quot;</span>);</div><div class="line">    LBMSDMField fld101 = rcvSDMMsg.locate(<span class="stringliteral">&quot;Field101&quot;</span>);</div><div class="line">    LBMSDMField fld102 = rcvSDMMsg.locate(<span class="stringliteral">&quot;Field102&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//Get each field value from the message</span></div><div class="line">    fld100Val = ((LBMSDMFieldInt8)fld100).get();</div><div class="line">    fld101Val = ((LBMSDMFieldInt16)fld101).get();</div><div class="line">    fld102Val = ((LBMSDMFieldInt32)fld102).get();</div><div class="line"></div><div class="line">    System.out.println(<span class="stringliteral">&quot;SDM Results: Field100=&quot;</span> + fld100Val +</div><div class="line">                       <span class="stringliteral">&quot;, Field101=&quot;</span> + fld101Val +</div><div class="line">                       <span class="stringliteral">&quot;, Field102=&quot;</span> + fld102Val);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> receiverParseMessageWithPDM(byte[] buffer) {</div><div class="line">    <span class="comment">//Values to be retrieved from the message</span></div><div class="line">    byte fld100Val;</div><div class="line">    <span class="keywordtype">short</span> fld101Val;</div><div class="line">    <span class="keywordtype">int</span> fld102Val;</div><div class="line"></div><div class="line">    <span class="comment">//Deserialize the bytes into a message</span></div><div class="line">    rcvPDMMsg.parse(buffer);</div><div class="line"></div><div class="line">    <span class="comment">//Get each field value from the message</span></div><div class="line">    fld100Val = rcvPDMMsg.getFieldValueAsInt8(fldInfo100);</div><div class="line">    fld101Val = rcvPDMMsg.getFieldValueAsInt16(fldInfo101);</div><div class="line">    fld102Val = rcvPDMMsg.getFieldValueAsInt32(fldInfo102);</div><div class="line"></div><div class="line">    System.out.println(<span class="stringliteral">&quot;PDM Results: Field100=&quot;</span> + fld100Val +</div><div class="line">                       <span class="stringliteral">&quot;, Field101=&quot;</span> + fld101Val +</div><div class="line">                       <span class="stringliteral">&quot;, Field102=&quot;</span> + fld102Val);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>Notice that with sourceCreateMessageWithSDM function, the three fields (name and value) are created and added to the fset variable, which is then added to the SDM message. On the other hand, the sourceCreateMessageWithPDM function uses the FieldInfo object references to add the field values to the message for each of the three fields.</p>
<p>Also notice that the receiverParseMessageWithSDM requires a cast to the specific field class (like LBMSDMFieldInt8) once the field has been located. After the cast, calling the get method returns the expected value. On the other hand the receiverParseMessageWithPDM uses the FieldInfo object reference to directly retrieve the field value using the appropriate getFieldValueAs* method.</p>
<p><b>SDM Raw Classes</b></p>
<p>Several SDM classes with Raw in their name could be used as the value when creating an LBMSDMField. For example, an LBMSDMRawBlob instance could be created from a byte array and then that the LBMSDMRawBlob could be used as the value to a LBMSDMFieldBlob as shown in the following example.</p>
<div class="fragment"><div class="line">byte[] blob = <span class="keyword">new</span> byte[25];</div><div class="line">LBMSDMRawBlob rawSDMBlob = <span class="keyword">new</span> LBMSDMRawBlob(blob);</div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">  LBMSDMField fld103 = <span class="keyword">new</span> LBMSDMFieldBlob(<span class="stringliteral">&quot;Field103&quot;</span>,rawSDMBlob);</div><div class="line">} <span class="keywordflow">catch</span> (LBMSDMException e1) {</div><div class="line">  System.out.println(e1);</div><div class="line">}</div></div><!-- fragment --><p>The actual field named "Field103" is created in the try block using the rawSDMBlob variable which has been created to wrap the blob byte array. This field can be added to a LBMSDMFields object, which then uses it in a LBMSDMessage.</p>
<p>In PDM, there are no "Raw" classes that can be created. When setting the value for a field for a message, the appropriate variable type should be passed in as the value. For example, setting the field value for a BLOB field would mean simply passing the byte array directly in the setValue method as shown in the following code snippet since the field is defined as type BLOB.</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> PDMFieldInfo fldInfo103;</div><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> setupPDM() {</div><div class="line">  ...</div><div class="line">  fldInfo103 = defn.addFieldInfo(<span class="stringliteral">&quot;Field103&quot;</span>, PDMFieldType.BLOB, <span class="keyword">true</span>);</div><div class="line">  ...</div><div class="line">  byte[] blob = <span class="keyword">new</span> byte[25];</div><div class="line"></div><div class="line">  srcPDMMsg.setFieldValue(fldInfo103, blob);</div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><p>The PDM types of DECIMAL, TIMESTAMP, and MESSAGE expect a corresponding instance of PDMDecimal, PDMTimestamp, and PDMMessage as the field value when being set in the message so those types do require an instantiation instead of using a native Java type. For example, if "Field103" had been of type PDMFieldType.DECIMAL, the following code would be used to set the value.</p>
<div class="fragment"><div class="line">PDMDecimal decimal = <span class="keyword">new</span> PDMDecimal((<span class="keywordtype">long</span>)2, (byte)32);</div><div class="line">srcPDMMsg.setFieldValue(fldInfo103, decimal);</div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="sendingtosources"></a>
Sending to Sources&nbsp;&nbsp;<small><a href="#sendingtosources">&lt;-</a></small></h2>
<p>There are many use cases where a subscriber application wants to send a message to a publisher application. For example, a client application which subscribes to market data may want to send a refresh request to the publishing feed handler. While this is possible to do with normal sources and receivers, UM supports a streamlined method of doing this.</p>
<p>Starting with UM version 6.10, a <a class="el" href="index.html#sourcestring">Source String</a> can be used as a destination for sending a unicast immediate message. The UM library will establish a TCP connection to the publisher's context via its <em>UIM port</em> (also known as "request port"). The publishing application can receive this message either from a normal <a class="el" href="index.html#receiverobject">Receiver Object</a>, or from a context immediate message callback via configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagetopicreceiverfunctioncontext">immediate_message_topic_receiver_function (context)</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagereceiverfunctioncontext">immediate_message_receiver_function (context)</a> (for topicless messages).</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcestringfromreceiveevent"></a>
Source String from Receive Event&nbsp;&nbsp;<small><a href="#sourcestringfromreceiveevent">&lt;-</a></small></h3>
<p>A receiving application's receiver callback function can obtain a source's source string from the message structure. However, that string is not suitable to being passed directly to the unicast immediate message send function.</p>
<p>Here's a code fragment in C for receiving a message from a source, and sending a message back to the originating source. For clarity, error detection and handling code is omitted.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> user_receiver_callback(<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *rcv, <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html">lbm_msg_t</a> *msg, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  ...</div><div class="line">  <span class="keywordflow">switch</span> (msg-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#ab25327dc4b4ebf527106f6e708dbc05f">type</a>) {</div><div class="line">    ...</div><div class="line">  <span class="keywordflow">case</span> <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a>:</div><div class="line">    <span class="comment">/* user code which processes received message and sets up &quot;msg_for_src&quot; */</span></div><div class="line">    ...</div><div class="line">    <span class="comment">/* A valid UIM destination is &quot;SOURCE:&quot; + source string. */</span></div><div class="line">    <span class="keywordtype">char</span> destination[LBM_MSG_MAX_SOURCE_LEN + 8];</div><div class="line">    strcpy(destination, <span class="stringliteral">&quot;SOURCE:&quot;</span>);</div><div class="line">    strcat(destination, msg-&gt;<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#a6631c87ac29792705794d46c4e1cda06">source</a>);</div><div class="line"></div><div class="line">    err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message</a>(ctx, destination, NULL,   <span class="comment">/* no topic */</span></div><div class="line">                                       msg_for_src, <span class="keyword">sizeof</span>(msg_for_src),</div><div class="line">                                       LBM_SRC_NONBLOCK);  <span class="comment">/* Called from context thread. */</span></div><div class="line">    ...</div><div class="line">  }  <span class="comment">/* switch msg-&gt;type */</span></div><div class="line">  ...</div><div class="line">}  <span class="comment">/* user_receiver_callback */</span></div></div><!-- fragment --><p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aaa7a945411e63884f12918417e8d117c">lbm_msg_t</a> structure supplies the source string, and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a> is used to send a topicless immediate message to the source's context. Alternatively, a request message could be sent with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a>. If the receive events are delivered without an <a class="el" href="index.html#eventqueueobject">event queue</a>, then <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8a470f02029480f179cc4872b7fa713">LBM_SRC_NONBLOCK</a> is needed.</p>
<p>The example above uses the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a> message type. Most receiver event (message) types also contain a valid source string. Other likely candidates for this use case might be: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab5489080adc7157549a9930b30c68425">LBM_MSG_BOS</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a88920e0a4188081f9a14fc8f76c18578">LBM_MSG_UNRECOVERABLE_LOSS</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a6629139aaf902976c8df9de3f37d10db">LBM_MSG_UNRECOVERABLE_LOSS_BURST</a>.</p>
<p>Note that in this example, a topicless message is sent. This requires the publishing application to use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagereceiverfunctioncontext">immediate_message_receiver_function (context)</a> option to set up a callback for receipt of topicless immediate messages. Alternatively, a topic name can be supplied to the unicast immediate message function, in which case the publishing application would either create a normal <a class="el" href="index.html#receiverobject">Receiver Object</a> for that topic, or would configure a callback with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmulticastimmediatemessagingoperation.html#immediatemessagetopicreceiverfunctioncontext">immediate_message_topic_receiver_function (context)</a>.</p>
<p>A Java program obtains the source string via <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMMessage.html#a5691adf8b8b740c7813d2f8d605c394d">LBMMessage::source()</a>, and sends topicless unicast immediate messages via <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMContext.html#af565951d6e1b6b974c8ebd42bc0cfe16">LBMContext::sendTopicless()</a>.</p>
<p>A .NET implementation is essentially the same as Java.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sourcestringfromsourcenotificationfunction"></a>
Source String from Source Notification Function&nbsp;&nbsp;<small><a href="#sourcestringfromsourcenotificationfunction">&lt;-</a></small></h3>
<p>Some subscribing applications need to send a message to the publisher as soon as possible after the publisher is subscribed. Receiver events can sometimes take significant time to be delivered. The source string can be obtained via the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#sourcenotificationfunctionreceiver">source_notification_function (receiver)</a> configuration option. This defines a callback function which is called at the start of the process of subscribing to a source.</p>
<p>Here's a code fragment in C for sending a message to a newly-discovered source. For clarity, error detection and handling code is omitted.</p>
<p>During initialization, when the receiver is defined, the callback must be configured using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__src__notification__func__t__stct.html">lbm_rcv_src_notification_func_t_stct</a> structure:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__src__notification__func__t__stct.html">lbm_rcv_src_notification_func_t</a> src_notif_callback_info;</div><div class="line">src_notif_callback_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__src__notification__func__t__stct.html#a21e8f6ccfe58569a8f25118576ba6e51">create_func</a> = src_notif_callback_create;  <span class="comment">/* User function. */</span></div><div class="line">src_notif_callback_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__src__notification__func__t__stct.html#aa4153d1fbbe0ffca2259c4f2fdf38584">delete_func</a> = src_notif_callback_delete;  <span class="comment">/* User function. */</span></div><div class="line">src_notif_callback_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__src__notification__func__t__stct.html#a0dd01701648ecca057c07cee3abd43a9">clientd</a> = NULL;   <span class="comment">/* Can be user&#39;s receiver-specific state. */</span></div><div class="line">...</div><div class="line">lbm_rcv_topic_attr_t *rcv_topic_attr;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0427c06f6d62e7401d9a7d1f09c79a2c">lbm_rcv_topic_attr_create_from_xml</a>(&amp;rcv_topic_attr, <span class="stringliteral">&quot;MyCtx&quot;</span>, receiver_topic_name);</div><div class="line"></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1afc75f0fb3601d072b3463e7acf16a6">lbm_rcv_topic_attr_setopt</a>(rcv_topic_attr, <span class="stringliteral">&quot;source_notification_function&quot;</span>,</div><div class="line">                               &amp;src_notif_callback_info, <span class="keyword">sizeof</span>(src_notif_callback_info));</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3f0c8cba0e6f00fe7ae0ed717405e46d">lbm_topic_t</a> *receiver_topic;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a3de8a6a659896f76475c453683db4e18">lbm_rcv_topic_lookup</a>(&amp;receiver_topic, ctx, receiver_topic_name, rcv_topic_attr);</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0a4af6b8247cc5a0a24a8578fb6e83bd">lbm_rcv_t</a> *receiver;</div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa7491c50fefbc2b70f8035fce7ac1477">lbm_rcv_create</a>(&amp;receiver, ctx, receiver_topic, ...);</div></div><!-- fragment --><p>This creates the <a class="el" href="index.html#receiverobject">Receiver Object</a> with the source notification callback configured. Note that the source notification callback has both a create and a delete function, to facilitate state management by the user.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> * src_notif_callback_create(<span class="keyword">const</span> <span class="keywordtype">char</span> *source_name, <span class="keywordtype">void</span> *clientd)</div><div class="line">{</div><div class="line">  <span class="comment">/* This function is called when the subscription is being set up. */</span></div><div class="line"></div><div class="line">  <span class="comment">/* user code which sets up &quot;msg_for_src&quot; */</span></div><div class="line">  ...</div><div class="line">  <span class="comment">/* A valid UIM destination is &quot;SOURCE:&quot; + source string. */</span></div><div class="line">  <span class="keywordtype">char</span> destination[LBM_MSG_MAX_SOURCE_LEN + 8];</div><div class="line">  strcpy(destination, <span class="stringliteral">&quot;SOURCE:&quot;</span>);</div><div class="line">  strcat(destination, source_name);</div><div class="line"></div><div class="line">  err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message</a>(ctx, destination, NULL,   <span class="comment">/* no topic */</span></div><div class="line">                                     msg_for_src, <span class="keyword">sizeof</span>(msg_for_src),</div><div class="line">                                     LBM_SRC_NONBLOCK);  <span class="comment">/* Called from context thread. */</span></div><div class="line">  ...</div><div class="line">  <span class="keywordflow">return</span> NULL;  <span class="comment">/* Can be per-source state. */</span></div><div class="line">}  <span class="comment">/* src_notif_callback_create */</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> src_notif_callback_delete(<span class="keyword">const</span> <span class="keywordtype">char</span> *source_name, <span class="keywordtype">void</span> *clientd, <span class="keywordtype">void</span> *source_clientd) {</div><div class="line">  <span class="comment">/* This function not used for anything in this example, but could be used to</span></div><div class="line"><span class="comment">   * to clean up per-source state. */</span></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}  <span class="comment">/* src_notif_callback_delete */</span></div></div><!-- fragment --><p>A Java program configures the source notification callback via <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMReceiverAttributes.html#ada8450c3e6c34d298256279418f026a4">com::latencybusters::lbm::LBMReceiverAttributes::setSourceNotificationCallbacks</a>.</p>
<p>A .NET implementation is essentially the same as Java.</p>
<p><br />
 </p>
<h3><a class="anchor" id="sendingtosourcereadiness"></a>
Sending to Source Readiness&nbsp;&nbsp;<small><a href="#sendingtosourcereadiness">&lt;-</a></small></h3>
<p>In most use cases for sending messages to a source, there is an implicit assumption that a subscribing receiver is fully set up and ready to receive messages from the publisher. However, due to the asynchronous nature of UM, there is no straight-forward way for a receiver to know the earliest point in time when messages sent by the source will be delivered to the receiver. For example, in a routed network (using the <a class="el" href="index.html#umrouter">DRO</a>), a receiver might deliver BOS to the application, but that just means that the connection to the proper DRO is complete. There could still be delays in the entire end-to-end path being able to deliver messages.</p>
<p>Also, be aware that although unicast immediate messages are delivered via TCP, these messages are not guaranteed. Especially in a routed network, there exists the possibility that a message will fail to reach the publisher.</p>
<p>In most cases, the immediate message is received by the publisher, and by the time the publisher reacts, the end-to-end source-to-receiver path is active. However, in the unlikely event that something goes wrong, a subscribing application should implement a timeout/retry mechanism. This advice is not specific to the "sending to source" use cases, and should be built into any kind of request/response-oriented use case.</p>
<p><br />
 </p>
<h2><a class="anchor" id="spectrum"></a>
Spectrum&nbsp;&nbsp;<small><a href="#spectrum">&lt;-</a></small></h2>
<p>UM Spectrum, which refers to a "spectrum of channels", allows the application designer to sub-divide a topic into any number of channels, which can be individually subscribed to by a receiving application. This provides an extra level of message filtering.</p>
<p>The publisher first allocates the desired number of source channel objects using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a73298f53aa9c5572cd0b1e68a4ec435a">lbm_src_channel_create()</a>. Then it creates a topic source in the normal way. Finally, the application sends messages using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a>, specifying the source channel object in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a21504de56612c7c6e4be655402b47a37">lbm_src_send_ex_info_t</a>'s channel_info field.</p>
<p>A receiving application first creates a topic receiver in the normal way. Then it subscribes to channels using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa8304114445d291e6f16472d733ab250">lbm_rcv_subscribe_channel()</a> or lbm_wrcv_subscribe_channel(). Since each channel requires a different receiver callback, the receiver application can achieve more granular filtering of messages. Moreover, messages are received in-order across channels since all messages are part of the same topic stream.</p>
<p>It should be noted that a regular topic receiver (one for which no spectrum channels are subscribed) delivers all received messages from a matching spectrum topic source to the receiver's callback without creating the channel_info object.</p>
<p>You can accomplish the same level of filtering with a topic space design that creates separate topics for each channel, however, UM cannot guarantee the delivery of messages from multiple sources/topics in any particular order. Not only can UM Spectrum deliver the messages over many channels in the order they were sent by the source, but it also reduces topic resolution traffic since UM advertises only topics, not channels.</p>
<dl class="section note"><dt>Note</dt><dd>With the UMQ product, you cannot use UM Spectrum with Queuing (both Brokered and ULB).</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="spectrumperformanceadvantages"></a>
Spectrum Performance Advantages&nbsp;&nbsp;<small><a href="#spectrumperformanceadvantages">&lt;-</a></small></h3>
<p>The use of separate callbacks for different channels improves filtering and also relieves the source application of the task of including filtering information in the message data.</p>
<p>Java and .NET performance also receives a boost because messages not of interest can be discarded before they transition to the Java or .NET level.</p>
<p><br />
 </p>
<h3><a class="anchor" id="spectrumconfigurationoptions"></a>
Spectrum Configuration Options&nbsp;&nbsp;<small><a href="#spectrumconfigurationoptions">&lt;-</a></small></h3>
<p>Spectrum's default behavior delivers messages on any channels the receiver has subscribed to on the callbacks specified when subscribing, and all other messages on the receiver's default callback. This behavior can be changed with the following configuration options.</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#nullchannelbehaviorreceiver">null_channel_behavior (receiver)</a> - behavior for messages delivered with no channel information. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#unrecognizedchannelbehaviorreceiver">unrecognized_channel_behavior (receiver)</a> - behavior for messages delivered with channel information but are on a channel for which the receiver has not registered interest. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#channelmaptableszreceiver">channel_map_tablesz (receiver)</a> - controls the size of the table used by a receiver to store channel subscriptions. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="spectrumreceivercallback"></a>
Spectrum Receiver Callback&nbsp;&nbsp;<small><a href="#spectrumreceivercallback">&lt;-</a></small></h3>
<p>When an application subscribes to a spectrum channel, it uses the spectrum subscribe API: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa8304114445d291e6f16472d733ab250">lbm_rcv_subscribe_channel()</a> - C/C++ </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMReceiver.html#a10b09a02efbc148a9176fd2d642e452b">com::latencybusters::lbm::LBMReceiver::subscribeChannel()</a> - Java/.NET </li>
</ul>
<p>Note that when subscribing to a channel, the receiver callback function is optional. If null is supplied as the callback, UM will invoke the underlying receiver's callback.</p>
<p>If a separate callback is supplied for the channel, be aware that only data message event types (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa47eb604db7dc9fd53f9650ed940e058">LBM_MSG_DATA</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab83f7de50ce32f69651a7252d84ea828">LBM_MSG_REQUEST</a>) will be delivered to it. Non-data events (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab5489080adc7157549a9930b30c68425">LBM_MSG_BOS</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2647b87f92adb5a34ea129fbfeeed5a3">LBM_MSG_EOS</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a88920e0a4188081f9a14fc8f76c18578">LBM_MSG_UNRECOVERABLE_LOSS</a>, etc.) will be delivered to the underlying receiver's callback.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcesandspectrum"></a>
Smart Sources and Spectrum&nbsp;&nbsp;<small><a href="#smartsourcesandspectrum">&lt;-</a></small></h3>
<p><a class="el" href="index.html#smartsources">Smart Sources</a> support Spectrum, but via different API functions. You need to tell UM that you intend to use spectrum at Smart Source creation time using the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcenablespectrumchannelsource">smart_src_enable_spectrum_channel (source)</a> configuration option. This pre-allocates space in the message header for the spectrum channel.</p>
<p>With Smart Sources, there is no need to allocate a Spectrum source object with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a73298f53aa9c5572cd0b1e68a4ec435a">lbm_src_channel_create()</a>. Instead, you simply set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5aa5ef8cbf768dd5ad5bb8a709cf9d78">LBM_SSRC_SEND_EX_FLAG_CHANNEL</a> flag and the spectrum channel number in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> passed to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex()</a> API function. It is also usually necessary to tell UM to rebuild the header. For example:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html">lbm_ssrc_send_ex_info_t</a> ss_send_info;</div><div class="line">memset((<span class="keywordtype">char</span> *)&amp;ss_send_info, 0, <span class="keyword">sizeof</span>(ss_send_info));</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5aa5ef8cbf768dd5ad5bb8a709cf9d78">LBM_SSRC_SEND_EX_FLAG_CHANNEL</a> | <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8e81e2661e6d2845790041d170864b1e">LBM_SSRC_SEND_EX_FLAG_REBUILD_BUFFER</a>;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#af3318fcf60e612912d16cd401e8aa39e">channel</a> = desired_channel_number;</div><div class="line"></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div></div><!-- fragment --><p>Note that if you are sending multiple messages in a row to the same spectrum channel, you can get a small performance boost by leaving the header alone and code subsequent calls as:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html">lbm_ssrc_send_ex_info_t</a> ss_send_info;</div><div class="line">ss_send_info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5aa5ef8cbf768dd5ad5bb8a709cf9d78">LBM_SSRC_SEND_EX_FLAG_CHANNEL</a>;</div><div class="line"></div><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ss, msg_buff, msg_size, 0, &amp;ss_send_info);</div></div><!-- fragment --><p>When a Smart Source is created with Spectrum enabled, it is possible to send messages without a Spectrum channel, either by clearing the LBM_SSRC_SEND_EX_FLAG_CHANNEL flag in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a>, or by simply not supplying a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> object by passing NULL for the <code>info</code> parameter. This suppresses all features enabled by that structure.</p>
<dl class="section note"><dt>Note</dt><dd>If using both Spectrum and <a class="el" href="index.html#messageproperties">Message Properties</a> with a single Smart Source, there is an added restriction: it is not possible to send a message omitting only one of those features. If both are enabled when the Smart Source is created, it is not possible to send a message with a message property and not a channel, and it is not possible to send a message with a channel and not a property. This is because the message header is defined at Smart Source creation, and the header either must contain both or neither.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="hotfailoverhf"></a>
Hot Failover (HF)&nbsp;&nbsp;<small><a href="#hotfailoverhf">&lt;-</a></small></h2>
<p>UM Hot Failover (HF) lets you implement sender redundancy in your applications. You can create multiple HF senders in different UM contexts, or, for even greater resiliency, on separate machines. There is no hard limit to the number of HF sources, and different HF sources can use different transport types.</p>
<p>Hot Failover receivers filter out the duplicate messages and deliver one message to your application. Thus, sources can drop a few messages or even fail completely without causing message loss, as long as the HF receiver receives each message from at least one source.</p>
<p>The following diagram displays Hot Failover operation.</p>
<div class="image">
<img src="Hot_Failover.png" alt="Hot_Failover.png"/>
</div>
 <p>In the figure above, HF sources send copies of Message X. An HF receiver delivers the first copy of Message X it receives to the application, and discards subsequent copies coming from the other sources.</p>
<dl class="section attention"><dt>Attention</dt><dd>See <a class="el" href="index.html#hotfailoverrestrictions">Hot Failover Restrictions</a>.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="implementinghotfailoversources"></a>
Implementing Hot Failover Sources&nbsp;&nbsp;<small><a href="#implementinghotfailoversources">&lt;-</a></small></h3>
<p>You create Hot Failover sources with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab5f6226d21dd4294bbad7d9f3e7c0bf6">lbm_hf_src_create()</a>. This returns a source object with internal state information that lets it send HF messages. You delete HF sources with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a29d45db8f76835b4ae78f4568c25712f">lbm_src_delete()</a> function.</p>
<p>HF sources send HF messages via <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac515c1425d9b3f04f1e2cea5d66d3005">lbm_hf_src_send_ex()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acb6f42a8811cb998b4b19748b190f39b">lbm_hf_src_sendv_ex()</a>. These functions take a sequence number, supplied via the exinfo object, that HF receivers use to identify the same message sent from different HF sources. The exinfo has an hf_sequence_number, with a flag (LBM_SRC_SEND_EX_FLAG_HF_32 or LBM_SRC_SEND_EX_FLAG_HF_64) that identifies whether it's a 32- or 64-bit number. Each HF source sends the same message content for a given sequence number, which must be coordinated by your application.</p>
<p>If the source needs to restart its sequence number to an earlier value (e.g. start of day; not needed for normal wraparound), delete and re-create the source and receiver objects. Without re-creating the objects, the receiver sees the smaller sequence number, assumes the data are duplicate, and discards it. In (and only in) cases where this cannot be done, use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9f7ed3785938fcfd4771965d6430c4f2">lbm_hf_src_send_rcv_reset()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Your application must synchronize calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac515c1425d9b3f04f1e2cea5d66d3005">lbm_hf_src_send_ex()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acb6f42a8811cb998b4b19748b190f39b">lbm_hf_src_sendv_ex()</a> with all threads sending on the same source. (One symptom of not doing so is messages appearing at the receiver as inside intentional gaps and being erroneously discarded.)</dd></dl>
<p>Please be aware that non-HF receivers created for an HF topic receive multiple copies of each message. We recommend you establish local conventions regarding the use of HF sources, such as including "HF" in the topic name.</p>
<p>For an example source application, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmhfsrc_c">Example lbmhfsrc.c</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="implementinghotfailoverreceivers"></a>
Implementing Hot Failover Receivers&nbsp;&nbsp;<small><a href="#implementinghotfailoverreceivers">&lt;-</a></small></h3>
<p>You create HF receivers with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac208c246a6e856e24e1130060e1806c3">lbm_hf_rcv_create()</a>, and delete them using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abc68152bcf4d18ef1d31d8f6a15ac080">lbm_hf_rcv_delete()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a755bd1ee0a12622098b618cef46d254f">lbm_hf_rcv_delete_ex()</a>.</p>
<p>Incoming messages have an hf_sequence_number field containing the sequence number, and a message flag (LBM_MSG_FLAG_HF_32 or LBM_MSG_FLAG_HF_64) noting the bit size.</p>
<dl class="section note"><dt>Note</dt><dd>Previous UM versions used sequence_number for HF message identification. This field holds a 32-bit value and is still set for backwards compatibility, but if the HF sequence numbers are 64-bit lengths, this non-HF sequence number is set to 0. Also, you can retrieve the original (non-HF) topic sequence number via lbm_msg_retrieve_original_sequence_number() or, in Java and .NET, via LBMMessage.osqn().</dd></dl>
<p>For the maximum time period to recover lost messages, the HF receiver uses the minimum of the LBT-RM and LBT-RU NAK generation intervals (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakgenerationintervalreceiver">transport_lbtrm_nak_generation_interval (receiver)</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrureliability.html#transportlbtrunakgenerationintervalreceiver">transport_lbtru_nak_generation_interval (receiver)</a>). Each transport protocol is configured as normal, but the lost message recovery timer is the minimum of the two settings.</p>
<p>Some lbm_msg_t objects coming from HF receivers may be flagged as having "passed through" the HF receiver. This means that the message has not been ordered with other HF messages. These messages have the LBM_MSG_FLAG_HF_PASS_THROUGH flag set. UM flags messages sent from HF sources using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> in this manner, as do all non-HF sources. Also, UM flags EOS, no source notification, and requests in this manner as well.</p>
<p>For an example receiver application, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmhfrcv_c">Example lbmhfrcv.c</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="implementinghotfailoverwildcardreceivers"></a>
Implementing Hot Failover Wildcard Receivers&nbsp;&nbsp;<small><a href="#implementinghotfailoverwildcardreceivers">&lt;-</a></small></h3>
<p>To create an HF wildcard receiver, set option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html#hfreceiverwildcardreceiver">hf_receiver (wildcard_receiver)</a> to 1, then create a wildcard receiver with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5b5d52f6b87499213757b73b09bc8160">lbm_wildcard_rcv_create()</a>. This actually creates individual HF receivers on a per-topic basis, so that each topic can have its own set of HF sequence numbers. Once the HF wildcard receiver detects that all sources for a particular topic are gone it closes the individual topic HF receivers and discards the HF sequence information (unlike a standard HF receiver). You can extend or control the delete timeout period of individual HF receivers with option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpwildcardreceiver.html#resolvernosourcelingertimeoutwildcardreceiver">resolver_no_source_linger_timeout (wildcard_receiver)</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="javaandnet"></a>
HF with Java and .NET&nbsp;&nbsp;<small><a href="#javaandnet">&lt;-</a></small></h3>
<p>For information on implement the HF feature in a Java application, go to UM Java API and see the documentation for classes <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMHotFailoverReceiver.html">LBMHotFailoverReceiver</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMHotFailoverSource.html">LBMHotFailoverSource</a>.</p>
<p>For information on implement the HF feature in a .NET application, go to UM .NET API and navigate to Namespaces-&gt;<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBM.html">com.latencybusters.lbm</a>-&gt;LBMHotFailoverReceiver and LBMHotFailoverSource.</p>
<p><br />
 </p>
<h3><a class="anchor" id="usinghotfailoverwithpersistence"></a>
Using Hot Failover with Persistence&nbsp;&nbsp;<small><a href="#usinghotfailoverwithpersistence">&lt;-</a></small></h3>
<p>When implementing Hot Failover with Persistence, you must consider the following impact on hardware resources:</p>
<ul>
<li>
Additional storage space required for a persistent Store </li>
<li>
Higher disk activity </li>
<li>
Higher network activity </li>
<li>
Increased application complexity regarding message filtering </li>
</ul>
<p>Also note that you must enable <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#explicitacknowledgments">Explicit Acknowledgments</a> and "Hot Failover duplicate delivery" (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html#hfduplicatedeliveryreceiver">hf_duplicate_delivery (receiver)</a>) in each Hot Failover receiving application.</p>
<p>For detailed information on using Hot Failover with Persistence, see the Knowledge Base article <a href="https://kb.informatica.com/faq/5/Pages/80173.aspx">FAQ: Is UMP compatible with Hot Failover?</a></p>
<p><br />
 </p>
<h3><a class="anchor" id="hotfailoverintentionalgapsupport"></a>
Hot Failover Intentional Gap Support&nbsp;&nbsp;<small><a href="#hotfailoverintentionalgapsupport">&lt;-</a></small></h3>
<p>UM supports intentional gaps in HF message streams. Your HF sources can supply message sequence numbers with number gaps up to 1073741824. HF receivers automatically detect the gaps and consider any missing message sequence numbers as not sent and do not attempt recovery for these missing sequence numbers. See the following example.</p>
<ol>
<li>
HF source 1 sends message sequence numbers: 10, 11, 12, 13, 25, 26, 38 </li>
<li>
HF source 2 sends message sequence numbers: 10, 11, 12, 13, 25, 26, 38 </li>
</ol>
<p>HF receiver 1 receives message sequence numbers in order with no pause between any messages: 10, 11, 12, 13, 25, 26, 38</p>
<p><br />
 </p>
<h3><a class="anchor" id="hotfailoveroptionalmessages"></a>
Hot Failover Optional Messages&nbsp;&nbsp;<small><a href="#hotfailoveroptionalmessages">&lt;-</a></small></h3>
<p>Hot Failover sources can send optional messages that HF receivers can be configured to receive or not receive (<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html#hfoptionalmessagesreceiver">hf_optional_messages (receiver)</a>). HF receivers detect an optional message by checking <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__msg__t__stct.html#a9041a176f44dca95c3a5c6cc23d32d6c">lbm_msg_t.flags</a> for LBM_MSG_FLAG_HF_OPTIONAL. HF sources indicate an optional message by passing <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a5bf62d916b1acee97156dc8077ac3584">LBM_SRC_SEND_EX_FLAG_HF_OPTIONAL</a> in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__src__send__ex__info__t__stct.html#aa450a079510ebdc97b19625d10bd18ea">lbm_src_send_ex_info_t.flags</a> field to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac515c1425d9b3f04f1e2cea5d66d3005">lbm_hf_src_send_ex()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acb6f42a8811cb998b4b19748b190f39b">lbm_hf_src_sendv_ex()</a>. In the examples below, optional messages appear with an "o" after the sequence number.</p>
<ol>
<li>
HF source 1 sends message sequence numbers: 10, 11, 12, 13o, 14o, 15, 16o, 17o, 18o, 19o, 20 </li>
<li>
HF source 2 sends message sequence numbers: 10, 11, 12, 13o, 14o, 15, 16o, 17o, 18o, 19o, 20 </li>
</ol>
<p>HF receiver 1 receives: 10, 11, 12, 13o, 14o, 15, 16o, 17o, 18o, 19o, 20</p>
<p>HF receiver 2, configured to ignore optional messages, receives: 10, 11, 12, 15, 20</p>
<p><br />
 </p>
<h3><a class="anchor" id="usinghotfailoverwithordereddelivery"></a>
Using Hot Failover with Ordered Delivery&nbsp;&nbsp;<small><a href="#usinghotfailoverwithordereddelivery">&lt;-</a></small></h3>
<p>An HF receiver takes some of its operating parameters directly from the receive topic attributes. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">ordered_delivery (receiver)</a> setting indicates the ordering for the HF receiver.</p>
<dl class="section note"><dt>Note</dt><dd>UM supports Arrival Order with HF only when all sources use the same transport type.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="hotfailoverrestrictions"></a>
Hot Failover Restrictions&nbsp;&nbsp;<small><a href="#hotfailoverrestrictions">&lt;-</a></small></h3>
<ul>
<li>
With the UMQ product, you cannot use Hot Failover with Queuing (both Brokered and ULB). </li>
<li>
The <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> feature does not support Hot Failover. </li>
<li>
The <a class="el" href="index.html#smartsources">Smart Sources</a> feature does not support Hot Failover. </li>
<li>
You cannot combine Hot Failover with the similar feature, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#drohotlinks">DRO Hotlinks</a>. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="hotfailoveracrossmultiplecontexts"></a>
Hot Failover Across Multiple Contexts (HFX)&nbsp;&nbsp;<small><a href="#hotfailoveracrossmultiplecontexts">&lt;-</a></small></h3>
<dl class="section warning"><dt>Warning</dt><dd><b>The HFX feature is deprecated and may be removed in a future release</b>. Users of HFX are advised to <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>.</dd></dl>
<p>If you have a receiving application on a multi-homed machine receiving HF messages from HF sources, you can set up the Hot Failover Across Contexts (HFX) feature. This involves setting up a separate UM context to receive HF messages over each NIC and then creating an HFX Object, which drops duplicate HF messages arriving over all contexts. Your receiving application then receives only one copy of each HF message. The HFX feature achieves the same effect across multiple contexts as the normal Hot Failover feature does within a single context.</p>
<p>The following diagram displays Hot Failover operation across UM contexts.</p>
<div class="image">
<img src="Hot_Failover_X.png" alt="Hot_Failover_X.png"/>
</div>
 <p>For each context that receives HF messages, create one HFX Receiver per topic. Each HFX Receiver can be configured independently by passing in a UM Receiver attributes object during creation. A unique client data pointer can also be associated with each HFX Receiver. The HFX Object is a special Ultra Messaging object and does not live in any UM context.</p>
<p>Note: You never have to call lbm_topic_lookup() for a HFX Receiver. If you are creating HFX Receivers along with normal UM receivers for the same topic, do not interleave the calls. For example, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a82e9efbf70242d83ab287916ac497645">lbm_hfx_create()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae717b7b9923a6e4277ae9f7409983ffc">lbm_hfx_rcv_create()</a> for the topic. Then call lbm_topic_lookup() and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aa7491c50fefbc2b70f8035fce7ac1477">lbm_rcv_create()</a> for the topic to create the normal UM receivers.</p>
<p>The following outlines the general procedure for HFX.</p>
<ol>
<li>
Create an HFX Object for every HF topic of interest with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a82e9efbf70242d83ab287916ac497645">lbm_hfx_create()</a>, passing in an attributes object created with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aabc739544b1a28481e9b4bc51bb49705">lbm_hfx_attr_create_from_xml()</a> to specify any attributes desired. </li>
<li>
Create a context for the first NIC receiving HF messages with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a>. </li>
<li>
Create a HFX Receiver for every HF topic with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae717b7b9923a6e4277ae9f7409983ffc">lbm_hfx_rcv_create()</a>, passing in UM Receive Topic Attributes. </li>
<li>
Repeat steps 2 and 3 for all NICs receiving HF message </li>
<li>
Receive messages. The HFX Object identifies and drops all duplicates, delivering messages through a single callback (and optional event queue) specified when you created the HFX Object. </li>
</ol>
<p>Delete each HFX Receiver with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a096626db73533d6c39b22765014485b7">lbm_hfx_rcv_delete()</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a08d8cbd7f47af1d7b2199c85ecf7c44c">lbm_hfx_rcv_delete_ex()</a>. Delete the HFX Object with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#abc9924a0bd826db0c45a42d7199030b1">lbm_hfx_delete()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>When writing source-side HF applications for HFX, be aware that HFX receivers do not support hf_sequence, 64-bit sequence numbers, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9f7ed3785938fcfd4771965d6430c4f2">lbm_hf_src_send_rcv_reset()</a> function, or HF wildcard receivers. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grphotfailoveroperation.html">Hot Failover Operation Options</a>, especially HFX-specific options.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="nakcutoff"></a>
NAK Cutoff&nbsp;&nbsp;<small><a href="#nakcutoff">&lt;-</a></small></h2>
<p>The "NAK cutoff" feature allows an application to force its context(s) to stop sending NAKs (LBT-RM only), even if packet loss is detected.</p>
<p>This feature was first added to UM in version 6.16.1 with the C API <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a49f29921c51b53813735b9f5f2750b47">lbm_context_set_nak_cutoff</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="whynakcutoff"></a>
Why NAK Cutoff?&nbsp;&nbsp;<small><a href="#whynakcutoff">&lt;-</a></small></h3>
<p>NAK-based network protocols, like LBT-RM and LBT-RU, can be susceptible to <a class="el" href="index.html#glossarynakstorm">NAK storms</a>. UM's algorithms enable the user to control the risk of NAK storms, reducing it close to zero if desired. However, be aware that these algorithms present a trade-off between performance and stability that needs to be considered.</p>
<p>Many users prevent NAK storms by simply provisioning their systems to be able to handle their worst-case load. In this case, there can be no overload (unless the calculation of "worst case" was faulty), and without overload, there can be no NAK storm.</p>
<p>But for some users, designing for theoretical worst-case is not practical, so other strategies must be used. For example, to reduce the chances of a NAK storm close to zero, it might be necessary to establish <a class="el" href="index.html#ratecontrols">Rate Controls</a> that will, under periods of stress, limit a publisher's ability to send messages when it is ready to. This is essentially an intentional use of latency to prevent overload.</p>
<p>But again, many of our customers consider those latency costs too high, so they live with increased risk. For example, they may establish rate controls that "overbook" the network's capacity under the assumption that not <em>all</em> publishers will send at their maximum allowed rate at the same time. This is generally a safe assumption, but still leaves open the possibility of overload.</p>
<p>UM version 6.16.1 introduced a feature called the NAK Cutoff. This is an API that allows an application to force its context(s) to stop sending NAKs, even if packet loss is detected. This API may be useful to users who cannot reduce the changes of NAK storms low enough, and want a contingency for the unlikely event that a NAK storm does happen. Note that employing this feature will result in some amount of <a class="el" href="index.html#unrecoverableloss1">Unrecoverable Loss</a>.</p>
<p>If the operations team concludes that they are having a NAK storm, they can command their applications to invoke the NAK cutoff feature (call the API) to disable NAKS long enough to allow the network to stabilize.</p>
<dl class="section attention"><dt>Attention</dt><dd>This API does not control remote contexts. Only the context(s) of the application calling it are affected. In most UM-based systems, there is an independent network used for command and control, separate from the low-latency network used for application data. It is the user's responsibility to implement centralized command and control to instruct their applications to call the cutoff API.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="whatisanakstorm"></a>
What Is a NAK Storm?&nbsp;&nbsp;<small><a href="#whatisanakstorm">&lt;-</a></small></h3>
<p>When applications send NAKs, that is typically not a NAK storm. NAKs are simply part of the UM lost packet recovery protocols. But in a worst-case scenario, the increased load of the lost-packet recovery protocols can cause additional packet loss, leading to a self-reinforcing feedback loop where loss triggers loss recovery, which causes additional loss, which triggers more loss recovery, etc.</p>
<p>This self-reinforcing feedback loop is a NAK storm. If not controlled, they can cripple a network for minutes or even hours, potentially requiring a shutdown / restart of the core parts of your system.</p>
<p>See <a href="https://ultramessaging.github.io/um_kb/html/nak-storms.html">NAK Storms</a> for detailed explanation of NAK storm causes, prevention, and avoidance.</p>
<p><br />
 </p>
<h3><a class="anchor" id="nakstormprevention"></a>
NAK Storm Prevention&nbsp;&nbsp;<small><a href="#nakstormprevention">&lt;-</a></small></h3>
<p>You can reduce the chances of a NAK storm by avoiding packet loss. Since the vast majority of packet loss is caused by overload, the basic methods of avoiding packet loss are to maximize the efficiency of data consumers and to control the sending of messages by data sources.</p>
<p>See <a href="https://ultramessaging.github.io/um_kb/html/packet-loss.html">Packet Loss</a> for detail and loss avoidance strategies.</p>
<p>See <a href="https://ultramessaging.github.io/um_kb/html/configuring-udp-based-transports.html">Configuring UDP-Based Transports</a> for specific UM configuration advice.</p>
<p><a class="anchor" id="daemonstatistics"></a><br />
 </p>
<h2><a class="anchor" id="binarydaemonstatistics"></a>
Binary Daemon Statistics&nbsp;&nbsp;<small><a href="#binarydaemonstatistics">&lt;-</a></small></h2>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>The <a class="el" href="index.html#persistence">Persistence</a> Store daemon and the <a class="el" href="index.html#umrouter">DRO</a> daemon each have a simple web server which provides operational information. This information is important for monitoring the operation and performance of these daemons. However, while the web-based presentation is convenient for manual, on-demand monitoring, it is not suitable for automated collection and recording of operational information for historical analysis.</p>
<p>(The <a class="el" href="index.html#glossaryumds">UMDS</a> product also supports Daemon Statistics as of UMDS version 6.12; see UMDS documentation for details.)</p>
<p>Starting with UM version 6.11, a feature called "Daemon Statistics" has been added to the Store and DRO daemons. The Stateful Resolver Service (SRS), added in UM version 6.12, supports Daemon Statistics only (no web server). The Daemon Statistics feature supports the background publishing of their operational information via UM messages. Monitoring systems can now subscribe to this information in much the same way that UM transport statistics can be subscribed.</p>
<p>While the information published by the Store, DRO, and SRS daemon statistics differ in their content, the general feature usage is the same between them. When the feature is configured, the daemon will periodically collect and publish its operational information.</p>
<p>The following sections give general information which is common across daemons, followed by links to daemon-specific details.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemoncontroller"></a>
Daemon Controller&nbsp;&nbsp;<small><a href="#daemoncontroller">&lt;-</a></small></h3>
<p>With the introduction of the Daemon Statistics feature, a new context is added to the daemons: the Daemon Controller. This context publishes the statistics and also can be configured to accept daemon control requests from external applications. These control requests are primarily used for controlling the Daemon Statistics feature (see <a class="el" href="index.html#daemoncontrolrequests">Daemon Control Requests</a>), but are also used for a few daemon-specific control functions that are unrelated to Daemon Statistics (for example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/storedaemonstatistics.html#requestmarkstoredmessageinvalid">Request: Mark Stored Message Invalid</a>).</p>
<p>Note that in every UM component that supports the Daemon Statistics feature, the Daemon Controller defaults to disabled. Each component's Daemon Statistics configuration must be set to enable the function of the Daemon Controller.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemonstatisticsstructures"></a>
Daemon Statistics Structures&nbsp;&nbsp;<small><a href="#daemonstatisticsstructures">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>The operational information is published as messages of different types sent over a normal UM topic source (topic name configurable). For the Store and DRO daemons, each message is in the form of a binary, C-style data structure.</p>
<p>There are generally two categories of messages: <em>config</em> and <em>stats</em>. A given instance of a category "config" message does not have content which changes over time. An instance of a category "stats" message has content that <em>does</em> change over time. The daemon-specific documentation indicates which messages are in which category.</p>
<p>Each message type is configured for a publishing interval. When the publishing interval for a message type expires, the possible messages are checked to see if its content has materially changed since the last interval. If not, then the message is <em>not</em> republished. The publishing interval for a stat message is typically set to shorter periods to see those changes as they occur.</p>
<p>Note that the SRS message format is JSON, and therefore the granularity of published data is finer. A given message type might be published, but only a subset of the fields within the message might be included. In contrast, the daemons which publish binary structures send the structures complete.</p>
<p>Finally, note that while the contents of a given instance of a config message does not change over time, new instances of the message type can be sent as a result of state changes. For example, a new instance of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/umedmonmsgs_8h.html#a3e3a1b935708cc8ac42cb70b0caf6808">umestore_repo_dmon_config_msg_t</a> is published each time a new source registers with the Store.</p>
<p>More detailed information is available in the daemon-specific documentation referenced below.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemonstatisticsbinarydata"></a>
Daemon Statistics Binary Data&nbsp;&nbsp;<small><a href="#daemonstatisticsbinarydata">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>For the Store and DRO daemons, the messages published are in binary form and map onto the C data structures defined for each message type.</p>
<p>For the SRS service, the messages are formatted as JSON, so this section does not apply to the SRS.</p>
<p>The byte order of the structure fields is defined as the host endian architecture of the publishing daemon. Thus, if a monitoring host receiving the messages has the same endian architecture, the binary structures can be used directly. If the monitoring host has the opposite endian architecture, the receiver must byte-swap the fields.</p>
<p>The message structure is designed to make it possible for a monitoring application to detect a mismatch in endian architecture. Detection and byte swapping is demonstrated with daemon-specific example monitoring applications.</p>
<p>More detailed information is available in the daemon-specific documentation referenced below.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemonstatisticsversioning"></a>
Daemon Statistics Versioning&nbsp;&nbsp;<small><a href="#daemonstatisticsversioning">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>For the Store and DRO daemons, each message sent by the daemon consists of a standard header followed by a message-type-specific set of fields. The standard header contains a <code>version</code> field which identifies the version of the C include file used to build the daemon.</p>
<p>For the SRS service, the messages are formatted as JSON, so this section does not apply to the SRS.</p>
<p>For example, the Store daemon is built with the include file <code><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/umedmonmsgs_8h.html">umedmonmsgs.h</a></code>. With each daemon statistics message sent by the Store daemon, it sets the header version field to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/umedmonmsgs_8h.html#af43ca32ea1917897c4ff1310d214c20b">LBM_UMESTORE_DMON_VERSION</a>. With each new release of the UM package, if that include file changes in a substantive way, the value of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/umedmonmsgs_8h.html#af43ca32ea1917897c4ff1310d214c20b">LBM_UMESTORE_DMON_VERSION</a> is increased. In this way, a monitoring application can determine if it is receiving messages from a Store daemon whose data structures match the monitoring application's structure definitions.</p>
<p>More detailed information is available in the daemon-specific documentation referenced below.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemoncontrolrequests"></a>
Daemon Control Requests&nbsp;&nbsp;<small><a href="#daemoncontrolrequests">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>Each daemon publishing binary daemon stats can optionally be configured to accept command-and-control requests from administrative applications. These command-and-control requests are handled by the daemon's <a class="el" href="index.html#daemoncontroller">Daemon Controller</a>, a context added to support Daemon Statistics.</p>
<dl class="section warning"><dt>Warning</dt><dd>If misused, the Daemon Control Requests feature allows a user to interfere with the messaging infrastructure in potentially disruptive ways. By default, this feature is disabled. However, specially if "config" requests are enabled, Informatica recommends <a class="el" href="index.html#securingdaemoncontrolrequests">Securing Daemon Control Requests</a>.</dd></dl>
<p>There are different categories of these requests. All daemons have in common categories <em>"snapshot"</em> and <em>"config"</em>, which are related to Daemon Statistics. Other categories are specific to the daemon type.</p>
<p>"Snapshot" requests tell the daemon to immediately republish the desired stats and/or configs without waiting until the next publishing interval. These requests might be sent by a monitoring application which has only just started running and needs a full snapshot of the operational information.</p>
<p>"Config" requests tell the daemon to modify an operational parameter of the running daemon.</p>
<p>An application sends a request to the daemon, and the daemon sends status messages in response. The exchanges are made via standard UM topicless immediate <a class="el" href="index.html#requestresponse">Request/Response</a> messaging. These requests should be sent using the Unicast Immediate Messaging (UIM) API for sending the requests using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a>. See <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> for details on UIM.</p>
<p>To use UIM effectively, Informatica recommends configuring the daemon monitor context for a specific UIM interface and port using: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpportcontext">request_tcp_port (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingnetwork.html#requesttcpinterfacecontext">request_tcp_interface (context)</a>. This enables the monitoring application to know how to address the request UIMs to the proper daemon.</p>
<p>For the Store and DRO daemons, The request message is formatted as a simple ASCII string. For the SRS service, the request message is formatted as a JSON message. The request is sent as a topicless unicast immediate request message. The daemon reacts by parsing the request and sending a UM response with a success/failure response. If the request was parsed successfully, the daemon then performs the requested operation (republishing the data or modifying the operational parameter). There are daemon-specific example applications which demonstrate the use of this request feature.</p>
<p>More detailed information is available in the daemon-specific documentation referenced below.</p>
<p><br />
 </p>
<h3><a class="anchor" id="securingdaemoncontrolrequests"></a>
Securing Daemon Control Requests&nbsp;&nbsp;<small><a href="#securingdaemoncontrolrequests">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>UM Daemon Statistics are implemented using normal UM messaging. In particular, the <a class="el" href="index.html#daemoncontroller">Daemon Controller</a> capability allows a remote application to send requests to a daemon that modify its behavior. If misused, these behaviors can be disruptive to normal operation. For example, the "umedmon" program can instruct a persistent Store to flag stored messages as invalid, which would prevent their delivery to a recovering receiver.</p>
<p>Note that the UM daemons default to rejecting these command-and-control messages, so taking special security precautions is only necessary if you have configured daemons to enable the Daemon Control requests.</p>
<p>One common way to prevent unauthorized use is to tightly control access to your production network so that no unauthorized users can accidentally or maliciously use Daemon Control requests to interfere with normal operation.</p>
<p>Additionally, you can configure the Daemon Control context for encryption, which supports certificate-based access control. This requires the use of an encrypted <a class="el" href="index.html#topicresolutiondomain">TRD</a> for Daemon Statistics. If your normal message data is unencrypted, you will need to define one or more <em>new</em> TRDs for Daemon Statistics that are separate from the normal TRDs (an encrypted TRD must not have unencrypted contexts assigned to it).</p>
<p>Use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpencryptedtcp.html#usetlscontext">use_tls (context)</a> configuration option in the UM configuration file you supply for the Daemon Statistics. For example, for the Store Daemon use the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/configurationreferenceforumestored.html#umeelementlbmconfig">UMP Element "&lt;lbm-config&gt;"</a> contained within the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/configurationreferenceforumestored.html#umeelementdaemonmonitor">UMP Element "&lt;daemon-monitor&gt;"</a>.</p>
<p>Note that the use of an encrypted TRD will require that the Daemon Statistics data be configured for the <a class="el" href="index.html#transporttcp">TCP transport</a>.</p>
<p>Since UM's encryption feature is certificate-based. A user wanting to use a Daemon Control request tool must have access to the proper certificate file(s). This means that unauthorized users must <em>not</em> have access to the certificate file(s).</p>
<p>Finally, be aware that a partially-encrypted DRO network can break the security of an encrypted TRD; see <a class="el" href="index.html#tlsandthedynamicroutingoptiondro">TLS and the DRO</a>.</p>
<p>See <a class="el" href="index.html#encryptedtcp">Encrypted TCP</a> for details on using encryption.</p>
<p><br />
 </p>
<h3><a class="anchor" id="daemonstatisticsdetails"></a>
Daemon Statistics Details&nbsp;&nbsp;<small><a href="#daemonstatisticsdetails">&lt;-</a></small></h3>
<dl class="section note"><dt>Note</dt><dd>the C-style binary structure format of daemon statistics is DEPRECATED and may be removed in a future release. Informatica requests that users migrate to protobuf-based format. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringumdaemons">Monitoring UM Daemons</a>.</dd></dl>
<p>For details on the persistent Store's daemon statistics feature, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/storedaemonstatistics.html">Store Binary Daemon Statistics</a>.</p>
<p>For details on the <a class="el" href="index.html#umrouter">DRO</a>'s daemon statistics feature, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterdaemonstatistics.html">DRO Binary Daemon Statistics</a>.</p>
<p>For details on the SRS's daemon statistics feature, see <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a>.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="advancedoptimizations"></a>
Advanced Optimizations&nbsp;&nbsp;<small><a href="#advancedoptimizations">&lt;-</a></small></h1>
<p>The internal design of UM has many compromises between performance and flexibility. For example, there are critical sections which maintain state information which must be kept internally consistent. Since UM allows the application the flexibility of multi-threaded use, those critical sections are protected with Mutex locks. These locks add very little overhead to UM's execution, but "very little" is not the same as "zero". The use of locks is a compromise between efficiency and flexibility. Similar lines of reasoning explain why UM makes use of dynamic memory (malloc and free), and bus-interlocked read/modify/write operations (e.g. atomic increment).</p>
<p>UM provides configuration options which improve efficiency, at the cost of reduced application design flexibility. Application designers who are able to constrain their programs within certain restrictions can take advantage of improved performance and reduced latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>).</p>
<p><b>RECEIVE-SIDE</b> </p><ul>
<li>
<a class="el" href="index.html#receivethreadbusywaiting">Receive Thread Busy Waiting</a>. </li>
<li>
<a class="el" href="index.html#receivebufferrecycling">Receive Buffer Recycling</a>. </li>
<li>
<a class="el" href="index.html#singlereceivingthread">Single Receiving Thread</a> - not generally applicable. </li>
<li>
<a class="el" href="index.html#lbmcontextprocesseventsex">Extended Context Process Events</a> - not generally applicable. </li>
<li>
<a class="el" href="index.html#receivemultipledatagrams">Receive Multiple Datagrams</a>. </li>
<li>
<a class="el" href="index.html#transportdemultiplexertablesize">Transport Demultiplexer Table Size</a>. </li>
<li>
<a class="el" href="index.html#xsplatencyreduction">XSP Latency Reduction</a>. </li>
<li>
<a class="el" href="index.html#receivesidebatching">Receive-Side Batching</a> - for use with event queues. </li>
</ul>
<p><b>SEND-SIDE</b> </p><ul>
<li>
<a class="el" href="index.html#smartsources">Smart Sources</a>. </li>
<li>
<a class="el" href="index.html#zerocopysendapi">Zero-Copy Send API</a> (not recommended; see <a class="el" href="index.html#comparisonofzerocopyandsmartsources">Comparison of Zero Copy and Smart Sources</a>). </li>
</ul>
<p><b>GENERAL (both receivers and senders)</b> </p><ul>
<li>
<a class="el" href="index.html#corepinning">Core Pinning</a>. </li>
<li>
<a class="el" href="index.html#memorylatencyreduction">Memory Latency Reduction</a>. </li>
<li>
<a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a> (Java and .NET). </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="receivethreadbusywaiting"></a>
Receive Thread Busy Waiting&nbsp;&nbsp;<small><a href="#receivethreadbusywaiting">&lt;-</a></small></h2>
<p>Busy looping is a method for reducing latency and especially latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>) by preventing threads from going to sleep. In an event-driven system, if a thread goes to sleep waiting for an event, and the event happens, the operating system needs to wake the thread back up and schedule its execution on a CPU core. This can take several microseconds. Alternatively, if the thread avoids going to sleep and "polls" for the event in a tight loop, it will detect and be able to start processing the event without the operating system scheduling delay.</p>
<p>However, remember that a thread that never goes to sleep will fully consume a CPU core. If you have more busy threads than you have CPU cores in your computer, you can have CPU thrashing, where threads are forced to time-share the cores. This can produce <em>worse</em> latency than sleep-based waits.</p>
<p>Only use busy waiting if there are enough cores to allocate a core exclusively to each busy thread. Also, <a class="el" href="index.html#glossarypinning">pinning</a> threads to cores is highly recommended to prevent thread migration across cores, which can introduce latency and significant jitter.</p>
<p><br />
 </p>
<h3><a class="anchor" id="networksocketbusywaiting"></a>
Network Socket Busy Waiting&nbsp;&nbsp;<small><a href="#networksocketbusywaiting">&lt;-</a></small></h3>
<p>The UM receive code performs socket calls to wait for network events, like received data. By default, UM does sleep-based waiting for events. For example, if there are no packets waiting to be read from any of the sockets, the operating system will put the receive thread to sleep until a packet is received.</p>
<p>However, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#filedescriptormanagementbehaviorcontext">file_descriptor_management_behavior (context)</a> configuration option can be used to change the behavior of the receive thread to <em>not</em> sleep. Instead, the socket is checked repeatedly in a tight loop - busy waiting. With most use cases, enabling "busy wait" will typically reduce <em>average</em> latency only a little, but it can significantly reduce latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>).</p>
<p>For network-based transports, a receive thread can either be the main context thread, or it can be an <a class="el" href="index.html#transportservicesproviderxsp">XSP thread</a>. A given application can have more than one context, and a given context can have zero or more XSPs. The threads of each context and XSP can be independently configured to have either busy waiting or sleep waiting.</p>
<p>Note that when creating an XSP, it is not unusual to simply let the XSP inherit the parent context's attributes. However, a common XSP use case is to create a single XSP for user data, and leave the parent context for Topic Resolution and other overhead. In this case, you may want to configure the parent context to use sleep-based waiting ("pend"), and configure the XSP to use busy waiting ("busy-wait"). You will need to pass a context attribute to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae38035c6036a84f07f9ba7cee1747dbf">lbm_xsp_create()</a> API.</p>
<p><b>A Better Alternative</b></p>
<p>Kernel bypass network drivers typically have a busy waiting mode of operation which happens inside the driver itself. For example Solarflare's Onload driver can be configured to do busy waiting. This can produce even greater improvement than UM receive thread busy waiting. When using a busy waiting kernel bypass network driver like Onload, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#filedescriptormanagementbehaviorcontext">file_descriptor_management_behavior (context)</a> configuration option should be left at its default, "pend".</p>
<p><br />
 </p>
<h3><a class="anchor" id="ipctransportbusywaiting"></a>
IPC Transport Busy Waiting&nbsp;&nbsp;<small><a href="#ipctransportbusywaiting">&lt;-</a></small></h3>
<p>The <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a> does not use the context or XSP threads for receiving messages. It has its own internal thread which can be configured for busy waiting with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcreceiverthreadbehaviorcontext">transport_lbtipc_receiver_thread_behavior (context)</a> option.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smxtransportbusywaiting"></a>
SMX Transport Busy Waiting&nbsp;&nbsp;<small><a href="#smxtransportbusywaiting">&lt;-</a></small></h3>
<p>The <a class="el" href="index.html#transportlbtsmx">Transport LBT-SMX</a> does not use the context or XSP threads for receiving messages. It has its own internal thread which always operates in busy waiting. It cannot be configured to sleep waiting.</p>
<p><br />
 </p>
<h2><a class="anchor" id="zeroobjectdelivery"></a>
Zero Object Delivery&nbsp;&nbsp;<small><a href="#zeroobjectdelivery">&lt;-</a></small></h2>
<p>Zero Object Delivery is a set of Java and .NET programming conventions to avoid garbage.</p>
<p>In Java and .NET, garbage collection (GC) can be a very useful feature to simplify programming. However, for low latency applications, GC is a problem. Most JVMs impose milliseconds of latency when GC runs. Also, unnecessary object creation introduces additional overhead.</p>
<p>Most high-performance Java and .NET programs avoid GC by saving objects that are no longer needed and reusing them. Most of this is the responsibility of the application programmer. However, UM application callbacks represent a special case. When UM needs to deliver an event, like a received message, to a Java or .NET program, it typically passes to the callback one or more objects containing the pertinent event data. UM needs to know when the application is finished with those passed-in objects so that UM can re-use them.</p>
<p>This requires the application to follow a set of conventions. Applications that deviate from these conventions will typically suffer from higher latency due to unnecessary object creation and garbage collection. These programming conventions are collectively called "Zero
Object Delivery" (ZOD).</p>
<p>The ZOD programming convention are the same between Java and .NET. (ZOD does not apply to the C API.)</p>
<ol>
<li>
Special data access methods must be used to access the received message's data. </li>
<li>
If a message needs to be processed outside of the application receiver callback, it must be "promoted". A UM recycler must be used to ensure no garbage is created. </li>
<li>
Every message must be explicitly deleted when the application is finished processing it. This is true for messages fully processed by the receiver callback, and for promoted messages that are processed outside of the receiver callback. This is done by calling the "dispose()" method. </li>
</ol>
<p>Details of these coding conventions can be found at: </p><ul>
<li>
<a class="el" href="index.html#javamessagereception">Java Message Reception</a> </li>
<li>
<a class="el" href="index.html#netmessagereception">.NET Message Reception</a> </li>
</ul>
<dl class="section note"><dt>Note</dt><dd>While the coding conventions of ZOD are most often seen with the receiver callback, many of the same conventions exist with other event delivery callbacks. For example, source events should be disposed. Source events must also be promoted before they are passed to another thread for processing, after which they should be disposed and recycled.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="receivebufferrecycling"></a>
Receive Buffer Recycling&nbsp;&nbsp;<small><a href="#receivebufferrecycling">&lt;-</a></small></h2>
<p>By default, the UM receive code base allocates a fresh buffer for each received datagram. This allows the user a great degree of threading and buffer utilization flexibility in the application design.</p>
<p>For transport types RM (reliable multicast), RU (Reliable Unicast), and IPC (shared memory), you can set a configuration option to enable reuse of receive buffers, which can avoid per-message dynamic memory calls (malloc/free). This produces a modest reduction in average latency, but more importantly, can significantly reduce occasional latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>).</p>
<p>See the configuration options: </p><ul>
<li>
RM - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmrecyclereceivebufferscontext">transport_lbtrm_recycle_receive_buffers (context)</a> </li>
<li>
RU - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtruoperation.html#transportlbtrurecyclereceivebufferscontext">transport_lbtru_recycle_receive_buffers (context)</a> </li>
<li>
IPC - <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcrecyclereceivebufferscontext">transport_lbtipc_recycle_receive_buffers (context)</a> </li>
</ul>
<p>Note that setting the option does not guarantee the elimination of per-message malloc and free except in fairly restrictive use cases.</p>
<p>Also note that this feature is different from the Java and .NET ZOD recycler. See <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="receivebufferrecyclingrestrictions"></a>
Receive Buffer Recycling Restrictions&nbsp;&nbsp;<small><a href="#receivebufferrecyclingrestrictions">&lt;-</a></small></h3>
<p>There are no hard restrictions to enabling buffer recycling. It is not functionally not compatible with any use patterns or UM features. However, some use patterns will prevent the recycling of the receive buffer, and therefore not deliver the benefit, even if the configuration option is set.</p>
<ul>
<li>
<b><a class="el" href="index.html#eventqueueobject">Event Queues</a></b> - Event Queues prevent the recycling of receive buffers. When the UM library transfers a received message to an event queue for later processing, it allocates (malloc) a new message receive buffer. </li>
<li>
<b><a class="el" href="index.html#messageobjectretention">Message Object Retention</a></b> - Message retention prevents the recycling. For context-thread receive message callbacks, the act of retaining a message allocates (mallocs) a new message receive buffer. </li>
<li>
<b><a class="el" href="index.html#persistence">Persistence</a></b> - For a persistent receiver, enabling receive buffer recycling will <em>reduce</em> dynamic memory usage (malloc/free), but does not eliminate it. Certain persistence-related features require the use of dynamic memory. </li>
<li>
<b><a class="el" href="index.html#packetloss">Packet Loss</a></b> - Applications typically use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#ordereddeliveryreceiver">Ordered Delivery</a>. When packets are lost, UM needs to internally retain newly received messages so that they can be delivered after the missing messages are retransmitted. This internal retention prevents the newly received message buffers from being recycled. </li>
<li>
<b><a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a></b> - Large application messages must be split into smaller fragments and sent serially. The receiver must internally retain these fragments so that the original large message can be reassembled and delivered to the application. This internal retention prevents the fragment message buffers from being recycled. </li>
</ul>
<p>Note that in spite of the restrictions that can prevent recycling of receive message buffers, UM dynamically takes advantage of recycling as much as it can. E.g. if there is a loss event which suppresses recycling while waiting for retransmission, once the gap is filled and pending messages are delivered, UM will once again be able to recycle its receive buffers.</p>
<p>Of specific interest for <em>persistent</em> receivers is the use of <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#explicitacknowledgments">Explicit Acknowledgments</a>, either to batch ACKs, or simply defer them. Instead of retaining the messages, which prevents message buffer recycling, you can extract the ACK information from a message and allow the return from the receiver callback to delete and recycle the message buffer without acknowledging it.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#objectfreeexplicitacknowledgments">Object-free Explicit Acknowledgments</a> for details.</p>
<p><br />
 </p>
<h2><a class="anchor" id="singlereceivingthread"></a>
Single Receiving Thread&nbsp;&nbsp;<small><a href="#singlereceivingthread">&lt;-</a></small></h2>
<p>This feature optimizes the execution of UM receive-path code by converting certain thread-safe operations to more-efficient thread-unsafe operations. For example, certain bus-locked operations (e.g. atomic increment) are replaced by non-bus-locked equivalents (e.g. non-atomic increment). This can reduce the latency of delivering received messages to the application, but does so at the expense of thread safety.</p>
<p>This feature is often used in conjunction with the <a class="el" href="index.html#contextlockreduction">Context Lock Reduction</a> feature.</p>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsessionsinglereceivingthreadcontext">transport_session_single_receiving_thread (context)</a> configuration option enables this feature.</p>
<p>Except as listed in the restrictions below, the Single Receiving Thread feature should be compatible with all other receive-side UM features.</p>
<p><br />
 </p>
<h3><a class="anchor" id="singlereceivingthreadrestrictions"></a>
Single Receiving Thread Restrictions&nbsp;&nbsp;<small><a href="#singlereceivingthreadrestrictions">&lt;-</a></small></h3>
<p>It is very important for applications using this feature to be designed within certain restrictions.</p>
<ul>
<li>
<p class="startli"><b>Threading</b> - The intended use case is for each received message to be fully processed by the UM thread that delivers the message to the application. Note that the <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> feature <em>is</em> compatible with the Single Receiving Thread feature.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No <a class="el" href="index.html#eventqueueobject">Event Queues</a></b> - Event queues cannot be used with Single Receiving Thread.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b><a class="el" href="index.html#messageobjectretention">Message Object Retention</a></b> - Most traditional uses of message retention are related to giving a message to an alternate thread for processing. This is not compatible with Single Receiving Thread feature.</p>
<p>However, there are some use cases where message retention is viable when used with Single Receiving Thread: when a message must be held for <em>future</em> processing, and that processing will be done by the same thread.</p>
<p>For example, a persistent application might use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#explicitacknowledgments">Explicit Acknowledgments</a> to delay message acknowledgement until the application completes a handshake with a remote service. As long as it is the same thread which initially receives and retains the message as that which completes the explicit acknowledgement of the message, it is supported to use message retain / message delete.</p>
<dl class="section note"><dt>Note</dt><dd>If the <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> feature is used, care must be taken to ensure that the same XSP thread is used to perform all processing for a received message. A different XSP or the main context may not be used to complete processing on a deferred retained message. For example, a user-scheduled timer event will be delivered using the main context thread, and therefore cannot complete processing of a retained message.</dd></dl>
</li>
<li>
<b>Transport Type</b> - The Single Receiving Thread feature does not enhance the operation of <a class="el" href="index.html#transportbroker">Broker</a> or <a class="el" href="index.html#transportlbtsmx">SMX</a> transport types. These transport types use somewhat different internal buffer handling. Note that these transport types are technically compatible with the Single Receiving Thread feature, they just don't benefit from it. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="lbmcontextprocesseventsex"></a>
Extended Context Process Events&nbsp;&nbsp;<small><a href="#lbmcontextprocesseventsex">&lt;-</a></small></h2>
<p>Most developers of UM applications use a multi-threaded approach to their application design. For example, they typically have one or more application threads, and they create a UM context with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#operationalmodecontext">embedded mode</a>, which creates a separate <a class="el" href="index.html#contextobject">context thread</a>.</p>
<p>However, there is a model of application design in which a single thread is used for the entire application. In this case, the UM context must be created with <a class="el" href="index.html#sequentialmode">Sequential Mode</a> and the application must regularly call the UM event processor API, usually with the <code>msec</code> parameter set to zero. In this design, there is no possibility that application code, UM API code, and/or UM context code will be executing concurrently.</p>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a> API allows the application to enable specialized optimizations. (For Java and .NET use the context object's <code>"processEvents()"</code> method with 2 or more input parameters. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/javaapi.tag:../../JavaAPI/" href="../../JavaAPI/classcom_1_1latencybusters_1_1lbm_1_1LBMContext.html#a78125f80281b91950f0409a4caddc4e3">com::latencybusters::lbm::LBMContext::processEvents</a>.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="contextlockreduction"></a>
Context Lock Reduction&nbsp;&nbsp;<small><a href="#contextlockreduction">&lt;-</a></small></h3>
<p>The application can improve performance by suppressing the taking of certain mutex locks within the UM context processing code. This can reduce the latency of delivering received messages to the application, but does so at the expense of thread safety.</p>
<p>This feature is often used in conjunction with the <a class="el" href="index.html#singlereceivingthread">Single Receiving Thread</a> feature.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is very important for the application to ensure that UM code related to a given context cannot be executed concurrently by multiple threads when this feature is used. This includes UM object creation and send-path API functions. The application may not call a UM message send API by one thread while another thread is calling <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a>. However, it is permissible for a context thread callback to call a UM message send API, within the restrictions of the send API being used.</dd></dl>
<p>To enable this feature, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a>, passing in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af09539ed3d358e071a3a5b0a903335f0">lbm_process_events_info_t</a> structure with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4d3385918ddb747b734f68151ff00d04">LBM_PROC_EVENT_EX_FLAG_NO_MAIN_LOOP_MUTEX</a> bit set in the <code>flags</code> field. (<a class="el" href="index.html#sequentialmode">Sequential Mode</a> is required for this feature.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="contextlockreductionrestrictions"></a>
Context Lock Reduction Restrictions&nbsp;&nbsp;<small><a href="#contextlockreductionrestrictions">&lt;-</a></small></h3>
<p>It is very important for applications using this feature to be designed within certain restrictions.</p>
<ul>
<li>
<p class="startli"><b>Threading</b> - It is critical that Context Lock Reduction be used <em>only</em> if <a class="el" href="index.html#sequentialmode">Sequential Mode</a> is used and there is no possibility of concurrent execution of UM code for a given context.</p>
<p>It is further strongly advised that the same thread be used for all UM execution within a given context. It is not guaranteed to be safe if the application has multiple threads which can operate on a context, even if the application guarantees that only one thread at a time will execute the UM code.</p>
<p>Note that if an application maintains two contexts, it is acceptable for a different thread to be used to operate on each context. However, it is not supported to pass UM objects between the threads.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a></b> - The Context Lock Reduction feature is not compatible with XSP.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No <a class="el" href="index.html#eventqueueobject">Event Queues</a></b> - Event queues cannot be used with Context Lock Reduction.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No <a class="el" href="index.html#transportlbtsmx">SMX</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#myricomdatagrambypasslayerdbl">DBL</a></b> - Context Lock Reduction is not compatible with SMX or DBL transports. This is because these transports create independent threads to monitor their respective transport types.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b><a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a></b> - Context Lock Reduction was not designed with the IPC transport in mind. By default, IPC creates an independent thread to monitor the shared memory, which is not compatible with Context Lock Reduction. However, in principle, it is possible to specify that the IPC receiver should use sequential mode (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtipcoperation.html#transportlbtipcreceiveroperationalmodecontext">transport_lbtipc_receiver_operational_mode (context)</a>), and then write your application to use the same thread to call the context and IPC event processing APIs. However, be aware that the IPC event processing API does not have an extended form, so IPC will simply continue to take the locks it is designed to take.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b><a class="el" href="index.html#messageobjectretention">Message Object Retention</a></b> - Most traditional uses of <a class="el" href="index.html#messageobjectretention">Message Object Retention</a> are related to handing a message to an alternate thread for processing. This is not compatible with Context Lock Reduction because the alternate thread is responsible for deleting the message when it is done. This represents two threads making API calls for the same context, which is not allowed for the Context Lock Reduction feature.</p>
<p>However, there are some use cases where message retention is viable when used with Context Lock Reduction: when a message must be held for <em>future</em> processing, and that processing will be done by the same thread.</p>
<p>For example, a persistent application might use <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/designingpersistentreceivers.html#explicitacknowledgments">Explicit Acknowledgments</a> to delay message acknowledgement until the application completes a handshake with a remote service. As long as it is the same thread which initially receives and retains the message as that which completes the explicit acknowledgement of the message, it is supported to use message retain / message delete.</p>
<p class="endli"></p>
</li>
<li>
<b>No <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a41a6bc8b3a5d8670b4066cf14fbe2556">LBM_SRC_BLOCK</a></b> - All forms of UM send message must be done non-blocking (with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab8a470f02029480f179cc4872b7fa713">LBM_SRC_NONBLOCK</a>). This is because of the way UM blocks calls that cannot be completed; the context thread explicitly wakes up the blocked call when appropriate. But if the same thread is being used to run the context (via the process events API) and also sending messages, a blocked send call will never be woken up. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="gettimeofdayreduction"></a>
Gettimeofday Reduction&nbsp;&nbsp;<small><a href="#gettimeofdayreduction">&lt;-</a></small></h3>
<p>UM's main context loop calls gettimeofday() in strategic places to ensure that its internal timers are processed correctly. However, there is a "polling" model of application design in which <a class="el" href="index.html#sequentialmode">Sequential Mode</a> is enabled and the context event processing API is called in a fast loop with the <code>msec</code> parameter set to zero. This results in the internal context call to gettimeofday() to happen unnecessarily frequently.</p>
<p>A polling application can improve performance by suppressing the internal context calls to gettimeofday(). This can reduce the latency of delivering received messages to the application.</p>
<p>To enable this feature, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a>, passing in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af09539ed3d358e071a3a5b0a903335f0">lbm_process_events_info_t</a> structure with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad38d38d8b34bb913ac48940f6bc52a94">LBM_PROC_EVENT_EX_FLAG_USER_TIME</a> bit set in the <code>flags</code> field. In addition, the application must set the <code>time_val</code> field in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af09539ed3d358e071a3a5b0a903335f0">lbm_process_events_info_t</a> with the value returned by gettimeofday(). (<a class="el" href="index.html#sequentialmode">Sequential Mode</a> is required for this feature.)</p>
<dl class="section note"><dt>Note</dt><dd>The internal UM timers generally use millisecond precision. Users of the gettimeofday() reduction feature typically design their application to fetch a new value for <code>time_val</code> only a few times per millisecond.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="gettimeofdayreductionrestrictions"></a>
Gettimeofday Reduction Restrictions&nbsp;&nbsp;<small><a href="#gettimeofdayreductionrestrictions">&lt;-</a></small></h3>
<ul>
<li>
<b>Monotonically Increasing Time</b> - The application is responsible for ensuring that each call to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a> has a <code>time_val</code> field value which is greater than or equal to the previous <code>time_val</code>. </li>
<li>
<b><code>"msec"</code> must be 0</b> - You must call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a> with the <code>"msec"</code> parameter set to zero. You can't tell <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a55b77c3057028116314fe5ff8e6afb25">lbm_context_process_events_ex()</a> to loop for a period of time, and also tell it not to call gettimeofday(); UM won't see the passage of time. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="receivemultipledatagrams"></a>
Receive Multiple Datagrams&nbsp;&nbsp;<small><a href="#receivemultipledatagrams">&lt;-</a></small></h2>
<p>A UM receiver for UDP-based protocols normally retrieves a single UDP datagram from the socket with each socket read. Setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#multiplereceivemaximumdatagramscontext">multiple_receive_maximum_datagrams (context)</a> to a value greater than zero directs UM to retrieve up to that many datagrams with each socket read. When receive socket buffers accumulate multiple messages, this feature improves CPU efficiency, which reduces the probability of loss, and also reduces total latency for those buffered datagrams. Note that UM does not need to wait for that many datagrams to be received before processing them; if fewer datagrams are in the socket's receive buffer, only the available datagrams are retrieved.</p>
<p>The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#multiplereceivemaximumdatagramscontext">multiple_receive_maximum_datagrams (context)</a> configuration option defaults to 0 so as to retain previous behavior, but users are encouraged to set this to a value between 2 and 10. (Having too large a value during a period of overload can allow starvation of low-rate Transport Sessions by high-rate Transport Sessions.)</p>
<p>Note that in addition to increasing efficiency, setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#multiplereceivemaximumdatagramscontext">multiple_receive_maximum_datagrams (context)</a> greater than one can produce changes in the dynamic behavior across multiple sockets. For example, let's say that a receiver is subscribed to two Transport Sessions, A and B. Let's further say that Transport Session A is sending message relatively quickly and has built up several datagrams in its socket buffer. But in this scenario, B is sending slowly. If <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#multiplereceivemaximumdatagramscontext">multiple_receive_maximum_datagrams (context)</a> is zero or one, the two sockets will compete equally for UM's attention. B's socket will still have a chance to be read after each A datagram is read and processed.</p>
<p>However, if <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#multiplereceivemaximumdatagramscontext">multiple_receive_maximum_datagrams (context)</a> is 10, then UM can process up to 10 of A's messages before giving B a chance to be read. This is desirable if low message latency is equally important across all Transport Sessions; the efficiency improvement derived by retrieving multiple datagrams with each read operation results in lower overall latency. However, if different transport sessions' data have different priorities in terms of latency, then processing 10 messages of a low priority transport session can unnecessarily delay processing of messages from a higher priority transport session.</p>
<p>In this case, the <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> feature can be used to prioritize different transport sessions differently and prevent low-priority messages from delaying high-priority messages.</p>
<p>Note that UM versions prior to 6.13 could see occasional increases in latency outliers when this feature was used. Starting with UM version 6.13, those outliers have been fixed (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/changelog.tag:../../ChangeLog/" href="../../ChangeLog/umversion6_13.html#bug10726">bug10726</a>).</p>
<p><br />
 </p>
<h3><a class="anchor" id="receivemultipledatagramscompatibility"></a>
Receive Multiple Datagrams Compatibility&nbsp;&nbsp;<small><a href="#receivemultipledatagramscompatibility">&lt;-</a></small></h3>
<p>The Receive Multiple Datagrams feature modifies the behavior of the UDP-based transport protocols: LBT-RM and LBT-RU.</p>
<p>(Note: prior to UM version 6.13, the Receive Multiple Datagrams feature also affected MIM and UDP-based Topic Resolution. But this could introduced undesired latencies, so starting with UM 6.13, MIM and Topic Resolution no longer use Receive Multiple Datagrams.)</p>
<p><br />
 </p>
<h3><a class="anchor" id="receivemultipledatagramsrestrictions"></a>
Receive Multiple Datagrams Restrictions&nbsp;&nbsp;<small><a href="#receivemultipledatagramsrestrictions">&lt;-</a></small></h3>
<p>The Receive Multiple Datagrams feature does not affect the following UM features:</p>
<ul>
<li>
Non-UDP Transport Protocols (TCP, IPC, SMX). </li>
<li>
MIM (as of UM version 6.13). </li>
<li>
UDP-based Topic Resolution (as of UM version 6.13). </li>
<li>
All TCP-based features (Unicast Immediate Message, Late Join, Persistent Store Recovery, UM Response messages). </li>
<li>
Non-Linux. </li>
<li>
Linux prior to kernel version 2.6.33, and glibc in version 2.12 (released in May, 2010). </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="transportdemultiplexertablesize"></a>
Transport Demultiplexer Table Size&nbsp;&nbsp;<small><a href="#transportdemultiplexertablesize">&lt;-</a></small></h2>
<p>A UM <a class="el" href="index.html#transportsessions">Transport Session</a> can have multiple sources (topics) mapped to it. For example, if a publishing application creates two sources with the same multicast address and destination port, both sources will be carried on the same transport session. A receiver joined to that transport session must separate (demultiplex) the topics, either for delivery to the proper receiver callback, or for discarding.</p>
<p>The demultiplexing of the topics is managed by a hash table (not the same kind of hash table that manages the Topic Resolution cache). As a result, the processing of received messages can be made more efficient by optimally sizing the hash table. This is done using the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportdemuxtableszreceiver">transport_demux_tablesz (receiver)</a>.</p>
<p>Unlike many hash tables, the transport demultiplexer needs to have a number of buckets which is a power of two. The demultiplexing code will be most efficient if the number of buckets is equal to or greater than the number of sources created on the transport session. In that case, the hash function is "perfect", which is to say that there will never be any collisions. Note that if the number of buckets is smaller than the number of sources, the collision resolution process is O(log N) where N is the length of the collision chain.</p>
<p>The only disadvantage of increasing the size of the hash table is memory usage (each bucket is 16 bytes on 64-bit architectures). Having a larger than optimal table does not make performance worse.</p>
<p>Note that if the number of sources is small, only a small degree of efficiency improvement results from optimally sizing the hash table.</p>
<p><br />
 </p>
<h2><a class="anchor" id="smartsources"></a>
Smart Sources&nbsp;&nbsp;<small><a href="#smartsources">&lt;-</a></small></h2>
<p>The normal <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> function (and its Java and .NET equivalents) are very flexible and support the full range of UM's rich feature set. To provide this level of capability, it is necessary to make use of dynamic (malloc/free) memory, and critical section locking (mutex) in the send path. While modern memory managers and thread locks are very efficient, they do introduce some degree of variability of execution time, leading to latency outliers (<a class="el" href="index.html#glossaryjitter">jitter</a>) potentially in the millisecond range.</p>
<p>For applications which require even higher speed and very consistent timing, and are able to run within certain constraints, UM has an alternate send feature called Smart Source. This is a highly-optimized send path with no dynamic memory operations or locking; all allocations are done at source creation time, and lockless algorithms are used throughout. To achieve these improvements, Smart Source imposes a number of restrictions (see <a class="el" href="index.html#smartsourcerestrictions">Smart Sources Restrictions</a>).</p>
<p>The Smart Source feature provides the greatest benefit when used in conjunction with a <a class="el" href="index.html#glossarykernelbypass">kernel bypass</a> network driver.</p>
<dl class="section note"><dt>Note</dt><dd>the Smart Source feature is <em>not</em> the same thing as the <a class="el" href="index.html#zerocopysendapi">Zero-Copy Send API</a> feature; see <a class="el" href="index.html#comparisonofzerocopyandsmartsources">Comparison of Zero Copy and Smart Sources</a>.</dd></dl>
<p>One design feature that is central to Smart Sources is the pre-allocation of a fixed number of carefully-sized buffers during source creation. This allows deterministic algorithms to be used for the management of message buffers throughout the send process. To gain the greatest benefit from Smart Sources, the application builds its outgoing messages directly in one of the pre-allocated buffers and submits the buffer to be sent.</p>
<p>To use Smart Sources, a user application typically performs the following steps:</p>
<ol>
<li>
Create a context with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a>, as normal. </li>
<li>
Create the topic object and the Smart Source with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1ba60407fa2bde0997aab6d5a5d2da1a">lbm_src_topic_alloc()</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9a8d169a8c2a90b8442d4eb3e3711c9c">lbm_ssrc_create()</a>, respectively. Use <a class="el" href="index.html#smartsourceconfiguration">Smart Sources Configuration</a> to pre-allocate the desired number of buffers. </li>
<li>
Get the desired number of messages buffers with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a98c5450e9fb93f30bd80fa33a2380dfc">lbm_ssrc_buff_get()</a> and initialize them if desired. The application typically constructs outgoing messages directly in these buffers for transmission. </li>
<li>
Send messages with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex()</a>. The buffers gotten in the previous step must be used. </li>
<li>
While most applications manage the message buffers internally, it is also possible to give the buffers back to UM with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ab57120414bf92bd2f44de7aea97e3f1b">lbm_ssrc_buff_put()</a>, and then getting them again for subsequent sends. Getting and putting messages buffers can simplify application design at the expense of extra overhead. </li>
<li>
To clean up, delete the Smart Source with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a9cd9dfee7a9c268059084a3c327f65f9">lbm_ssrc_delete()</a>. It is not necessary to "put" the message buffers back to UM; they will be freed automatically when the Smart Source is deleted. </li>
</ol>
<p>For details, see the example applications <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/example.tag:../../example/" href="../../example/index.html#examplelbmssrc_c">Example lbmssrc.c</a> or <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/java_example.tag:../../java_example/" href="../../java_example/index.html#examplelbmssrc_java">Example lbmssrc.java</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>To avoid the overhead of locking, the Smart Source API functions are not thread-safe. Applications must be written to avoid concurrent calls. In particular, the application is restricted to sending messages on a given <a class="el" href="index.html#transportsessions">Transport Session</a> with one thread. If <a class="el" href="index.html#smartsourcedefensivechecks">Smart Source Defensive Checks</a> are enabled, the first call to send a message on a newly-created Transport Session captures the ID of the calling thread. Subsequently, only that thread is allowed to call send for Smart Sources on that Transport Session. For applications which have multiple sending threads, Smart Source topics must be mapped to Transport Sessions carefully such that all of the topics on a given Transport Session are managed by the same sending thread.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>There are no special requirements on the receive side when using Smart Sources. Normal receiving code is used.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcemessagebuffers"></a>
Smart Source Message Buffers&nbsp;&nbsp;<small><a href="#smartsourcemessagebuffers">&lt;-</a></small></h3>
<p>When a Smart Source is created, UM pre-allocates a set of user buffers according to the configuration options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcuserbuffercountsource">smart_src_user_buffer_count (source)</a>.</p>
<p>Starting with UM version 6.12, Smart Source supports <a class="el" href="index.html#glossaryumfragmentation">UM fragmentation</a>. Which is to say that messages larger than the transport's <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a> can be sent, which the Smart Source will split into multiple datagrams.</p>
<p>For example, an application can configure <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a> to be 2000, while the datagram max size is set to 1500 (network MTU size). During operation, the application might send a 500-byte message. This will not require any fragmentation; the message is sent in a single network packet. However, when the application sends a 2000-byte message, the Smart Source will split it into two datagrams. This avoids IP fragmentation. The precise sizes of those datagrams will depend on the space reserved for headers, and is subject to change with different versions of UM.</p>
<p>Another feature available as of UM version 6.12 is the user-specified buffer. This allows an application to send messages larger than the configured <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a>. Instead of building the message in a pre-allocated Smart Source buffer, the application must allocate and manage its own user-supplied buffer. To use this feature, the application supplies both a pre-allocated buffer and a user-supplied buffer. The Smart Source will use the supplied pre-allocated buffer as a "work area" for building the datagram with proper headers, and use the user-supplied buffer for message content.</p>
<p>For example to use the buffer <code>"ubuffer"</code>, you simply set the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a366727d0b5f3039e03b9c4bce8065da5">LBM_SSRC_SEND_EX_FLAG_USER_SUPPLIED_BUFFER</a> flag and the <code>usr_supplied_buffer</code> field in the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a33886eeac2e67170effea009d2dc3a35">lbm_ssrc_send_ex_info_t</a> passed to the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex()</a> API function, as shown below: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> *ubuffer = malloc(65536);  <span class="comment">/* Large user-supplied buffer. */</span></div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html">lbm_ssrc_send_ex_info_t</a> info;</div><div class="line">info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#a20b6feb8a3737d2ad4330c64552ba18c">flags</a> = 0;</div><div class="line"><span class="keywordtype">char</span> *ss_buffer = NULL;  <span class="comment">/* Smart Source pre-allocated buffer. */</span></div><div class="line">...</div><div class="line">lbm_ssrc_buff_get(ssrc, &amp;ss_buffer, 0);  <span class="comment">/* Get Smart Source pre-alloc buff. */</span></div><div class="line">...</div><div class="line"><span class="comment">/* Application puts message data into ubuffer. */</span></div><div class="line">info.flags |= <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a366727d0b5f3039e03b9c4bce8065da5">LBM_SSRC_SEND_EX_FLAG_USER_SUPPLIED_BUFFER</a>;</div><div class="line">info.<a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__ssrc__send__ex__info__t__stct.html#adcb94e05adb46da7cb8cce93a656b7d4">usr_supplied_buffer</a> = ubuffer;</div><div class="line"><a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a2f50f56536778332e9f5712b06546425">lbm_ssrc_send_ex</a>(ssrc, ss_buffer, message_len, 0, &amp;info);</div></div><!-- fragment --><p>Note that the Smart Source pre-allocated buffer <code>ss_buffer</code> also has to be passed in.</p>
<p>Also note that sending messages with the user-supplied message buffer is slightly less CPU efficient than using the pre-allocated buffers. But making pre-allocated buffers larger to accommodate occasional large messages can be very wasteful of memory, depending on the counts of user buffers, transmission window buffers, and retention buffers.</p>
<p><b>UM Fragment Sizes</b></p>
<p>A traditional source will split application messages into "N" fragments when those messages (plus worst-case header) are greater than the <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a>. The size of the first "N-1" fragments will be (approximately) the datagram max size.</p>
<p>With Smart Sources, fragmentation is done somewhat differently. Consider as an example a configuration with a datagram max size of 8192 and a Smart Source max message length of 2000. No UM message fragmentation will happen when the application uses the Smart Source pre-allocated buffers to build outgoing messages. However, if a user-supplied buffer is used, the user can send arbitrarily large application message, and the Smart Source will split the message into "N" fragments. But those fragments will be limited in size to the Smart Source max message length of 2000 bytes of application data (plus additional bytes for headers).</p>
<p>This can lead to unexpected inefficiencies. Continuing the above example, suppose case the application sends a 6000-byte message. The Smart Source will spit it into three 2000-byte datagrams. The underlying IP stack will perform IP fragmentation and send each datagram as two packets of 1500 and 500 bytes respectively, for a total of 6 packets. Whereas if the Smart Source max message length were set to 1500, then the message would be split into 4 fragments of 1500 bytes each, and each fragment would fit in a single packet, for a total of 4 packets. (The calculations above were simplified for clarity, but are not accurate because they do not take into consideration headers.)</p>
<p>When a <a class="el" href="index.html#glossarykernelbypass">kernel bypass</a> network driver is being used, users will sometimes set the datagram max size to approximately an MTU. In that case, it could easily happen that the Smart Source pre-allocated buffers are <em>larger</em> than the datagram max size. In that case, the Smart Source will behave more like a traditional source, splitting the application message into datagrams of (approximately) datagram max size fragments. See <a class="el" href="index.html#datagrammaxsizeandnetworkmtu">Datagram Max Size and Network MTU</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcesandmemorymanagement"></a>
Smart Sources and Memory Management&nbsp;&nbsp;<small><a href="#smartsourcesandmemorymanagement">&lt;-</a></small></h3>
<p>Starting with UM 6.11, there are new C APIs that give the application greater control over the allocation of memory when Smart Sources are being created. Since creation of a Smart Source pre-allocates buffers used for application message data as well as internal retransmission buffers, an application can override the stock malloc/free to ensure, for example, that memory is local to the CPU core that will be sending messages.</p>
<p>When the application is ready to create the Smart Source, it should set up the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#memmgtcallbackssource">mem_mgt_callbacks (source)</a>, which uses the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aae7c35eda2692944970e73d93217239b">lbm_mem_mgt_callbacks_t</a> structure to specify application callback functions.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourceconfiguration"></a>
Smart Sources Configuration&nbsp;&nbsp;<small><a href="#smartsourceconfiguration">&lt;-</a></small></h3>
<p>The following configuration options are used to control the creation and operation of Smart Sources:</p>
<ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a> - should be set to the maximum expected size for messages sent to on the source. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcuserbuffercountsource">smart_src_user_buffer_count (source)</a> - number of buffers to be pre-created at Smart Source create time. Deleting a Smart Source also frees these buffers, so applications must not access these buffers after their corresponding Smart Source is deleted. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcretentionbuffercountsource">smart_src_retention_buffer_count (source)</a> - enables <a class="el" href="index.html#latejoin">Late Join</a> and <a class="el" href="index.html#offtransportrecoveryotr">Off-Transport Recovery (OTR)</a> functionality. Takes the place of the normal late join / OTR options "retransmit_retention_*". (On the receive side, the normal late join options apply.) </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#transportlbtrmsmartsrctransmissionwindowbuffercountsource">transport_lbtrm_smart_src_transmission_window_buffer_count (source)</a> - size of the LBT-RM transmission window. Takes the place of the normal window options "transport_lbtrm_transmission_window_*". </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#transportlbtrusmartsrctransmissionwindowbuffercountsource">transport_lbtru_smart_src_transmission_window_buffer_count (source)</a> - size of the LBT-RU transmission window. Takes the place of the normal window options "transport_lbtru_transmission_window_*". </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcenablespectrumchannelsource">smart_src_enable_spectrum_channel (source)</a> - should be set if <a class="el" href="index.html#spectrum">Spectrum</a> channels will be used. <br />
 See <a class="el" href="index.html#smartsourcesandspectrum">Smart Sources and Spectrum</a>. </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmessagepropertyintcountsource">smart_src_message_property_int_count (source)</a> - should be set if <a class="el" href="index.html#messageproperties">Message Properties</a> will be used. <br />
 See <a class="el" href="index.html#smartsourcesandmessageproperties">Smart Sources and Message Properties</a>. </li>
</ul>
<p>The option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a> is used to size the window transmission buffers. This means that the first Smart Source created on the session defines the maximum possible size of user messages for all Smart Sources on the Transport Session. It is not legal to create a subsequent Smart Source on the same Transport Session that has a larger <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpsmartsource.html#smartsrcmaxmessagelengthsource">smart_src_max_message_length (source)</a>, although smaller values are permissible.</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcedefensivechecks"></a>
Smart Source Defensive Checks&nbsp;&nbsp;<small><a href="#smartsourcedefensivechecks">&lt;-</a></small></h3>
<p>Ultra Messaging generally includes defensive checks in API functions to verify validity of input parameters. In support of faster operation, deep defensive checks for Smart Sources are optional, and are disabled by default. Users should enable them during application development, and can leave them disabled for production.</p>
<p>To enable deep Smart Source defensive checks, set the environment variable <b>LBM_SMART_SOURCE_CHECK</b> to the numeric sum of desired values. Hexadecimal values may be supplied with the "0x" prefix. Each value enables a class of defensive checking:</p>
<center> <table class="doxtable">
<tr>
<th>Numeric Value</th><th>Deep Check </th></tr>
<tr>
<td><b>1</b></td><td>Send argument checking </td></tr>
<tr>
<td><b>2</b></td><td>Thread checking </td></tr>
<tr>
<td><b>4</b></td><td>User buffer pointer checking </td></tr>
<tr>
<td><b>8</b></td><td>User buffer structure checking </td></tr>
<tr>
<td><b>16, 0x10</b></td><td>user message length checking </td></tr>
<tr>
<td><b>32, 0x20</b></td><td>application header checking, including <a class="el" href="index.html#spectrum">Spectrum</a> and <a class="el" href="index.html#messageproperties">Message Properties</a>. </td></tr>
<tr>
<td><b>64, 0x40</b></td><td>null check for User Supplied Buffer (see <a class="el" href="index.html#smartsourcemessagebuffers">Smart Source Message Buffers</a>) </td></tr>
</table>
</center><p>To enable all checking, set the environment variable <b>LBM_SMART_SOURCE_CHECK</b> to "0xffffffff".</p>
<p><br />
 </p>
<h3><a class="anchor" id="smartsourcerestrictions"></a>
Smart Sources Restrictions&nbsp;&nbsp;<small><a href="#smartsourcerestrictions">&lt;-</a></small></h3>
<ul>
<li>
<p class="startli"><b>No Hotlinks</b> - Smart Sources do not support the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#drohotlinks">DRO Hotlinks</a> feature.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Linux and Windows 64-bit Only</b> - Smart Sources is only supported on the 64-bit Linux and 64-bit Windows platforms, C and Java APIs.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>LBT-RM And LBT-RU Sources Only</b> - Smart Sources can only be created with the LBT-RM and LBT-RU transport types. Smart Sources are not compatible with the UM features <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>, <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a>, or sending responses with <a class="el" href="index.html#requestresponse">Request/Response</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Persistence</b> - Starting with UM 6.11, Smart Sources support <a class="el" href="index.html#persistence">Persistence</a>, but with some restrictions. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/enablingpersistence.html#smartsourcesandpersistence">Smart Sources and Persistence</a> for details.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Spectrum</b> - Starting with UM 6.11, Smart Sources support <a class="el" href="index.html#spectrum">Spectrum</a>, but with some API changes. See <a class="el" href="index.html#smartsourcesandspectrum">Smart Sources and Spectrum</a> for details.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Single-threaded Only</b> - It is the application's responsibility to serialize calls to Smart Source APIs for a given Transport Session. Concurrent sends to different Transport Sessions are permitted.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No Application Headers</b> - <a class="el" href="index.html#applicationheaders">Application Headers</a> are not compatible with Smart Sources.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Limited Message Properties</b> - <a class="el" href="index.html#messageproperties">Message Properties</a> may be included, but their use has restrictions. See <a class="el" href="index.html#smartsourcemessagepropertiesusage">Smart Source Message Properties Usage</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No Queuing</b> - <a class="el" href="index.html#queuing">Queuing</a> is not currently supported, although support for ULB is a possibility in the future.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No Send Request for Java</b> - The Java API does not support sending UM <a class="el" href="index.html#requestresponse">Requests</a>. (Starting with UM version 6.14, the C API does: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af20577a5adf4b621a74eb7cb89ad2c16">lbm_ssrc_send_request_ex()</a>).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No Data Rate Limit</b> - Smart Source data messages are not <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmdataratelimitcontext">rate limited</a>, although retransmissions are <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html#transportlbtrmretransmitratelimitcontext">rate limited</a>. Care must be taken in designing and provisioning systems to prevent overloading network and host equipment, and overrunning receivers.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>No Hot Failover</b> - Smart Sources are not compatible with <a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>.</p>
<p class="endli"></p>
</li>
<li>
<b>No Batching</b> - Smart Sources are not compatible with <a class="el" href="index.html#implicitbatching">Implicit Batching</a> or <a class="el" href="index.html#explicitbatching">Explicit Batching</a>. </li>
</ul>
<dl class="section note"><dt>Note</dt><dd>It is not permitted to mix Smart Source API calls with standard source API calls for a given Transport Session.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="zerocopysendapi"></a>
Zero-Copy Send API&nbsp;&nbsp;<small><a href="#zerocopysendapi">&lt;-</a></small></h2>
<p>This section introduces the use of the zero-copy send API for LBT-RM.</p>
<dl class="section note"><dt>Note</dt><dd>the Zero-Copy Send API feature is <em>not</em> the same thing as the <a class="el" href="index.html#smartsources">Smart Sources</a> feature; see <a class="el" href="index.html#comparisonofzerocopyandsmartsources">Comparison of Zero Copy and Smart Sources</a>.</dd></dl>
<p>The zero-copy send API modifies the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> function for sending messages such that the UM library does not copy the user's message data before handing the datagram to the socket layer. These changes reduce CPU overhead and provide a minor reduction in latency. The effects are more pronounced for larger user messages, within the restrictions outlined below.</p>
<p>Application code using the zero-copy send API must call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#adf24bf7c4b07549d6a2f89d56e6c913a">lbm_src_alloc_msg_buff()</a> to request a message buffer into which it will build its outgoing message. That function returns a message buffer pointer and also a separate buffer handle. When the application is ready to send the message, it must call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a>, passing the buffer handle as the message (not the message buffer) and specify the LBM_MSG_BUFF_ALLOC send flag.</p>
<p>Once the message is sent, UM will process the buffer asynchronously. Therefore, the application must not make any further reference to either the buffer or the handle.</p>
<p><br />
 </p>
<h3><a class="anchor" id="zerocopysendcompatibility"></a>
Zero-Copy Send Compatibility&nbsp;&nbsp;<small><a href="#zerocopysendcompatibility">&lt;-</a></small></h3>
<p>The zero-copy send API is compatible with the following UM features:</p>
<ul>
<li>
C language, Streaming, source-based publishing applications using LBT-RM. </li>
<li>
Messages sent with the zero-copy API can be received by any UM product or daemon. No special restrictions apply to receivers of messages sent with the zero-copy send API. </li>
<li>
Compatible with implicit batching and message flushing. </li>
<li>
Compatible with non-blocking sends and wakeup source event handling. </li>
<li>
Compatible with hardware timestamps (see section <a class="el" href="index.html#highresolutiontimestamps">High-resolution Timestamps</a> ). </li>
<li>
Compatible with UD Acceleration. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="zerocopyrestrictions"></a>
Zero-Copy Restrictions&nbsp;&nbsp;<small><a href="#zerocopyrestrictions">&lt;-</a></small></h3>
<p>Due to the specialized nature of this feature, there are several restrictions in its use:</p>
<ul>
<li>
<b>Languages</b>. Java and .NET are not supported at this time. </li>
<li>
<b>Transport LBT-RM only</b>. Sourced-based LBT-RM (multicast) only. Zero-copy sends are not compatible with LBT-RU, TCP, IPC, SMX, <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a>, or <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>. Note that an application that uses zero-copy sends for certain sources may also have other sources configured for other transport types. </li>
<li>
<b>Applications only</b>. UM daemons (e.g. <a class="el" href="index.html#umrouter">DRO</a>, Stored, etc.) cannot be configured to use the zero-copy API. </li>
<li>
<b>Streaming only</b>. Zero-copy sends are not compatible with <a class="el" href="index.html#persistence">Persistence</a> or <a class="el" href="index.html#queuing">Queuing</a>. Note that an application that uses zero-copy sends for certain sources may also have other sources mapped to Persistence and/or queuing. </li>
<li>
<b><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send()</a> only</b>. zero-copy sends are not compatible with send APIs not supported: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#af28189e64ef0ee10d3444e418443aaa9">lbm_src_sendv()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a091b5806bf18d10ebd0d9117e0c70229">lbm_src_send_ex()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a4d883eaaa22baf81abf21d495f471c8b">lbm_src_sendv_ex()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aeff48e558306b4bd869af2d99dcf5f4c">lbm_hf_src_send()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a713c05423f7bf1767a29727c07aa4447">lbm_hf_src_sendv()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac515c1425d9b3f04f1e2cea5d66d3005">lbm_hf_src_send_ex()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#acb6f42a8811cb998b4b19748b190f39b">lbm_hf_src_sendv_ex()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ad4d06f66b8404684e191ca178e0cc09b">lbm_send_request()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#aabcfb44e7f5188a47d8d56540e783fa7">lbm_send_request_ex()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a0bbc01b600ccc2ae874474e35955eb85">lbm_send_response()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a24e5bff3a70e571bb12024af67b47cbb">lbm_multicast_immediate_message()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a54f3933e4dd154a9c7bb72598d0d9ef1">lbm_multicast_immediate_request()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a497d77b133cea1547c3346fcba99872a">lbm_unicast_immediate_message()</a>, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ae011c7a66e1db1f012d7f9633dbd321d">lbm_unicast_immediate_request()</a>. Applications may still use these APIs, but not with the zero-copy send feature. </li>
<li>
<b>Send order</b>. It is recommended that zero-copy buffers be sent in the same order that they are allocated. A future version may require this. </li>
<li>
<a class="el" href="index.html#latejoin">Late Join</a>. Not compatible with zero-copy sends. Note that an application that uses zero-copy sends on certain sources may also use late join on other sources. </li>
<li>
<a class="el" href="index.html#requestresponse">Request/Response</a>. Not compatible with zero-copy sends. </li>
<li>
<a class="el" href="index.html#messagemetadata">Message Metadata</a>. Not compatible with <a class="el" href="index.html#messageproperties">Message Properties</a> or <a class="el" href="index.html#applicationheaders">Application Headers</a>. Note that an application that uses zero-copy sends for messages without metadata may also send messages with metadata using other send APIs, even to the same source. </li>
<li>
<a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>. Not supported. Note that an application that uses zero-copy sends for certain sources may use hot failover for other sources. </li>
<li>
<a class="el" href="index.html#explicitbatching">Explicit Batching</a>. not compatible with zero-copy sends. Note that implicit batching is supported. Also note that an application that uses zero-copy sends for certain sources may use explicit batching for other sources. </li>
<li>
<a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a>. not compatible with zero-copy sends. Messages sent zero-copy must fit within a single datagram, as defined by the LBT-RM <a class="el" href="index.html#datagrammaxsizes">Datagram Max Sizes</a>. No special restrictions apply to <a class="el" href="index.html#glossaryipfragmentation">IP fragmentation</a>. Note that an application that uses zero-copy sends for single-datagram messages may also send multi-datagram messages using other send APIs, even to the same source. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="comparisonofzerocopyandsmartsources"></a>
Comparison of Zero Copy and Smart Sources&nbsp;&nbsp;<small><a href="#comparisonofzerocopyandsmartsources">&lt;-</a></small></h2>
<p>There are two UM features that are intended to reduce latency and <a class="el" href="index.html#glossaryjitter">jitter</a> when sending messages: </p><ul>
<li>
<a class="el" href="index.html#smartsources">Smart Sources</a> </li>
<li>
<a class="el" href="index.html#zerocopysendapi">Zero-Copy Send API</a> </li>
</ul>
<p>These two features use different approaches to latency and jitter reduction, and are not compatible with each other. There are trade-offs explained below, and users seeking latency and/or jitter reduction will sometimes need to try both and empirically measure which is better for their use case.</p>
<p>The zero-copy send API removes a copy of the user's data buffer, as compared to a normal send. For small messages of a few hundred bytes, a malloc and a data copy represent a very small amount of time, so unless your messages are large, the absolute latency reduction is minimal.</p>
<p>The Smart Source has the advantage of eliminating all mallocs and frees from the send path. In addition, all thread locking is eliminated. This essentially removes all sources of jitter from the UM send path. Also, the Smart Source feature supports <a class="el" href="index.html#glossaryumfragmentation">UM fragmentation</a>, which zero-copy sends do not. However, because of the approach taken, sending to a Smart Source is somewhat more restrictive than sending with the zero-copy API.</p>
<p>In general, Informatica recommends Smart Sources to achieve the maximum reduction in jitter. For example, the zero-copy send API supports the use of batching to combine multiple messages into a single network datagram. Batching can be essential to achieve high throughputs. Some application designers may determine that the throughput advantages of zero-copy with batching outweigh the jitter advantages of Smart Sources.</p>
<p>See the sections <a class="el" href="index.html#zerocopysendapi">Zero-Copy Send API</a> and <a class="el" href="index.html#smartsources">Smart Sources</a> for details of their restrictions.</p>
<p><br />
 </p>
<h2><a class="anchor" id="xsplatencyreduction"></a>
XSP Latency Reduction&nbsp;&nbsp;<small><a href="#xsplatencyreduction">&lt;-</a></small></h2>
<p>A common source of latency outliers is when Topic Resolution packets are received at the same time that user data messages are received. The UM context thread might process those Topic Resolution packets before processing the user data messages.</p>
<p>By using the XSP feature, user data reception can be moved to a different thread than topic resolution reception. See <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> for details, paying careful attention to <a class="el" href="index.html#xspthreadingconsiderations">XSP Threading Considerations</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="receivesidebatching"></a>
Receive-Side Batching&nbsp;&nbsp;<small><a href="#receivesidebatching">&lt;-</a></small></h2>
<p>The receive-side batching feature can improve throughput of subscribers that use UM <a class="el" href="index.html#eventqueueobject">event queues</a> and/or are written in Java.</p>
<p>See also source-side <a class="el" href="index.html#messagebatching">Message Batching</a>.</p>
<p>UM <a class="el" href="index.html#eventqueueobject">event queues</a> introduce a small overhead which adds latency and reduces maximum sustainable throughput. UM's Java API also introduces a small overhead to deliver received messages from the UM library. Both of these overheads can usually be mitigated with the receive-side batching feature.</p>
<p>This feature is enabled via the configuration option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpdeliverycontrol.html#deliverycontrolmessagebatchingcontext">delivery_control_message_batching (context)</a>.</p>
<p>The feature works by collecting receiver events into bundles. For an event queue, the bundle is sent to the dispatch thread as a single queue item. For Java, the bundle is passed to the Java language as a single object. In both cases, the overhead is amortized across the multiple messages in the bundle.</p>
<p>This feature is most effective when used along with the <a class="el" href="index.html#receivemultipledatagrams">Receive Multiple Datagrams</a> feature (Linux only), which will increase the bundle size automatically if the receiver falls behind. A publisher using <a class="el" href="index.html#messagebatching">Message Batching</a> also increases the bundle size. Larger bundles means greater efficiency gains.</p>
<dl class="section note"><dt>Note</dt><dd>If you enable receive-side batching and you use an event queue that is in polling mode (using <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a1995a85e2c983f6b38322c5c5784f32e">LBM_EVENT_QUEUE_POLL</a>), a single call to <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#ac06b127bae882dd5fb68b7044fdceb5f">lbm_event_dispatch()</a> can result in multiple events being dispatched.</dd></dl>
<p><br />
 </p>
<h3><a class="anchor" id="receivesidebatchingrestrictions"></a>
Receive-Side Batching Restrictions&nbsp;&nbsp;<small><a href="#receivesidebatchingrestrictions">&lt;-</a></small></h3>
<ul>
<li>
<p class="startli">The <a class="el" href="index.html#transportservicesproviderxsp">XSP</a> feature does not support receive-side batching. Note that users of XSP are typically trying to maximize the performance of UM, and probably should not be using <a class="el" href="index.html#eventqueueobject">event queues</a>. For alternatives, please <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>.</p>
<p class="endli"></p>
</li>
<li>
Do not use receive-side batching for C or .NET programs that are not using event queues. The feature does not increase efficiency and can actually reduce it. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="corepinning"></a>
Core Pinning&nbsp;&nbsp;<small><a href="#corepinning">&lt;-</a></small></h2>
<p>The Unix and Windows operating systems attempt to balance CPU utilization across all available CPU cores. They often do this without regard to the architectural design of the system hardware, which can introduce significant inefficiencies. For example, if a thread's execution migrates from one <a href="https://queue.acm.org/detail.cfm?id=2513149">NUMA node</a> to another, the code will frequently need to access memory located in the other NUMA zone, which happens over a slower memory interconnect.</p>
<p>Fortunately, Unix and Windows support <a class="el" href="index.html#glossarypinning">pinning</a> processes and threads to specific CPU cores. It is the user's responsibility to understand the host architecture sufficiently to know which cores are grouped into NUMA zones. Pinning a group of related threads to cores within the same NUMA zone is important to maintain high performance.</p>
<p>However, even letting the operating system migrate a thread from one core to another within a single NUMA zone has the side effect of invalidating the cache, which introduces latency. You get the best performance when each thread is pinned to its own core, with no other threads contending for that core. This approach obviously severely limits the number of threads that can run on a host.</p>
<p>UM does not have a general feature that pins threads to cores for applications. It is the user's responsibility to pin (set affinity) using the appropriate operating system APIs.</p>
<p>The Persistent Store allows the user to assign individual threads to specific cores. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/storethreadaffinity.html">Store Thread Affinity</a> for details.</p>
<p>For the <a class="el" href="index.html#umrouter">DRO</a>, it is not possible to identify specific threads and assign them to individual cores. But the user can use the operating system's user interface to assign the entire DRO process to a group of cores known to be in the same NUMA zone.</p>
<p><br />
 </p>
<h2><a class="anchor" id="memorylatencyreduction"></a>
Memory Latency Reduction&nbsp;&nbsp;<small><a href="#memorylatencyreduction">&lt;-</a></small></h2>
<p>UM makes use of dynamic memory allocation/deallocation using malloc() and free(). The default memory allocator included with Linux and Windows can sometimes introduce latency outliers of multiple milliseconds. It is rare, but we have seen outliers as long as 10 milliseconds.</p>
<p>There are higher-performing allocators available, many of them open-source. For example, <a href="http://hoard.org/">Hoard</a>. There are <a href="https://en.wikipedia.org/wiki/C_dynamic_memory_allocation#Implementations">many others</a>.</p>
<p>A good commercial product is <a href="http://microquill.com/smartheap/">MicroQuill's SmartHeap</a>. In fact, the Persistent Store is built and ships with SmartHeap. Note that licensing Ultra Messaging does not grant a license to the customer for general use of SmartHeap. Users who want to use SmartHeap in applications should contact <a href="http://microquill.com/">MicroQuill</a> directly.</p>
<p>None of these products can <b>guarantee</b> that there will never be millisecond-long latencies, but they can greatly reduce the frequency.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="manpagesforsrs"></a>
Man Pages for SRS&nbsp;&nbsp;<small><a href="#manpagesforsrs">&lt;-</a></small></h1>
<p>TCP-based resolver services for UM messaging products are provided by SRS.</p>
<p>For more information on TCP-based TR, see <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-Based Topic Resolution Details</a>. For more information on Topic Resolution general, see <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</p>
<p>There are two executables for the SRS, each with it's own man page: </p><ul>
<li>
<a class="el" href="index.html#srsmanpage">SRS Man Page</a> - Unix and Windows command-line interface. </li>
<li>
<a class="el" href="index.html#srsdsmanpage">Srsds Man Page</a> - Windows Service interface. </li>
</ul>
<p>Note that these executables are not in the same "bin" directory as the platform native UM executables. Since it is a Java program, it has its own directory sub-tree, "SRS", with sub-directories "bin" and "lib". For example, the UMS SRS executables are under "UMS_6.17/SRS/bin". For instructions on using a different directory structure, see the "Usage Notes" sections in <a class="el" href="index.html#srsmanpage">SRS Man Page</a> and <a class="el" href="index.html#srsdsmanpage">Srsds Man Page</a>.</p>
<p>Note also that the SRS uses the underlying platform-specific UM library, so your proper paths should be set up.</p>
<p><br />
 </p>
<h2><a class="anchor" id="srsmanpage"></a>
SRS Man Page&nbsp;&nbsp;<small><a href="#srsmanpage">&lt;-</a></small></h2>
<p>Unix and Windows command-line interface.</p>
<pre class="fragment">Usage: SRS [options] [configfile]
Available options: 
  -d, --dump             dump the user configuration to stdout and exit
  -D, --Debug=PATH:MASK  set debug PATH and MASK
  -h, --help             display this help message and exit
  -j, --java             print Java properties to the SRS log file (-j -j = print more Java properties)
  -v, --validate         validate config file and exit
  -x, --xsd              dump the configuration XSD to stdout and exit</pre><dl class="section user"><dt><b>Description</b> </dt><dd>The <code>SRS</code> command runs the Stateful Resolver Service (SRS). It can be run interactively from a shell or command prompt, or from a script or batch file. (For use as a Windows Service, see <a class="el" href="index.html#srsdsmanpage">Srsds Man Page</a>.)</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"configfile"</b> parameter is optional. If supplied, it specifies the file path for the SRS's XML configuration file. if omitted, the SRS defaults all configurable options. See <a class="el" href="index.html#srsconfigurationfile">SRS Configuration File</a> for configuration details.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-D"</b> option sets enables debugging output. This output is intended primarily for Informatica Support, not end-users.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-j"</b> option prints Java properties to the SRS log file. It can be repeated ('-j -j') to increase the output. This output is intended primarily for Informatica Support, not end-users.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-d"</b> option dumps (prints) to standard out the full SRS configuration. After printing, the SRS exits. (Note, this is different from other UM daemons in which "-d" dumps the daemon's DTD. But the SRS does not use a DTD, it uses an XSD. See the "-x" option below.)</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-x"</b> option prints the XSD which is used to validate the configuration file. After printing, the SRS exits.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-v"</b> validates the XML structure of the given configuration file against the SRS's XML XSD. After validating the configuration file's XML structure, SRS exits with status 0 for no errors, or non-zero if errors were found. For example: <div class="fragment"><div class="line">SRS -v /um/srs_cfg.xml</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt></dt><dd>Note that valid XML structure does not guarantee that the configuration file is completely correct. It must be tested on a running SRS.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-h"</b> option prints the man page and exits.</dd></dl>
<dl class="section user"><dt><b>Exit</b> <b>Status</b> </dt><dd>The exit status from SRS is 0 for success and some non-zero value for failure.</dd></dl>
<dl class="section user"><dt><b>Usage</b> <b>Notes</b> </dt><dd></dd></dl>
<ul>
<li>
<p class="startli">When shutting down a Unix-based SRS Process, use a SIGINT to trigger a clean shutdown, which attempts to cleanly finish outstanding IO requests before shutting down.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Given how the SRS was implemented, there are scripts, binary executables, and Java JAR files associated with the service. By default, the scripts and executables assume a certain directory structure, with the scripts and executables stored in a "bin" sub-directory, and JAR files stored in a "lib" sub-directory. This corresponds to how the UM package installation structures the files.</p>
<p class="endli">Starting with UM version 6.17, the user can adopt a different directory structure. To assist the scripts and executables in finding the JAR files, the user can define an environment variable, "UM_SRS_DIR", which contains the full path for the directory containing the JAR files. </p>
</li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="srsdsmanpage"></a>
Srsds Man Page&nbsp;&nbsp;<small><a href="#srsdsmanpage">&lt;-</a></small></h2>
<p>Windows Service interface.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#umdaemonsaswindowsservices">UM Daemons as Windows Services</a> for general information about UM daemons as Windows Services.</p>
<dl class="section note"><dt>Note</dt><dd>In the descriptions below, three different log files are referenced: "service log", "process log", and "SRS log". It is important that all three of these be specified, and that they be separate files. In normal use, only the "SRS log" will be written to; the other two are only necessary to record unusual error conditions.</dd></dl>
<pre class="fragment">Usage: srsds [options] srs_cfgfile_name 
Available options:
  -h, --help                  display this help and exit
  -l, --service-log=FILE      set a logfile name for the service log.
  -p, --process-log=FILE      set a logfile name for the srs process output.
  -s, --service=request       Install, remove or add a configuration file.
                              Examples: '-s install' to install the service with no config file
                                '-s install cfgfile.xml' to install the service with a configuration file of cfgfile.xml
                                '-s remove' to remove the service
                                '-s config cfg2.xml' to change or add a configuration file
  -e, --event-log-level       Update/set service logging level.  This is the minimum logging
                              level to send to the Windows event log.  Valid values are:
                                NONE - Send no events
                                INFO
                                WARN - default
                                ERROR
  -E, --env_var_file          update/set the environment Variable File
  -f, --flatdir               specify that binaries and java libraries are in the same directory
                                Note: This sets UM_SRS_DIR environment variable to the directory path of this executable
  -U, --noenv_var_file        unset env_var_file (-E) entry
                                Note: -U and -E are not supported on the same command line</pre><dl class="section user"><dt><b>Description</b> </dt><dd>The <code>srsds</code> command has two functions: <ul>
<li>
First, it lets the user supply Windows Service operating parameters, which the command saves into the Windows registry. Those operating parameters are subsequently used by the SRS Service. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a>. </li>
<li>
Second, it provides Windows with the SRS daemon executable to run as a Service. </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"srs_cfgfile_name"</b> parameter specifies the file path for the SRS's XML configuration file. It is supplied in conjunction with the "-s config" option (see below). See <a class="el" href="index.html#srsconfigurationfile">SRS Configuration File</a> for configuration details.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-l"</b> option specifies a "service" log file path, which is saved in the Windows registry and subsequently by the Windows Service. Under normal circumstances, this log file will never be written to. It will be written if the SRS is unsuccessful in starting up as a service. (The normal SRS log file is configured differently, using the <a class="el" href="index.html#srselementlog">&lt;log&gt;</a> element in the configuration file.)</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-p"</b> option specifies a "process" log file path, which is saved in the Windows registry and subsequently by the Windows Service. Under normal circumstances, this log file will never be written to. It will be written if the Java JVM writes to standard out or standard error, of if the SRS is not able to write to its configured log file.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>By default, the SRS's configuration file uses <a class="el" href="index.html#srselementlog">&lt;log type="console"&gt;</a>. In this case, normal SRS logs are written to standard out and will be captured in the "process" log file. <b>This is not recommended as it leads to unbounded growth of the log file.</b> Users should set <a class="el" href="index.html#srselementlog">&lt;log type="file"&gt;</a> and related attributes to control the log file sizes.</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-s install"</b> see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#installthewindowsservice">Install the Windows Service</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-s remove"</b> see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#removethewindowsservice">Remove the Windows Service</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-s config"</b> and <b>"-e"</b>, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-h"</b> option prints the man page and exits.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-E env_var_file"</b> option provides a convenient method to specify environment variables for the service without having to modify the system-level environment. The SRS service will read this file and define variables in its own environment.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-U"</b> option removes a previously set "env_var_file" ("-E") so that the next time the Windows service is started, that file will not be read. (New in UM version 6.17)</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-f"</b> option is a short cut for telling the SRS that its JAR files are in the same directory as the executables, without the need to define the "UM_SRS_DIR" environment variable. (New in UM version 6.17)</dd></dl>
<dl class="section user"><dt><b>Exit</b> <b>Status</b> </dt><dd>The exit status from SRS is 0 for success and some non-zero value for failure.</dd></dl>
<dl class="section user"><dt><b>Usage</b> <b>Notes</b> </dt><dd></dd></dl>
<ul>
<li>
<p class="startli">When installing the SRS as a Microsoft Windows service, use only local disk devices and fully qualified path names for all filenames. This is because Windows services run by default under a Local System account, which has reduced privileges and is not allowed access to network devices.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Given how the SRS Windows service was implemented, there are binary executables and Java JAR files associated with the service. By default, the executables assume a certain directory structure, with the executables stored in a "bin" sub-directory, and JAR files stored in a "lib" sub-directory. This corresponds to how the UM package installation structures the files.</p>
<p>Starting with UM version 6.17, the user can use their own directory structure. To assist the executables in finding the JAR files, the user can define an environment variable, "UM_SRS_DIR", which contains the full path for the directory containing the JAR files. This environment variable can either be made at the system level, or can be defined in a disk file, specified by the "-E" command-line option to <code>mcsds</code>.</p>
<p>Alternatively, if you plan to store the executables in the same directory as the JAR files, you can instead use the "-f" command-line option to <code>mcsds</code>.</p>
<p class="endli"></p>
</li>
<li>
Stopping the SRS service triggers a clean shutdown, which attempts to cleanly finish outstanding IO requests before shutting down. </li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>Do not use the task manager or the "kill" command to stop a UM daemon running as a Windows service. Use the Windows service control panel to stop the service.</dd></dl>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="srsconfigurationfile"></a>
SRS Configuration File&nbsp;&nbsp;<small><a href="#srsconfigurationfile">&lt;-</a></small></h1>
<p>For general information about TCP-based topic resolution, see <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-Based Topic Resolution Details</a>.</p>
<p>The SRS configuration file must start with this line: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div></div><!-- fragment --><p>After that, the '<b>&lt;um-srs&gt;</b>' element contains the rest of the configuration.</p>
<p>The SRS configuration does not support the XInclude feature.</p>
<p>Here is a sample short configuration: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;log type=<span class="stringliteral">&quot;file&quot;</span> frequency=<span class="stringliteral">&quot;hourly&quot;</span> size=<span class="stringliteral">&quot;10&quot;</span> max-history=<span class="stringliteral">&quot;10&quot;</span></div><div class="line">         total-size-cap=<span class="stringliteral">&quot;10000&quot;</span> compression=<span class="stringliteral">&quot;zip&quot;</span>&gt;SRS.log&lt;/log&gt;</div><div class="line">    &lt;pid-file&gt;SRS.pid&lt;/pid-file&gt;</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;interface&gt;10.12.34.56&lt;/interface&gt;</div><div class="line">    &lt;port&gt;27000&lt;/port&gt;</div><div class="line">    &lt;state-lifetime&gt;3600&lt;/state-lifetime&gt;</div><div class="line">  &lt;/srs&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;<span class="keywordflow">default</span>&gt;2000&lt;/<span class="keywordflow">default</span>&gt;</div><div class="line">      &lt;config-opts&gt;20000&lt;/config-opts&gt;</div><div class="line">      &lt;<span class="keyword">internal</span>-config-opts&gt;0&lt;/<span class="keyword">internal</span>-config-opts&gt;</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    &lt;lbm-attributes&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;operational_mode&quot;</span> value=<span class="stringliteral">&quot;embedded&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;mim_incoming_address&quot;</span> value=<span class="stringliteral">&quot;0.0.0.0&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_port_low&quot;</span> value=<span class="stringliteral">&quot;14381&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_port_high&quot;</span> value=<span class="stringliteral">&quot;15381&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;source&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_interface&quot;</span> value=<span class="stringliteral">&quot;10.29.3.0/24&quot;</span> /&gt;</div><div class="line">    &lt;/lbm-attributes&gt;</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>It is important to configure the SRS with <a class="el" href="index.html#srselementinterface">SRS Element "&lt;interface&gt;"</a>, even if the SRS is running on a single-homed host (one network connection).</dd></dl>
<p>When the daemon monitor is enabled, the first two lbm attribute option setting are recommended for conserving resources.</p>
<p><br />
 </p>
<h2><a class="anchor" id="srsconfigurationelements"></a>
SRS Configuration Elements&nbsp;&nbsp;<small><a href="#srsconfigurationelements">&lt;-</a></small></h2>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementumsrs"></a>
SRS Element "&lt;um-srs&gt;"&nbsp;&nbsp;<small><a href="#srselementumsrs">&lt;-</a></small></h3>
<p>Container element which holds the SRS configuration. Also defines the version of the configuration format used by the file.</p>
<ul>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementdaemon">&lt;daemon&gt;</a>, <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a>, <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>, <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>version</b> </td><td>Version number of user's configuration file. </td><td>nonEmptyString </td><td><b><code>"1.0"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementdaemonmonitor"></a>
SRS Element "&lt;daemon-monitor&gt;"&nbsp;&nbsp;<small><a href="#srselementdaemonmonitor">&lt;-</a></small></h3>
<p>Contains elements which configure the SRS monitoring capability. This feature is used to monitor the SRS's health and performance. It can also be useful to monitor activity in the entire <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a>.</p>
<p>Note that the "topic" attribute <em>must</em> be supplied, otherwise no statistics will be published. Also note that if using the <a class="el" href="index.html#srselementmonitorformat">protobuf format</a>, other UM components default to the topic "/29west/statistics".</p>
<p>See child elements for details.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementumsrs">&lt;um-srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementpinginterval">&lt;ping-interval&gt;</a>, <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a>, <a class="el" href="index.html#srselementlbmattributes">&lt;lbm-attributes&gt;</a>, <a class="el" href="index.html#srselementpublishconnectionevents">&lt;publish-connection-events&gt;</a>, <a class="el" href="index.html#srselementremotesnapshotrequest">&lt;remote-snapshot-request&gt;</a>, <a class="el" href="index.html#srselementremoteconfigchangesrequest">&lt;remote-config-changes-request&gt;</a>, <a class="el" href="index.html#srselementmonitorformat">&lt;monitor-format&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>topic</b> </td><td>Set the name of the topic on which the SRS publishes its daemon stats. </td><td>nonEmptyString </td><td>(no default; must be specified) </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementmonitorformat"></a>
SRS Element "&lt;monitor-format&gt;"&nbsp;&nbsp;<small><a href="#srselementmonitorformat">&lt;-</a></small></h3>
<p>Specifies the desired format of monitoring data. For use with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html#monitoringcollectorservicemcs">Monitoring Collector Service (MCS)</a>, use the format "pb" (proto buff).</p>
<p>Valid values are "pb" (recommended) or "json" (deprecated). See <a class="el" href="index.html#srsmonitoring">SRS Monitoring</a>.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> json </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementremoteconfigchangesrequest"></a>
SRS Element "&lt;remote-config-changes-request&gt;"&nbsp;&nbsp;<small><a href="#srselementremoteconfigchangesrequest">&lt;-</a></small></h3>
<p>Controls whether the SRS daemon monitor accepts <a class="el" href="index.html#requesttypesetpublishinginterval">Request Type: SET_PUBLISHING_INTERVAL</a>. This allows remote monitoring applications to change operational parameters of the SRS Daemon Monitoring feature.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>allow</b> </td><td>Enable or disable this function. </td><td><b><code>"true"</code></b> - Enabled <br />
<b><code>"false"</code></b> - Disabled </td><td><b><code>"false"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;remote-config-changes-request allow=<span class="stringliteral">&quot;true&quot;</span>/&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementremotesnapshotrequest"></a>
SRS Element "&lt;remote-snapshot-request&gt;"&nbsp;&nbsp;<small><a href="#srselementremotesnapshotrequest">&lt;-</a></small></h3>
<p>Controls whether the SRS daemon monitor accepts <a class="el" href="index.html#requesttypereportmonitorinfo">Request Type: REPORT_MONITOR_INFO</a>. This allows remote monitoring applications to trigger immediate publishing of monitoring data.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>allow</b> </td><td>Enable or disable this function. </td><td><b><code>"true"</code></b> - Enabled <br />
<b><code>"false"</code></b> - Disabled </td><td><b><code>"false"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;remote-snapshot-request allow=<span class="stringliteral">&quot;true&quot;</span>/&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementpublishconnectionevents"></a>
SRS Element "&lt;publish-connection-events&gt;"&nbsp;&nbsp;<small><a href="#srselementpublishconnectionevents">&lt;-</a></small></h3>
<p>Controls whether the SRS reports connection-oriented events from UM contexts as part of the daemon stats. See <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a> for more information.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>allow</b> </td><td>Enable or disable this function. </td><td><b><code>"true"</code></b> - Enabled <br />
<b><code>"false"</code></b> - Disabled </td><td><b><code>"false"</code></b> </td></tr>
</table>
<p><b>Example:</b> (SRS includes connection-oriented events in monitoring stats) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publish-connection-events allow=<span class="stringliteral">&quot;true&quot;</span>/&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementlbmattributes"></a>
SRS Element "&lt;lbm-attributes&gt;"&nbsp;&nbsp;<small><a href="#srselementlbmattributes">&lt;-</a></small></h3>
<p>Container element containing any number of <a class="el" href="index.html#srselementoption">&lt;option&gt;</a> elements. Each <a class="el" href="index.html#srselementoption">&lt;option&gt;</a> element supplies an LBM configuration option to the UM context that the SRS creates to publish daemon stats. Any number of <a class="el" href="index.html#srselementoption">&lt;option&gt;</a> elements can be supplied in the <a class="el" href="index.html#srselementlbmattributes">&lt;lbm-attributes&gt;</a> container element.</p>
<p>See <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a> for more information on daemon statistics.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementoption">&lt;option&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;lbm-attributes&gt;</div><div class="line">      ...</div><div class="line">    &lt;/lbm-attributes&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementoption"></a>
SRS Element "&lt;option&gt;"&nbsp;&nbsp;<small><a href="#srselementoption">&lt;-</a></small></h3>
<p>Supplies an LBM configuration option to the UM context that the SRS creates to publish daemon stats. Any number of <a class="el" href="index.html#srselementoption">&lt;option&gt;</a> elements can be supplied in the <a class="el" href="index.html#srselementlbmattributes">&lt;lbm-attributes&gt;</a> container element.</p>
<p>See the <a href="../../Config/index.html">UM Configuration Guide</a> for the full list of LBM configuration options.</p>
<p>See <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a> for more information on daemon statistics.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. unbounded </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementlbmattributes">&lt;lbm-attributes&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>scope</b> </td><td>Scope for the LBM configuration option being set. One of: <br />
 <b><code>"context"</code></b> <br />
 <b><code>"source"</code></b> <br />
 <b><code>"receiver"</code></b> <br />
(The normal LBM scopes <code>wildcard_receiver</code>, <code>event_queue</code>, and <code>hfx</code> are not applicable to the SRS monitor context.) </td><td>nonEmptyString </td><td>(no default; must be specified) </td></tr>
<tr>
<td><b>name</b> </td><td>Name of LBM configuration option being set. </td><td>nonEmptyString </td><td>(no default; must be specified) </td></tr>
<tr>
<td><b>value</b> </td><td>Value of LBM configuration option being set. </td><td>nonEmptyString </td><td>(no default; must be specified) </td></tr>
</table>
<p><b>Example:</b> (SRS publishes monitoring stats using LBT-RU transport) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;lbm-attributes&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;operational_mode&quot;</span> value=<span class="stringliteral">&quot;embedded&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;mim_incoming_address&quot;</span> value=<span class="stringliteral">&quot;0.0.0.0&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_port_low&quot;</span> value=<span class="stringliteral">&quot;14381&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;context&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_port_high&quot;</span> value=<span class="stringliteral">&quot;15381&quot;</span> /&gt;</div><div class="line">      &lt;option scope=<span class="stringliteral">&quot;source&quot;</span> name=<span class="stringliteral">&quot;transport_tcp_interface&quot;</span> value=<span class="stringliteral">&quot;10.29.3.0/24&quot;</span> /&gt;</div><div class="line">      ...</div><div class="line">    &lt;/lbm-attributes&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><p>The first two option settings above are recommended for conserving resources.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementpublishinginterval"></a>
SRS Element "&lt;publishing-interval&gt;"&nbsp;&nbsp;<small><a href="#srselementpublishinginterval">&lt;-</a></small></h3>
<p>Set how often the SRS publishes its daemon stats. See <a class="el" href="index.html#srsdaemonstatistics">SRS Daemon Statistics</a> for more information. The child elements set the intervals for each class of monitoring data. For any class of data omitted, the <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a> element sets the interval.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>, <a class="el" href="index.html#srselementsrsstats">&lt;srs-stats&gt;</a>, <a class="el" href="index.html#srselementumclientstats">&lt;um-client-stats&gt;</a>, <a class="el" href="index.html#srselementconnectionevents">&lt;connection-events&gt;</a>, <a class="el" href="index.html#srselementsrserrorstats">&lt;srs-error-stats&gt;</a>, <a class="el" href="index.html#srselementumclienterrorstats">&lt;um-client-error-stats&gt;</a>, <a class="el" href="index.html#srselementconfigopts">&lt;config-opts&gt;</a>, <a class="el" href="index.html#srselementinternalconfigopts">&lt;internal-config-opts&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementinternalconfigopts"></a>
SRS Element "&lt;internal-config-opts&gt;"&nbsp;&nbsp;<small><a href="#srselementinternalconfigopts">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes certain internal configuration data. These data are primarily of interest to Informatica Support. The value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 10 </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;<span class="keyword">internal</span>-config-opts&gt;10000&lt;/<span class="keyword">internal</span>-config-opts&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementconfigopts"></a>
SRS Element "&lt;config-opts&gt;"&nbsp;&nbsp;<small><a href="#srselementconfigopts">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes its configuration data. The special value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;config-opts&gt;10000&lt;/config-opts&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementumclienterrorstats"></a>
SRS Element "&lt;um-client-error-stats&gt;"&nbsp;&nbsp;<small><a href="#srselementumclienterrorstats">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes statistics related to internal client-facing software errors. These statistics are primarily of interest to Informatica Support. The special value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;um-client-error-stats&gt;10000&lt;/um-client-error-stats&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementsrserrorstats"></a>
SRS Element "&lt;srs-error-stats&gt;"&nbsp;&nbsp;<small><a href="#srselementsrserrorstats">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes statistics related to internal SRS software errors. These statistics are primarily of interest to Informatica Support. The value zero disables publishing that class of daemon stats.</p>
<p>Valid values: 0, 200 - 7776000000</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;srs-error-stats&gt;10000&lt;/srs-error-stats&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementconnectionevents"></a>
SRS Element "&lt;connection-events&gt;"&nbsp;&nbsp;<small><a href="#srselementconnectionevents">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes client connect and disconnect events. The value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;connection-events&gt;10000&lt;/connection-events&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementumclientstats"></a>
SRS Element "&lt;um-client-stats&gt;"&nbsp;&nbsp;<small><a href="#srselementumclientstats">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes statistics related to Topic Resolution clients. The special value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;um-client-stats&gt;10000&lt;/um-client-stats&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementsrsstats"></a>
SRS Element "&lt;srs-stats&gt;"&nbsp;&nbsp;<small><a href="#srselementsrsstats">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes internal SRS operational statistics. The special value zero disables publishing that class of daemon stats.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Value supplied by <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>. </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;srs-stats&gt;10000&lt;/srs-stats&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementdefault"></a>
SRS Element "&lt;default&gt;"&nbsp;&nbsp;<small><a href="#srselementdefault">&lt;-</a></small></h3>
<p>Sets how often (in milliseconds) the SRS publishes those classes of daemon stats which are not explicitly set by other elements. The special value zero disables publishing that class of daemon stats. See <a class="el" href="index.html#srselementpublishinginterval">SRS Element "&lt;publishing-interval&gt;"</a> for the classes.</p>
<p>Valid range: 0, 200 .. 7776000000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementpublishinginterval">&lt;publishing-interval&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 0 </li>
</ul>
<p><b>Example:</b> (SRS publishes monitoring stats every 10 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;publishing-interval&gt;</div><div class="line">      &lt;<span class="keywordflow">default</span>&gt;10000&lt;/<span class="keywordflow">default</span>&gt;</div><div class="line">      ...</div><div class="line">    &lt;/publishing-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementpinginterval"></a>
SRS Element "&lt;ping-interval&gt;"&nbsp;&nbsp;<small><a href="#srselementpinginterval">&lt;-</a></small></h3>
<p>Controls the period (in milliseconds) at which SRS internal statistics are sampled and made available. The special value zero disables this sampling.</p>
<p>The ping-interval control is available under the <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> element and the <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a> element. Unless otherwise directed by Informatica Support, only the <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> instance is of interest to users.</p>
<p>Note that there can only be one ping interval across both functions. A &lt;daemon-monitor&gt; setting for ping-interval will override a &lt;debug-monitor&gt; setting.</p>
<p>See <a class="el" href="index.html#srsmonitoring">SRS Monitoring</a>.</p>
<p>Valid range: 100 .. 3600000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>, <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 60000 (1 minute) </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon-monitor topic=<span class="stringliteral">&quot;/29west/statistics&quot;</span>&gt;</div><div class="line">    &lt;ping-interval&gt;10000&lt;/ping-interval&gt;</div><div class="line">    ...</div><div class="line">    &lt;monitor-format&gt;pb&lt;/monitor-format&gt;</div><div class="line">  &lt;/daemon-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementdebugmonitor"></a>
SRS Element "&lt;debug-monitor&gt;"&nbsp;&nbsp;<small><a href="#srselementdebugmonitor">&lt;-</a></small></h3>
<p>Contains elements which configure the optional web-based debug monitor for the SRS. The debug monitor is primarily for use by Informatica support, and is not intended for end users. Unless otherwise instructed by Informatica support, users should not enable the debug monitor.</p>
<p>Omit this element to disable the debug monitor.</p>
<p>See <a class="el" href="index.html#webmonsecurity">Webmon Security</a> for important security information.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementumsrs">&lt;um-srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementinterface">&lt;interface&gt;</a>, <a class="el" href="index.html#srselementport">&lt;port&gt;</a>, <a class="el" href="index.html#srselementpinginterval">&lt;ping-interval&gt;</a>, <a class="el" href="index.html#srselementenabled">&lt;enabled&gt;</a> </li>
</ul>
<p>This is NOT related to monitoring the SRS health and performance. See <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a>.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;debug-monitor&gt;</div><div class="line">    ...</div><div class="line">  &lt;/debug-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementenabled"></a>
SRS Element "&lt;enabled&gt;"&nbsp;&nbsp;<small><a href="#srselementenabled">&lt;-</a></small></h3>
<p>Controls whether the debug monitor is active. Can be set to <code>true</code> or <code>false</code>. See <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> false </li>
</ul>
<p><b>Example:</b> (disable debug-monitor explicitly) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;debug-monitor&gt;</div><div class="line">    &lt;enabled&gt;<span class="keyword">false</span>&lt;/enabled&gt;</div><div class="line">    ...</div><div class="line">  &lt;/debug-monitor&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementport"></a>
SRS Element "&lt;port&gt;"&nbsp;&nbsp;<small><a href="#srselementport">&lt;-</a></small></h3>
<p>Supplies network port to bind the socket required by the parent element. This is the port that a UM context should use when TCP-based TR is configured with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>. The value contained within the <code>&lt;port&gt;...&lt;/port&gt;</code> is an integer.</p>
<p>Valid range: 0 .. 65535</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>, <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 27000 </li>
</ul>
<p><b>Example:</b> (UM clients use port 12000 with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a> option) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;port&gt;12000&lt;/port&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementinterface"></a>
SRS Element "&lt;interface&gt;"&nbsp;&nbsp;<small><a href="#srselementinterface">&lt;-</a></small></h3>
<p>Specifies the network interface to bind the socket required by the parent element.</p>
<dl class="section attention"><dt>Attention</dt><dd>It is important to configure the SRS with <a class="el" href="index.html#srselementinterface">SRS Element "&lt;interface&gt;"</a>, even if the SRS is running on a single-homed host (one network connection).</dd></dl>
<p>For the <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> element, this is the IP address that a UM context should use when TCP-based TR is configured with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>. The value contained within the <code>&lt;interface&gt;...&lt;/interface&gt;</code> can be a fully-qualified dotted-decimal IP address or a DNS host name.</p>
<dl class="section warning"><dt>Warning</dt><dd>Unlike UM library configurations, the SRS configuration does not support CIDR specification of an IP network to match an interface by network number. This interface specification must include the host number.</dd></dl>
<p>For the <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a> element, this is the host for the URL that a web browser should use to display the debug monitor page.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>, <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> localhost </li>
</ul>
<p><b>Example:</b> (UM clients use 10.12.34.56 with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a> option) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;interface&gt;10.12.34.56&lt;/interface&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementsrs"></a>
SRS Element "&lt;srs&gt;"&nbsp;&nbsp;<small><a href="#srselementsrs">&lt;-</a></small></h3>
<p>Defines network and operational settings of the SRS service.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementumsrs">&lt;um-srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementinterface">&lt;interface&gt;</a>, <a class="el" href="index.html#srselementport">&lt;port&gt;</a>, <a class="el" href="index.html#srselementstatelifetime">&lt;state-lifetime&gt;</a>, <a class="el" href="index.html#srselementsourcestatelifetime">&lt;source-state-lifetime&gt;</a>, <a class="el" href="index.html#srselementintereststatelifetime">&lt;interest-state-lifetime&gt;</a>, <a class="el" href="index.html#srselementroutestatelifetime">&lt;route-state-lifetime&gt;</a>, <a class="el" href="index.html#srselementcontextnamestatelifetime">&lt;context-name-state-lifetime&gt;</a>, <a class="el" href="index.html#srselementsourceleavebackoff">&lt;source-leave-backoff&gt;</a>, <a class="el" href="index.html#srselementotidmap">&lt;otidmap&gt;</a>, <a class="el" href="index.html#srselementtopicmap">&lt;topicmap&gt;</a>, <a class="el" href="index.html#srselementroutemap">&lt;routemap&gt;</a>, <a class="el" href="index.html#srselementnamemap">&lt;namemap&gt;</a>, <a class="el" href="index.html#srselementclientactor">&lt;clientactor&gt;</a>, <a class="el" href="index.html#srselementapplicationid">&lt;application-id&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementapplicationid"></a>
SRS Element "&lt;application-id&gt;"&nbsp;&nbsp;<small><a href="#srselementapplicationid">&lt;-</a></small></h3>
<p>Adds an "Application ID" for SRS monitoring statistics. Used with monitoring format "pb" (proto buff).</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> (none) </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;application-<span class="keywordtype">id</span>&gt;SRS1&lt;/application-<span class="keywordtype">id</span>&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementclientactor"></a>
SRS Element "&lt;clientactor&gt;"&nbsp;&nbsp;<small><a href="#srselementclientactor">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementrequeststreammaxmsgcount">&lt;request-stream-max-msg-count&gt;</a>, <a class="el" href="index.html#srselementrecordqueueserviceinterval">&lt;record-queue-service-interval&gt;</a>, <a class="el" href="index.html#srselementbatchframemaxrecordcount">&lt;batch-frame-max-record-count&gt;</a>, <a class="el" href="index.html#srselementbatchframemaxdatagramsize">&lt;batch-frame-max-datagram-size&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementbatchframemaxdatagramsize"></a>
SRS Element "&lt;batch-frame-max-datagram-size&gt;"&nbsp;&nbsp;<small><a href="#srselementbatchframemaxdatagramsize">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementclientactor">&lt;clientactor&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementbatchframemaxrecordcount"></a>
SRS Element "&lt;batch-frame-max-record-count&gt;"&nbsp;&nbsp;<small><a href="#srselementbatchframemaxrecordcount">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementclientactor">&lt;clientactor&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementrecordqueueserviceinterval"></a>
SRS Element "&lt;record-queue-service-interval&gt;"&nbsp;&nbsp;<small><a href="#srselementrecordqueueserviceinterval">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<p>Valid range: 1 .. 1000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementclientactor">&lt;clientactor&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementrequeststreammaxmsgcount"></a>
SRS Element "&lt;request-stream-max-msg-count&gt;"&nbsp;&nbsp;<small><a href="#srselementrequeststreammaxmsgcount">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementclientactor">&lt;clientactor&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementnamemap"></a>
SRS Element "&lt;namemap&gt;"&nbsp;&nbsp;<small><a href="#srselementnamemap">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementshards"></a>
SRS Element "&lt;shards&gt;"&nbsp;&nbsp;<small><a href="#srselementshards">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementotidmap">&lt;otidmap&gt;</a>, <a class="el" href="index.html#srselementtopicmap">&lt;topicmap&gt;</a>, <a class="el" href="index.html#srselementroutemap">&lt;routemap&gt;</a>, <a class="el" href="index.html#srselementnamemap">&lt;namemap&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementroutemap"></a>
SRS Element "&lt;routemap&gt;"&nbsp;&nbsp;<small><a href="#srselementroutemap">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementtopicmap"></a>
SRS Element "&lt;topicmap&gt;"&nbsp;&nbsp;<small><a href="#srselementtopicmap">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementotidmap"></a>
SRS Element "&lt;otidmap&gt;"&nbsp;&nbsp;<small><a href="#srselementotidmap">&lt;-</a></small></h3>
<p>This is for Informatica internal use only. Do not set unless directed to do so by Informatica Support.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> </li>
</ul>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementsourceleavebackoff"></a>
SRS Element "&lt;source-leave-backoff&gt;"&nbsp;&nbsp;<small><a href="#srselementsourceleavebackoff">&lt;-</a></small></h3>
<p>Set how long an SRS delays before informing receivers about certain state changes in sources. There are conditions related to sources being deleted or timing out which can cause a receiver to "flap" - repeating cycling between connect (BOS) and disconnect (EOS). These conditions are usually related connectivity problems in the network. This element can eliminate, or at least slow down the flapping.</p>
<p>Valid range: 0 .. 60000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 500 (half sec) </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;source-leave-backoff&gt;1000&lt;/source-leave-backoff&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementcontextnamestatelifetime"></a>
SRS Element "&lt;context-name-state-lifetime&gt;"&nbsp;&nbsp;<small><a href="#srselementcontextnamestatelifetime">&lt;-</a></small></h3>
<p>Sets the value (in seconds) of a Store's context name information lifetime.</p>
<p>If a Store loses connection with SRS, the Context Name Information Record (CNIR) will be remembered by the SRS for a limited amount of time: the <em>context name state lifetime</em>. After that time expires, the SRS deletes the CNIR associated with that lost endpoint connection.</p>
<p>Zero is a special value which disables the timing of context name information of disconnected Stores. With zero, the CNIR of a lost Store is never deleted. This is generally not recommended as it can lead to unlimited memory growth in both the SRS and client contexts.</p>
<p>Note that <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a> has no effect on this option.</p>
<p>See <a class="el" href="index.html#srsstatelifetime">SRS State Lifetime</a> for more information.</p>
<p>Valid range: 0 .. 20736000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 86400 (24 hours) </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;context-name-state-lifetime&gt;120&lt;/context-name-state-lifetime&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementroutestatelifetime"></a>
SRS Element "&lt;route-state-lifetime&gt;"&nbsp;&nbsp;<small><a href="#srselementroutestatelifetime">&lt;-</a></small></h3>
<p>Sets the value (in seconds) of a DRO's routing information lifetime.</p>
<p>If a DRO endpoint loses connection with SRS, the Domain Information Record (DIR) and the Route Information Record (RTIR) will be remembered by the SRS for a limited amount of time: the <em>route state lifetime</em>. After that time expires, the SRS deletes the DIR and RTIR associated with that lost endpoint connection.</p>
<p>Zero is a special value which disables the timing of routing information of disconnected DROs. With zero, the DIR and RTIR of a lost DRO are never deleted. This is generally not recommended as it can lead to unlimited memory growth in both the SRS and client contexts.</p>
<p>Note that <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a> has no effect on this option.</p>
<p>See <a class="el" href="index.html#srsstatelifetime">SRS State Lifetime</a> for more information.</p>
<p>Valid range: 0 .. 20736000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 30 (seconds) </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;route-state-lifetime&gt;120&lt;/route-state-lifetime&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementintereststatelifetime"></a>
SRS Element "&lt;interest-state-lifetime&gt;"&nbsp;&nbsp;<small><a href="#srselementintereststatelifetime">&lt;-</a></small></h3>
<p>Sets the value (in seconds) of the client interest state lifetime.</p>
<p>If a client context loses connection with SRS, the topic interest of that context will be remembered by the SRS for a limited amount of time: the <em>interest state lifetime</em>. If the context does not re-connect within that time, the SRS deletes all of the topic interest owned by that lost context.</p>
<p>Zero is a special value which disables the timing of interest of disconnected contexts. With zero, the interest of a lost context is never deleted. This is generally not recommended as it can lead to unlimited memory growth in both the SRS and client contexts.</p>
<p>If this element is not supplied, the interest state lifetime defaults to the current value for <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a>.</p>
<p>See <a class="el" href="index.html#srsstatelifetime">SRS State Lifetime</a> for more information.</p>
<p>Valid range: 0 .. 20736000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Current value for <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a> </li>
</ul>
<p><b>Example:</b> (SRS deletes a lost context's interest after 120 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;interest-state-lifetime&gt;120&lt;/interest-state-lifetime&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementsourcestatelifetime"></a>
SRS Element "&lt;source-state-lifetime&gt;"&nbsp;&nbsp;<small><a href="#srselementsourcestatelifetime">&lt;-</a></small></h3>
<p>Sets the value (in seconds) of the client source state lifetime.</p>
<p>If a client context loses connection with SRS, the sources contained by that context will be remembered by the SRS for a limited amount of time: the <em>source state lifetime</em>. If the context does not re-connect within that time, the SRS deletes all of the sources owned by that lost context. Those deletions will be shared with all connected client contexts.</p>
<p>Zero is a special value which disables the timing of sources of disconnected contexts. With zero, the sources from a lost context are never deleted. This is generally not recommended as it can lead to unlimited memory growth in both the SRS and client contexts.</p>
<p>If this element is not supplied, the source state lifetime defaults to the current value for <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a></p>
<p>See <a class="el" href="index.html#srsstatelifetime">SRS State Lifetime</a> for more information.</p>
<p>Valid range: 0 .. 20736000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> Current value for <a class="el" href="index.html#srselementstatelifetime">SRS Element "&lt;state-lifetime&gt;"</a> </li>
</ul>
<p><b>Example:</b> (SRS deletes a lost context's sources after 120 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;source-state-lifetime&gt;120&lt;/source-state-lifetime&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementstatelifetime"></a>
SRS Element "&lt;state-lifetime&gt;"&nbsp;&nbsp;<small><a href="#srselementstatelifetime">&lt;-</a></small></h3>
<p>Sets the default (in seconds) of the client <a class="el" href="index.html#srselementsourcestatelifetime">SRS Element "&lt;source-state-lifetime&gt;"</a> and <a class="el" href="index.html#srselementintereststatelifetime">SRS Element "&lt;interest-state-lifetime&gt;"</a>. Note that it does <b>not</b> affect <a class="el" href="index.html#srselementroutestatelifetime">SRS Element "&lt;route-state-lifetime&gt;"</a> or <a class="el" href="index.html#srselementcontextnamestatelifetime">SRS Element "&lt;context-name-state-lifetime&gt;"</a>.</p>
<p>See <a class="el" href="index.html#srsstatelifetime">SRS State Lifetime</a> for more information.</p>
<p>Valid range: 0 .. 20736000</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 86400 (24 hours) </li>
</ul>
<p><b>Example:</b> (SRS deletes a lost context's sources and interest after 120 seconds) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;srs&gt;</div><div class="line">    &lt;state-lifetime&gt;120&lt;/state-lifetime&gt;</div><div class="line">    ...</div><div class="line">  &lt;/srs&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementdaemon"></a>
SRS Element "&lt;daemon&gt;"&nbsp;&nbsp;<small><a href="#srselementdaemon">&lt;-</a></small></h3>
<p>Contains elements which define logging behavior and sets a file name for the service's Process ID.</p>
<p>See child elements for details.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementumsrs">&lt;um-srs&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>, <a class="el" href="index.html#srselementpidfile">&lt;pid-file&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementpidfile"></a>
SRS Element "&lt;pid-file&gt;"&nbsp;&nbsp;<small><a href="#srselementpidfile">&lt;-</a></small></h3>
<p>Supplies the desired name of file in which the SRS writes its Process ID (PID).</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemon">&lt;daemon&gt;</a> </li>
</ul>
<p><b>Example:</b> (SRS writes process ID to "srs_pid.txt" file) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;pid-file&gt;srs_pid.txt&lt;/pid-file&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="srselementlog"></a>
SRS Element "&lt;log&gt;"&nbsp;&nbsp;<small><a href="#srselementlog">&lt;-</a></small></h3>
<p>Configures SRS logging behavior. The value contained within the <code>&lt;log&gt;...&lt;/log&gt;</code> is a file name, but is only used if the "type" attribute is set to "file".</p>
<p>When the <code>type</code> attribute is set to <code>"file"</code>, the SRS supports "rolling" the log file, which consists a series of files over time so that no one file grows too large.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#srselementdaemon">&lt;daemon&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>type</b> </td><td>Where to write log messages. </td><td><b><code>"file"</code></b> - Write log messages to a file. <br />
<b><code>"console"</code></b> - Write log messages to standard output. </td><td><b><code>"console"</code></b> </td></tr>
<tr>
<td><b>frequency</b> </td><td>Time-frame by which to roll the log file. </td><td><b><code>"disable"</code></b> - Do not roll the log file based on time. <br />
<b><code>"daily"</code></b> - Roll the log file at midnight. <br />
<b><code>"hourly"</code></b> - Roll the log file each hour. </td><td><b><code>"disable"</code></b> </td></tr>
<tr>
<td><b>size</b> </td><td>Size (in MB, that is 2**20, or 1,048,576 bytes) of current log file at which it is rolled. Specify 0 to disable rolling by log file size. </td><td>positiveInteger </td><td><b><code>"10"</code></b> (10,485,760 bytes) </td></tr>
<tr>
<td><b>max-history</b> </td><td>Number of rolled log files at which the oldest file is deleted when the current log file is rolled. </td><td>positiveInteger </td><td><b><code>"10"</code></b> </td></tr>
<tr>
<td><b>total-size-cap</b> </td><td>Total disk space consumed (in MB, that is 2**20, or 1,048,576 bytes) by rolled log files at which the oldest file is deleted to make room for the next log roll. </td><td>positiveInteger </td><td><b><code>"1000"</code></b> (1,048,576,000 bytes) </td></tr>
<tr>
<td><b>compression</b> </td><td>Enables compression for rolled log files. </td><td><b><code>"none"</code></b> - Do not compress log files. <br />
<b><code>"zip"</code></b> - Compress log files using "zip" format. <br />
<b><code>"gzip"</code></b> - Compress log files using "gzip" format. </td><td><b><code>"none"</code></b> </td></tr>
</table>
<p><b>Example</b> <b>1</b>: (write log messages to standard out) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;log type=<span class="stringliteral">&quot;console&quot;</span>/&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><p><b>Example</b> <b>2</b>: (write log messages to "srs.log" file) </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;um-srs version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;log type=<span class="stringliteral">&quot;file&quot;</span> frequency=<span class="stringliteral">&quot;daily&quot;</span>&gt;srs.log&lt;/log&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/um-srs&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h2><a class="anchor" id="srsxsdfile"></a>
SRS XSD file&nbsp;&nbsp;<small><a href="#srsxsdfile">&lt;-</a></small></h2>
<p>The XSD file is used to validate the user's configuration file.</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div><div class="line">&lt;xs:schema attributeFormDefault=<span class="stringliteral">&quot;unqualified&quot;</span> elementFormDefault=<span class="stringliteral">&quot;qualified&quot;</span> xmlns:xs=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>&gt;</div><div class="line">  &lt;xs:element name=<span class="stringliteral">&quot;um-srs&quot;</span> type=<span class="stringliteral">&quot;um-srsType&quot;</span>/&gt;</div><div class="line"></div><div class="line">  &lt;!-- Custom types and restrictions --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;nonEmptyString&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:minLength value=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;logTypeEnumeration&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;file&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;console&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;logFrequencyEnumeration&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;disable&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;daily&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;hourly&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;compressionEnumeration&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;none&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;zip&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;gzip&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;portInteger&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:integer&quot;</span>&gt;</div><div class="line">      &lt;xs:minInclusive value=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">      &lt;xs:maxInclusive value=<span class="stringliteral">&quot;65535&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;booleanEnumeration&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;true&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;false&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;!-- Acceptable values <span class="keywordflow">for</span> publishingIntervalLong type are 0 or &gt;= 200 --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span>&gt;</div><div class="line">    &lt;xs:<span class="keyword">union</span>&gt;</div><div class="line">      &lt;xs:simpleType&gt;</div><div class="line">        &lt;xs:restriction base=<span class="stringliteral">&quot;xs:long&quot;</span>&gt;</div><div class="line">          &lt;xs:pattern value=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">        &lt;/xs:restriction&gt;</div><div class="line">      &lt;/xs:simpleType&gt;</div><div class="line">      &lt;xs:simpleType&gt;</div><div class="line">        &lt;xs:restriction base=<span class="stringliteral">&quot;xs:long&quot;</span>&gt;</div><div class="line">          &lt;xs:minInclusive value=<span class="stringliteral">&quot;200&quot;</span>/&gt;</div><div class="line">          &lt;xs:maxInclusive value=<span class="stringliteral">&quot;7776000000&quot;</span>/&gt; &lt;!-- 90 days in milliseconds --&gt;</div><div class="line">        &lt;/xs:restriction&gt;</div><div class="line">      &lt;/xs:simpleType&gt;</div><div class="line">    &lt;/xs:<span class="keyword">union</span>&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;!-- Acceptable values <span class="keywordflow">for</span> stateLifetimeInteger type are 0, ..., 20736000 --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:nonNegativeInteger&quot;</span>&gt;</div><div class="line">      &lt;xs:minInclusive value=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">      &lt;xs:maxInclusive value=<span class="stringliteral">&quot;20736000&quot;</span>/&gt; &lt;!-- 240 days in seconds --&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;!-- Acceptable values <span class="keywordflow">for</span> sourceLeaveBackoffInteger type are 0, ..., 60000 --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;sourceLeaveBackoffInteger&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:nonNegativeInteger&quot;</span>&gt;</div><div class="line">      &lt;xs:minInclusive value=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">      &lt;xs:maxInclusive value=<span class="stringliteral">&quot;60000&quot;</span>/&gt; &lt;!-- 1 minute in milliseconds --&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;!-- Acceptable values <span class="keywordflow">for</span> recordQueueServiceIntervalInteger type are 1, ..., 1000 --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;recordQueueServiceIntervalInteger&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span>&gt;</div><div class="line">      &lt;xs:minInclusive value=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:maxInclusive value=<span class="stringliteral">&quot;1000&quot;</span>/&gt; &lt;!-- 1 second in milliseconds --&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;!-- Acceptable values <span class="keywordflow">for</span> pingIntervalInteger type are 100, ..., 3600000 --&gt;</div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;pingIntervalInteger&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:nonNegativeInteger&quot;</span>&gt;</div><div class="line">      &lt;xs:minInclusive value=<span class="stringliteral">&quot;100&quot;</span>/&gt;</div><div class="line">      &lt;xs:maxInclusive value=<span class="stringliteral">&quot;3600000&quot;</span>/&gt; &lt;!-- 1 hour in milliseconds --&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line">  &lt;xs:simpleType name=<span class="stringliteral">&quot;monitorFormatEnumeration&quot;</span>&gt;</div><div class="line">    &lt;xs:restriction base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;json&quot;</span>/&gt;</div><div class="line">      &lt;xs:enumeration value=<span class="stringliteral">&quot;pb&quot;</span>/&gt;</div><div class="line">    &lt;/xs:restriction&gt;</div><div class="line">  &lt;/xs:simpleType&gt;</div><div class="line"></div><div class="line"></div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;logType&quot;</span> &gt;</div><div class="line">    &lt;xs:simpleContent&gt;</div><div class="line">      &lt;xs:extension base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;logTypeEnumeration&quot;</span> name=<span class="stringliteral">&quot;type&quot;</span> use=<span class="stringliteral">&quot;required&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;logFrequencyEnumeration&quot;</span> name=<span class="stringliteral">&quot;frequency&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;size&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;max-history&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;total-size-cap&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;compressionEnumeration&quot;</span> name=<span class="stringliteral">&quot;compression&quot;</span>/&gt;</div><div class="line">      &lt;/xs:extension&gt;</div><div class="line">    &lt;/xs:simpleContent&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;otidmapType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;shards&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;topicmapType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;shards&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;routemapType&quot;</span>&gt;</div><div class="line">  &lt;xs:all&gt;</div><div class="line">    &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;shards&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">  &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;namemapType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;shards&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;clientActorType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;request-stream-max-msg-count&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;recordQueueServiceIntervalInteger&quot;</span> name=<span class="stringliteral">&quot;record-queue-service-interval&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;batch-frame-max-record-count&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;xs:positiveInteger&quot;</span> name=<span class="stringliteral">&quot;batch-frame-max-datagram-size&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;daemonType&quot;</span> &gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;logType&quot;</span> name=<span class="stringliteral">&quot;log&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;pid-file&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;debugMonitorType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;interface&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;portInteger&quot;</span> name=<span class="stringliteral">&quot;port&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;pingIntervalInteger&quot;</span> name=<span class="stringliteral">&quot;ping-interval&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;booleanEnumeration&quot;</span> name=<span class="stringliteral">&quot;enabled&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;lbmOptionType&quot;</span> &gt;</div><div class="line">    &lt;xs:simpleContent&gt;</div><div class="line">      &lt;xs:extension base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;scope&quot;</span> use=<span class="stringliteral">&quot;required&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;name&quot;</span> use=<span class="stringliteral">&quot;required&quot;</span>/&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;value&quot;</span> use=<span class="stringliteral">&quot;required&quot;</span>/&gt;</div><div class="line">      &lt;/xs:extension&gt;</div><div class="line">    &lt;/xs:simpleContent&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;lbmAttributesType&quot;</span>&gt;</div><div class="line">    &lt;xs:sequence&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;lbmOptionType&quot;</span> name=<span class="stringliteral">&quot;option&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;unbounded&quot;</span>/&gt;</div><div class="line">    &lt;/xs:sequence&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;daemonMonitorType&quot;</span> mixed=<span class="stringliteral">&quot;true&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;pingIntervalInteger&quot;</span> name=<span class="stringliteral">&quot;ping-interval&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalType&quot;</span> name=<span class="stringliteral">&quot;publishing-interval&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;lbmAttributesType&quot;</span> name=<span class="stringliteral">&quot;lbm-attributes&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;allowType&quot;</span> name=<span class="stringliteral">&quot;publish-connection-events&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;allowType&quot;</span> name=<span class="stringliteral">&quot;remote-snapshot-request&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;allowType&quot;</span> name=<span class="stringliteral">&quot;remote-config-changes-request&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;monitorFormatEnumeration&quot;</span> name=<span class="stringliteral">&quot;monitor-format&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">    &lt;xs:attribute type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;topic&quot;</span>/&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;publishingIntervalType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;default&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;srs-stats&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;um-client-stats&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;connection-events&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;srs-error-stats&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;um-client-error-stats&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;config-opts&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;publishingIntervalLong&quot;</span> name=<span class="stringliteral">&quot;internal-config-opts&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;allowType&quot;</span> &gt;</div><div class="line">    &lt;xs:simpleContent&gt;</div><div class="line">      &lt;xs:extension base=<span class="stringliteral">&quot;xs:string&quot;</span>&gt;</div><div class="line">        &lt;xs:attribute type=<span class="stringliteral">&quot;booleanEnumeration&quot;</span> name=<span class="stringliteral">&quot;allow&quot;</span> use=<span class="stringliteral">&quot;required&quot;</span>/&gt;</div><div class="line">      &lt;/xs:extension&gt;</div><div class="line">    &lt;/xs:simpleContent&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;um-srsType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;daemonType&quot;</span> name=<span class="stringliteral">&quot;daemon&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;srsType&quot;</span> name=<span class="stringliteral">&quot;srs&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;debugMonitorType&quot;</span> name=<span class="stringliteral">&quot;debug-monitor&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;daemonMonitorType&quot;</span> name=<span class="stringliteral">&quot;daemon-monitor&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">    &lt;xs:attribute type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;version&quot;</span>/&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">  &lt;xs:complexType name=<span class="stringliteral">&quot;srsType&quot;</span>&gt;</div><div class="line">    &lt;xs:all&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;interface&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;portInteger&quot;</span> name=<span class="stringliteral">&quot;port&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span> name=<span class="stringliteral">&quot;state-lifetime&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span> name=<span class="stringliteral">&quot;source-state-lifetime&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span> name=<span class="stringliteral">&quot;interest-state-lifetime&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span> name=<span class="stringliteral">&quot;route-state-lifetime&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;stateLifetimeInteger&quot;</span> name=<span class="stringliteral">&quot;context-name-state-lifetime&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;sourceLeaveBackoffInteger&quot;</span> name=<span class="stringliteral">&quot;source-leave-backoff&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;otidmapType&quot;</span> name=<span class="stringliteral">&quot;otidmap&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;topicmapType&quot;</span> name=<span class="stringliteral">&quot;topicmap&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;routemapType&quot;</span> name=<span class="stringliteral">&quot;routemap&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;namemapType&quot;</span> name=<span class="stringliteral">&quot;namemap&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;clientActorType&quot;</span> name=<span class="stringliteral">&quot;clientactor&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">      &lt;xs:element type=<span class="stringliteral">&quot;nonEmptyString&quot;</span> name=<span class="stringliteral">&quot;application-id&quot;</span> minOccurs=<span class="stringliteral">&quot;0&quot;</span> maxOccurs=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line">    &lt;/xs:all&gt;</div><div class="line">  &lt;/xs:complexType&gt;</div><div class="line">&lt;/xs:schema&gt;</div></div><!-- fragment --><p><br />
 </p><hr/>
<h1><a class="anchor" id="srsdaemonstatistics"></a>
SRS Daemon Statistics&nbsp;&nbsp;<small><a href="#srsdaemonstatistics">&lt;-</a></small></h1>
<p>This section contains details on the SRS's Daemon Statistics feature. <b>You should already be familiar with the general information contained in <a class="el" href="index.html#daemonstatistics">daemonstatistics</a>.</b></p>
<p>The SRS Daemon Statistics are published in the form of JSON messages. These are ASCII text messages which represent internal SRS data structures containing statistical and configuration information.</p>
<p>The following sub-sections describe the content of the messages. Note that while the sample messages shown are "beautified" (whitespace inserted for readability), a receiver of these messages should make no assumption about the presence or absence of whitespace. Also, as it true generally with JSON, the order of the fields is not fixed and can vary.</p>
<p>The message types are: </p><ul>
<li>
<a class="el" href="index.html#messagetypesrsstats">Message Type: SRS_STATS</a> </li>
<li>
<a class="el" href="index.html#messagetypesrserrorstats">Message Type: SRS_ERROR_STATS</a> </li>
<li>
<a class="el" href="index.html#messagetypeumclientstats">Message Type: UM_CLIENT_STATS</a> </li>
<li>
<a class="el" href="index.html#messagetypeumclienterrorstats">Message Type: UM_CLIENT_ERROR_STATS</a> </li>
<li>
<a class="el" href="index.html#messagetypeconnectionevents">Message Type: CONNECTION_EVENTS</a> </li>
<li>
<a class="el" href="index.html#messagetypeconfigopts">Message Type: CONFIG_OPTS</a> </li>
<li>
<a class="el" href="index.html#messagetypeinternalconfigopts">Message Type: INTERNAL_CONFIG_OPTS</a> </li>
<li>
<a class="el" href="index.html#requesttypereportsrsversion">Request Type: REPORT_SRS_VERSION</a> </li>
<li>
<a class="el" href="index.html#requesttypereportmonitorinfo">Request Type: REPORT_MONITOR_INFO</a> </li>
<li>
<a class="el" href="index.html#requesttypesetpublishinginterval">Request Type: SET_PUBLISHING_INTERVAL</a> </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="messagetypesrsstats"></a>
Message Type: SRS_STATS&nbsp;&nbsp;<small><a href="#messagetypesrsstats">&lt;-</a></small></h2>
<p>Message type SRS_STATS contains information about the overall state of the SRS service.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{ </div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;SRS_STATS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;stats&quot;</span>: [</div><div class="line">    { </div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;clients.inactive.SIR.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 0</div><div class="line">    },</div><div class="line">    { </div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;clients.next.client.ID&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 17</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p> This example has two statistics. Be aware that a given message can have any number of statistic entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "SRS_STATS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>stats</b></td><td><p class="starttd">Array of sub-structures, one per statistic. The number and order of the contained statistics is not fixed.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].name</b></td><td><p class="starttd">Name of statistic (see below).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].value</b></td><td>Value of statistic. </td></tr>
</table>
</center><p>Meaning of each statistic: </p><center> <table class="doxtable">
<tr>
<th>Statistic</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>clients.next.client.ID</b> </td><td><p class="starttd">Unique session ID that will be assigned to the next context to connect.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>active.clients.count</b> </td><td><p class="starttd">Number of currently connected contexts.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.connects.count</b> </td><td><p class="starttd">Number of contexts that have connected since this SRS started.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.disconnects.count</b> </td><td><p class="starttd">Number of contexts that have disconnected since this SRS started.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.max.concurrent.connections.count</b> </td><td><p class="starttd">High water mark of simultaneous connections since the SRS service was started.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.SIR.count</b> </td><td><p class="starttd">Number of sources being maintained from connected contexts.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.RIR.count</b> </td><td><p class="starttd">Number of receivers being maintained from connected contexts.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.WIR.count</b> </td><td><p class="starttd">Number of wildcard receivers being maintained from connected contexts.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.DIR.count</b> </td><td><p class="starttd">Number of Domain Information Records (DIRs) being maintained from connected DRO endpoints.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.SIR.count</b> </td><td><p class="starttd">Number of sources being temporarily maintained from disconnected contexts. These get cleaned up after the state lifetime expires.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.RIR.count</b> </td><td><p class="starttd">Number of receivers being temporarily maintained from disconnected contexts. These get cleaned up after the state lifetime expires.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.WIR.count</b> </td><td><p class="starttd">Number of wildcard receivers being temporarily maintained from disconnected contexts. These get cleaned up after the state lifetime expires.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.DIR.count</b> </td><td><p class="starttd">Number of Domain Information Records (DIRs) being temporarily maintained from disconnected DRO endpoints. These get cleaned up after the state lifetime expires.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.SIR.count</b> </td><td><p class="starttd">Number of times the SRS deleted source records due to the state lifetime being expired. This will happen when applications exit without deleting their sources, which is not recommended. If this number increases frequently, consider modifying your applications to clean up before exiting.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.RIR.count</b> </td><td><p class="starttd">Number of times the SRS deleted receiver records due to the state lifetime being expired. This will happen when applications exit without deleting their receivers, which is not recommended. If this number increases frequently, consider modifying your applications to clean up before exiting.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.WIR.count</b> </td><td><p class="starttd">Number of times the SRS deleted wildcard receiver records due to the state lifetime being expired. This will happen when applications exit without deleting their receivers, which is not recommended. If this number increases frequently, consider modifying your applications to clean up before exiting.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.DIR.count</b> </td><td><p class="starttd">Number of times the SRS deleted Domain Information Records (DIRs) due to the state lifetime being expired. This will happen when DROs exit abnormally. Informatica support should be informed if this count increments frequently.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.CNIR.count</b> </td><td><p class="starttd">Number of times the SRS deleted Context Name Information Records (CNIRs) due to the state lifetime being expired. This will happen when Stores exit abnormally. Informatica support should be informed if this count increments frequently.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.DR.inactive.SIR.count</b> </td><td><p class="starttd">If DROs are involved, it is normal for this count to increment. Otherwise, this should not increment, and Informatica support should be informed if it does. (A context disconnected while it has SIRs that were inactive.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.SLR.no.OTID.match.count</b> </td><td><p class="starttd">If the system is otherwise behaving normally, increments in this count are most likely harmless. (A receiver sent a source leave record for a source that the SRS does not know about.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.RTIR.count</b> </td><td><p class="starttd">Number of Route Information Records (RTIR) being maintained from all connected DRO endpoint contexts. Should be equal to the number of active DRO endpoints in this TRD.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.RTIR.count</b> </td><td><p class="starttd">Number of Route Information Records (RTIR) being temporarily maintained from disconnected DRO endpoint contexts.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.expired.RTIR.count</b> </td><td><p class="starttd">Number of inactive Route Information Records (RTIR) deleted due to expiration of their state lifetimes. This value is cumulative since the SRS was started.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.active.CNIR.count</b> </td><td><p class="starttd">Number of Context Name Information Records (CNIRs) being maintained from connected contexts. This is for Stores identified by their context names; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/persistencearchitecture.html#identifyingpersistentstores">Identifying Persistent Stores</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.inactive.CNIR.count</b> </td><td><p class="starttd">Number of Context Name Information Records (CNIRs) being temporarily maintained from disconnected contexts. Currently, this is only for Stores identified by their context names; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/persistencearchitecture.html#identifyingpersistentstores">Identifying Persistent Stores</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.duplicate.CNIR.count</b> </td><td>Number of duplicate Context Name Information Records (CNIRs) received from all Store endpoints. While not a fatal condition, Informatica support should be informed if this is non-zero. </td></tr>
</table>
</center><p>All of the above statistics are included in a snapshot. Only the changed statistics are included during a periodic update.</p>
<p><br />
 </p>
<h2><a class="anchor" id="messagetypesrserrorstats"></a>
Message Type: SRS_ERROR_STATS&nbsp;&nbsp;<small><a href="#messagetypesrserrorstats">&lt;-</a></small></h2>
<p>Message type SRS_ERROR_STATS contains counters for errors detected by the SRS service. These types of errors should not be happening in a properly configured network; <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a> if the counters are increasing frequently.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{ </div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;SRS_ERROR_STATS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;stats&quot;</span>: [</div><div class="line">    { </div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;clients.duplicate.SIR.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 0</div><div class="line">    },</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;clients.invalid.SDR.no.OTID.match.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 17</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p> This example has two statistics. Be aware that a given message can have any number of statistic entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "SRS_ERROR_STATS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>stats</b></td><td><p class="starttd">Array of sub-structures, one per statistic. The number and order of the contained statistics is not fixed.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].name</b></td><td><p class="starttd">Name of statistic (see below).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].value</b></td><td>Value of statistic. </td></tr>
</table>
</center><p>Meaning of each statistic: </p><center> <table class="doxtable">
<tr>
<th>Statistic</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>clients.duplicate.SIR.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (Number of times that the SRS is informed about a source when it didn't need to be informed because the SRS already knew about it.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.duplicate.RIR.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (Number of times that the SRS is informed about a receiver when it didn't need to be informed because the SRS already knew about it.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.duplicate.WIR.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (Number of times that the SRS is informed about a wildcard receiver when it didn't need to be informed because the SRS already knew about it.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.SDR.no.topic.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context deleted a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.SDR.no.OTID.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context deleted a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.SDR.no.transport.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context deleted a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.DR.no.topic.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A source that the SRS does not know about disconnected, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.DR.no.OTID.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context deleted a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.DR.no.transport.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context deleted a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.SLR.no.topic.match.count</b> </td><td><p class="starttd">While not a fatal condition, Informatica support should be informed if this count increments frequently. (A receiver notified source leave for a source that the SRS does not know about, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.DR.inactive.SIR.count</b> </td><td><p class="starttd">This counter should never be greater than zero. While not a fatal condition, Informatica support should be informed if this count increments frequently. (A context disconnected while it has SIRs that were inactive, which should never happen.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.duplicate.DIR.count</b> </td><td><p class="starttd">Number of duplicate Domain Information Records (DIRs) the SRS generated. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.mismatched.DIR.count</b> </td><td><p class="starttd">A non-zero count indicates that at least two DRO endpoints have reported different domain IDs, which is illegal. All DRO endpoints servicing the same TRD must be configured for the same domain ID value.</p>
<p>If all DRO endpoints being services by this SRS are configured for the same <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/xmlconfigurationreference.html#droelementdomainid">&lt;domain-id&gt;</a> value, <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.duplicate.RTIR.count</b> </td><td><p class="starttd">Number of duplicate Route Information Records (RTIRs) received from all DRO endpoints. While not a fatal condition, Informatica support should be informed if this is non-zero.</p>
<p>See also statistic "client.duplicate.RTIR.received.count" in <a class="el" href="index.html#messagetypeumclienterrorstats">Message Type: UM_CLIENT_ERROR_STATS</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>clients.invalid.CNIR.name.mismatch.count</b> </td><td>Number of Context Name Information Records (CNIRs) received from a context that are different from the initial CNIR. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero. </td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="messagetypeumclientstats"></a>
Message Type: UM_CLIENT_STATS&nbsp;&nbsp;<small><a href="#messagetypeumclientstats">&lt;-</a></small></h2>
<p>Message type UM_CLIENT_STATS contains information related to an individual connected context. Multiple instances of this message can be sent, one per connected context.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_STATS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">    <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.43&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;60681&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0x9739b88f&quot;</span></div><div class="line">  },</div><div class="line">  <span class="stringliteral">&quot;stats&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;client.SIR.received.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 1</div><div class="line">    },</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;client.SDR.received.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 0</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p> This example has two statistics. Be aware that a given message can have any number of statistic entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "UM_CLIENT_STATS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>srsRegistrationInfo</b></td><td><p class="starttd">Structure containing identifying information about the connected context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.ip</b></td><td><p class="starttd">IP address of the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.port</b></td><td><p class="starttd">TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.sessionId</b></td><td><p class="starttd">The unique identifier assigned by the SRS to this connection.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>stats</b></td><td><p class="starttd">Array of sub-structures, one per statistic. The number and order of the contained statistics is not fixed.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].name</b></td><td><p class="starttd">Name of statistic (see below).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].value</b></td><td>Value of statistic. </td></tr>
</table>
</center><p>Meaning of each statistic: </p><center> <table class="doxtable">
<tr>
<th>Statistic</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>record.queue.depth</b> </td><td><p class="starttd">Snapshot of the context's SRS worker thread's work queue containing Topic Resolution updates that need to be sent to the context. This number should normally be zero. If it remains above zero for significant time <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.SIR.sent.count</b> </td><td><p class="starttd">Number of sources that the SRS has informed the context of.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.SER.sent.count</b> </td><td><p class="starttd">Number of source deletions that the SRS has informed the context of. Either the application explicitly deleted a source, or the context abnormally disconnected and the state lifetime expired.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RIR.sent.count</b> </td><td><p class="starttd">Number of receivers that the SRS has informed the context of.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RER.sent.count</b> </td><td><p class="starttd">Number of receiver deletions that the SRS has informed the context of. Either the application explicitly deleted a receiver, or the context abnormally disconnected and the state lifetime expired.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.WIR.sent.count</b> </td><td><p class="starttd">Number of wildcard receivers that the SRS has informed the context of.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.WER.sent.count</b> </td><td><p class="starttd">Number of wildcard receiver deletions that the SRS has informed the context of. Either the application explicitly deleted a receiver, or the context abnormally disconnected and the state lifetime expired.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.SIR.received.count</b> </td><td><p class="starttd">Number of created sources that the context has informed the SRS. This number is not necessarily the current number of sources; for example, the counter does not decrease as sources are deleted.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.SDR.received.count</b> </td><td><p class="starttd">Number of sources deleted that the context has informed the SRS.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RIR.received.count</b> </td><td><p class="starttd">Number of created receivers (one per topic even if more than one receivers on a topic) that the context has informed the SRS. This number is not necessarily the current number of receivers; for example the counter does not decrease as receivers are deleted.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.WIR.received.count</b> </td><td><p class="starttd">Number of created wildcard receivers (one per pattern even if more than one receivers on a pattern) that the context has informed the SRS. This number is not necessarily the current number of wildcard receivers; for example the counter does not decrease as wildcard receivers are deleted.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RDR.received.count</b> </td><td><p class="starttd">Number of deleted receivers (one per topic even if more than one receivers on a topic) that the context has informed the SRS. This number is not necessarily the current number of receivers; for example the counter does not decrease as receivers are deleted.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.WDR.received.count</b> </td><td><p class="starttd">Number of deleted wildcard receivers (one per pattern even if more than one receivers on a pattern) that the context has informed the SRS. This number is not necessarily the current number of wildcard receivers; for example the counter does not decrease as wildcard receivers are deleted.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.SLR.received.count</b> </td><td><p class="starttd">Number of source leave records that the receiver context has informed the SRS.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.active.SIR.count</b> </td><td><p class="starttd">Number of sources that currently exist in the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.max.concurrent.SIR.count</b> </td><td><p class="starttd">High water mark of simultaneous sources managed since the SRS service started.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.DIR.sent.count</b> </td><td><p class="starttd">Number of Domain Information Records (DIRs) that the SRS has sent to the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RTIR.sent.count</b> </td><td><p class="starttd">Number of Route Information Records (RTIRs) the SRS has sent to the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RTIR.received.count</b> </td><td><p class="starttd">Number of Route Information Records (RTIRs) the context has sent to the SRS.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.RTER.sent.count</b> </td><td><p class="starttd">Number of Route End Records (RTERs) the SRS has sent to the context. This is incremented if a DRO disconnects from an SRS and that DRO's Route Information Record state lifetime expires.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.CNIR.sent.count</b> </td><td><p class="starttd">Number of Context Name Information Records (CNIRs) sent to the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.CNIR.received.count</b> </td><td><p class="starttd">Number of Context Name Information Records (CNIRs) received from the context. This should normally be 1 or 2.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.CNQR.received.count</b> </td><td><p class="starttd">Number of Context Name Query Records (CNQRs) received from the context. This should normally be 1.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.unexpected.CNER.received.count</b> </td><td><p class="starttd">Number of Context Name End Records (CNERs) received from the context. This should normally be 0, but if the client is UM version 6.14, this counter can increase.</p>
<p class="endtd"></p>
</td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="messagetypeumclienterrorstats"></a>
Message Type: UM_CLIENT_ERROR_STATS&nbsp;&nbsp;<small><a href="#messagetypeumclienterrorstats">&lt;-</a></small></h2>
<p>Message type UM_CLIENT_ERROR_STATS contains error counters related to an individual connected context. Multiple instances of this message can be sent, one per connected context. These types of errors should not be happening in a properly configured network; <a href="https://ultramessaging.github.io/UM_Support.html">contact UM Support</a> if the counters are increasing frequently.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_ERROR_STATS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">    <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.43&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;60681&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0x9739b88f&quot;</span></div><div class="line">  },</div><div class="line">  <span class="stringliteral">&quot;stats&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;client.invalid.SRS.message.received.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 1</div><div class="line">    },</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;client.invalid.SDR.received.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: 0</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p> This example has two statistics. Be aware that a given message can have any number of statistic entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th>Description </th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td>Message type. Set to the string "UM_CLIENT_ERROR_STATS". </td></tr>
<tr>
<td><b>srsRegistrationInfo</b></td><td>Structure containing identifying information about the connected context. </td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.ip</b></td><td>IP address of the context. </td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.port</b></td><td>TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>. </td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.sessionId</b></td><td>The unique identifier assigned by the SRS to this connection. </td></tr>
<tr>
<td><b>stats</b></td><td>Array of sub-structures, one per statistic. The number and order of the contained statistics is not fixed. </td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].name</b></td><td>Name of statistic (see below). </td></tr>
<tr>
<td><b>.&#160;.&#160;stats[].value</b></td><td>Value of statistic. </td></tr>
</table>
</center><p>Meaning of each statistic: </p><center> <table class="doxtable">
<tr>
<th>Statistic</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>client.duplicate.RIR.received.count</b> </td><td>Number of created duplicate receivers that the context has informed the SRS. </td></tr>
<tr>
<td><b>client.duplicate.WIR.received.count</b> </td><td><p class="starttd">Number of created duplicate wildcard receivers that the context has informed the SRS.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.invalid.SRS.message.received.count</b> </td><td><p class="starttd">This counter should never be greater than zero. While not a fatal condition, Informatica support should be informed if this count increments frequently. (Number of messages received from this context that could not be processed.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.invalid.SDR.received.count</b> </td><td><p class="starttd">This counter should never be greater than zero. While not a fatal condition, Informatica support should be informed if this count increments frequently. (Number of source delete messages received from this context which could not be processed correctly.)</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.duplicate.RTIR.received.count</b> </td><td><p class="starttd">Number of duplicate Route Information Records (RTIRs) received from this DRO endpoint. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero.</p>
<p>See also statistic "clients.duplicate.RTIR.count" in <a class="el" href="index.html#messagetypesrserrorstats">Message Type: SRS_ERROR_STATS</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.unexpected.SRS.message.sent.count</b> </td><td><p class="starttd">Number of unexpected messages sent to the context. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.duplicate.CNIR.received.count</b> </td><td><p class="starttd">Number of duplicate Context Name Information Records (CNIRs) received from this context. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>client.duplicate.CNQR.received.count</b> </td><td>Number of duplicate Context Name Query Records (CNQRs) received from this context. This should never happen. While not a fatal condition, Informatica support should be informed if this is non-zero. </td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="messagetypeconnectionevents"></a>
Message Type: CONNECTION_EVENTS&nbsp;&nbsp;<small><a href="#messagetypeconnectionevents">&lt;-</a></small></h2>
<p><br />
 </p>
<h3><a class="anchor" id="messagesubtypeumclientconnect"></a>
Message Subtype: UM_CLIENT_CONNECT&nbsp;&nbsp;<small><a href="#messagesubtypeumclientconnect">&lt;-</a></small></h3>
<p>Message type CONNECTION_EVENTS, sub-type UM_CLIENT_CONNECT, logs a single connect of a context to the SRS.</p>
<div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;CONNECTION_EVENTS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">    <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.42&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;41873&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0xaecbff98&quot;</span></div><div class="line">  },</div><div class="line">  <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_CONNECT&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;events&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_CONNECT&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;connectionEventTime&quot;</span>: <span class="stringliteral">&quot;Thu Jan 24 00:28:26 CET 2019&quot;</span>,</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "CONNECTION_EVENTS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>srsRegistrationInfo</b></td><td><p class="starttd">Structure containing identifying information about the connected context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.ip</b></td><td><p class="starttd">IP address of the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.port</b></td><td><p class="starttd">TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.sessionId</b></td><td><p class="starttd">The unique identifier assigned by the SRS to this connection.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "UM_CLIENT_CONNECT".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>events</b></td><td><p class="starttd">Technically <code>events</code> is constructed as an array of sub-structures, however each CONNECTION_EVENTS message contains exactly one event log.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "UM_CLIENT_CONNECT".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventTime</b></td><td>ASCII time/date stamp of event. </td></tr>
</table>
</center><p><br />
 </p>
<h3><a class="anchor" id="messagesubtypeumclientdisconnect"></a>
Message Subtype: UM_CLIENT_DISCONNECT&nbsp;&nbsp;<small><a href="#messagesubtypeumclientdisconnect">&lt;-</a></small></h3>
<p>Message type CONNECTION_EVENTS, sub-type UM_CLIENT_DISCONNECT, logs a single disconnect of a context to the SRS.</p>
<div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;CONNECTION_EVENTS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">    <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.42&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;35350&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0x0388cf20&quot;</span></div><div class="line">  },</div><div class="line">  <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_DISCONNECT&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;events&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">        <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.42&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;35350&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0x0388cf20&quot;</span></div><div class="line">      },</div><div class="line">      <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;UM_CLIENT_DISCONNECT&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;connectionEventTime&quot;</span>: <span class="stringliteral">&quot;Wed Jan 30 23:50:30 CET 2019&quot;</span>,</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "CONNECTION_EVENTS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>srsRegistrationInfo</b></td><td>Structure containing identifying information about the connected context. &#160;&#160;</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.ip</b></td><td><p class="starttd">IP address of the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.port</b></td><td><p class="starttd">TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.sessionId</b></td><td><p class="starttd">The unique identifier assigned by the SRS to this connection.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "UM_CLIENT_DISCONNECT".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>events</b></td><td><p class="starttd">Technically <code>events</code> is constructed as an array of sub-structures, however each CONNECTION_EVENTS message contains exactly one event log.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].srsRegistrationInfo</b></td><td><p class="starttd">Structure containing identifying information about the connected context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;.&#160;.&#160;events[].srsRegistrationInfo.ip</b></td><td><p class="starttd">IP address of the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;.&#160;.&#160;events[].srsRegistrationInfo.port</b></td><td><p class="starttd">TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;.&#160;.&#160;event[].srsRegistrationInfo.sessionId</b></td><td><p class="starttd">The unique identifier assigned by the SRS to this connection.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "UM_CLIENT_DISCONNECT".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventTime</b></td><td>ASCII time/date stamp of event. </td></tr>
</table>
</center><p><br />
 </p>
<h3><a class="anchor" id="messagesubtypessirandsdr"></a>
Message Subtypes: SIR and SDR&nbsp;&nbsp;<small><a href="#messagesubtypessirandsdr">&lt;-</a></small></h3>
<p>Message type CONNECTION_EVENTS, sub-types SIR and SDR, log a single context source creation or deletion message to the SRS.</p>
<div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;CONNECTION_EVENTS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;srsRegistrationInfo&quot;</span>: {</div><div class="line">    <span class="stringliteral">&quot;ip&quot;</span>: <span class="stringliteral">&quot;10.29.3.43&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;port&quot;</span>: <span class="stringliteral">&quot;60809&quot;</span>,</div><div class="line">    <span class="stringliteral">&quot;sessionId&quot;</span>: <span class="stringliteral">&quot;0x1c668bad&quot;</span></div><div class="line">  },</div><div class="line">  <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;SIR&quot;</span> or <span class="stringliteral">&quot;SDR&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;events&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;topic&quot;</span>: <span class="stringliteral">&quot;srs_topic&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;source&quot;</span>: <span class="stringliteral">&quot;LBTRM:10.29.3.43:24000:47b87920:225.11.28.85:14400&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;connectionEventType&quot;</span>: <span class="stringliteral">&quot;SIR&quot;</span> or <span class="stringliteral">&quot;SDR&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;connectionEventTime&quot;</span>: <span class="stringliteral">&quot;Fri Feb 1 02:16:06 CET 2019&quot;</span>,</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "CONNECTION_EVENTS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>srsRegistrationInfo</b></td><td>Structure containing identifying information about the connected context. &#160;&#160;</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.ip</b></td><td><p class="starttd">IP address of the context.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.port</b></td><td><p class="starttd">TCP "source port" the context used locally for its SRS connection. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptcpbasedresolveroperation.html#resolverservicecontext">resolver_service (context)</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;srsRegistrationInfo.sessionId</b></td><td><p class="starttd">The unique identifier assigned by the SRS to this connection.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "SIR" or "SDR".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>events</b></td><td><p class="starttd">Technically <code>events</code> is constructed as an array of sub-structures, however each CONNECTION_EVENTS message contains exactly one event log.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventType</b></td><td><p class="starttd">type of event contained in the <code>events</code> sub-structure. Set to "SIR" or "SDR".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;events[].connectionEventTime</b></td><td>ASCII time/date stamp of event. </td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="messagetypeconfigopts"></a>
Message Type: CONFIG_OPTS&nbsp;&nbsp;<small><a href="#messagetypeconfigopts">&lt;-</a></small></h2>
<p>Message type CONFIG_OPTS contains SRS configuration information.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;CONFIG_OPTS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;configOptions&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;um-srs.daemon-monitor.lbm-attributes.context.context_name&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: <span class="stringliteral">&quot;statsLbmContext&quot;</span>,</div><div class="line">    },</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;um-srs.daemon-monitor.lbm-attributes.context.default_interface&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: <span class="stringliteral">&quot;192.168.0.0/24&quot;</span>,</div><div class="line">    }</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><p> This example has two options. Be aware that a given message can have any number of option entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "CONFIG_OPTS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>configOptions</b></td><td><p class="starttd">Array of sub-structures, one per configuration option. The number and order of the contained options is not fixed.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;configOptions[].name</b></td><td><p class="starttd">Name of option (see below).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;configOptions[].value</b></td><td>Value of option. </td></tr>
</table>
</center><p>Meaning of each option: </p><center> <table class="doxtable">
<tr>
<th>Option Name</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>um-srs.version</b> </td><td><p class="starttd">Value for '<b>version</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementumsrs">&lt;um-srs&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.type</b> </td><td><p class="starttd">Value for '<b>type</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.frequency</b> </td><td><p class="starttd">Value for '<b>frequency</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.size</b> </td><td><p class="starttd">Value for '<b>size</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.max-history</b> </td><td><p class="starttd">Value for '<b>max-history</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.total-size-cap</b> </td><td><p class="starttd">Value for '<b>total-size-cap</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.log.compression</b> </td><td><p class="starttd">Value for '<b>compression</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementlog">&lt;log&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon.pid-file</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementrequeststreammaxmsgcount">&lt;request-stream-max-msg-count&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.interface</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementinterface">&lt;interface&gt;</a> inside <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.port</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementport">&lt;port&gt;</a> inside <a class="el" href="index.html#srselementsrs">&lt;srs&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.state-lifetime</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementstatelifetime">&lt;state-lifetime&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.source-state-lifetime</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementsourcestatelifetime">&lt;source-state-lifetime&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.interest-state-lifetime</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementintereststatelifetime">&lt;interest-state-lifetime&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.route-state-lifetime</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementcontextnamestatelifetime">&lt;context-name-state-lifetime&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.context-name-state-lifetime</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementcontextnamestatelifetime">&lt;context-name-state-lifetime&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.source-leave-backoff</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementsourceleavebackoff">&lt;source-leave-backoff&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.application-id</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementapplicationid">&lt;application-id&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.clientactor.request-stream-max-msg-count</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementrequeststreammaxmsgcount">&lt;request-stream-max-msg-count&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.clientactor.record-queue-service-interval</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementrecordqueueserviceinterval">&lt;record-queue-service-interval&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.clientactor.batch-frame-max-record-count</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementbatchframemaxrecordcount">&lt;batch-frame-max-record-count&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.clientactor.batch-frame-max-datagram-size</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementbatchframemaxdatagramsize">&lt;batch-frame-max-datagram-size&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.debug-monitor.interface</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementinterface">&lt;interface&gt;</a> inside <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.debug-monitor.port</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementport">&lt;port&gt;</a> inside <a class="el" href="index.html#srselementdebugmonitor">&lt;debug-monitor&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.debug-monitor.enabled</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementenabled">&lt;enabled&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.debug-monitor.ping-interval</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementpinginterval">&lt;ping-interval&gt;</a> for debug-monitor.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.ping-interval</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementpinginterval">&lt;ping-interval&gt;</a> for daemon-monitor.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.topic</b> </td><td><p class="starttd">Value for '<b>topic</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.default</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementdefault">&lt;default&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.srs-stats</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementsrsstats">&lt;srs-stats&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.um-client-stats</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementumclientstats">&lt;um-client-stats&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.connection-events</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementconnectionevents">&lt;connection-events&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.srs-error-stats</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementsrserrorstats">&lt;srs-error-stats&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.um-client-error-stats</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementumclienterrorstats">&lt;um-client-error-stats&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.config-opts</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementconfigopts">&lt;config-opts&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publishing-interval.internal-config-opts</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementinternalconfigopts">&lt;internal-config-opts&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.publish-connection-events.allow</b> </td><td><p class="starttd">Value for '<b>allow</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementpublishconnectionevents">&lt;publish-connection-events&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.remote-snapshot-request.allow</b> </td><td><p class="starttd">Value for '<b>allow</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementremotesnapshotrequest">&lt;remote-snapshot-request&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.remote-config-changes-request.allow</b> </td><td><p class="starttd">Value for '<b>allow</b>' attribute to SRS configuration element <a class="el" href="index.html#srselementremoteconfigchangesrequest">&lt;remote-config-changes-request&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.monitor-format</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementmonitorformat">&lt;monitor-format&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.daemon-monitor.lbm-attributes.lbmConfigOptionScope.lbmConfigOptionName</b> </td><td>A UM configuration option, as documented in <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/index.html#configurationoverview">Configuration Overview</a>, where 'lbmConfigOptionScope' is the option scope ('context', 'source', etc) and 'lbmConfigOptionName' is the option name. </td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="messagetypeinternalconfigopts"></a>
Message Type: INTERNAL_CONFIG_OPTS&nbsp;&nbsp;<small><a href="#messagetypeinternalconfigopts">&lt;-</a></small></h2>
<p>Message type INTERNAL_CONFIG_OPTS contains SRS internal configuration information. These options are not intended for application use.</p>
<p><b>EXAMPLE:</b> </p><div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;INTERNAL_CONFIG_OPTS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;configOptions&quot;</span>: [</div><div class="line">    {</div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;um-srs.srs.otidmap.async-receiver-distribution&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: <span class="stringliteral">&quot;false&quot;</span>,</div><div class="line">    },</div><div class="line">    { </div><div class="line">      <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;um-srs.srs.otidmap.shards&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;value&quot;</span>: <span class="stringliteral">&quot;4&quot;</span>,</div><div class="line">    } </div><div class="line">  ]   </div><div class="line">}</div></div><!-- fragment --><p> This example has two options. Be aware that a given message can have any number of option entries.</p>
<p>Overall structure of message: </p><center> <table class="doxtable">
<tr>
<th>Field</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>monitorInfoCategory</b></td><td><p class="starttd">Message type. Set to the string "INTERNAL_CONFIG_OPTS".</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>configOptions</b></td><td><p class="starttd">Array of sub-structures, one per configuration option. The number and order of the contained options is not fixed.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;configOptions[].name</b></td><td><p class="starttd">Name of option (see below).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>.&#160;.&#160;configOptions[].value</b></td><td>Value of option. </td></tr>
</table>
</center><p>Meaning of each option: </p><center> <table class="doxtable">
<tr>
<th>Option Name</th><th><p class="starttd">Description</p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>um-srs.srs.otidmap.shards</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> within element <a class="el" href="index.html#srselementotidmap">&lt;otidmap&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.topicmap.shards</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> within element <a class="el" href="index.html#srselementtopicmap">&lt;topicmap&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.routemap.shards</b> </td><td><p class="starttd">Value for the SRS configuration element <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> within element <a class="el" href="index.html#srselementroutemap">&lt;routemap&gt;</a>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>um-srs.srs.namemap.shards</b> </td><td>Value for the SRS configuration element <a class="el" href="index.html#srselementshards">&lt;shards&gt;</a> within element <a class="el" href="index.html#srselementnamemap">&lt;namemap&gt;</a>. </td></tr>
</table>
</center><p><br />
 </p>
<h2><a class="anchor" id="requesttypereportsrsversion"></a>
Request Type: REPORT_SRS_VERSION&nbsp;&nbsp;<small><a href="#requesttypereportsrsversion">&lt;-</a></small></h2>
<p>Request type REPORT_SRS_VERSION is sent by a monitoring application to determine the software version of the SRS.</p>
<div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;commandMessageType&quot;</span>: <span class="stringliteral">&quot;REPORT_SRS_VERSION&quot;</span></div><div class="line">}</div></div><!-- fragment --><p>The SRS will send a response of the form: </p><pre class="fragment">SRS Version 6.17
</pre><p><br />
 </p>
<h2><a class="anchor" id="requesttypereportmonitorinfo"></a>
Request Type: REPORT_MONITOR_INFO&nbsp;&nbsp;<small><a href="#requesttypereportmonitorinfo">&lt;-</a></small></h2>
<p>Request type REPORT_MONITOR_INFO is sent by a monitoring application to initiate an immediate publishing of monitoring data.</p>
<p>The SRS will only process this request if the configuration contains <a class="el" href="index.html#srselementremotesnapshotrequest">&lt;remote-snapshot-request allow="true"/&gt;</a>.</p>
<div class="fragment"><div class="line">{</div><div class="line">  <span class="stringliteral">&quot;commandMessageType&quot;</span>: <span class="stringliteral">&quot;REPORT_MONITOR_INFO&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;SRS_STATS&quot;</span></div><div class="line">}</div></div><!-- fragment --><p>Where the <code>"monitorInfoCategory"</code> field is set to one of the following: </p><ul>
<li>
SRS_STATS </li>
<li>
UM_CLIENT_STATS </li>
<li>
CONNECTION_EVENTS </li>
<li>
SRS_ERROR_STATS </li>
<li>
UM_CLIENT_ERROR_STATS </li>
<li>
CONFIG_OPTS </li>
<li>
INTERNAL_CONFIG_OPTS </li>
</ul>
<p>The SRS will send a response of the form: </p><pre class="fragment">snap SRS_STATS - OK!
</pre><p> Note that "SRS_STATS" is replaced by the requested category.</p>
<p><br />
 </p>
<h2><a class="anchor" id="requesttypesetpublishinginterval"></a>
Request Type: SET_PUBLISHING_INTERVAL&nbsp;&nbsp;<small><a href="#requesttypesetpublishinginterval">&lt;-</a></small></h2>
<p>Request type SET_PUBLISHING_INTERVAL is sent by a monitoring application to Modify the publishing intervals for a running SRS. Note that SRS does not persist the new interval value; if the SRS is restarted, the value returns to the value configured via <a class="el" href="index.html#srselementdaemonmonitor">&lt;daemon-monitor&gt;</a>.</p>
<p>The SRS will only process this request if the configuration contains <a class="el" href="index.html#srselementremoteconfigchangesrequest">&lt;remote-config-changes-request allow="true"/&gt;</a>.</p>
<div class="fragment"><div class="line">{     </div><div class="line">  <span class="stringliteral">&quot;commandMessageType&quot;</span>: <span class="stringliteral">&quot;SET_PUBLISHING_INTERVAL&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;monitorInfoCategory&quot;</span>: <span class="stringliteral">&quot;SRS_STATS&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;publishingInterval&quot;</span>: 60000</div><div class="line">}</div></div><!-- fragment --><p>Where the <code>"monitorInfoCategory"</code> field is set to one of the following: </p><ul>
<li>
SRS_STATS </li>
<li>
UM_CLIENT_STATS </li>
<li>
CONNECTION_EVENTS </li>
<li>
SRS_ERROR_STATS </li>
<li>
UM_CLIENT_ERROR_STATS </li>
<li>
CONFIG_OPTS </li>
<li>
INTERNAL_CONFIG_OPTS </li>
</ul>
<p>The SRS will send a response of the form: </p><pre class="fragment">SRS_STATS 60000 - OK!
</pre><p> Note that "SRS_STATS" is replaced by the requested category.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="manpagesforlbmrd"></a>
Man Pages for Lbmrd&nbsp;&nbsp;<small><a href="#manpagesforlbmrd">&lt;-</a></small></h1>
<p>Unicast UDP-based Topic Resolution services are provided by the Lbm Resolver Daemon (lbmrd).</p>
<p>For more information on UDP-based TR, see <a class="el" href="index.html#udpbasedtopicresolutiondetails">UDP-Based Topic Resolution Details</a>. For more information on Topic Resolution general, see <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</p>
<p>There are two executables for the lbmrd, each with it's own man page: </p><ul>
<li>
<a class="el" href="index.html#lbmrdmanpage">Lbmrd Man Page</a> - Unix and Windows command-line interface. </li>
<li>
<a class="el" href="index.html#lbmrdsmanpage">Lbmrds Man Page</a> - Windows Service interface. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="lbmrdmanpage"></a>
Lbmrd Man Page&nbsp;&nbsp;<small><a href="#lbmrdmanpage">&lt;-</a></small></h2>
<p>Unix and Windows command-line interface.</p>
<pre class="fragment">UMResolver daemon
Usage: lbmrd [options] [config-file]
Available options:
  -a, --activity=IVL    interval between client activity checks (in milliseconds)(default 60000)
  -d, --dump-dtd        dump the configuration DTD to stdout and exit
  -h, --help            display this help and exit
  -i, --interface=ADDR  listen for unicast topic resolution messages on interface ADDR
                        ADDR accepts CIDR eg:10.0.0.0/8, Quoted device name eg:"eth0", DNS Host name eg:host.mydomain.com/24.
  -L, --logfile=FILE    use FILE as the log file
  -p, --port=PORT       use UDP port PORT for topic resolution messages (default 15380)
  -t, --ttl=TTL         use client time-to-live of TTL seconds (default 60)
  -r, --rcv-buf=SIZE    set the receive buffer to SIZE bytes.
  -s, --snd-buf=SIZE    set the send buffer to SIZE bytes.
  -v, --validate        validate config-file then exit</pre><dl class="section user"><dt><b>Description</b> </dt><dd>The <code>lbmrd</code> command runs the Lbm Resolver Daemon. It can be run interactively from a shell or command prompt, or from a script or batch file. (For use as a Windows Service, see <a class="el" href="index.html#lbmrdsmanpage">Lbmrds Man Page</a>.)</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"config-file"</b> parameter is optional. If supplied, it specifies the file path for the lbmrd's XML configuration file. If omitted, the lbmrd defaults all configuration details. See <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a> for configuration details.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-i"</b> and <b>"-p"</b> options identify the network interface IP address and port that lbmrd opens to listen for unicast topic resolution traffic. The defaults are 0.0.0.0 and 15380, respectively. Note that 0.0.0.0 is not interpreted as INADDR_ANY, it is a directive for UM to choose the first interface it finds. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/generalconfigurationguidelines.html#specifyinginterfaces">Specifying Interfaces</a> for methods of specifying the interface. Alternatively, the <a class="el" href="index.html#lbmrdelementinterface">LBMRD Element "&lt;interface&gt;"</a> and <a class="el" href="index.html#lbmrdelementport">LBMRD Element "&lt;port&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd><b>WARNING</b>: It is strongly recommended to specify an interface when running lbmrd, either via the "-i" command-line option, or the <a class="el" href="index.html#lbmrdelementinterface">&lt;interface&gt;</a> XML tag. Otherwise, UM will select the first interface it finds, potentially 127.0.0.1 (loopback), which is rarely a good choice. Note that CIDR notation can make it easier. For example, "10.0.0.0/8" will match any interface on the 10 network.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-a"</b> and <b>"-t"</b> options interact to detect and remove "dead" clients, that is client applications that are in the lbmrd active client list, but have stopped sending topic resolution queries, advertisements, or keepalives, usually due to early termination or looping. These are described in detail below.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-t"</b> option describes the length of time (in seconds), during which no messages have been received from a given client, that will cause that client to be marked "dead" and removed from the active client list. Ultra Messaging recommends a value at least 5 seconds longer than the longest network outage you wish to tolerate. Alternatively, the <a class="el" href="index.html#lbmrdelementttl">LBMRD Element "&lt;ttl&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>Option <b>"-a"</b> describes a repeating time interval (in milliseconds), after which lbmrd checks for these "dead" clients. Ultra Messaging recommends a value not larger than "-t" * 1000. Alternatively, the <a class="el" href="index.html#lbmrdelementactivity">LBMRD Element "&lt;activity&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>Note that even clients that send no topic resolution advertisements or queries will still send keepalive messages to lbmrd every 5 seconds. This value is hard-coded and not configurable.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-s"</b> option sets the send socket buffer size in bytes. Alternatively, the <a class="el" href="index.html#lbmrdelementresolver_unicast_send_socket_buffer">LBMRD Element "&lt;resolver_unicast_send_socket_buffer&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-r"</b> option sets the receive socket buffer size in bytes. Alternatively, the <a class="el" href="index.html#lbmrdelementresolver_unicast_receiver_socket_buffer">LBMRD Element "&lt;resolver_unicast_receiver_socket_buffer&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-L"</b> option specifies the file path name for the lbmrd log file. Alternatively, the <a class="el" href="index.html#lbmrdelementlog">LBMRD Element "&lt;log&gt;"</a> can be used in the <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a>.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-d"</b> option dumps (prints) the lbmrd's XML DTD to standard output. After dumping the DTD, <code>lbmrd</code> exits.</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-h"</b> option prints the man page and exits.</dd></dl>
<dl class="section user"><dt><b>Exit</b> <b>Status</b> </dt><dd>The exit status from lbmrd is 0 for success and some non-zero value for failure.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="lbmrdsmanpage"></a>
Lbmrds Man Page&nbsp;&nbsp;<small><a href="#lbmrdsmanpage">&lt;-</a></small></h2>
<p>Windows Service interface.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#umdaemonsaswindowsservices">UM Daemons as Windows Services</a> for general information about UM daemons as Windows Services.</p>
<p>Note that many operating parameters that are available in the <code>lbmrd</code> command are not available in the <code>lbmrds</code> command. For example, "-p", "-t", "-r", etc. If it is desired to set these parameters, the corresponding XML elements must be used in an lbmrd configuration file.</p>
<pre class="fragment">UMResolver service
Usage: lbmrds [options] [config-file]
Available options:
  -h, --help                display this help and exit
  -E, --env-var-file        update/set environment variable file
  -U, --unset-env-var-file  unset the environment variable file
  -S, --service=install     install the service passing configfile
  -S, --service=remove      delete/remove the service
  -S, --service=config      update configfile info to use configfile passed
  -e, --event-log-level     update/set service logging level.  This is the minimum logging
                            level to send to the Windows event log.  Valid values are:
                               NONE - Send no events
                               INFO
                               WARN - default
                               ERROR
  configfile                XML config file (if not present, looks in registry)</pre><dl class="section user"><dt><b>Description</b> </dt><dd>The <code>lbmrds</code> command has two functions: <ul>
<li>
First, it lets the user supply Windows Service operating parameters, which the command saves into the Windows registry. Those operating parameters are subsequently used by the lbmrd Service. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a>. </li>
<li>
Second, it provides Windows with the lbmrd Daemon executable to run as a Service. </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"config-file"</b> parameter provides the file path for the lbmrd's XML configuration file. It is supplied in conjunction with the "-s config" option (see below). See <a class="el" href="index.html#lbmrdconfigurationfile">lbmrd Configuration File</a> for configuration details.</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-S install"</b> see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#installthewindowsservice">Install the Windows Service</a> (note that <code>lbmrds</code> uses upper-case "-S").</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-S remove"</b> see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#removethewindowsservice">Remove the Windows Service</a> (note that <code>lbmrds</code> uses upper-case "-S").</dd></dl>
<dl class="section user"><dt></dt><dd>For <b>"-S config"</b>, <b>"-e"</b>, <b>"-E"</b>, and <b>"-U"</b>, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a> (note that <code>lbmrds</code> uses upper-case "-S").</dd></dl>
<dl class="section user"><dt></dt><dd>The <b>"-h"</b> option prints the man page and exits.</dd></dl>
<dl class="section user"><dt><b>Exit</b> <b>Status</b> </dt><dd>The exit status from lbmrd is 0 for success and some non-zero value for failure.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Do not use the task manager or the "kill" command to stop a UM daemon running as a Windows service. Use the Windows service control panel to stop the service.</dd></dl>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="lbmrdconfigurationfile"></a>
lbmrd Configuration File&nbsp;&nbsp;<small><a href="#lbmrdconfigurationfile">&lt;-</a></small></h1>
<p>The lbmrd configuration file must start with this line: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div></div><!-- fragment --><p>After that, the '<b>&lt;lbmrd&gt;</b>' element contains the rest of the configuration.</p>
<p>The lbmrd configuration does not support the XInclude feature.</p>
<dl class="section note"><dt>Note</dt><dd>The configuration file must contain a '<b>&lt;domains&gt;</b>' element and a '<b>&lt;transformations&gt;</b>' element (and their contents), even if there is no NAT. See <a class="el" href="index.html#dummylbmrdconfigurationfile">Dummy lbmrd Configuration File</a>. The '<b>&lt;daemon&gt;</b>' element and its contents are optional.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="lbmrdconfigurationelements"></a>
lbmrd Configuration Elements&nbsp;&nbsp;<small><a href="#lbmrdconfigurationelements">&lt;-</a></small></h2>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementlbmrd"></a>
LBMRD Element "&lt;lbmrd&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementlbmrd">&lt;-</a></small></h3>
<p>Container element which holds the lbmrd configuration. Also defines the version of the configuration format used by the file.</p>
<ul>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a>, <a class="el" href="index.html#lbmrdelementdomains">&lt;domains&gt;</a>, <a class="el" href="index.html#lbmrdelementtransformations">&lt;transformations&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>version</b> </td><td>Version number of user's configuration file. </td><td><b><code>"1.0"</code></b> - Initial version </td><td><b><code>"1.0"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementtransformations"></a>
LBMRD Element "&lt;transformations&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementtransformations">&lt;-</a></small></h3>
<p>Container element for definitions of NAT translations applied to TIRs. Translations are used to help lbmrd know how to modify source advertisements when Network Address Translation (NAT) is being used.</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementlbmrd">&lt;lbmrd&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    ...</div><div class="line">  &lt;/transformations&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementtransform"></a>
LBMRD Element "&lt;transform&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementtransform">&lt;-</a></small></h3>
<p>Defines a set of transformation tuples. Each tuple applies to a TIR sent from a specific network domain (specified using the <code>source</code> attribute), and destined for a specific network domain (specified using the <code>destination</code> attribute). The <code>source</code> and <code>destination</code> attributes must specify network domain names as defined by the <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a> elements.</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementtransformations">&lt;transformations&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementrule">&lt;rule&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>source</b> </td><td>Name of source network domain, defined in <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a>. </td><td>IDREF </td><td>(no default; must be specified) </td></tr>
<tr>
<td><b>destination</b> </td><td>Name of receiver network domain, defined in <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a>. </td><td>IDREF </td><td>(no default; must be specified) </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;Net-NYC&quot;</span> destination=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      ...</div><div class="line">    &lt;/transform&gt;</div><div class="line">    ...</div><div class="line">  &lt;/transformations&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementrule"></a>
LBMRD Element "&lt;rule&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementrule">&lt;-</a></small></h3>
<p>Container for a transformation rule which maps one address and port to another.</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementmatch">&lt;match&gt;</a>, <a class="el" href="index.html#lbmrdelementreplace">&lt;replace&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;Net-NYC&quot;</span> destination=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;rule&gt;</div><div class="line">        ...</div><div class="line">      &lt;/rule&gt;</div><div class="line">      ...</div><div class="line">    &lt;/transform&gt;</div><div class="line">    ...</div><div class="line">  &lt;/transformations&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementreplace"></a>
LBMRD Element "&lt;replace&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementreplace">&lt;-</a></small></h3>
<p>Defines the address and port which are to replace those matched in the TIR originating from a UM context within the <code>source</code> network (as specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a>), and being delivered to contexts within the <code>destination</code> network.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementrule">&lt;rule&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>address</b> </td><td>IP address within a TIR. Address must be specified only in dotted-decimal and refer to a specific host. For <a class="el" href="index.html#lbmrdelementmatch">LBMRD Element "&lt;match&gt;"</a>, the IP address should be within the network specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> <code>source</code> attribute. For <a class="el" href="index.html#lbmrdelementreplace">LBMRD Element "&lt;replace&gt;"</a>, the IP address should be within the network specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> <code>destination</code> attribute. </td><td>string </td><td>(no default; must be specified) </td></tr>
<tr>
<td><b>port</b> </td><td>Port number to match or replace. To match any port, use value <b><code>"*"</code></b>. To replace with same port as matched, use value <b><code>"*"</code></b>. </td><td>string </td><td><b><code>"*"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;Net-NYC&quot;</span> destination=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;rule&gt;</div><div class="line">        &lt;match address=<span class="stringliteral">&quot;10.1.1.50&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">        &lt;replace address=<span class="stringliteral">&quot;192.168.1.1&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">        ...</div><div class="line">      &lt;/rule&gt;</div><div class="line">      ...</div><div class="line">    &lt;/transform&gt;</div><div class="line">    ...</div><div class="line">  &lt;/transformations&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementmatch"></a>
LBMRD Element "&lt;match&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementmatch">&lt;-</a></small></h3>
<p>Defines the address and port to match within a TIR originating from a UM context within the <code>source</code> network (as specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a>), and being delivered to contexts within the <code>destination</code> network.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementrule">&lt;rule&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>address</b> </td><td>IP address within a TIR. Address must be specified only in dotted-decimal and refer to a specific host. For <a class="el" href="index.html#lbmrdelementmatch">LBMRD Element "&lt;match&gt;"</a>, the IP address should be within the network specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> <code>source</code> attribute. For <a class="el" href="index.html#lbmrdelementreplace">LBMRD Element "&lt;replace&gt;"</a>, the IP address should be within the network specified by <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> <code>destination</code> attribute. </td><td>string </td><td>(no default; must be specified) </td></tr>
<tr>
<td><b>port</b> </td><td>Port number to match or replace. To match any port, use value <b><code>"*"</code></b>. To replace with same port as matched, use value <b><code>"*"</code></b>. </td><td>string </td><td><b><code>"*"</code></b> </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;Net-NYC&quot;</span> destination=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;rule&gt;</div><div class="line">        &lt;match address=<span class="stringliteral">&quot;10.1.1.50&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">        &lt;replace address=<span class="stringliteral">&quot;192.168.1.1&quot;</span> port=<span class="stringliteral">&quot;*&quot;</span>/&gt;</div><div class="line">        ...</div><div class="line">      &lt;/rule&gt;</div><div class="line">      ...</div><div class="line">    &lt;/transform&gt;</div><div class="line">    ...</div><div class="line">  &lt;/transformations&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementdomains"></a>
LBMRD Element "&lt;domains&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementdomains">&lt;-</a></small></h3>
<p>Container element for definitions of network domains. Network domains are used to help lbmrd recognize networks and/or subnetworks which connect via Network Address Translation (NAT).</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementlbmrd">&lt;lbmrd&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;domains&gt;</div><div class="line">    ...</div><div class="line">  &lt;/domains&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementdomain"></a>
LBMRD Element "&lt;domain&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementdomain">&lt;-</a></small></h3>
<p>Defines a network domain. The domain must be given a unique name via the <code>name</code> attribute. This name is referenced in <a class="el" href="index.html#lbmrdelementtransform">&lt;transform&gt;</a> elements. The <code>&lt;domain&gt;</code> element contains one or more <a class="el" href="index.html#lbmrdelementnetwork">&lt;network&gt;</a> elements.</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdomains">&lt;domains&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementnetwork">&lt;network&gt;</a> </li>
</ul>
<p><b>XML</b> <b>Attributes:</b> </p><table class="doxtable">
<tr>
<th>Attribute </th><th>Description </th><th>Valid Values </th><th>Default Value </th></tr>
<tr>
<td><b>name</b> </td><td>Unique name assigned to the defined network. </td><td>ID </td><td>(no default; must be specified) </td></tr>
</table>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;domains&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NYC&quot;</span>&gt;</div><div class="line">      ...</div><div class="line">    &lt;/domain&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      ...</div><div class="line">    &lt;/domain&gt;</div><div class="line">    ...</div><div class="line">  &lt;/domains&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementnetwork"></a>
LBMRD Element "&lt;network&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementnetwork">&lt;-</a></small></h3>
<p>Defines a single network specification which is to be considered part of the enclosing <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a> element. The network specification must contain either an IP address, or a network specification in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR notation</a>. DNS host names are not supported in the lbmrd configuration file.</p>
<p>See <a class="el" href="index.html#networkaddresstranslationnat">LBMRD NAT Transit</a> for more information on NAT.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdomain">&lt;domain&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;domains&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NYC&quot;</span>&gt;</div><div class="line">      &lt;network&gt;10.1.0.0/16&lt;/network&gt;</div><div class="line">      ...</div><div class="line">    &lt;/domain&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;Net-NJC&quot;</span>&gt;</div><div class="line">      &lt;network&gt;192.168.1/24&lt;/network&gt;</div><div class="line">      ...</div><div class="line">    &lt;/domain&gt;</div><div class="line">    ...</div><div class="line">  &lt;/domains&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p>For a full example of an lbmrd NAT configuration, see <a class="el" href="index.html#examplenatconfiguration">Example NAT Configuration</a>.</p>
<hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementdaemon"></a>
LBMRD Element "&lt;daemon&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementdaemon">&lt;-</a></small></h3>
<p>Container element for configuration related to the overall lbmrd process.</p>
<ul>
<li>
<b>Cardinality</b> (number of times element can be supplied): 0 .. 1 </li>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementlbmrd">&lt;lbmrd&gt;</a> </li>
<li>
<b>Children:</b> <a class="el" href="index.html#lbmrdelementactivity">&lt;activity&gt;</a>, <a class="el" href="index.html#lbmrdelementinterface">&lt;interface&gt;</a>, <a class="el" href="index.html#lbmrdelementport">&lt;port&gt;</a>, <a class="el" href="index.html#lbmrdelementttl">&lt;ttl&gt;</a>, <a class="el" href="index.html#lbmrdelementlog">&lt;log&gt;</a>, <a class="el" href="index.html#lbmrdelementresolver_unicast_receiver_socket_buffer">&lt;resolver_unicast_receiver_socket_buffer&gt;</a>, <a class="el" href="index.html#lbmrdelementresolver_unicast_send_socket_buffer">&lt;resolver_unicast_send_socket_buffer&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementresolver_unicast_send_socket_buffer"></a>
LBMRD Element "&lt;resolver_unicast_send_socket_buffer&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementresolver_unicast_send_socket_buffer">&lt;-</a></small></h3>
<p>Sets the send-side socket buffer size (in bytes).</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 1048576 </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;resolver_unicast_send_socket_buffer&gt;</div><div class="line">      1048576</div><div class="line">    &lt;/resolver_unicast_send_socket_buffer&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementresolver_unicast_receiver_socket_buffer"></a>
LBMRD Element "&lt;resolver_unicast_receiver_socket_buffer&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementresolver_unicast_receiver_socket_buffer">&lt;-</a></small></h3>
<p>Sets the receive-side socket buffer size (in bytes).</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 1048576 </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;resolver_unicast_receiver_socket_buffer&gt;</div><div class="line">      1048576</div><div class="line">    &lt;/resolver_unicast_receiver_socket_buffer&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementlog"></a>
LBMRD Element "&lt;log&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementlog">&lt;-</a></small></h3>
<p>Specifies the file name used for lbmrd logging.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;log&gt;lbmrd.log&lt;/log&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementttl"></a>
LBMRD Element "&lt;ttl&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementttl">&lt;-</a></small></h3>
<p>Interval (in milliseconds) between keep alive checks between the lbmrd and the UM contexts.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 60000 </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;ttl&gt;60000&lt;/ttl&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementport"></a>
LBMRD Element "&lt;port&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementport">&lt;-</a></small></h3>
<p>Supplies network port to bind the socket for receiving TR traffic from UM contexts. This is the port that a UM context should use when TCP-based TR is configured with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastresolvernetwork.html#resolverunicastdaemoncontext">resolver_unicast_daemon (context)</a>. The value contained within the <code>&lt;port&gt;...&lt;/port&gt;</code> is an integer between 1 and 65535.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 15380 </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt; </div><div class="line">    &lt;port&gt;15380&lt;/port&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementinterface"></a>
LBMRD Element "&lt;interface&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementinterface">&lt;-</a></small></h3>
<p>Specifies the network interface to bind the socket for receiving TR traffic from UM contexts. This is the IP address that a UM context should use when Unicast UDP-based TR is configured with the option <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastresolvernetwork.html#resolverunicastdaemoncontext">resolver_unicast_daemon (context)</a>. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/generalconfigurationguidelines.html#specifyinginterfaces">Specifying Interfaces</a> for methods of specifying the interface within <code>&lt;interface&gt;...&lt;/interface&gt;</code>.</p>
<p>If not specified, UM chooses the first interface it finds.</p>
<p><b>WARNING</b>: It is strongly recommended to specify an interface when running lbmrd, either via the "-i" <a class="el" href="index.html#lbmrdmanpage">command-line option</a>, or the <code>&lt;interface&gt;</code> XML tag. Otherwise, UM will select the first interface it finds, potentially 127.0.0.1 (loopback), which is rarely a good choice. Note that CIDR notation can make it easier. For example, "10.0.0.0/8" will match any interface on the 10 network.</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;interface&gt;10.1.1.50&lt;/interface&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><hr/>
<p> <br />
 </p>
<h3><a class="anchor" id="lbmrdelementactivity"></a>
LBMRD Element "&lt;activity&gt;"&nbsp;&nbsp;<small><a href="#lbmrdelementactivity">&lt;-</a></small></h3>
<p>Interval between client activity checks (in milliseconds)</p>
<ul>
<li>
<b>Parent:</b> <a class="el" href="index.html#lbmrdelementdaemon">&lt;daemon&gt;</a> </li>
<li>
<b>Default</b> <b>Value:</b> 60000 </li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    &lt;activity&gt;60000&lt;/activity&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  ...</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="dummylbmrdconfigurationfile"></a>
Dummy lbmrd Configuration File&nbsp;&nbsp;<small><a href="#dummylbmrdconfigurationfile">&lt;-</a></small></h2>
<p>If no NAT is present, and it is desired to use the XML configuration file for it's '<b>&lt;daemon&gt;</b>' contents, a "dummy" NAT configuration should be used.</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> ?&gt;</div><div class="line">&lt;lbmrd version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;daemon&gt;</div><div class="line">    ...</div><div class="line">  &lt;/daemon&gt;</div><div class="line">  &lt;domains&gt;</div><div class="line">    &lt;domain name=<span class="stringliteral">&quot;dummy&quot;</span>&gt;</div><div class="line">      &lt;network&gt;0.0.0.0/32&lt;/network&gt;</div><div class="line">    &lt;/domain&gt;</div><div class="line">  &lt;/domains&gt;</div><div class="line">  &lt;transformations&gt;</div><div class="line">    &lt;transform source=<span class="stringliteral">&quot;dummy&quot;</span> destination=<span class="stringliteral">&quot;dummy&quot;</span>&gt;</div><div class="line">      &lt;rule&gt;</div><div class="line">        &lt;match address=<span class="stringliteral">&quot;0.0.0.0&quot;</span> port=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">        &lt;replace address=<span class="stringliteral">&quot;0.0.0.0&quot;</span> port=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line">      &lt;/rule&gt;</div><div class="line">    &lt;/transform&gt;</div><div class="line">  &lt;/transformations&gt;</div><div class="line">&lt;/lbmrd&gt;</div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="lbmrddtdfile"></a>
Lbmrd DTD file&nbsp;&nbsp;<small><a href="#lbmrddtdfile">&lt;-</a></small></h2>
<p>The DTD file is used to validate the user's configuration file.</p>
<div class="fragment"><div class="line">&lt;!ELEMENT lbmrd (daemon?, domains, transformations)&gt;</div><div class="line">&lt;!ATTLIST lbmrd</div><div class="line">          version (1.0) <span class="preprocessor">#REQUIRED</span></div><div class="line">&gt;</div><div class="line">&lt;!ELEMENT daemon (activity|interface|port|ttl|log|resolver_unicast_receiver_socket_buffer|resolver_unicast_send_socket_buffer)*&gt;</div><div class="line">&lt;!ELEMENT activity (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT interface (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT port (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT ttl (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT log (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT resolver_unicast_receiver_socket_buffer (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT resolver_unicast_send_socket_buffer (#PCDATA) &gt;</div><div class="line">&lt;!ELEMENT domains (domain+)&gt;</div><div class="line">&lt;!ELEMENT domain (network+)&gt;</div><div class="line">&lt;!ATTLIST domain name ID #REQUIRED&gt;</div><div class="line">&lt;!ELEMENT network ( #PCDATA )&gt;</div><div class="line">&lt;!ELEMENT transformations ( transform+ )&gt;</div><div class="line">&lt;!ELEMENT transform ( rule+ )&gt;</div><div class="line">&lt;!ATTLIST transform</div><div class="line">          source IDREF #REQUIRED</div><div class="line">          destination IDREF #REQUIRED</div><div class="line">&gt;</div><div class="line">&lt;!ELEMENT rule ( match, replace )&gt;</div><div class="line">&lt;!ELEMENT match EMPTY&gt;</div><div class="line">&lt;!ATTLIST match</div><div class="line">          address CDATA #REQUIRED</div><div class="line">          port CDATA <span class="stringliteral">&quot;*&quot;</span></div><div class="line">&gt;</div><div class="line">&lt;!ELEMENT replace EMPTY&gt;</div><div class="line">&lt;!ATTLIST replace</div><div class="line">          address CDATA #REQUIRED</div><div class="line">          port CDATA <span class="stringliteral">&quot;*&quot;</span></div><div class="line">&gt;</div></div><!-- fragment --><p><br />
 </p><hr/>
<h1><a class="anchor" id="packetloss"></a>
Packet Loss&nbsp;&nbsp;<small><a href="#packetloss">&lt;-</a></small></h1>
<p>This section is about packet loss. It applies primarily to UDP-based network protocols used by UM: LBT-RM, LBT-RU, and UDP-based topic resolution.</p>
<p>(Packet loss also affects TCP-based protocols, but UM has no control over how it is handled by the IP stack. "Packet" loss can also happen with the IPC transport type if source-pacing is selected, but most of this section's discussion doesn't apply to IPC.)</p>
<p>Packet loss is almost always caused when some part of the system is receiving packets at a higher rate than it is able to process them. This might be a router, a switch, a subscribing host's kernel, or the subscribing process itself. This typically results in queuing of incoming packets within the router, switch, kernel, or socket buffer. But queues do not have unlimited size. If the incoming packets exceed the processing speed for too long a period of time, the queue will fill and packets will be dropped.</p>
<p>Packet loss is a fact of life in networks. Some users are able to provision and tune their systems such that they might only lose a few packets per week. Other users routinely live with several lost packets per minute. Many users do not monitor their system for loss and have no idea how frequent it is.</p>
<p>Packet loss is undesirable for many reasons. For reliable protocols (TCP, LBT-RM, etc), detection and retransmission of lost packets introduces significant latency. If packet rates are too high for too long a period of time, the transport protocol can give up trying to recover the lost data. For <a class="el" href="index.html#streaming">Streaming</a>, this can cause disconnects or <a class="el" href="index.html#unrecoverableloss1">Unrecoverable Loss</a>, where application messages can be lost forever.</p>
<p>Informatica recommends that you: </p><ol>
<li>
Design your system to prevent packet loss. </li>
<li>
Configure UM for proper recovery from packet loss. </li>
<li>
Monitor your network for packet loss. </li>
<li>
Diagnose the cause of the observed packet loss and fine-tune your design and configuration to better prevent loss and optimize recovery from it. </li>
</ol>
<p><br />
 </p>
<h2><a class="anchor" id="designtopreventloss"></a>
Design to Prevent Loss&nbsp;&nbsp;<small><a href="#designtopreventloss">&lt;-</a></small></h2>
<p>There are two complementary methods of avoiding packet loss: </p><ul>
<li>
<a class="el" href="index.html#decreasepacketflowthroughlosspoints">Decrease Packet Flow through Loss Points</a>. </li>
<li>
<a class="el" href="index.html#increaseefficiencyofpacketconsumers">Increase Efficiency of Packet Consumers</a>. </li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="decreasepacketflowthroughlosspoints"></a>
Decrease Packet Flow through Loss Points&nbsp;&nbsp;<small><a href="#decreasepacketflowthroughlosspoints">&lt;-</a></small></h3>
<ul>
<li>
<p class="startli"><b><a class="el" href="index.html#messagebatching">Message Batching</a></b>. At most loss points, the number of packets is usually more important than the sizes of the packets. 100 packets of 60 bytes each is <em>much</em> more burdensome to packet consumers than 10 packets of 600 bytes each. For latency-sensitive applications, consider implementing an <a class="el" href="index.html#intelligentbatching">Intelligent Batching</a> algorithm.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Reduce discards</b>. Due to the way publishers map topics to <a class="el" href="index.html#transportsessions">Transport Sessions</a>, it is often the case that the receiver will have to discard messages that it hasn't subscribed to. The <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__transport__stats__t__stct.html">LBT-RM transport statistics</a> structure for each transport type contains the field "lbm_msgs_no_topic_rcved" which counts the number of data messages discarded. Also, the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__context__stats__t__stct.html">context statistics</a> structure contains the field "lbtrm_unknown_msgs_rcved", which also counts data messages discarded.</p>
<p>For the LBT-RU transport type, you can get similar discards. See the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__rcv__transport__stats__lbtru__t__stct.html">LBT-RU transport statistics</a> structure field "lbm_msgs_no_topic_rcved", and the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/structlbm__context__stats__t__stct.html">context statistics</a> structure field "lbtru_unknown_msgs_rcved".</p>
<p>For the TCP or LBT-RU transport types, you can often decrease discards by turning on <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsourcesidefilteringbehaviorsource">Source Side Filtering</a>.</p>
<p class="endli">With Multicast, the Source Side Filtering feature is not possible. So it is usually necessary to change the topic-to-transport session mapping. Ideally, this can be done by taking into account the topic interests of the subscribers. But often it simply means increasing the number of transport sessions. In the case of LBT-RM, increasing the number of multicast groups is preferred, but is often limited by the network hardware. In that case, you can multiply the number of transport sessions by varying the destination port. </p>
</li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="increaseefficiencyofpacketconsumers"></a>
Increase Efficiency of Packet Consumers&nbsp;&nbsp;<small><a href="#increaseefficiencyofpacketconsumers">&lt;-</a></small></h3>
<p>Here are some methods for increasing the efficiency of subscribers: Use a <a class="el" href="index.html#glossarykernelbypass">kernel-bypass driver</a>. For Linux, use <a class="el" href="index.html#receivemultipledatagrams">Receive Multiple Datagrams</a>. Use <a class="el" href="index.html#receivebufferrecycling">Receive Buffer Recycling</a>. For Java and .NET, use <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umrecoveryoflostpackets"></a>
UM Recovery of Lost Packets&nbsp;&nbsp;<small><a href="#umrecoveryoflostpackets">&lt;-</a></small></h2>
<p>See <a class="el" href="index.html#messagingreliability">Messaging Reliability</a> for a high-level description of message loss as it relates to UM.</p>
<p>UM recovers lost packets at multiple levels: </p><ul>
<li>
<b>Transport</b> - TCP, LBT-RU, LBT-RM have low-level handshakes to detect and retransmit lost packets. </li>
<li>
<b>OTR/Late Join</b> - independent of transport, OTR and Late Join will recover data, typically after the transport layer is unable to recover. </li>
<li>
<b>Persistence</b> - closely-associated with OTR and Late Join, the persistent Store provides a much greater capacity to recover lost data. UM persistence provides a guarantee of message delivery, subject to a set of configurable constraints. </li>
</ul>
<p>One common goal for most UM use cases is that users want the flow of new messages to continue unimpeded in parallel with recovery efforts of lost packets. Given that packet loss is almost always a result of high packet rates overloading one or more queuing points along a messaging path, the addition of packet recovery efforts can make the overload even worse. "Pouring gasoline on a fire" is an often-repeated metaphor.</p>
<p>Fortunately, packet rate overload tends to be temporary, associated with short-term traffic bursts. That is one reason why the UM lost packet recovery algorithms use time delays. For example: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmnakinitialbackoffintervalreceiver">transport_lbtrm_nak_initial_backoff_interval (receiver)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpofftransportrecovery.html#otrrequestinitialdelayreceiver">otr_request_initial_delay (receiver)</a>. By waiting before requesting retransmissions, the burst is allowed some time to subside before we add retransmission to the normal traffic load. These delays do add to latency, but shortening the delay too much risks making the loss worse, which can make the overall latency worse than having a longer delay.</p>
<p>One limiting factor related to data recovery is UM's use of retransmission rate limits. After a short period of severe packet loss due to overload, many receivers will be requesting retransmission. It would make no sense for the initial request delay to successfully bypass the original traffic burst, only to create its own overloading burst of retransmissions. Older NAK-based systems can get into a positive feedback loop where loss leads to retransmission, which leads to more loss, which leads to more retransmission, etc. Even once new data rates return to normal, networks can be locked into this kind of NAK/Retransmission storm. UM's retransmission rate limiter throttles the retransmission of lost packets over time without worsening the loss.</p>
<p>Another limiting factor related to data recovery is the amount of data which the sender buffers and is available for retransmission. Applications need to continue sending new data while recovery takes place. Since the buffer is of limited size, older buffered messages will eventually be overwritten with new messages.</p>
<p>For streaming applications, these buffers are held in memory, and the sizes are usually measured in megabytes. For persistent applications, the Store writes its buffer to disk, allowing for buffer sizes orders of magnitude larger than memory-based buffers. But even the Store's disk-based buffer is of finite size, and is susceptible to being overwritten if it takes too long to recover data.</p>
<p>Note that the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/operationalview.html#rppnormaloperation">Receiver Paced Persistence (RPP)</a> feature seeks to maximize the reliability of messaging by allowing the publisher to be blocked from sending rather than overwriting unacknowledged data.</p>
<p>Given these limiting factors for data recovery, a sufficiently-overloaded network can reach a point where lost data can no longer be recovered, a situation called "unrecoverable loss".</p>
<p>Finally, it is very important for UM users to make use of UM's extensive monitoring capabilities. Since UM does a good job of recovering lost packets, you may be experiencing high latency spikes without knowing it. And recovered loss today can be a warning of unrecoverable loss tomorrow. User are strongly advised to monitor transport statistics and pay special attention to receivers that repeatedly experience loss. Even if that loss is successfully recovered, you should diagnose and treat the loss before it gets worse and becomes unrecoverable.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/operations.tag:../../Operations/" href="../../Operations/monitoring.html">Monitoring</a> for more information.</p>
<p><br />
 </p>
<h2><a class="anchor" id="packetlosspoints"></a>
Packet Loss Points&nbsp;&nbsp;<small><a href="#packetlosspoints">&lt;-</a></small></h2>
<p>There are just a few common points at which packets are normally lost:</p>
<div class="image">
<img src="loss_points.png" alt="loss_points.png"/>
</div>
 <p>The red buffers/queues are the most common locations where packets are typically lost during a packet burst.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lossswitchegressport"></a>
Loss: Switch Egress Port&nbsp;&nbsp;<small><a href="#lossswitchegressport">&lt;-</a></small></h3>
<p>The switch egress port can come under pressure if data flows from multiple sources need to be merged onto a single outgoing link. The outgoing link can be an internal trunk or communication link connecting two pieces of network equipment, but more typically it is link to a destination host.</p>
<p>It is easy to understand how loss can happen here. Suppose three remote hosts are sending UDP data streams at the destination host. If each stream is carrying 0.5 gigabit/sec of throughput, the switch needs to send 1.5 gigabit/sec over a 1 gigabit link, a clear overload. If this is a very short-term burst, the egress queue will hold the data until the incoming data flows subside and the outgoing port can get caught up. But if the burst lasts too long and the egress queue fills, the switch has no choice but to drop packets.</p>
<p>Note that the switch will not count these drops as "errors". There is a separate drop counter which should be examined to diagnose switch egress port loss.</p>
<p><a class="anchor" id="mitigateswitchegressport"></a><b>MITIGATION</b></p>
<p>The only solution is to reduce the packet rate being sent to the destination host. See <a class="el" href="index.html#decreasepacketflowthroughlosspoints">Decrease Packet Flow through Loss Points</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lossnicringbuffer"></a>
Loss: NIC Ring Buffer&nbsp;&nbsp;<small><a href="#lossnicringbuffer">&lt;-</a></small></h3>
<p>As packets are received by the host's NIC (Network Interface Card), they are copied into host memory in a structure called the Receive Ring Buffer. The NIC interrupts the OS, which has the responsibility to unload the packet buffers from the Ring Buffer. If the incoming packet rate is faster than the OS can unload the Ring Buffer, it will fill and packets will be dropped.</p>
<p>Normally, the kernel is able to service NIC interrupts without any trouble. However, there is one situation which can put the Ring Buffer under pressure: When multiple processes on the host are subscribed to the same multicast stream, the kernel must replicate and deliver the packets to each process. For a small number of processes (5-10), the kernel will still be able to keep up with the incoming packets.</p>
<p>However, as companies consolidation servers by moving to large, many-core hosts (often virtualized), we see the same multicast stream subscribed to by increasing numbers of processes on the same physical server. We have seen NIC Ring Buffer loss (also called "overrun") with as few as 15 processes subscribed to a heavy stream of multicast packets.</p>
<p>(Note that this is generally only a problem for multicast. With Unicast data distribution to many recipients, the source essentially does the packet replication work. The receive-side work for the kernel for each unicast packet is minimal.)</p>
<p><a class="anchor" id="mitigatenicringbuffer"></a><b>MITIGATION</b></p>
<p>Users should maximize the size of the NIC's Receive Ring Buffer. For many NICs, the size of the ring buffer is configured by the number of receive descriptors. This should be set to the maximum allowable value.</p>
<p>The mitigators listed in <a class="el" href="index.html#lossswitchegressport">Loss: Switch Egress Port</a> will also help this problem by reducing the incoming packet rate.</p>
<p>Another solution is to spread processes across more physical hosts. This has the additional advantage of reducing latency, since multicast replication within a host must be done in software by the kernel and is serial in nature, whereas replication in the network is done by specialized hardware in parallel.</p>
<p>Another possible solution involves the use of the DRO as the primary receiver of the multicast data, which then re-publishes it on the host using the IPC transport. This has the disadvantage of introducing some additional latency since the messages must be received by the DRO and then forwarded to the application receivers. It also requires separating the applications to their own <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs).</p>
<p><a class="el" href="index.html#glossaryopenonload">Onload</a> users can get more information at <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#solarflaretips">Solarflare Tips</a>.</p>
<p><br />
 </p>
<h3><a class="anchor" id="losssocketbuffer"></a>
Loss: Socket Buffer&nbsp;&nbsp;<small><a href="#losssocketbuffer">&lt;-</a></small></h3>
<p>The Socket Buffer represents the interface between the OS kernel and the user process. Received data is transferred from the NIC Ring Buffer to the destination Socket Buffer(s). The Socket Buffers are then emptied by the application process (in this case, the UM Context Thread). Socket buffer sizes are configurable, according to the transport type. For example, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#transportlbtrmreceiversocketbuffercontext">transport_lbtrm_receiver_socket_buffer (context)</a>.</p>
<p>The TCP protocol is designed to ensure that the socket buffer cannot be overflowed. However, UDP-based protocols (LBT-RU and LBT-RM) are susceptible to socket buffer overflow, which leads to datagram loss.</p>
<p><a class="anchor" id="mitigatenicsocketbuffer"></a><b>MITIGATION</b></p>
<p>All of the mitigators listed <a class="el" href="index.html#lossnicringbuffer">Loss: NIC Ring Buffer</a> will help this problem by reducing the incoming packet rate.</p>
<p>An obvious mitigator is to increase the sizes of the receive socket buffers. Informatica usually recommends at least 8MB for UDP-based protocols. But this only works if the problem is related to short-term traffic bursts. Simply increasing the size of the buffer will not avoid loss if the <em>average</em> message rate exceeds the average consumption and processing rate of the receiving program.</p>
<p>A very useful method for mitigating socket buffer loss is to increase the efficiency of the receiving application. The <a class="el" href="index.html#receivemultipledatagrams">Receive Multiple Datagrams</a> can increase that efficiency without sacrificing latency.</p>
<p>Also, the <a class="el" href="index.html#transportservicesproviderxsp">Transport Services Provider (XSP)</a> feature can help by splitting the work of unloading multiple sockets across multiple threads.</p>
<p><br />
 </p>
<h3><a class="anchor" id="lossother"></a>
Loss: Other&nbsp;&nbsp;<small><a href="#lossother">&lt;-</a></small></h3>
<p>The three loss locations described above are all related to high packet rates causing fixed-sized packet buffers to overflow. These represent by far the most common reasons for packet loss. However, it is possible that you will experience loss that cannot be diagnosed to those three causes.</p>
<p>For example, we have seen reports of NIC hardware malfunctioning such that most packets are successfully received and delivered, but some percentage of packets fail. At least one user reported that a misconfigured router "flapped" a route, resulting in periodic, short-term loss of connectivity between two sub-networks. We have seen a case where the use of kernel bypass drivers for high-performance NICs (specifically Solarflare) can cause multicast <a class="el" href="index.html#glossarydeafness">deafness</a> if both accelerated and non-accelerated processes are run on the same host. We have even seen a case where replacing the Ethernet cable between a host and the switch resolved packet loss.</p>
<p>It is not possible to have a step-by-step diagnostic procedure which will pinpoint every possible cause of packet loss. The techniques described in this document should successfully diagnose a large majority of packet loss causes, but nothing can replace your infrastructure network engineers expertise at tracking down problems.</p>
<p><br />
 </p>
<h2><a class="anchor" id="verifyinglossdetectiontools"></a>
Verifying Loss Detection Tools&nbsp;&nbsp;<small><a href="#verifyinglossdetectiontools">&lt;-</a></small></h2>
<p>The preceding techniques for mitigating loss are best deployed after you have identified the type of loss. Unfortunately, we have found that the tools available to detect and identify the location of loss to be problematic. Informatica does not provide such tools, and does not follow the market for such tools to find a reliable supplier.</p>
<p>However, we have a starting point that has given us some measure of success in diagnosing the loss points. It is important that you try out these tools to verify that they properly detect the different types of loss. In order to verify them, you need to be able to reproduce on demand loss at each of the points: switch, NIC, and socket buffer.</p>
<p>Fortunately, this is reasonably easy using the <code>msend</code> and <code>mdump</code> tools provided in the "mtools" package offered by Informatica free of charge. Download the mtools package from <a href="https://community.informatica.com/solutions/informatica_mtools">https://community.informatica.com/solutions/informatica_mtools</a> The source files for <code>msend</code> and <code>mdump</code> are provided, as well as pre-built binaries for most major platforms.</p>
<p>Informatica recommends verifying your loss diagnosis tools <em>before</em> you have a serious loss event that disrupts your application system, preferably before your system goes into full production usage. Periodically running and recording the results of these tools during normal operation will make it possible to diagnose loss after the fact. Detecting and identifying non-severe (recoverable) loss can be used to prevent serious (unrecoverable) loss events in the future.</p>
<p><br />
 </p>
<h3><a class="anchor" id="preparetoverify"></a>
Prepare to Verify&nbsp;&nbsp;<small><a href="#preparetoverify">&lt;-</a></small></h3>
<ol>
<li>
Download and install mtools on two hosts, designated "sender" and "receiver". Informatica recommends that the hosts be "bare metal" (not virtual machines), and that they be connected to the same switch. This minimizes the chances that the verification tests will cause any disruption to normal operation. </li>
<li>
Contact your system and network administrators and set up some time that they can work with your during the verification process. They will need to perform operations that you probably do not have the ability to do. </li>
<li>
Have the network administrator allocate a multicast group that you can use for this test. That multicast group should be otherwise unused in your organization. Warn the administrator that you will be pushing intense traffic bursts between the two hosts. </li>
</ol>
<p><br />
 </p>
<h3><a class="anchor" id="verifyingswitchloss"></a>
Verifying Switch Loss&nbsp;&nbsp;<small><a href="#verifyingswitchloss">&lt;-</a></small></h3>
<p>A possible Unix command that a network administrator could use is:</p>
<p><code>snmpwalk -v 1 -c public</code> <em>SWITCH_ADDR</em> <code>IF-MIB</code><code>::</code><code>ifOutDiscards</code></p>
<p>Note that the above community string ("public") is probably not enabled; the network administrator will know the appropriate value. Ideally, the network administrator would run that command every 5 or 10 minutes, logging to a file, with a time stamp. If this log file could be shared read-only to the project groups, they can time-correlate any unusual application event with loss reported by the switch.</p>
<p>To verify that you properly detect switch loss, follow these steps:</p>
<ol>
<li>
Work with your system and network administrators to <b>enable</b> Ethernet flow control in both the switch port and the NIC. </li>
<li>
Use the above <code>snmpwalk</code> command (or equivalent) to record the current drop counts for the switch ports. </li>
<li>
On the receiving host, run 30 copies of the following command: <br />
<code>mdump -q</code> <em>MCAST_ADDR</em> <code>12000</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the receiving host. </li>
<li>
On the sending host, run the following command: <br />
<code>msend -5</code> <em>MCAST_ADDR</em> <code>12000 15</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the sending host. </li>
<li>
When the test completes, use the <code>snmpwalk</code> command again (or equivalent) to record another set of drop counters. The receiving host's drop count should be larger. </li>
</ol>
<p>This test works by making the receiving host's kernel work very hard for each received datagram. It should be unable to keep up. (If you don't see any drops caused by the test, try doubling the number of copies of <code>mdump</code> on the receiving host.) The Ethernet flow control settings on the NIC and switch will prevent NIC loss in its ring buffer by slowing down the switch's egress port. Thus, the switch's egress queue will fill and should overflow.</p>
<p><br />
 </p>
<h3><a class="anchor" id="verifyingnicloss"></a>
Verifying NIC Loss&nbsp;&nbsp;<small><a href="#verifyingnicloss">&lt;-</a></small></h3>
<p><b>Unix</b></p>
<p>On some Unix systems, the "ifconfig" command will accurately report receive overrun on the NIC. For example: <br />
<code>ifconfig eth0</code></p>
<p>But in many Unix systems, the values reported by "ifconfig" remain at zero, even when the NIC has in fact overrun its receive ring buffer. We recommend also trying the "ethtool" command. For example: <br />
<code>ethtool -s eth0</code></p>
<p><b>Windows</b></p>
<p>To the best of our knowledge, there is no standard Windows tool for detecting NIC loss. Some drivers might provide that information from the interface control panel. Otherwise, you might need to download a management application from the NIC or system vendor.</p>
<p>If you know of a widely-available method to detect NIC overrun on Windows, please let us know at our <b>DLMessagingBuilds</b> email account on informatica.com (that awkward wording used to avoid spam address harvesters).</p>
<p>To verify that you properly detect NIC loss, follow these steps:</p>
<ol>
<li>
Work with your system and network administrators to <b>disable</b> Ethernet flow control in both the switch port and the NIC. </li>
<li>
Use your NIC loss tool to get the current receive overrun count. </li>
<li>
On the receiving host, run 30 copies of the following command: <br />
<code>mdump -q</code> <em>MCAST_ADDR</em> <code>12000</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the receiving host. </li>
<li>
On the sending host, run the following command: <br />
<code>msend -5</code> <em>MCAST_ADDR</em> <code>12000 15</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the sending host. </li>
<li>
When the test completes, use the NIC loss tool again to record the receive overrun count. </li>
</ol>
<p>This test works by making the receiving host's kernel work very hard for each received datagram. It should be unable to keep up. (If you don't see any drops caused by the test, try doubling the number of copies of <code>mdump</code> on the receiving host.) The lack of Ethernet flow control means that the switch will send the packets at full line rate, which should overflow the NIC ring buffer.</p>
<p><br />
 </p>
<h3><a class="anchor" id="verifyingsocketbufferloss"></a>
Verifying Socket Buffer Loss&nbsp;&nbsp;<small><a href="#verifyingsocketbufferloss">&lt;-</a></small></h3>
<p>On most systems, the <code>netstat</code> command can be used to detect socket buffer overflow. For example: <br />
<code>netstat -s</code> <br />
Look in the UDP section for "receive errors". This normally represents the number of datagrams dropped due to the receive socket buffer being full.</p>
<p>Note that Windows prior to version 7 does not increment that field for socket buffer overflows. If you have pre-Windows 7, we don't know of any command to detect socket buffer overflow.</p>
<p>To verify that you properly detect socket buffer overflow, follow these steps:</p>
<ol>
<li>
Use <code>netstat -s</code> to get the current receive error count. </li>
<li>
On the receiving host, run a single copy of the command: <br />
<code>mdump -q -p1000/5</code> <em>MCAST_ADDR</em> <code>12000</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the receiving host. </li>
<li>
On the sending host, run the following command: <br />
<code>msend -5 -s2200</code> <em>MCAST_ADDR</em> <code>12000 15</code> <em>INTFC_ADDR</em> <br />
where <em>MCAST_ADDR</em> is the multicast group for the test, and <em>INTFC_ADDR</em> is the IP address of the sending host. </li>
<li>
When the test completes, use <code>netstat -s</code> again to get the new receive error count. </li>
</ol>
<p>This test works by introducing a short sleep in the "mdump" command between reception of datagrams. This causes the socket buffer to overflow.</p>
<p><br />
 </p>
<h2><a class="anchor" id="tcpdisconnections"></a>
TCP Disconnections&nbsp;&nbsp;<small><a href="#tcpdisconnections">&lt;-</a></small></h2>
<p>The TCP protocol is generally very good at recovering from periods of packet loss. However, if no packets at all can get through for an extended period, TCP will reach its retry limit and disconnect. This can affect the <a class="el" href="index.html#transporttcp">TCP transport</a> and <a class="el" href="index.html#unicastimmediatemessaging">UIMs</a>.</p>
<p>This can happen if there is a network fault that lasts for an extended period.</p>
<p>Another potential root cause of TCP disconnections can be a <a href="https://en.wikipedia.org/wiki/Stateful_firewall">stateful firewall</a>. These devices monitor traffic on active TCP connections and will time out idle connections if no packets are sent for a configurable period, typically measured in minutes. The firewall typically does not inform the hosts using the TCP connection, so the hosts think the connection is still valid. However, when the sending host tries to transmit, the firewall will simply drop the packets, leading to the sender timing out the TCP connection and disconnecting.</p>
<p>Note that the other side of the connection often does not detect this disconnection, leading to a <a href="https://en.wikipedia.org/wiki/TCP_half-open">half-open</a> connection. For the <a class="el" href="index.html#transporttcp">TCP transport</a>, this can prevent a receiver from restarting topic resolution, which can be necessary for the receiver to recover from a temporary outage.</p>
<p>One solution to this problem is to enable TCP keepalives by setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpactivitymethodreceiver">transport_tcp_activity_method (receiver)</a> to "SO_KEEPALIVE" and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransporttcpoperation.html#transporttcpactivitytimeoutsource">transport_tcp_activity_timeout (source)</a> to a greater-than-zero value for TCP transports, and setting <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#requesttcpactivitytimeoutcontext">request_tcp_activity_timeout (context)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpunicastimmediatemessagingoperation.html#responsetcpactivitytimeoutcontext">response_tcp_activity_timeout (context)</a> to greater-than-zero values for UIMs. These keepalives prevent the firewall from timing out a quiet TCP connection, or if the connection is lost for some other reason, will inform both hosts in a timely fashion.</p>
<p><br />
 </p><hr/>
<h1><a class="anchor" id="umglossary"></a>
UM Glossary&nbsp;&nbsp;<small><a href="#umglossary">&lt;-</a></small></h1>
<p><br />
 </p>
<h2><a class="anchor" id="glossarya"></a>
Glossary A&nbsp;&nbsp;<small><a href="#glossarya">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryabi"></a></p><dl class="section user"><dt><b>ABI</b> - Application Binary Interface</dt><dd>The execution-time interfaces presented by one software system, generally in the form of a dynamic (shared) library, for use by other software systems. ABIs are generally considered to be in the realm of binary, compiled code, not source code. Two versions are considered ABI compatible if the dynamic libraries can be used interchangeably by an application without the need to rebuild or relink that application. See also <a class="el" href="index.html#glossaryapi">API</a>.</dd></dl>
<p><a class="anchor" id="glossaryack"></a></p><dl class="section user"><dt><b>ACK</b> - Acknowledge</dt><dd>Generally, a control message which acknowledges some event or condition. Within the context of Ultra Messaging, it is often used to refer to a persistence control message sent by a subscriber to the Persistent Store to indicate that it has completed processing of a given data message. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossaryace"></a></p><dl class="section user"><dt><b>ACE</b> - Access Control Entry</dt><dd>A filter specifier to control which topics are allowed to transit a <a class="el" href="index.html#umrouter">DRO</a> portal. One or more ACEs make up an Access Control List (ACL). See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterimplementation.html#accesscontrollistsacl">Access Control Lists (ACL)</a>.</dd></dl>
<p><a class="anchor" id="glossaryacl"></a></p><dl class="section user"><dt><b>ACL</b> - Access Control List</dt><dd>A method used by the <a class="el" href="index.html#umrouter">DRO</a> to control which topics are allowed to transit a DRO portal. An ACL consists of one or more Access Control Entries (ACE). See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterimplementation.html#accesscontrollistsacl">Access Control Lists (ACL)</a>.</dd></dl>
<p><a class="anchor" id="glossaryactivemq"></a></p><dl class="section user"><dt><b>ActiveMQ</b> </dt><dd>The name of an open-source JMS-oriented messaging system. The Ultra Messaging UMQ product contains an enhanced form of ActiveMQ to provide queuing semantics and a JMS API. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/index.html#umqoverview">UMQ Overview</a>.</dd></dl>
<p><a class="anchor" id="glossaryamqp"></a></p><dl class="section user"><dt><b>AMQP</b> - Advanced Message Queuing Protocol</dt><dd>An open standard messaging wire protocol. See <a href="https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol">Wikipedia's write-up</a> for more information on AMQP. The UMQ product makes use of AMQP to provide interoperability between Ultra Messaging and ActiveMQ. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/index.html#umqoverview">UMQ Overview</a>.</dd></dl>
<p><a class="anchor" id="glossaryapi"></a></p><dl class="section user"><dt><b>API</b> - Application Programming Interface</dt><dd>The callable functions, classes, methods, data formats, and structures presented by one software system for use by other software systems. APIs are generally considered to be in the realm of source code, not compiled binaries. APIs are generally documented, and can be extended from one version to the next. Two versions are considered API compatible if the application can be built against either version interchangeably without the need to modify the source code. Ultra Messaging has APIs available for the C, Java, and .NET (C#) programming languages. For example, <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/api.tag:../../API/" href="../../API/lbm_8h.html#a8058947690bd0995bc2c59d4a61b462f">lbm_context_create()</a> is part of the C API. See also <a class="el" href="index.html#glossaryabi">ABI</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryb"></a>
Glossary B&nbsp;&nbsp;<small><a href="#glossaryb">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarybos"></a></p><dl class="section user"><dt><b>BOS</b> - Beginning Of Stream</dt><dd>An event delivered to a receiver callback indicating that the link between the source and the receiver is now active. Be aware that in a deployment that includes the <a class="el" href="index.html#umrouter">DRO</a>, it may only indicate an active link between the receiver and the local router portal, not necessarily full end-to-end connectivity. See also <a class="el" href="index.html#glossaryeos">EOS</a></dd></dl>
<p><a class="anchor" id="glossarybroker"></a></p><dl class="section user"><dt><b>Broker</b> </dt><dd>A daemon which mediates the exchange of messages. In the context of Ultra Messaging, it refers to the ActiveMQ daemon which implements the queuing functionality and JMS. See <a class="el" href="index.html#queuing">Queuing</a>.</dd></dl>
<p><a class="anchor" id="glossarybusywaiting"></a></p><dl class="section user"><dt><b>Busy</b> Waiting</dt><dd>Also known as "busy looping" and "polling". A method of a thread to wait for a real-time event by testing for the event in a tight loop without giving up the CPU. Typically leads to the thread consuming 100% of a CPU core.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryc"></a>
Glossary C&nbsp;&nbsp;<small><a href="#glossaryc">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarycidr"></a></p><dl class="section user"><dt><b>CIDR</b> - Classless Inter-Domain Routing</dt><dd>Generally, CIDR refers to the division of a 32-bit IPv4 address between network and host parts. In the context of Ultra Messaging, CIDR notation can be used to ease the specification of host network interfaces. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/generalconfigurationguidelines.html#specifyinginterfaces">Specifying Interfaces</a>.</dd></dl>
<p><a class="anchor" id="glossarycontext"></a></p><dl class="section user"><dt><b>Context</b> </dt><dd>Within the context of Ultra Messaging, a context is an object which functions conceptually as an environment in which UM runs. Context is often abbreviated as "ctx". See <a class="el" href="index.html#contextobject">Context Object</a>.</dd></dl>
<p><a class="anchor" id="crybabyreceiver"></a></p><dl class="section user"><dt><b>Crybaby</b> Receiver</dt><dd>Within the context of a NAK-based protocol (like LBT-RM or LBT-RU), a crybaby receiver is one that experiences sustained loss even during periods of normal traffic load. This might be due to equipment malfunction (e.g. a lossy NIC) or software malfunction (application which can't keep up with normal traffic). See <a class="el" href="index.html#naksuppression">NAK Suppression</a>.</dd></dl>
<p><a class="anchor" id="glossaryctx"></a></p><dl class="section user"><dt><b>CTX</b> - Context</dt><dd>Within the context of Ultra Messaging, a context is an object which functions conceptually as an environment in which UM runs. See <a class="el" href="index.html#contextobject">Context Object</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryd"></a>
Glossary D&nbsp;&nbsp;<small><a href="#glossaryd">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarydbl"></a></p><dl class="section user"><dt><b>DBL</b> - Datagram Bypass Layer</dt><dd>A kernel-bypass driver that accelerates sending and receiving UDP traffic and operates with Myricom 10-Gigabit Ethernet adapter cards for Linux and Windows. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#myricomdatagrambypasslayerdbl">Myricom Datagram Bypass Layer (DBL)</a>.</dd></dl>
<p><a class="anchor" id="glossarydeafness"></a></p><dl class="section user"><dt><b>Deafness</b> </dt><dd>An informal term for a problem where a subscriber for a topic is not receiving messages sent by a publisher for that topic.</dd></dl>
<p><a class="anchor" id="glossarydeliveryconfirmation"></a></p><dl class="section user"><dt><b>Delivery</b> <b>Confirmation</b> </dt><dd>An optional event generated by a persistent subscriber's receiver and delivered to a persistent publisher's source to indicate that the subscriber has completed processing of a message. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossarydeliverycontroller"></a></p><dl class="section user"><dt><b>Delivery</b> <b>Controller</b> </dt><dd>An instance of the receive-side "topic layer" within the UM software stack. See <a class="el" href="index.html#umsoftwarestack">UM Software Stack</a>.</dd></dl>
<p><a class="anchor" id="glossarydlq"></a></p><dl class="section user"><dt><b>DLQ</b> - Dead Letter Queue</dt><dd>With queuing, the Dead Letter Queue (DLQ) is a destination for messages that cannot be delivered to a receiver. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/conceptsandfeatures.html#deadletterqueue">Dead Letter Queue</a>.</dd></dl>
<p><a class="anchor" id="glossarydro"></a></p><dl class="section user"><dt><b>DRO</b> - Dynamic Routing Option</dt><dd>The name of an Ultra Messaging option which provides routing of messages different <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs). See <a class="el" href="index.html#umrouter">DRO</a>.</dd></dl>
<p><a class="anchor" id="glossarydynamicroutingoptiondro"></a></p><dl class="section user"><dt><b>Dynamic</b> <b>Routing</b> <b>Option</b> (DRO)</dt><dd>The name of an Ultra Messaging option which provides routing of messages different <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domains</a> (TRDs). See <a class="el" href="index.html#umrouter">DRO</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossarye"></a>
Glossary E&nbsp;&nbsp;<small><a href="#glossarye">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryeos"></a></p><dl class="section user"><dt><b>EOS</b> - End Of Stream</dt><dd>An event delivered to a receiver callback indicating that the link between the source and the receiver is deleted. Be aware that in a deployment that includes the <a class="el" href="index.html#umrouter">DRO</a>, it may only indicate a deleted link between the receiver and the local router portal, not necessarily a full end-to-end link. See also <a class="el" href="index.html#glossarybos">BOS</a></dd></dl>
<p><a class="anchor" id="glossaryeventqueue"></a></p><dl class="section user"><dt><b>Event</b> <b>Queue</b> </dt><dd>Within the context of Ultra Messaging, an event queue object is a serialization queue structure and execution thread for delivery of other objects' events. Event queue is often abbreviated as "evq". See <a class="el" href="index.html#eventqueueobject">Event Queue Object</a>.</dd></dl>
<p><a class="anchor" id="glossaryevq"></a></p><dl class="section user"><dt><b>EVQ</b> - Event Queue</dt><dd>Within the context of Ultra Messaging, an event queue object is a serialization queue structure and execution thread for delivery of other objects' events. See <a class="el" href="index.html#eventqueueobject">Event Queue Object</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryf"></a>
Glossary F&nbsp;&nbsp;<small><a href="#glossaryf">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryflightsize"></a></p><dl class="section user"><dt><b>Flight</b> <b>Size</b> </dt><dd>The number of messages that a persistent publisher can have outstanding that are not stable. A persistent publisher generally limits the number of unstable messages it can have outstanding, and may block further attempts to send until some outstanding messages become stable. See <a class="el" href="index.html#persistence">Persistence</a>. See also <a class="el" href="index.html#glossarystability">Stability</a>.</dd></dl>
<p><a class="anchor" id="glossaryfragmentation"></a></p><dl class="section user"><dt><b>Fragmentation</b> <b>Size</b> </dt><dd>The splitting of a large application message into multiple pieces. There are two forms of fragmentation: <a class="el" href="index.html#glossaryumfragmentation">UM fragmentation</a> (done by UM) and <a class="el" href="index.html#glossaryipfragmentation">IP fragmentation</a> (done by the operating system). See <a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryg"></a>
Glossary G&nbsp;&nbsp;<small><a href="#glossaryg">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarygateway"></a></p><dl class="section user"><dt><b>Gateway</b> </dt><dd>An early version of a message router, replaced as of version 6.10 with the <a class="el" href="index.html#umrouter">DRO</a>. See <a class="el" href="index.html#glossarydynamicroutingoptiondro">Dynamic Routing Option (DRO)</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryh"></a>
Glossary H&nbsp;&nbsp;<small><a href="#glossaryh">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryhf"></a></p><dl class="section user"><dt><b>HF</b> - Hot Failover</dt><dd>A form of redundancy in which multiple instances of a publisher send the same messages at the same time to subscribers, which select for application delivery the first copy received. If one publisher instance fails, the subscribers are able to continue operation receiving from the remaining publisher. See <a class="el" href="index.html#hotfailoverhf">Hot Failover (HF)</a>.</dd></dl>
<p><a class="anchor" id="glossaryhfx"></a></p><dl class="section user"><dt><b>HFX</b> - Hot Failover eXtended</dt><dd>An extended form of Hot Failover. Note: HFX is deprecated. See <a class="el" href="index.html#hotfailoveracrossmultiplecontexts">Hot Failover Across Multiple Contexts (HFX)</a>.</dd></dl>
<p><a class="anchor" id="glossaryhrt"></a></p><dl class="section user"><dt><b>HRT</b> - High Resolution Timestamp</dt><dd>A feature that leverages the hardware timestamping function of certain network interface cards to measure sub-microsecond times that packets are transmitted and received. See <a class="el" href="index.html#highresolutiontimestamps">High-resolution Timestamps</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryi"></a>
Glossary I&nbsp;&nbsp;<small><a href="#glossaryi">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryipfragmentation"></a></p><dl class="section user"><dt><b>IP</b> <b>Fragmentation</b> </dt><dd>The Operating System function of splitting UDP datagrams into <a href="https://en.wikipedia.org/wiki/Maximum_transmission_unit">MTU-sized</a> packets. See <a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a>.</dd></dl>
<p><a class="anchor" id="glossaryipc"></a></p><dl class="section user"><dt><b>IPC</b> - InterProcess Communication</dt><dd>Generally, the term simply refers to any of several mechanisms by which an operating system allows processes to communicate or share data. Within the context of Ultra Messaging, LBT-IPC specifically refers to the shared memory transport type. A source configured for LBT-IPC can only pass messages to receivers running on the same machine (or virtual machine). See <a class="el" href="index.html#transportlbtipc">Transport LBT-IPC</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryj"></a>
Glossary J&nbsp;&nbsp;<small><a href="#glossaryj">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryjitter"></a></p><dl class="section user"><dt><b>Jitter</b> </dt><dd>The amount of variation from the average, usually latency. High jitter can either mean frequent small variations, or infrequent large variations. Large latency outliers are undesirable, even if rare.</dd></dl>
<p><a class="anchor" id="glossaryjms"></a></p><dl class="section user"><dt><b>JMS</b> - Java Message Service</dt><dd>A standardized API for Java applications to send and receive messages. Ultra Messaging's UMQ product allows limited interoperability between applications using UM and applications using JMS. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/index.html#jms">JMS</a>.</dd></dl>
<p><a class="anchor" id="glossaryjni"></a></p><dl class="section user"><dt><b>JNI</b> - Java Native Interface</dt><dd>A method by which Java code can invoke code written in C.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryk"></a>
Glossary K&nbsp;&nbsp;<small><a href="#glossaryk">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarykernelbypass"></a></p><dl class="section user"><dt><b>Kernel-Bypass</b> <b>Driver</b> </dt><dd>A device driver software package, normally supplied by a hardware vendor, which provides a user-space library and API for accessing the hardware without transitioning into the kernel. Some examples: Solarflare's Onload driver, Myricom's DBL driver, Cisco's "ExaSOCK" driver, Voltaire's VMA driver. See <a class="el" href="index.html#datagrammaxsizeandnetworkmtu">Datagram Max Size and Network MTU</a> for related information.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryl"></a>
Glossary L&nbsp;&nbsp;<small><a href="#glossaryl">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarylbm"></a></p><dl class="section user"><dt><b>LBM</b> - Latency Busters Messaging</dt><dd>An old name of the Ultra Messaging product line. Superseded by UM. "LBM" is sometimes used to refer to the streaming product. That use is superseded by "UMS". The abbreviation "lbm" lives on in various parts of the UM API, and was kept for backwards compatibility.</dd></dl>
<p><a class="anchor" id="glossarylbt"></a></p><dl class="section user"><dt><b>LBT</b> - Latency Busters Transport</dt><dd>Usually used as a prefix for a specific transport type: LBT-RM, LBT-RU, LBT-IPC, and LBT-SMX. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grpmajoroptions.html#transportsource">transport (source)</a>.</dd></dl>
<p><a class="anchor" id="glossarylj"></a></p><dl class="section user"><dt><b>LJ</b> - Late Join</dt><dd>A function by which a subscriber can create a receiver for a topic, and is able to retrieve one or more messages sent to that topic prior to the receiver being created. See <a class="el" href="index.html#latejoin">Late Join</a>.</dd></dl>
<p><a class="anchor" id="glossaryljir"></a></p><dl class="section user"><dt><b>LJIR</b> - Late Join Information Request</dt><dd>A type of control message sent by a receiver to a source to request an Late Join Information control message. See <a class="el" href="index.html#latejoin">Late Join</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossarym"></a>
Glossary M&nbsp;&nbsp;<small><a href="#glossarym">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarymim"></a></p><dl class="section user"><dt><b>MIM</b> - Multicast Immediate Message</dt><dd>Alternate send method which makes use of a pre-configured LBT-RM transport which is shared by all like-configured applications. The "immediate" means that messages may be sent to arbitrary topic names without the creation of source objects. See <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>. See also <a class="el" href="index.html#glossaryuim">glossaryuim</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryn"></a>
Glossary N&nbsp;&nbsp;<small><a href="#glossaryn">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarynak"></a></p><dl class="section user"><dt><b>NAK</b> - Negative AcKnowledgement</dt><dd>A type of control message sent by a receiver using LBT-RM or LBT-RU transports. Sent when packet loss causes a sequence number gap in received messages, the NAKs specify which sequence numbers are missing and request retransmission. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html">Transport LBT-RM Reliability Options</a>.</dd></dl>
<p><a class="anchor" id="glossarynat"></a></p><dl class="section user"><dt><b>NAT</b> - Network Address Translation</dt><dd>A function of a network device (typically a router or firewall) that modifies packet headers' IP addresses and ports to enable communication between networks using different address spaces. We recommend using a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterimplementation.html#dronattransit">pair of DROs</a> to transit a NAT router, but you can also <a class="el" href="index.html#networkaddresstranslationnat">use an lbmrd</a>.</dd></dl>
<p><a class="anchor" id="glossaryncf"></a></p><dl class="section user"><dt><b>NCF</b> - NAK ConFirmation</dt><dd>A type of control message sent by a source using LBT-RM transport. The LBT-RM protocol requires a source send an NCF if it receives a NAK for which it is not willing to send a re-transmission. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmreliability.html#lbtrmsourceignoringnaksforefficiency">LBT-RM Source Ignoring NAKs for Efficiency</a>.</dd></dl>
<p><a class="anchor" id="glossarynakstorm"></a></p><dl class="section user"><dt><b>NAK</b> <b>Storm</b> </dt><dd>A network condition in which packet loss triggers packet recovery operations for a NAK-based protocol (like LBT-RM and LBT-RU), and the packet recovery operations themselves induce further packet loss. This can lead to a self-reinforcing feedback loop in which the packet recovery operations trap the protocol in an unbounded loss condition. See <a class="el" href="index.html#whatisanakstorm">What Is a NAK Storm?</a> for details and prevention.</dd></dl>
<p><a class="anchor" id="glossarynic"></a></p><dl class="section user"><dt><b>NIC</b> - Network Interface Card</dt><dd>A part of a computer which connects to one or more network cables and provides packet-level communication to the operating system.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryo"></a>
Glossary O&nbsp;&nbsp;<small><a href="#glossaryo">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryonload"></a></p><dl class="section user"><dt><b>Onload</b> </dt><dd>A kernel-bypass driver that accelerates sending and receiving network traffic and operates with Solarflare Ethernet adapter cards for Linux. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#solarflareonload">Solarflare Onload</a>.</dd></dl>
<p><a class="anchor" id="glossaryopenonload"></a></p><dl class="section user"><dt><b>OpenOnload</b> </dt><dd>The <a href="https://github.com/Xilinx-CNS/onload">open-source version</a> of Onload, a kernel-bypass driver that accelerates sending and receiving network traffic and operates with Solarflare Ethernet adapter cards for Linux. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#solarflareonload">Solarflare Onload</a>.</dd></dl>
<p><a class="anchor" id="glossaryopenssl"></a></p><dl class="section user"><dt><b>OpenSSL</b> - Open Secure Sockets Layer</dt><dd>A library which provides encryption services. OpenSSL is used by Ultra Messaging's encryption feature. See <a href="https://www.openssl.org">https://www.openssl.org</a> for general information about OpenSSL. See <a class="el" href="index.html#encryptedtcp">Encrypted TCP</a> for information about Ultra Messaging's encryption feature.</dd></dl>
<p><a class="anchor" id="glossaryotid"></a></p><dl class="section user"><dt><b>OTID</b> - Originating Transport IDentifier</dt><dd>Control information which uniquely identifies a source object within a UM network. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/umrouterconcepts.html#moreaboutproxysourcesandreceivers">More About Proxy Sources and Receivers</a>.</dd></dl>
<p><a class="anchor" id="glossaryotr"></a></p><dl class="section user"><dt><b>OTR</b> - Off-Transport Recovery</dt><dd>A method by which are lost and are not recoverable by the source transport can be recovered by UIMs using a method similar to Late Join. See <a class="el" href="index.html#offtransportrecoveryotr">Off-Transport Recovery (OTR)</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryp"></a>
Glossary P&nbsp;&nbsp;<small><a href="#glossaryp">&lt;-</a></small></h2>
<p><a class="anchor" id="pacing"></a></p><dl class="section user"><dt><b>Pacing</b> </dt><dd>In messaging, pacing refers to the method by which the send rate is controlled (or not controlled). In general, there is "source pacing", where the source determines the rate of message transmission, or "receiver pacing", where the slowest receiver of a source can limit the rate of message transmission. See <a class="el" href="index.html#transportpacing">Transport Pacing</a>.</dd></dl>
<p><a class="anchor" id="glossarypcre"></a></p><dl class="section user"><dt><b>PCRE</b> - Perl Compatible Regular Expressions</dt><dd>An open-source library which closely implements the Perl 5 regular expression language. UM uses PCRE for wildcard receiver pattern matching. See <a href="https://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions">Wikipedia's write-up</a> for information on PCRE. See also <a class="el" href="index.html#umwildcardreceivers">UM Wildcard Receivers</a>.</dd></dl>
<p><a class="anchor" id="glossarypdm"></a></p><dl class="section user"><dt><b>PDM</b> - Pre-Defined Messages</dt><dd>A message encoding scheme based on integer field identifiers for structured messages can be assembled and sent by applications. Includes field types and performs data marshaling across different CPU architectures. See <a class="el" href="index.html#predefinedmessages">Pre-Defined Messages</a>. See also <a class="el" href="index.html#glossarysdm">SDM</a>.</dd></dl>
<p><a class="anchor" id="glossarypersistence"></a></p><dl class="section user"><dt><b>Persistence</b> </dt><dd>One of the basic <a class="el" href="index.html#messagingparadigms">Messaging Paradigms</a> supported by UM (the other two are <a class="el" href="index.html#glossarystreaming">Streaming</a> and <a class="el" href="index.html#glossaryqueuing">Queuing</a>). Persistence, sometimes called "durable" or "guaranteed" messages, saves messages sent by a publisher in non-volatile storage so that subscribers can recover missed messages under a variety of failure scenarios. If multiple subscribers exist for the same topic, each subscriber will get all messages sent by the publisher. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossarypgm"></a></p><dl class="section user"><dt><b>PGM</b> - Pragmatic General Multicast</dt><dd>A standards-based protocol for reliable multicast. Ultra Messaging's "LBT-RM" protocol is inspired by PGM. See <a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a> for a list of differences between LBT-RM and PGM..</dd></dl>
<p><a class="anchor" id="glossarypinning"></a></p><dl class="section user"><dt><b>Pinning</b> </dt><dd>To achieve the highest performance, users should make use of "core pinning", also called "task setting" or "setting thread affinity". This is where time-critical threads are assigned to execute on a specific set of one or more CPU cores. Without pinning, the operating system will sometimes migrate a thread from one NUMA zone to another. This introduces significant latency and jitter. Core pinning prevents this from happening. See <a class="el" href="index.html#corepinning">Core Pinning</a>.</dd></dl>
<p><a class="anchor" id="glossaryportal"></a></p><dl class="section user"><dt><b>Portal</b> </dt><dd>An interface to the <a class="el" href="index.html#umrouter">DRO</a>. A DRO portal can either be an endpoint portal (interfaces with a Topic Resolution Domain), or a peer portal (interfaces with another DRO). See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/gateway.tag:../../Gateway/" href="../../Gateway/droarchitecture.html#umrouterportals">DRO Portals</a>.</dd></dl>
<p><a class="anchor" id="glossaryptp"></a></p><dl class="section user"><dt><b>PTP</b> - Precision Time Protocol</dt><dd>A protocol used to synchronize clocks throughout a computer network. Used by some NICs to synchronize host clocks (e.g. Solarflare). See <a href="https://en.wikipedia.org/wiki/Precision_Time_Protocol">Wikipedia's write-up</a> for more information.</dd></dl>
<p><a class="anchor" id="glossarypubsub"></a></p><dl class="section user"><dt><b>Pub/Sub</b> - Publish / Subscribe</dt><dd>A model of messaging passing in which the publisher (sender) does not keep track of the subscribers (intended recipients) of messages. Instead, the messages carry metadata (topic name) in which the subscribers express interest, and the underlying messaging software forwards messages to the subscribers based on that interest.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryq"></a>
Glossary Q&nbsp;&nbsp;<small><a href="#glossaryq">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryqueuing"></a></p><dl class="section user"><dt><b>Queuing</b> </dt><dd>One of the basic <a class="el" href="index.html#messagingparadigms">Messaging Paradigms</a> supported by UM (the other two are <a class="el" href="index.html#glossarystreaming">Streaming</a> and <a class="el" href="index.html#glossarypersistence">Persistence</a>). Queuing supports "load balancing" whereby published messages can be distributed across a set of subscribers such each message is only handled by one of the subscribers. See <a class="el" href="index.html#queuing">Queuing</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryr"></a>
Glossary R&nbsp;&nbsp;<small><a href="#glossaryr">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryrcv"></a></p><dl class="section user"><dt><b>RCV</b> - Receiver</dt><dd>Within the context of Ultra Messaging, a receiver is an object used to subscribe to a topic. "Receiver" is sometimes used to refer generally to an entire subscribing application. See <a class="el" href="index.html#receiverobject">Receiver Object</a>. See also <a class="el" href="index.html#glossarywildcardreceiver">Wildcard Receiver</a>.</dd></dl>
<p><a class="anchor" id="glossaryreceiver"></a></p><dl class="section user"><dt><b>Receiver</b> </dt><dd>Within the context of Ultra Messaging, a receiver is an object used to subscribe to a topic. "Receiver" is sometimes used to refer generally to an entire subscribing application. Receiver is often abbreviated as "rcv". See <a class="el" href="index.html#receiverobject">Receiver Object</a>. See also <a class="el" href="index.html#glossarywildcardreceiver">Wildcard Receiver</a>.</dd></dl>
<p><a class="anchor" id="glossaryregistration"></a></p><dl class="section user"><dt><b>Registration</b> </dt><dd>When a publisher creates a persistent source, that source must register with the configured persistent Stores before it can start sending messages. This registration prepares the persistent Store and the source to cooperate in the transfer of persisted messages. Likewise, when a subscriber creates a persistent receiver, that receiver must register with the configured persistent Stores before it can start receiving messages. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossaryrequestport"></a></p><dl class="section user"><dt><b>Request</b> <b>Port</b> </dt><dd>Also known as "UIM Port". TCP port that a context listens to for incoming UIM traffic. See <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> for general information on UIM.</dd></dl>
<p><a class="anchor" id="glossaryrm"></a></p><dl class="section user"><dt><b>RM</b> - Reliable Multicast</dt><dd>A shortening of "LBT-RM". The Ultra Messaging protocol and implementation in which user messages sent via Multicast UDP are monitored for loss, and retransmissions are arranged to recover loss. See <a class="el" href="index.html#transportlbtrm">Transport LBT-RM</a>.</dd></dl>
<p><a class="anchor" id="glossaryrpp"></a></p><dl class="section user"><dt><b>RPP</b> - Receiver-Paced Persistence.</dt><dd>A form of persistence in which a publisher can be blocked from sending if receivers are having trouble keeping up with the message rate. See <a class="el" href="index.html#persistence">Persistence</a>. See also <a class="el" href="index.html#glossaryspp">SPP</a>.</dd></dl>
<p><a class="anchor" id="glossaryrouter"></a></p><dl class="section user"><dt><b>Router</b> </dt><dd>Within the context of Ultra Messaging, "\ref umrouter" generally refers to the daemon within the <a class="el" href="index.html#umrouter">DRO</a>. See <a class="el" href="index.html#glossarydynamicroutingoptiondro">Dynamic Routing Option (DRO)</a>.</dd></dl>
<p><a class="anchor" id="glossaryrsa"></a></p><dl class="section user"><dt><b>RSA</b> - Rivest, Shamir, and Aleman</dt><dd>A public-key cryptosystem developed by Ron Rivest, Adi Shamir, and Leonard Adleman. Included in the OpenSSL library used by Ultra Messaging's encryption feature. See <a class="el" href="index.html#encryptedtcp">Encrypted TCP</a>.</dd></dl>
<p><a class="anchor" id="glossaryru"></a></p><dl class="section user"><dt><b>RU</b> - Reliable Unicast</dt><dd>A shortening of "LBT-RU". The Ultra Messaging protocol and implementation in which user messages sent via Unicast (point-to-point) UDP are monitored for loss, and retransmissions are arranged to recover loss. See <a class="el" href="index.html#transportlbtru">Transport LBT-RU</a>.</dd></dl>
<p><a class="anchor" id="glossaryrx"></a></p><dl class="section user"><dt><b>RX</b> - Re-transmission</dt><dd>Depending on the context, RX can either mean the messages retransmitted by the LBT-RM and LBT-RU transport protocols (e.g. in transport statistics), or it can mean the messages recovered via the Persistent Store or Late Join.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossarys"></a>
Glossary S&nbsp;&nbsp;<small><a href="#glossarys">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarysdm"></a></p><dl class="section user"><dt><b>SDM</b> - Self-Describing Messages</dt><dd>A message encoding scheme based on keyword-value pairs for structured messages can be assembled and sent by applications. Includes field types and performs data marshaling across different CPU architectures. See <a class="el" href="index.html#selfdescribingmessaging">Self Describing Messaging</a>. See also <a class="el" href="index.html#glossarypdm">PDM</a>.</dd></dl>
<p><a class="anchor" id="glossarysir"></a></p><dl class="section user"><dt><b>SIR</b> - Source Information Record</dt><dd>A type of control message used by the SRS to advertise sources to contexts. See <a class="el" href="index.html#tcpbasedtopicresolutiondetails">TCP-Based Topic Resolution Details</a>.</dd></dl>
<p><a class="anchor" id="glossarysm"></a></p><dl class="section user"><dt><b>SM</b> - Session Message</dt><dd>A type of control message used by the LBT-RM protocol to keep a Transport Session alive. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportlbtrmoperation.html">Transport LBT-RM Operation Options</a>.</dd></dl>
<p><a class="anchor" id="glossarysnmp"></a></p><dl class="section user"><dt><b>SNMP</b> - Simple Network Management Protocol</dt><dd>A standardized protocol by which computers and network equipment can be monitored and managed from a central point (management station). SNMP is also the name of an Ultra Messaging option which makes UM application usage statistics available for monitoring by a standard SNMP management station.</dd></dl>
<p><a class="anchor" id="glossarysource"></a></p><dl class="section user"><dt><b>Source</b> </dt><dd>Within the context of Ultra Messaging, a source is an object used to send messages to a topic. "Source" is sometimes used to refer generally to an entire publishing application. Source is often abbreviated as "src". See <a class="el" href="index.html#sourceobject">Source Object</a>.</dd></dl>
<p><a class="anchor" id="glossaryspp"></a></p><dl class="section user"><dt><b>SPP</b> - Source-Paced Persistence.</dt><dd>A form of persistence in which a publisher is allowed to continue sending at its natural rate, even if one or more receivers are falling behind to the point that the message repository's oldest messages are overwritten, leading to unrecoverable loss. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossarysrc"></a></p><dl class="section user"><dt><b>SRC</b> - Source</dt><dd>Within the context of Ultra Messaging, a source is an object used to send messages to a topic. "Source" is sometimes used to refer generally to an entire publishing application. See <a class="el" href="index.html#sourceobject">Source Object</a>.</dd></dl>
<p><a class="anchor" id="glossarysrs"></a></p><dl class="section user"><dt><b>SRS</b> - Stateful Resolver Service</dt><dd>A daemon which provides TCP-based Topic Resolution. See <a class="el" href="index.html#topicresolutiondescription">Topic Resolution Description</a>.</dd></dl>
<p><a class="anchor" id="glossarysri"></a></p><dl class="section user"><dt><b>SRI</b> - Source Registration Information</dt><dd>A type of control message used to communicate persistence information between persistent publishers and subscribers. A subscriber of persistent messages needs an SRI to successfully register with a persistent Store. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossarystability"></a></p><dl class="section user"><dt><b>Stability</b> </dt><dd>The state that a persistent publisher's sent message has been successfully persisted in the persistent Store. In the time between message transmission and message stability, the message is at risk of being lost. The term is also used to refer to the source event delivered to a publishing application to indicate a message's stability. See <a class="el" href="index.html#persistence">Persistence</a>. See also <a class="el" href="index.html#glossaryflightsize">Flight Size</a>.</dd></dl>
<p><a class="anchor" id="glossarystore"></a></p><dl class="section user"><dt><b>Store</b> </dt><dd>A shortening of "persistent Store". An Ultra Messaging component which works with persistent sources and receivers to record messages, and also deliver previously-recorded messages for recovery. The UMP and UMQ products include the persistent Store; the UMS product does not. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossarystreaming"></a></p><dl class="section user"><dt><b>Streaming</b> </dt><dd>One of the basic <a class="el" href="index.html#messagingparadigms">Messaging Paradigms</a> supported by UM (the other two are <a class="el" href="index.html#glossarypersistence">Persistence</a> and <a class="el" href="index.html#glossaryqueuing">Queuing</a>). Streaming requires that the publisher and subscriber be running at the same time for messages to be delivered. Messages are not saved to non-volatile storage. If multiple subscribers exist for the same topic, each subscriber will get all messages sent by the publisher. See <a class="el" href="index.html#streaming">Streaming</a>.</dd></dl>
<p><a class="anchor" id="glossarystrongregid"></a></p><dl class="section user"><dt><b>Strong</b> RegID</dt><dd>When Persistence is configured with a non-zero activity timeout, the Store prevents simultaneous use of a registration ID by two processes. The registration ID is said to be "strong". See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/persistencefaulttolerance.html#activitytimeoutandstatelifetimes">Activity Timeout and State Lifetimes</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryt"></a>
Glossary T&nbsp;&nbsp;<small><a href="#glossaryt">&lt;-</a></small></h2>
<p><a class="anchor" id="glossarytir"></a></p><dl class="section user"><dt><b>TIR</b> - Topic Information Record</dt><dd>A type of topic resolution control message used by a source to advertise its details. Subscribers use TIRs to discover and connect to sources of interest. See <a class="el" href="index.html#topicresolutionoverview">Topic Resolution Overview</a>.</dd></dl>
<p><a class="anchor" id="glossarytopicless"></a></p><dl class="section user"><dt><b>Topicless</b> </dt><dd>Related to <a class="el" href="index.html#immediatemessaging">Immediate Messaging</a>, a "topicless" message is one that has no topic associated with it.</dd></dl>
<p><a class="anchor" id="glossarytnwg"></a></p><dl class="section user"><dt><b>TNWG</b> - Twenty Nine West Gateway</dt><dd>A historic name for the <a class="el" href="index.html#umrouter">DRO</a>. The name was changed to DRO in UM version 6.0, but the older name of the executable file (<code>tnwgd</code>) was retained for backwards compatibility.</dd></dl>
<p><a class="anchor" id="glossarytqr"></a></p><dl class="section user"><dt><b>TQR</b> - Topic Query Record</dt><dd>A type of topic resolution control message used by a receiver to discover sources of interest. Publishers use TQRs to trigger the sending of TIRs. See <a class="el" href="index.html#topicresolutionoverview">Topic Resolution Overview</a>.</dd></dl>
<p><a class="anchor" id="glossarytr"></a></p><dl class="section user"><dt><b>TR</b> - Topic Resolution</dt><dd>The protocol used by Ultra Messaging components to exchange information about available topics and topic interest. See <a class="el" href="index.html#topicresolutionoverview">Topic Resolution Overview</a>. See also <a class="el" href="index.html#glossarytir">TIR</a> and <a class="el" href="index.html#glossarytqr">TQR</a>.</dd></dl>
<p><a class="anchor" id="glossarytransportsession"></a></p><dl class="section user"><dt><b>Transport</b> <b>Session</b> </dt><dd>A specific run-time instance of a transport type to carry application messages. The <a class="el" href="index.html#transportsessions">Transport Session</a> can be thought of as a communications channel. As a publishing application creates sources, it maps those sources onto Transport Sessions. A Transport Session is fairly resource-intensive, so it is frequently the case that many sources are mapped to each Transport Session.</dd></dl>
<p><a class="anchor" id="glossarytrd"></a></p><dl class="section user"><dt><b>TRD</b> - Topic Resolution Domain</dt><dd>A group of Ultra Messaging applications and UM components which communicate with each other directly, not through a <a class="el" href="index.html#umrouter">DRO</a>. Specifically, it refers to those applications and components which directly exchange Topic Resolution control messages. Applications in different TRDs are not able to communicate with each other unless one or more DROs are used to interconnect the TRDs. See <a class="el" href="index.html#topicresolutiondomain">Topic Resolution Domain</a>.</dd></dl>
<p><a class="anchor" id="glossarytsni"></a></p><dl class="section user"><dt><b>TSNI</b> - Topic Sequence Number Information</dt><dd>A type of control message sent by a source to assist in the detection and recovery from certain types of packet loss. See <a class="el" href="index.html#lossdetectionusingtsnis">Loss Detection Using TSNIs</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryu"></a>
Glossary U&nbsp;&nbsp;<small><a href="#glossaryu">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryuim"></a></p><dl class="section user"><dt><b>UIM</b> - Unicast Immediate Message</dt><dd>Alternate send method which makes use of pre-configured TCP transports. The "immediate" means that messages may be sent to arbitrary topic names without the creation of source objects. Sending a UIM bypasses Topic Resolution, so the calling application must specify the address information for the intended recipient. Because of this, the UIM feature is rarely used directly by user applications. However, Ultra Messaging uses UIMs internally for many of its control messages. See <a class="el" href="index.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>. See also <a class="el" href="index.html#glossarymim">glossarymim</a>.</dd></dl>
<p><a class="anchor" id="glossaryuimport"></a></p><dl class="section user"><dt><b>UIM</b> <b>Port</b> - Unicast Immediate Messaging Port</dt><dd>Also known as "Request Port". TCP port that a context listens to for incoming UIM traffic. See <a class="el" href="index.html#unicastimmediatemessaging">Unicast Immediate Messaging</a> for general information on UIM.</dd></dl>
<p><a class="anchor" id="glossaryulb"></a></p><dl class="section user"><dt><b>ULB</b> - Ultra Load Balance</dt><dd>A feature of the Ultra Messaging UMQ product which provides a limited subset of queuing semantics without the use of a central message broker. ULB is generally used to provide high-speed load balancing of UM messages. In the Pub/Sub model, if multiple subscribers create receivers for the same topic, each subscriber will receive a copy of every message sent. In the Queuing model, the messages are <em>distributed</em> to the multiple subscribers, with each message only being acted on by one of those subscribers. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/umq.tag:../../UMQ/" href="../../UMQ/ultraloadbalancingulb.html">Ultra Load Balancing (ULB)</a>.</dd></dl>
<p><a class="anchor" id="glossaryum"></a></p><dl class="section user"><dt><b>UM</b> - Ultra Messaging</dt><dd>The name of the Informatica messaging middleware product line. UM is based on the pub/sub model of message passing, which allows the components of distributed applications to communicate. Note that Ultra Messaging is registered trademark of Informatica, LLC.</dd></dl>
<p><a class="anchor" id="glossaryumfragmentation"></a></p><dl class="section user"><dt><b>UM</b> <b>Fragmentation</b> </dt><dd>The UM function of splitting large application messages into datagrams. See <a class="el" href="index.html#messagefragmentationandreassembly">Message Fragmentation and Reassembly</a>.</dd></dl>
<p><a class="anchor" id="glossaryumrouter"></a></p><dl class="section user"><dt><b>UM</b> <b>Router</b> </dt><dd>Within the context of Ultra Messaging, "\ref umrouter" generally refers to the daemon within the <a class="el" href="index.html#umrouter">DRO</a>. See <a class="el" href="index.html#glossarydynamicroutingoptiondro">Dynamic Routing Option (DRO)</a>.</dd></dl>
<p><a class="anchor" id="glossaryumcache"></a></p><dl class="section user"><dt><b>UMCache</b> - Ultra Messaging Cache</dt><dd>The name of an Ultra Messaging option which provides a limited degree of message storage and retrieval.</dd></dl>
<p><a class="anchor" id="glossaryumds"></a></p><dl class="section user"><dt><b>UMDS</b> - Ultra Messaging Desktop Services</dt><dd>The name of an Ultra Messaging option which consists of a server daemon and a set of client libraries which provides simplified access to an Ultra Messaging network.</dd></dl>
<p><a class="anchor" id="glossaryume"></a></p><dl class="section user"><dt><b>UME</b> - Ultra Messaging, Enterprise edition</dt><dd>An old name of the UMP product. Superseded by UMP. The abbreviation "ume" lives on in various parts of the UM API, and was kept for backwards compatibility.</dd></dl>
<p><a class="anchor" id="glossaryumm"></a></p><dl class="section user"><dt><b>UMM</b> - Ultra Messaging Manager</dt><dd>A component of UM which allows users to centrally edit, store, and distribute configuration information to distributed applications. NOTE: this component is deprecated as of UM version 6.17 and will be removed from a future release. See the <a href="../../UMM/index.html">UM Manager Guide</a>.</dd></dl>
<p><a class="anchor" id="glossaryump"></a></p><dl class="section user"><dt><b>UMP</b> - Ultra Messaging, Persistence edition</dt><dd>An Ultra Messaging product which supports message <a class="el" href="index.html#streaming">Streaming</a> and <a class="el" href="index.html#persistence">Persistence</a>. The term is sometimes used to refer specifically to the persistence function. See <a class="el" href="index.html#persistence">Persistence</a>.</dd></dl>
<p><a class="anchor" id="glossaryumq"></a></p><dl class="section user"><dt><b>UMQ</b> - Ultra Messaging, Queuing edition</dt><dd>An Ultra Messaging product which supports message <a class="el" href="index.html#streaming">Streaming</a>, <a class="el" href="index.html#persistence">Persistence</a>, and <a class="el" href="index.html#queuing">Queuing</a>. The term is sometimes used to refer specifically to the queuing function. See <a class="el" href="index.html#queuing">Queuing</a>.</dd></dl>
<p><a class="anchor" id="glossaryums"></a></p><dl class="section user"><dt><b>UMS</b> - Ultra Messaging, Streaming edition</dt><dd>An Ultra Messaging product which supports message <a class="el" href="index.html#streaming">Streaming</a>. The term is sometimes used to refer specifically to the streaming function.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryv"></a>
Glossary V&nbsp;&nbsp;<small><a href="#glossaryv">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryvma"></a></p><dl class="section user"><dt><b>VMA</b> - Voltaire Messaging Accelerator</dt><dd>A kernel-bypass driver that accelerates sending and receiving UDP traffic and operates with Mellanox 10-Gigabit Ethernet and Infiniband adapter cards for Linux. (The software used to be owned by a company called Voltaire, which was acquired by Mellanox.) See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/config.tag:../../Config/" href="../../Config/grptransportacceleration.html#mellanoxudacceleration">UD Acceleration for Mellanox Hardware Interfaces</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryw"></a>
Glossary W&nbsp;&nbsp;<small><a href="#glossaryw">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryweakregid"></a></p><dl class="section user"><dt><b>Weak</b> RegID</dt><dd>When Persistence is configured with a zero activity timeout, the Store does not prevent simultaneous use of a registration ID by two processes. The registration ID is said to be "weak". See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.17_RC3/doc/Design/ume.tag:../../UME/" href="../../UME/persistencefaulttolerance.html#activitytimeoutandstatelifetimes">Activity Timeout and State Lifetimes</a>.</dd></dl>
<p><a class="anchor" id="glossarywildcardreceiver"></a></p><dl class="section user"><dt><b>Wildcard</b> <b>Receiver</b> </dt><dd>An object created by an application using the UM API to subscribe to a group of topics based on a Regular Expression pattern match. See <a class="el" href="index.html#umwildcardreceivers">UM Wildcard Receivers</a>. See also <a class="el" href="index.html#glossarypcre">PCRE</a>. See also <a class="el" href="index.html#glossaryreceiver">Receiver</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryx"></a>
Glossary X&nbsp;&nbsp;<small><a href="#glossaryx">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryxsp"></a></p><dl class="section user"><dt><b>XSP</b> - Transport Services Provider</dt><dd>An object created by a subscribing application to control the threading of message reception. See <a class="el" href="index.html#transportservicesproviderobject">Transport Services Provider Object</a>.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="glossaryz"></a>
Glossary Z&nbsp;&nbsp;<small><a href="#glossaryz">&lt;-</a></small></h2>
<p><a class="anchor" id="glossaryzod"></a></p><dl class="section user"><dt><b>ZOD</b> - Zero Object Delivery</dt><dd>Feature which allows a Java or .NET subscribers to have received messages delivered without per-message object creation. This is more efficient than creating objects with each received message, and also avoids garbage collection. See <a class="el" href="index.html#zeroobjectdelivery">Zero Object Delivery</a>.</dd></dl>
<p><br />
<br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Concepts Guide: Manpage for lbmrd</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Concepts Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('manpageforlbmrd.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Manpage for lbmrd </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Help for the lbmrd command line can be obtained by entering "lbmrd -h". Help for the lbmrd configuration file can be obtained by entering "lbmrd -d".</p>
<p><br />
 </p>
<h1><a class="anchor" id="lbmrdcommandline"></a>
lbmrd Command Line</h1>
<pre class="fragment">lbmrd [options] [config-file]
  -a, --activity=IVL    interval between client activity checks (in milliseconds)(default 60000)
  -d, --dump-dtd        dump the configuration DTD to stdout and exit
  -h, --help            display this help and exit
  -i, --interface=ADDR  listen for unicast topic resolution messages on interface ADDR
  -L, --logfile=FILE    use FILE as the log file
  -p, --port=PORT       use UDP port PORT for topic resolution messages (default 15380)
  -t, --ttl=TTL         use client time-to-live of TTL seconds (default 60)
  -r, --rcv-buf=SIZE    set the receive buffer to SIZE bytes.
  -s, --snd-buf=SIZE    set the send buffer to SIZE bytes.
  -v, --validate        validate config-file then exit
</pre><dl class="section user"><dt><b>Description</b> </dt><dd>Resolver services for UM messaging products are provided by lbmrd. </dd></dl>
<dl class="section user"><dt></dt><dd>The <code>-i</code> and <code>-p</code> (or <code>--interface</code> and <code>--port</code>) options identify the network interface IP address and port that lbmrd opens to listen for unicast topic resolution traffic. The defaults are INADDR_ANY and 15380, respectively. Specified either as dotted numeric IP address, or DNS host name. </dd></dl>
<dl class="section user"><dt></dt><dd>The <code>-a</code> and <code>-t</code> (or <code>--activity</code> and <code>--ttl</code>) options interact to detect and remove "dead" clients, i.e., UMS/UME client applications that are in the lbmrd active client list, but have stopped sending topic resolution queries, advertisements, or keepalives, usually due to early termination or looping. These are described in detail below. </dd></dl>
<dl class="section user"><dt></dt><dd>Option <code>-t</code> describes the length of time (in seconds), during which no messages have been received from a given client, that will cause that client to be marked "dead" and removed from the active client list. Ultra Messaging recommends a value at least 5 seconds longer than the longest network outage you wish to tolerate. </dd></dl>
<dl class="section user"><dt></dt><dd>Option <code>-a</code> describes a repeating time interval (in milliseconds) after which lbmrd checks for these "dead" clients. Ultra Messaging recommends a value not larger than <code>-t</code> * 1000. </dd></dl>
<dl class="section user"><dt></dt><dd>Even clients that send no topic resolution advertisements or queries will still send keepalive messages to lbmrd every 5 seconds. This value is hard-coded and not configurable. </dd></dl>
<dl class="section user"><dt></dt><dd>The <code>-s</code> option sets the send socket buffer size in bytes. </dd></dl>
<dl class="section user"><dt></dt><dd>The <code>-r</code> option sets the receive socket buffer size in bytes. </dd></dl>
<dl class="section user"><dt></dt><dd>The output is written to a log file if either <code>-L</code> or <code>--logfile</code> is supplied. </dd></dl>
<dl class="section user"><dt></dt><dd>The DTD used to validate a configuration file will be dumped to standard output with the <code>-d</code> or <code>--dump-dtd</code> option. After dumping the DTD, lbmrd exits immediately. </dd></dl>
<dl class="section user"><dt></dt><dd><code>config-file</code> is the XML configuration file. It will be validated against the DTD if either the <code>-v</code> or <code>--validate</code> options are given. After attempting validation, lbmrd exits immediately. The exit status will be 0 for a configuration file validated by the DTD and non-zero otherwise. </dd></dl>
<dl class="section user"><dt></dt><dd>Command line help is available with <code>-h</code> or <code>--help</code>.</dd></dl>
<dl class="section user"><dt><b>Exit</b> <b>Status</b> </dt><dd>The exit status from lbmrd is 0 for success and some non-zero value for failure.</dd></dl>
<p><br />
 </p>
<h1><a class="anchor" id="lbmrdconfigurationfile"></a>
lbmrd Configuration File</h1>
<p>Here is the DTD for the lbmrd XML configuration file:</p>
<pre class="fragment">&lt;!ELEMENT lbmrd (daemon?, domains, transformations)&gt;
&lt;!ATTLIST lbmrd
          version (1.0) #REQUIRED
&gt;


&lt;!ELEMENT daemon (activity|interface|port|ttl|log|resolver_unicast_receiver_socket_buffer|resolver_unicast_send_socket_buffer)*&gt;

&lt;!ELEMENT activity (#PCDATA) &gt;
&lt;!ELEMENT interface (#PCDATA) &gt;
&lt;!ELEMENT port (#PCDATA) &gt;
&lt;!ELEMENT ttl (#PCDATA) &gt;
&lt;!ELEMENT log (#PCDATA) &gt;
&lt;!ELEMENT resolver_unicast_receiver_socket_buffer (#PCDATA) &gt;
&lt;!ELEMENT resolver_unicast_send_socket_buffer (#PCDATA) &gt;

&lt;!ELEMENT domains (domain+)&gt;
&lt;!ELEMENT domain (network+)&gt;
&lt;!ATTLIST domain name ID #REQUIRED&gt;
&lt;!ELEMENT network ( #PCDATA )&gt;
&lt;!ELEMENT transformations ( transform+ )&gt;
&lt;!ELEMENT transform ( rule+ )&gt;
&lt;!ATTLIST transform
          source IDREF #REQUIRED
          destination IDREF #REQUIRED
&gt;
&lt;!ELEMENT rule ( match, replace )&gt;
&lt;!ELEMENT match EMPTY&gt;
&lt;!ATTLIST match
          address CDATA #REQUIRED
          port CDATA "*"
&gt;
&lt;!ELEMENT replace EMPTY&gt;
&lt;!ATTLIST replace
          address CDATA #REQUIRED
          port CDATA "*"
&gt;</pre><dl class="section note"><dt>Note</dt><dd>The configuration file must contain a '<b>&lt;domains&gt;</b>' element and a '<b>&lt;transformations&gt;</b>' element (and their contents), even if there is no NAT. See <a class="el" href="manpageforlbmrd.html#dummylbmrdconfigurationfile">Dummy lbmrd Configuration File</a>. The '<b>&lt;daemon&gt;</b>' element and its contents are optional.</dd></dl>
<dl class="section user"><dt><b>&lt;lbmrd&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;lbmrd&gt;</b>' element is the root element. It requires a single attribute, version, which defines the version of the DTD to be used. Currently, only version 1.0 is supported.</dd></dl>
<dl class="section user"><dt><b>&lt;activity&gt;IVL&lt;/activity&gt;</b> </dt><dd>interval between client activity checks (in milliseconds)(default 60000)</dd></dl>
<dl class="section user"><dt><b>&lt;interface&gt;ADDR&lt;/interface&gt;</b> </dt><dd>listen for unicast topic resolution messages on interface ADDR</dd></dl>
<dl class="section user"><dt><b>&lt;port&gt;PORT&lt;/port&gt;</b> </dt><dd>use UDP port PORT for topic resolution messages (default 15380)</dd></dl>
<dl class="section user"><dt><b>&lt;ttl&gt;TTL&lt;/ttl&gt;</b> </dt><dd>use client time-to-live of TTL seconds (default 60)</dd></dl>
<dl class="section user"><dt><b>&lt;log&gt;FILE&lt;/log&gt;</b> </dt><dd>use FILE as the log file</dd></dl>
<dl class="section user"><dt><b>&lt;resolver_unicast_receiver_socket_buffer&gt;SIZE&lt;/resolver_unicast_receiver_socket_buffer&gt;</b> </dt><dd>set the receive socket buffer to SIZE bytes.</dd></dl>
<dl class="section user"><dt><b>&lt;resolver_unicast_send_socket_buffer&gt;SIZE&lt;/resolver_unicast_send_socket_buffer&gt;</b> </dt><dd>set the send socket buffer to SIZE bytes.</dd></dl>
<dl class="section user"><dt><b>&lt;domains&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;domains&gt;</b>' element defines the set of network domains. The '<b>&lt;domains&gt;</b>' element may contain one or more '<b>&lt;domain&gt;</b>' elements. Domains are used to help lbmrd recognize networks and/or subnetworks which connect via Network Address Translation (NAT). See <a class="el" href="architecture.html#networkaddresstranslationnat">Network Address Translation (NAT)</a> for more information on NAT.</dd></dl>
<dl class="section user"><dt><b>&lt;domain&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;domain&gt;</b>' element defines a single network domain. Each domain must be named via the <code>name</code> attribute. This name is referenced in '<b>&lt;transform&gt;</b>' elements, which are discussed below. Each domain name must be unique. The '<b>&lt;domain&gt;</b>' element may contain one or more '<b>&lt;network&gt;</b>' elements.</dd></dl>
<dl class="section user"><dt><b>&lt;network&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;network&gt;</b>' element defines a single network specification which is to be considered part of the enclosing '<b>&lt;domain&gt;</b>'. The network specification must contain either an IP address, or a network specification in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR notation</a>. DNS host names are not supported in the lbmrd configuration file.</dd></dl>
<dl class="section user"><dt><b>&lt;transformations&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;transformations&gt;</b>' element defines and contains the set of transformations to be applied to the TIRs. The '<b>&lt;transformations&gt;</b>' element contains one or more '<b>&lt;transform&gt;</b>' elements, described below. Transformations are used to help lbmrd know how to modify source advertisements when Network Address Translation (NAT) is being used. See <a class="el" href="architecture.html#networkaddresstranslationnat">Network Address Translation (NAT)</a> for more information on NAT.</dd></dl>
<dl class="section user"><dt><b>&lt;transform&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;transform&gt;</b>' element defines a set of transformation tuples. Each tuple applies to a TIR sent from a specific network domain (specified using the <code>source</code> attribute), and destined for a specific network domain (specified using the <code>destination</code> attribute). The <code>source</code> and <code>destination</code> attributes must specify a network domain name as defined by the '<b>&lt;domain&gt;</b>' elements. The '<b>&lt;transform&gt;</b>' element contains one or more '<b>&lt;rule&gt;</b>' elements, described below.</dd></dl>
<dl class="section user"><dt><b>&lt;rule&gt;</b> <b>Element</b> </dt><dd>Each '<b>&lt;rule&gt;</b>' element is associated with the enclosing '<b>&lt;transform&gt;</b>' element, and completes the transformation tuple. The '<b>&lt;rule&gt;</b>' element must contain one '<b>&lt;match&gt;</b>' element, and one '<b>&lt;replace&gt;</b>' element, described below.</dd></dl>
<dl class="section user"><dt><b>&lt;match&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;match&gt;</b>' element defines the address and port to match within the TIR. The attributes <code>address</code> and <code>port</code> specify the address and port. <code>address</code> must specify a full IP address (a network specification is not permitted). <code>port</code> specifies the port in the TIR. To match any port, specify port="*" (which is the default). DNS host names are not supported in the lbmrd configuration file.</dd></dl>
<dl class="section user"><dt><b>&lt;replace&gt;</b> <b>Element</b> </dt><dd>The '<b>&lt;replace&gt;</b>' element defines the address and port which are to replace those matched in the TIR. The attributes <code>address</code> and <code>port</code> specify the address and port. <code>address</code> must specify a full IP address (a network specification is not permitted). To leave the TIR port unchanged, specify <code>port="*"</code> (which is the default). DNS host names are not supported in the lbmrd configuration file.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="dummylbmrdconfigurationfile"></a>
Dummy lbmrd Configuration File</h2>
<p>If no NAT is present, and it is desired to use the XML configuration file for it's '<b>&lt;daemon&gt;</b>' contents, a "dummy" NAT configuration should be used.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;lbmrd version="1.0"&gt;
  &lt;daemon&gt;
    ...
  &lt;/daemon&gt;
  &lt;domains&gt;
    &lt;domain name="dummy"&gt;
      &lt;network&gt;0.0.0.0/32&lt;/network&gt;
    &lt;/domain&gt;
  &lt;/domains&gt;
  &lt;transformations&gt;
    &lt;transform source="dummy" destination="dummy"&gt;
      &lt;rule&gt;
        &lt;match address="0.0.0.0" port="0"/&gt;
        &lt;replace address="0.0.0.0" port="0"/&gt;
      &lt;/rule&gt;
    &lt;/transform&gt;
  &lt;/transformations&gt;
&lt;/lbmrd&gt;
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>

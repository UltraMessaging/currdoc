<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Guide for Persistence: Store Repository Profiling (SRP)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Guide for Persistence
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('storerepositoryprofilingsrp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Store Repository Profiling (SRP) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To aid the users in operating and maintaining their Persistent Store deployment, Informatica provides an API that will read Store cache and state files and return useful information about them, including message content. This is the Store Repository Profiling (SRP). (The API is not in the normal "lbm" library; see <a class="el" href="storerepositoryprofilingsrp.html#usingthesrpapi">Using the SRP API</a>.)</p>
<p>Also supplied is the "umesnaprepo" example program, which uses the SRP API to read the information and print to standard out. It can be used as-is (see <a class="el" href="storerepositoryprofilingsrp.html#umesnaprepomanpage">umesnaprepo Man Page</a>), or its <a href="../example/umesnaprepo.c">source code</a> can be used as a guide for users to develop their own management tools.</p>
<p>This API and example program are supported on the same platforms that support the Persistent Store: 64-bit Linux and 64-bit Windows. The API is C-only (no Java or .NET).</p>
<p><b>IMPORTANT</b>: due to differences in certain Windows and Linux data sizes, a given set of state and cache files needs to be read on the same platform where it was generated. For example it is <em>NOT</em> valid to copy a Linux store's files to a Windows machine and use the windows-based SRP API or command-line tool to read them.</p>
<dl class="section note"><dt>Note</dt><dd>The Store Instance <b>should NOT be running</b> while the API or example program is used to read the Store files. There currently is no tool that performs the same function on an actively running Store.</dd></dl>
<p><br />
 </p>
<h1><a class="anchor" id="usingthesrpapi"></a>
Using the SRP API&nbsp;&nbsp;<small><a href="#usingthesrpapi">&lt;-</a></small></h1>
<p>Use the <a href="../example/umesnaprepo.c">umesnaprepo.c</a> source code as your guide.</p>
<p>The "umeprofile.h" header file contains the needed definitions.</p>
<p>The API code is <em>not</em> contained within the normal "lbm" library. On Linux, it is in libumestorelib.a, a static library. On Windows, it is in "umestore.lib", also static. It is not offered as a dynamic library.</p>
<p>The main API functions are: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_REL_6_13/29West/lbm/doc/UME/api.tag:../API/" href="../API/umeprofile_8h.html#aec84332e2bbb5e4d27a0703ed2568877">lbm_srp_create()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_REL_6_13/29West/lbm/doc/UME/api.tag:../API/" href="../API/umeprofile_8h.html#a7db2559f876d023c4ad52fc0ddff1aaf">lbm_srp_delete()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_REL_6_13/29West/lbm/doc/UME/api.tag:../API/" href="../API/umeprofile_8h.html#a77ca8bf5287fe50f7375ca0163f8d1e4">lbm_srp_get_repo_state()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_REL_6_13/29West/lbm/doc/UME/api.tag:../API/" href="../API/umeprofile_8h.html#a7d42a44d9383c34ffb6de59f1e8fd9d2">lbm_srp_free_repo_state()</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_REL_6_13/29West/lbm/doc/UME/api.tag:../API/" href="../API/umeprofile_8h.html#aef81e49d9e25088de8fe6cfbf1c259a6">lbm_srp_get_repo_message()</a> </li>
</ul>
<p><br />
 </p>
<h1><a class="anchor" id="umesnaprepomanpage"></a>
umesnaprepo Man Page&nbsp;&nbsp;<small><a href="#umesnaprepomanpage">&lt;-</a></small></h1>
<p>The "umesnaprepo" command is an example program that uses the <a class="el" href="storerepositoryprofilingsrp.html">Store Repository Profiling (SRP)</a> API to read Store state and cache files and print useful information, including message content. It can be used as-is, or its <a href="../example/umesnaprepo.c">source code</a> can be used as a guide for users to develop their own management tools.</p>
<dl class="section note"><dt>Note</dt><dd>The Store Instance <b>should NOT be running</b> while the API or example program is used to read the Store files. There currently is no tool that performs the same function on an actively running Store.</dd></dl>
<pre class="fragment">Usage: umesnaprepo -s state_dir [options]
Available options:
  -c, --cache-dir=PATH     cache file search PATH
  -h, --help               display this help and exit
  -n, --no-checksum        disable cache checksum checking
  -p, --parse              enable LBM header parsing
  -s, --state-dir=NUM      state file search PATH [required]
  -t, --truncate=NUM       limit cache message displays to NUM bytes
  -T, --terse              summarize cache and skip cache message displays
</pre><p>For example: </p><pre class="fragment">umesnaprepo -s /UM/store5/state -c /UM/store5/cache
</pre><p>This examines the state and cache files and prints information for every Store Instance represented there. Here's some example output: </p><pre class="fragment">Examining repository at index: 0
state_filename: /UM/store5/state/2545027182-state
cache_filename: /UM/store5/cache/2545027182-cache
...
Repository cache:
    number of messages: 26
...
Receiver 0
    regid: 2545027183
    sqn: 25
...
Message sqn [0]:
   tsp: 1584022054.898262
   disk_len: 37
   disk_offset: 0
   flags: 0x01
Message body:
00 00 00 25 a4 ab 82 e6 00 00 00 00 6d 65 73 73         ...%........mess
61 67 65 20 30 00 00 00 00 00 00 00 00 00 00 00         age 0...........
00 00 00 00 00                                          .....          
...
</pre><p>In this example output, notice that the actual beginning of the message (the first byte is the "m" of "message 0") is at offset 12 from the beginning of the buffer. The 12 bytes in front of the message is the "LBMC" header. The example application lets you supply the "-T" option, which parses the LBMC header and starts printing the message at the actual start of data. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>

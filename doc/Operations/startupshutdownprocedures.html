<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Operations Guide: Startup/Shutdown Procedures</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Operations Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('startupshutdownprocedures.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Startup/Shutdown Procedures </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In a multicast environment, only the applications and monitoring tools need to be started. If using Persistence, the Store daemon (umestored) also needs to be started. Likewise, use of the DRO requires starting the DRO daemon (tnwgd).</p>
<p>In a unicast-only environment, one or more resolver daemons (lbmrd) are typically required. It is recommended that you start the lbmrd before starting the applications.</p>
<p>Informatica recommends that you shutdown applications using UM sources and receivers cleanly, even though UM is able to cope with the ungraceful shutdown and restart of applications and UM daemons.</p>
<p>A failed assertion could lead to immediate application shutdown. If opting to restart a UM client or lbmrd, no other components need be restarted. Failed assertions should be logged with Informatica support.</p>
<p><br />
 </p>
<h1><a class="anchor" id="topicresolution"></a>
Topic Resolution&nbsp;&nbsp;<small><a href="#topicresolution">&lt;-</a></small></h1>
<p>Topic Resolution (TR) is the process by which subscribers discover a topic's publisher's <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/fundamentalconcepts.html#transportsessions">transport session</a> information. The subscriber uses this information to join the source's transport session, which then delivers published messages to the subscriber. With <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/topicresolutiondescription.html#multicastudptr">Multicast UDP TR</a>, topic resolution does not need to be started or shutdown. But TR does require network resources, and if not configured properly can lead to temporary or permanent <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/umglossary.html#glossarydeafness">deafness</a> in receivers, as well as other problems. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/fundamentalconcepts.html#topicresolutionoverview">Topic Resolution Overview</a> for more detailed information.</p>
<p>Applications cannot deliver messages until topic resolution completes. UM monitoring statistics are active before all topics resolve. In a large topic space (e.g. 10,000 topics) topic resolution messages may be 'staggered' or rate controlled, taking potentially several seconds to complete.</p>
<p>For example, 10,000 topics at the default value of 1,000 for <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/config.tag:../Config/" href="../Config/grpudpbasedresolveroperation.html#resolverinitialadvertisementspersecondcontext">resolver_initial_advertisements_per_second (context)</a> will take 10 seconds to send out an advertisement for every topic. If all receiving applications have been started first, fully resolving all topics may not take much more than 10 seconds. The rate of topic resolution can also be controlled with the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/config.tag:../Config/" href="../Config/grpudpbasedresolveroperation.html#resolverinitialadvertisementbpscontext">resolver_initial_advertisement_bps (context)</a> configuration option. Topic advertisements contain the topic string and approximately 110 bytes overhead. Topic queries from receivers contain no overhead, only the topic string.</p>
<p>Your UM development or administration team should anticipate the time and bandwidth required to resolve all topics when all applications initially start. This team should also establish any restarting restrictions.</p>
<p>Operations staff typically don't have any operational tasks related to topic resolution aside from monitoring hosts' CPU and bandwidth usage.</p>
<p><br />
 </p>
<h1><a class="anchor" id="umapplications"></a>
UM Applications&nbsp;&nbsp;<small><a href="#umapplications">&lt;-</a></small></h1>
<p>Your UM development team should provide you with the application names, resident machines and startup parameters, along with a sequence of application/daemon startups and shutdowns.</p>
<p>The following lists typical application startup errors.</p>
<ul>
<li>
Lack of resources </li>
<li>
License not configured - LOG Level 3: CRITICAL: LBM license invalid [LBM_LICENSE_FILENAME nor LBM_LICENSE_INFO are set] </li>
<li>
<p class="startli">Cannot bind port - lbm_context_create: could not find open TCP server port in range.</p>
<p>Too many applications may be running using the UM context's configured port range on this machine. This possibility should be escalated to your UM development team.</p>
<p class="endli">Application is possibly already running. It is possible to start more than one instance of the same UM application. </p>
</li>
<li>
Invalid network interface name / mask - lbm_config: line 1: no interfaces matching criteria </li>
<li>
Multiple interfaces detected - LOG Level 5: WARNING: Host has multiple multicast-capable interfaces; going to use [en1][10.10.10.102] </li>
</ul>
<p>This message appears for multi-homed machines. UM is not explicitly configured to use a single interface. This may not cause an issue but requires configuration review by your UM development team.</p>
<p><br />
 </p>
<h1><a class="anchor" id="indicationsofpossibleapplicationshutdown"></a>
Indications of Possible Application Shutdown&nbsp;&nbsp;<small><a href="#indicationsofpossibleapplicationshutdown">&lt;-</a></small></h1>
<p>A UM application shutdown may not be obvious immediately, especially if you are monitoring scores of applications. The following lists events that may indicate an application has shutdown.</p>
<ul>
<li>
The Process ID disappears. Consider a method to monitor all process IDs (PIDs). </li>
<li>
You notice the existence of a core dump file on the machine. </li>
<li>
UM statistics appear to reduce in volume or stop flowing. </li>
<li>
In an Application Log, one or more End Of Session (EOS) events signaling the cessation of a transport session. This may indicate a source application may have shut down. Your UM development team must explicitly log LBM_MSG_EOS events. Some EOS events may be delayed for some transports. </li>
<li>
In an Application Log, disconnect events (LBM_SRC_EVENT_DISCONNECT) for unicast transports (if implemented) indicate UM receiver applications have shutdown. </li>
</ul>
<p><br />
 </p>
<h1><a class="anchor" id="unicasttopicresolverlbmrd"></a>
Unicast Topic Resolver (lbmrd)&nbsp;&nbsp;<small><a href="#unicasttopicresolverlbmrd">&lt;-</a></small></h1>
<p>If not using multicast topic resolution, one or more instances of lbmrd must be started prior to stating applications. Unicast resolver daemons require an XML configuration file and multiple resolver daemons can be specified by your UM development team for resiliency. For more information on Unicast Topic Resolution, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/topicresolutiondescription.html#unicastudptr">Unicast UDP TR</a>.</p>
<p>Execute the following command on the appropriate machine to start a unicast topic resolver (lbmrd) from command line:</p>
<div class="fragment"><div class="line">lbmrd --interface=ADDR -L daemon_logfile.out -p PORT lbmrd.cfg</div></div><!-- fragment --><p>For more information on the lbmrd command-line, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdmanpage">Lbmrd Man Page</a>.</p>
<p>To stop an lbmrd that is running as a Windows service, use the Windows service control panel to stop it. Otherwise, kill the PID. If an lbmrd terminates, you need to restart it.</p>
<p>Observe the lbmrd logfile for errors and warnings</p>
<p>To make the lbmrd a Windows Service, see <a class="el" href="startupshutdownprocedures.html#umdaemonsaswindowsservices">UM Daemons as Windows Services</a>.</p>
<p>If running multiple lbmrds and an lbmrd in the list becomes inactive, the following message appears in the clients' log files:</p>
<div class="fragment"><div class="line">unicast resolver <span class="stringliteral">&quot;&lt;ip&gt;:&lt;port&gt;&quot;</span> went inactive</div></div><!-- fragment --><p>If all unicast resolver daemons become inactive, the following message appears in the clients' log files:</p>
<div class="fragment"><div class="line">No active resolver instances, sending via inactive instance</div></div><!-- fragment --><p>After all topics are resolved, daemons do not strictly need to be running unless you restart applications. Resolver daemons do not cache or persist state and do not require other shutdown maintenance.</p>
<p><br />
 </p>
<h1><a class="anchor" id="persistentstoreumestored"></a>
Running Persistent Stores (umestored)&nbsp;&nbsp;<small><a href="#persistentstoreumestored">&lt;-</a></small></h1>
<p>Stores can operate in disk-backed or memory-only mode specified in the Store's XML configuration file. Disk backed Stores are subject to the limitations of the disk hardware. For high performance applications, Informatica recommends solid-state disks local to the physical host running the Store. Those solid-state disks should be optimized for writing and should be dedicated to UM Store usage only (don't share it with other databases or disk-intensive programs).</p>
<p>There are a few scenarios where you need to start a Store: </p><ol>
<li>
Bringing a whole system up from scratch (applications, Stores, etc.). In this case, you typically want to <a class="el" href="startupshutdownprocedures.html#eliminatepaststate">Eliminate Past State</a>. </li>
<li>
Restarting a Store after a problem (unplanned shutdown, crash, power outage, etc.). In this case, you typically want to <a class="el" href="startupshutdownprocedures.html#retainpaststate">Retain Past State</a>. </li>
<li>
Restarting a Store after a planned maintenance window. In this case, you might <a class="el" href="startupshutdownprocedures.html#eliminatepaststate">Eliminate Past State</a> or <a class="el" href="startupshutdownprocedures.html#retainpaststate">Retain Past State</a>; the choice is yours. </li>
</ol>
<p>For details on starting a Store, see <a class="el" href="startupshutdownprocedures.html#startingastore">Starting a Store</a>.</p>
<p>Similarly, there are a few scenarios where you need to shut down a Store: </p><ol>
<li>
Regular system shutdown, as for a planned maintenance window. </li>
<li>
A problem is detected and you have decided restarting the Stores will help. </li>
</ol>
<p>For details on shutting down a Store, see <a class="el" href="startupshutdownprocedures.html#restartingastore">Shutting Down a Store</a>.</p>
<p>When you shut down a Store with the intention of restarting it, or if a Store fails, you should wait to restart for more than the time specified by the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/config.tag:../Config/" href="../Config/grpultramessagingpersistence.html#umestoreactivitytimeoutsource">ume_store_activity_timeout (source)</a> (defaults to 10 seconds). I.e. you should wait for the publishers to time out the old Store instance before you bring up the new instance.</p>
<p><br />
 </p>
<h2><a class="anchor" id="eliminatepaststate"></a>
Eliminate Past State&nbsp;&nbsp;<small><a href="#eliminatepaststate">&lt;-</a></small></h2>
<p>Sometimes when you start a Store, you want to eliminate past state. That is, you don't want any subscribers to recover older messages. For example, if bringing a whole system up from scratch. Or many users do a clean start after every maintenance window.</p>
<p>In this case, you must cleanly restart all publishers, subscribers, and Stores. It is recommended to have every component in the down state simultaneously before restarting any of them. Otherwise you risk having a newly restarted component learning old state from a not-yet-restarted component.</p>
<p>Part of cleanly restarting all Stores is deleting their state and cache files. If you fail to delete the state and cache files from one or more Stores, subscribers might start up and recover (replay) old messages that it had already processed. Or subscribers can be temporarily <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/umglossary.html#glossarydeafness">deaf</a> to some set (potentially large) set of newly published messages. Please ensure proper deletion of state and cache files prior to restarting Stores when you intend to eliminate past state.</p>
<p><br />
 </p>
<h2><a class="anchor" id="retainpaststate"></a>
Retain Past State&nbsp;&nbsp;<small><a href="#retainpaststate">&lt;-</a></small></h2>
<p>Sometimes when you start a Store, you want to retain past state. That is, you want to restart Stores in such a way that applications can pick up where they left off, and recover lost messages if necessary. For example, if restarting a store after a problem.</p>
<p>You should restart the Store with the state and cache files intact. When the Store restarts, it will read and restore the previous state. It will then attempt to recover as many missed messages from the sources, as possible. Then the Store resumes normal operation.</p>
<p>Note that if the cache files are very large, it might take a significant amount of time for the Store to initialize. If this time is objectionable, you may choose a <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/designingpersistentstores.html#limitinitialrestore">Limit Initial Restore with Restore-Last</a>.</p>
<p>There are times where it is not possible to retain the past state. For example, a failure of the disk holding the state and cache files. Or a failure of the Store's host, and the Store is restarted on a new host. In that case, care must be taken to ensure that the applications will properly restore as much of their previous state as possible.</p>
<p>For example, let's say that two Stores out of a three-Store QC group fail and lose their state and cache files. You have no choice but to restart those Stores cleanly, without state and cache. Note that in this example, since only one Store is running (the "stateful" Store), the applications lose quorum and pause their execution until Quorum is restored.</p>
<p>In this dual-failure case, it is important <em>*not*</em> to restart both failed Stores at the same time. To do so could result in applications registering with the two cleaned Stores first, and resetting their own internal states. This could lead to subscriber <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/umglossary.html#glossarydeafness">deafness</a>, or replay of previously processed messages.</p>
<p>Instead, you must restart one of the cleaned Stores and allow the applications to register with the clean Store and the stateful Store. Allow some time for the the cleaned Store to collect some state from the applications (typically requires several seconds). Then the other cleaned Store can be restarted.</p>
<p><br />
 </p>
<h2><a class="anchor" id="startingastore"></a>
Starting a Store&nbsp;&nbsp;<small><a href="#startingastore">&lt;-</a></small></h2>
<p>Unix users can start a Store with following command from a shell prompt or script:</p>
<div class="fragment"><div class="line">umestored config-file.xml</div></div><!-- fragment --><p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/manpagesforstore.html#umestoredmanpage">Umestored Man Page</a> for details on the umestored command-line.</p>
<p>Windows users typically install the Store as a Windows service (see <a class="el" href="startupshutdownprocedures.html#umdaemonsaswindowsservices">UM Daemons as Windows Services</a>). Windows has a control panel for starting services.</p>
<p>Memory-only Stores do not save state in disk files; they always start up without past state.</p>
<p>Disk-based Stores create two types of state files:</p>
<ul>
<li>
Cache file - contains the actual persisted messages, and can grow to be very large over time. Each cache file created corresponds to a specific publisher source. It is important to ensure that there is enough disk space to record the desired amount of persisted data. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/optionsforastoresumeattributeselement.html#umecfgrepositorydiskfilesizelimit">Topic Option "repository-disk-file-size-limit"</a>. </li>
<li>
State file - contains information about the current state of each client connection. These files is much smaller. </li>
</ul>
<p>A Store signals it has completed initialization by logging a message of the form: </p><pre class="fragment">Store-5688-5546: Store "StoreName" ready to accept registrations
</pre><p> If a Store process is configured to have more than one Store instance, this message will be logged for each configured Store instance (see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/persistencearchitecture.html#storeprocessesandinstances">Store Processes and Instances</a>).</p>
<p>The time required for a Store to complete initialization depends on the size of the cache file. For very large cache files, the initialization time can become objectionably long. see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/designingpersistentstores.html#limitinitialrestore">Limit Initial Restore with Restore-Last</a> for a solution.</p>
<p><br />
 </p>
<h2><a class="anchor" id="restartingastore"></a>
Shutting Down a Store&nbsp;&nbsp;<small><a href="#restartingastore">&lt;-</a></small></h2>
<p>If the Store is running as a Windows service, use the Service Manager to stop the Windows service.</p>
<p>Otherwise kill the PID. You can find the PID in the configured PID file; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/configurationreferenceforumestored.html#umeelementpidfile">UMP Element "&lt;pidfile&gt;"</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Do not perform a "forced kill" (in Unix "kill -9"). This can cause corruption of the state and/or cache files.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="commonstartupandshutdownissues"></a>
Common Startup and Shutdown Issues&nbsp;&nbsp;<small><a href="#commonstartupandshutdownissues">&lt;-</a></small></h2>
<ul>
<li>
Cache and state directories don't exist. It is the user's responsibility to pre-create those directories. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/optionsforastoresumeattributeselement.html#umecfgdiskstatedirectory">Store Option "disk-state-directory"</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/optionsforastoresumeattributeselement.html#umecfgdiskcachedirectory">Store Option "disk-cache-directory"</a>. </li>
<li>
Disk space - Cache files contain the actual persisted messages, and can grow to be very large over time. It is important to ensure that there is enough disk space to record the appropriate amount of persisted data. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/optionsforastoresumeattributeselement.html#umecfgrepositorydiskfilesizelimit">Topic Option "repository-disk-file-size-limit"</a>. </li>
<li>
Configuration error - UM parses a Store's XML configuration file at startup, reporting errors to standard error. </li>
<li>
Configuration error - UM reports other configuration errors the Store's log file. </li>
<li>
Missing license details. </li>
</ul>
<p><br />
 </p>
<h1><a class="anchor" id="umroutertnwgd"></a>
DRO (tnwgd)&nbsp;&nbsp;<small><a href="#umroutertnwgd">&lt;-</a></small></h1>
<p>When a DRO starts it discovers all sources and receivers in the topic resolution domains to which it connects. This results in a measurable increase and overall volume of topic resolution traffic and can take some time to complete depending upon the number of sources, receivers, and topics. The rate limits set on topic resolution also affect the time to resolve all topics.</p>
<p>See also <a class="el" href="startupshutdownprocedures.html#topicresolution">Topic Resolution</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="startingaumrouter"></a>
Starting a DRO&nbsp;&nbsp;<small><a href="#startingaumrouter">&lt;-</a></small></h2>
<p>Execute the following command on the appropriate machine to start a DRO (tnwgd) from command line:</p>
<div class="fragment"><div class="line">tnwgd config-file.xml</div></div><!-- fragment --><p>Informatica recommends: </p><ul>
<li>
Record tnwgd PID to monitor process presence for failure detection. </li>
<li>
Monitor the tnwgd logfile for errors and warnings. </li>
</ul>
<p>For more information on the tnwgd command-line, see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/manpagesforumrouter.html#tnwgdmanpage">Tnwgd Man Page</a>. To make the DRO a Windows Service, see <a class="el" href="startupshutdownprocedures.html#umdaemonsaswindowsservices">UM Daemons as Windows Services</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="restartingaumrouter"></a>
Restarting a DRO&nbsp;&nbsp;<small><a href="#restartingaumrouter">&lt;-</a></small></h2>
<p>Perform the following procedure to restart a DRO.</p>
<ol>
<li>
If the DRO is still running as a Windows service, use the Windows service control panel to stop the process. Otherwise, kill the PID. </li>
<li>
Wait 20-30 seconds to let timeouts expire. After a restart new proxy sources and receivers must be created on the DRO. Applications will not use the new proxies until the transport timeout setting expires for the old connections. Until this happens, applications may appear to be <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/umglossary.html#glossarydeafness">deaf</a> since they are still considering themselves as connected to the "old" DRO proxies. Therefore, do not rapidly restart the DRO. </li>
<li>
Run the command: tnwgd config-file.xml </li>
</ol>
<p><br />
 </p>
<h1><a class="anchor" id="umdaemonsaswindowsservices"></a>
UM Daemons as Windows Services&nbsp;&nbsp;<small><a href="#umdaemonsaswindowsservices">&lt;-</a></small></h1>
<p>On the Microsoft Windows platform, the UM daemons can be used either from the command line or as Windows Services.</p>
<dl class="section attention"><dt>Attention</dt><dd>Do not use the task manager or the "kill" command to stop a UM daemon running as a Windows service. Use the Windows service control panel to stop the service. In particular, if the persistent Store is killed non-gracefully, it can leave its files in an inconsistent state.</dd></dl>
<p>The UM daemons available as Windows Services are:</p>
<table class="doxtable">
<tr>
<th>Executable File </th><th>Description </th><th>Service Display Name </th><th>Man Page </th></tr>
<tr>
<td><b>lbmrds.exe</b> </td><td>UDP-based Unicast Topic Resolver </td><td>"LBMR Store Daemon" </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">man page</a> </td></tr>
<tr>
<td><b>srsds.exe</b> </td><td>TCP-based Topic Resolver </td><td>"UM Stateful Topic Resolution Service" </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforsrs.html#srsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>mcsds.exe</b> </td><td>Monitoring Collector Service </td><td>"UM Monitoring Collector Service" </td><td><a class="el" href="manpagesformcs.html#mcsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>storeds.exe</b> </td><td>Persistent Store </td><td>"UME Store Daemon" </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/manpagesforstore.html#umestoredsmanpage">man page</a> </td></tr>
<tr>
<td><b>tnwgds.exe</b> </td><td>Dynamic Router (DRO) </td><td>"Ultra Messaging Gateway" </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/manpagesforumrouter.html#tnwgdsmanpage">man page</a> </td></tr>
</table>
<p>Note that the Ultra Messaging Manager daemon (<code>"ummd"</code>) is not offered as a Windows Service at this time.</p>
<p>Also note that the UM daemons were not designed to run multiple instances of the service on the same host. See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/changelog.tag:../ChangeLog/" href="../ChangeLog/knownlimitations.html#bug9337">known limitation 9337</a>.</p>
<p>As of UM version 6.12 and beyond, the above UM daemons work similarly with respect to running as a Windows Service. See the individual man pages for differences.</p>
<p>For each service, the executable file (e.g. "storeds.exe") is used for two purposes: </p><ul>
<li>
Windows invokes the executable to run the service. </li>
<li>
The user manually invokes the executable to <a class="el" href="startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a>. </li>
</ul>
<p>That second purpose, configuring the UM Windows Service, consists of running the executable with one or more command-line options to store desired operational parameters into the Windows registry. This makes those parameters available to the service when Windows starts the service.</p>
<p>First, make sure that your UM license key is provided in a way that the service can access it. In particular, if you are using an environment variable to set the license key, it must be a system environment variable, not user.</p>
<p>Once your license key is ready, there are 4 overall steps to running a UM daemon as a Windows Service: </p><ol>
<li>
<a class="el" href="startupshutdownprocedures.html#installthewindowsservice">Install the Windows Service</a> </li>
<li>
<a class="el" href="startupshutdownprocedures.html#configurethedaemon">Configure the Daemon</a> </li>
<li>
<a class="el" href="startupshutdownprocedures.html#configurethewindowsservice">Configure the Windows Service</a> </li>
<li>
<a class="el" href="startupshutdownprocedures.html#startthewindowsservice">Start the Windows Service</a> </li>
</ol>
<p>All 4 steps must be completed before the Service can be used.</p>
<p><br />
 </p>
<h2><a class="anchor" id="installthewindowsservice"></a>
Install the Windows Service&nbsp;&nbsp;<small><a href="#installthewindowsservice">&lt;-</a></small></h2>
<p>There are two ways to install a UM daemon as a Windows Service: </p><ul>
<li>
Product package installer. </li>
<li>
Command line. </li>
</ul>
<p><b>Product package installer</b></p>
<p>When installing the product using the package installer, the dialog box titled "Choose Components" provides one or more check boxes for UM daemons to be installed as services. You may check any number of the boxes and proceed with the installation.</p>
<p>Note that for any box <em>not</em> checked, the software for that daemon is still copied onto the machine. This allows for installation as a Windows Service at a later time using the Command Line method.</p>
<p><b>Command line</b></p>
<p>If a daemon was not installed as a Windows Service from the product's package installer (possibly because the package installer was not used), daemons can be installed at a later time from the command line.</p>
<ol>
<li>
<p class="startli">Open a Windows Command Prompt, enabling Administrator access. (One way to do this is to right-click on the Command Prompt icon and select "More &gt; Run as administrator".)</p>
<p class="endli"></p>
</li>
<li>
Run the Service executable with the "-s install" command-line option. For example: <div class="fragment"><div class="line">umestoreds -s install</div></div><!-- fragment --> (Note: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">lbmrds</a> uses upper-case "-S".) </li>
</ol>
<p><br />
 </p>
<h2><a class="anchor" id="configurethedaemon"></a>
Configure the Daemon&nbsp;&nbsp;<small><a href="#configurethedaemon">&lt;-</a></small></h2>
<p>UM daemons are configured via XML configuration files. These files must be created and managed by the user. Each individual daemon needs its own separate XML configuration file.</p>
<p>Informatica recommends developing and testing the daemon configuration files interactively, using the command-line interface of each daemon. Do not run the daemon as a Windows Service until the daemon configuration has been validated and tested. This provides the fastest test cycle while the configuration is being developed and finalized.</p>
<p>The configuration files should be located on the hosts that are intended to run the daemons in files/folders of the user's choosing.</p>
<p>For more information on configuring and running the daemons interactively, see: </p><table class="doxtable">
<tr>
<th>Executable File </th><th>Description </th><th>Configuration Details </th><th>Man Page </th></tr>
<tr>
<td><b>lbmrds.exe</b> </td><td>UDP-based Unicast Topic Resolver </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/lbmrdconfigurationfile.html">lbmrd Configuration File</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">man page</a> </td></tr>
<tr>
<td><b>srsds.exe</b> </td><td>TCP-based Topic Resolver </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/srsconfigurationfile.html">SRS Configuration File</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforsrs.html#srsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>mcsds.exe</b> </td><td>Monitoring Collector Service </td><td><a class="el" href="mcsconfigurationfile.html">MCS Configuration File</a> </td><td><a class="el" href="manpagesformcs.html#mcsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>storeds.exe</b> </td><td>Persistent Store </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/configurationreferenceforumestored.html">Configuration Reference for Umestored</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/manpagesforstore.html#umestoredsmanpage">man page</a> </td></tr>
<tr>
<td><b>tnwgds.exe</b> </td><td>Dynamic Router (DRO) </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/xmlconfigurationreference.html">DRO Configuration Reference</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/manpagesforumrouter.html#tnwgdsmanpage">man page</a> </td></tr>
</table>
<p><br />
 </p>
<h2><a class="anchor" id="configurethewindowsservice"></a>
Configure the Windows Service&nbsp;&nbsp;<small><a href="#configurethewindowsservice">&lt;-</a></small></h2>
<p>"Configure the Windows Service" is different from <a class="el" href="startupshutdownprocedures.html#configurethedaemon">Configure the Daemon</a>. Configuring a UM Service provides Windows-specific operational parameters to the UM Daemon, which are not configurable via the Daemon Configuration. For example, you need to tell the Service where to find the Daemon Configuration file.</p>
<p>At this point, you should have the Daemon XML configuration file(s) prepared and available on the host which is to run the desired daemon(s) (See <a class="el" href="startupshutdownprocedures.html#configurethedaemon">Configure the Daemon</a>). And you should have tested the configuration using the daemon interactively to verify is correct operation.</p>
<p>Configuring the Service consists of running the Service executable from a Windows Command Prompt with one or more command-line options to store desired operational parameters into the Windows registry. This makes those parameters available to the service when Windows starts the service.</p>
<dl class="section attention"><dt>Attention</dt><dd>You need the Command Prompt window running as Administrator. (One way to do this is to right-click on the Command Prompt icon and select "More &gt; Run as administrator".)</dd></dl>
<p>There are several operational parameters that are common across all of the UM Windows Services: </p><ul>
<li>
Setting up the Windows Event Logger </li>
<li>
Setting up the Environment Variables file </li>
<li>
Setting up the Daemon Configuration file </li>
<li>
Service installation or removal </li>
</ul>
<p>Each Service has additional parameters that are specific to that Service; see each Service's man page: </p><table class="doxtable">
<tr>
<th>Executable File </th><th>Description </th><th>Configuration Details </th><th>Man Page </th></tr>
<tr>
<td><b>lbmrds.exe</b> </td><td>UDP-based Unicast Topic Resolver </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/lbmrdconfigurationfile.html">lbmrd Configuration File</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">man page</a> </td></tr>
<tr>
<td><b>srsds.exe</b> </td><td>TCP-based Topic Resolver </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/srsconfigurationfile.html">SRS Configuration File</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforsrs.html#srsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>mcsds.exe</b> </td><td>TCP-based Topic Resolver </td><td><a class="el" href="mcsconfigurationfile.html">MCS Configuration File</a> </td><td><a class="el" href="manpagesformcs.html#mcsdsmanpage">man page</a> </td></tr>
<tr>
<td><b>storeds.exe</b> </td><td>Persistent Store </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/configurationreferenceforumestored.html">Configuration Reference for Umestored</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/ume.tag:../UME/" href="../UME/manpagesforstore.html#umestoredsmanpage">man page</a> </td></tr>
<tr>
<td><b>tnwgds.exe</b> </td><td>Dynamic Router (DRO) </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/xmlconfigurationreference.html">DRO Configuration Reference</a> </td><td><a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/gateway.tag:../Gateway/" href="../Gateway/manpagesforumrouter.html#tnwgdsmanpage">man page</a> </td></tr>
</table>
<p><b>Daemon Configuration File</b></p>
<p>The UM daemons require a configuration file. You must configure the Windows Service with the path to the daemon's configuration file. This is done with the <code>"-s config"</code> command-line option. For example: </p><div class="fragment"><div class="line">umestoreds -s config c:\UM\store_config.xml</div></div><!-- fragment --><p> This saves the file path into the Windows registry. Subsequently, each time the UME Store Windows Service starts, it will read that file to configure the Store daemon. (Note: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">lbmrds</a> uses upper-case "-S".)</p>
<p><b>Windows Event Logger</b></p>
<p>The UM daemons write their log messages to their log files. The UM Windows Services have the option of also writing the log messages to the Windows Event Logger.</p>
<p>UM Log messages are categorized into different severity levels: "info", "notice", "warning", "err", "alert", "emerg". By default, the UM Windows Services will write log messages of category "warning" and above to the Windows Event Log.</p>
<p>If desired, the category can be configured with the <code>"-e"</code> command-line option. For example: </p><div class="fragment"><div class="line">umestoreds -e notice</div></div><!-- fragment --><p> This saves the "notice" category into the Windows registry. Subsequently, each time the UME Store Windows Service starts, it will log message of "notice" and above to the Windows Event Log.</p>
<p>Be aware that setting the severity level below "warning" can result in very many messages being written to the Windows Event Log. Also be aware that messages of <em>all</em> severity levels are written to the daemon's log file, independent of the <code>"-e"</code> setting.</p>
<p><b>Environment Variables File</b></p>
<p>The UM daemons occasionally can have useful features enabled through the use of environment variables. Most of the UM Windows Services allow the use of an optional disk file containing environment variable assignments. Each time the Service starts, that file is read and the environment variables are set for that daemon process. The SRS Windows service does not currently support this.</p>
<p>If desired, the Environment Variable file path can be configured with the <code>"-E"</code> command-line option. For example: </p><div class="fragment"><div class="line">umestoreds -E c:\UM\store_env.txt</div></div><!-- fragment --><p> This saves the file path into the Windows registry. Subsequently, each time the UME Store Windows Service starts, it will read that file and set its environment variables.</p>
<p>The format of that file is shown by this example: </p><pre class="fragment"># Environment Variable File for UME Store
LBM_DEBUG_MASK="0xC384"
LBM_DEBUG_FILENAME="c:\temp\store_debug.txt"
</pre><p> The quote marks are required.</p>
<p>If you want to stop using an environment variable file, you must remove its entry from the Windows registry with the <code>"-U"</code> command-line option. For example: </p><div class="fragment"><div class="line">umestoreds -U</div></div><!-- fragment --><p> This removes the environment variable file path from the Windows registry. The next time the UME Store Windows Service starts, it will not set its environment. Note that this operation does <em>not</em> remove the environment file.</p>
<p><br />
 </p>
<h2><a class="anchor" id="startthewindowsservice"></a>
Start the Windows Service&nbsp;&nbsp;<small><a href="#startthewindowsservice">&lt;-</a></small></h2>
<p>Windows Services are controlled by the "Services" control panel. See your Windows documentation for information on controlling Windows Services.</p>
<p><br />
 </p>
<h2><a class="anchor" id="removethewindowsservice"></a>
Remove the Windows Service&nbsp;&nbsp;<small><a href="#removethewindowsservice">&lt;-</a></small></h2>
<p>There are two ways to remove the UM daemons as Windows Services: </p><ul>
<li>
Use the Windows uninstaller. </li>
<li>
Manually remove the service using the daemon's executable program. </li>
</ul>
<p><b>Windows Uninstaller</b></p>
<p>If the UM package was installed by the Package Installer, using the normal Windows "Add or Remove Programs" control panel removes the Windows Service, as well as also removing the installed files.</p>
<p><b>Manual Service Removal</b></p>
<p>You can remove a UM Windows Service manually using the <code>"-s remove"</code> command-line option. For example: </p><div class="fragment"><div class="line">umestoreds -s <span class="keyword">remove</span></div></div><!-- fragment --><p> This removes the UM Store as a Windows Service. (Note: <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Operations/design.tag:../Design/" href="../Design/manpagesforlbmrd.html#lbmrdsmanpage">lbmrds</a> uses upper-case "-S".)</p>
<p>Note that this does not uninstall any of the UM software. It only removes the the daemon as a Windows Service.</p>
<p><br />
 </p>
<h1><a class="anchor" id="umanalysistools"></a>
UM Analysis Tools&nbsp;&nbsp;<small><a href="#umanalysistools">&lt;-</a></small></h1>
<p>Tools available to analyze UM activity and performance.</p>
<p><br />
 </p>
<h2><a class="anchor" id="packetcapturetools"></a>
Packet Capture Tools&nbsp;&nbsp;<small><a href="#packetcapturetools">&lt;-</a></small></h2>
<ul>
<li>
Wireshark is an open-source network packet analysis tool, for which Informatica provides 'dissectors' describing our packet formats. It is used to open and sift through packet capture files, which can be gathered by a variety of both software and hardware tools. </li>
<li>
Tshark is a command-line version of Wireshark. </li>
<li>
Tcpdump is the primary software method for gathering packet capture data from a specific host. It is available on most Unix-based systems, though generally gathering packet captures with the tool requires super-user permissions. </li>
</ul>
<p>For more information about Wireshark please visit <a href="https://www.wireshark.org/">https://www.wireshark.org/</a>. (The UM plugins are part of the current release.)</p>
<p><br />
 </p>
<h2><a class="anchor" id="resourcemonitors"></a>
Resource Monitors&nbsp;&nbsp;<small><a href="#resourcemonitors">&lt;-</a></small></h2>
<ul>
<li>
Top is a system resource monitor available on Linux/Unix that presents a variety of useful data, such as CPU use (both average and per-CPU), including time spent in user mode, system mode, time processing interrupts, time spent waiting on I/O, etc. </li>
<li>
Microsoft Windows System Resource Manager manages Windows Server 2008 processor and memory usage with built-in or custom resource policies. </li>
<li>
<b>prstat</b> is a resource manager for Solaris that provides similar CPU and memory usage information. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="processanalysistools"></a>
Process Analysis Tools&nbsp;&nbsp;<small><a href="#processanalysistools">&lt;-</a></small></h2>
<ul>
<li>
<p class="startli"><b>pstack</b> dumps a stack trace for a process (pid). If the process named is part of a thread group, then</p>
<p class="endli"><b>pstack</b> traces all the threads in the group. </p>
</li>
<li>
<b>gcore</b> generates a core dump for a Solaris, Linux, and HP-UX process. The process continues after core has been dumped. Thus, gcore is especially useful for taking a snapshot of a running process. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="networktools"></a>
Network Tools&nbsp;&nbsp;<small><a href="#networktools">&lt;-</a></small></h2>
<ul>
<li>
<b>netstat</b> provides network statistics for a computer's configured network interfaces. This extensive command-line tool is available on Linux/Unix based systems and Windows operating systems. </li>
<li>
<b>wget</b> is a Linux tool that captures content from a web interface, such as a UM daemon web monitor. Its features include recursive download, conversion of links for off-line viewing of local HTML, support for proxies, and more. </li>
<li>
<b>netsh</b> is a Windows utility that allows local or remote configuration of network devices such as the interface. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="umtools"></a>
UM Tools&nbsp;&nbsp;<small><a href="#umtools">&lt;-</a></small></h2>
<ul>
<li>
lbmmoncache is a utility that monitors both source notification and source/receiver statistics. <a href="https://ultramessaging.github.io/UM_Support.html">Contact UM Support</a> for more information about this utility. </li>
<li>
lbtrreq restarts the topic resolution process. <a href="https://ultramessaging.github.io/UM_Support.html">Contact UM Support</a> for more information about this utility. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="umdebugflags"></a>
UM Debug Flags&nbsp;&nbsp;<small><a href="#umdebugflags">&lt;-</a></small></h2>
<p>The use of UM debug flags requires the assistance of UM Support. Also refer to the following Knowledge Base articles for more information about using debug flags. </p><ul>
<li>
<a href="https://kb.informatica.com/howto/4/Pages/80100.aspx">Using debug flags</a> </li>
<li>
<a href="https://kb.informatica.com/howto/4/Pages/80101.aspx">Using debug flags in application code</a> </li>
<li>
<a href="https://kb.informatica.com/howto/4/Pages/80242.aspx">Using debug flags with daemons</a> </li>
<li>
<a href="https://kb.informatica.com/howto/4/Pages/80241.aspx">Using debug flags with daemons running as windows services</a> </li>
</ul>
<p><br />
<br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>

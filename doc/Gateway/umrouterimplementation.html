<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Dynamic Routing Guide: UM Router Implementation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dynamic Routing Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('umrouterimplementation.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">UM Router Implementation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><br />
 </p>
<h1><a class="anchor" id="umrouterconfigurationoverview"></a>
UM Router Configuration Overview</h1>
<p>When the UM Router daemon launches, it uses configuration option settings to determine its behavior and expectations. You specify option values in an XML configuration file, and reference the file from a command line argument.</p>
<p>Typically, you have a separate XML configuration file for each UM Router, which contains structured configuration elements that describe aspects of the UM Router. Within this XML configuration file, each endpoint portal definition points to a UM configuration file, which allow the portal to properly connect to its TRD.</p>
<p><br />
 </p>
<h1><a class="anchor" id="creatingapplicationsforumroutercompatibility"></a>
Creating Applications for UM Router Compatibility</h1>
<p>When developing messaging applications that use Ultra Messaging and, in particular, the UM Router, please observe the following guidelines.</p>
<p><br />
 </p>
<h2><a class="anchor" id="namingandidentification"></a>
Naming and Identification</h2>
<p>An important part to successfully implementing UM Routers is prudent and error-free naming of TRDs, UM Routers, portals, etc., as well as correct identification of IP addresses and ports. It is good practice to first design the UM Router network by defining all connections and uniquely naming all UM Routers, portals, and TRDs. This works well as a diagram similar to some examples presented in this document. Include the following names and parameters in your design diagram:</p>
<ul>
<li>
TRD names and IDs </li>
<li>
UM Router names </li>
<li>
Portal names </li>
<li>
Portal costs </li>
</ul>
<p>For example, a well-prepared UM Router design could look like the following figure.</p>
<div class="image">
<img src="design_diagram.png" alt="design_diagram.png"/>
</div>
 <p><br />
 </p>
<h2><a class="anchor" id="portalcosts"></a>
Portal Costs</h2>
<p>A network of UM Routers uses forwarding cost as the criterion for determining the best (lowest cost) path over which to resolve a topic and route data. Forwarding cost is simply the sum of all portal costs along a multi-UM Router path. Thus, total cost for the single path in the above example is 34. (Note that this is a non-real-world example, since costs are pointless without alternate routes to compare to.) You assign portal costs via the <code>&lt;cost&gt;</code> configuration option.</p>
<p>After the UM Router network calculates its paths, if a new lower-cost source becomes available, receivers switch to that path.</p>
<p><br />
 </p>
<h2><a class="anchor" id="accesscontrollistsacl"></a>
Access Control Lists (ACL)</h2>
<p>You can apply Access Control Lists (ACL) to a UM Router's portals to filter traffic by certain topics, transports, topic patterns, multicast groups, etc. You configure ACLs in a UM Router's XML configuration file, as children of an <code>&lt;endpoint&gt;</code> or <code>&lt;peer&gt;</code> portal. As traffic arrives at the portal, the portal either forwards it or rejects it per ACL criteria.</p>
<p>Inbound ACLs determine what information to forward to other portals in the UM Router, while Outbound ACLs determine (by topic) what information from other portals that this portal can send out the UM Router. Each portal (endpoint or peer) can have up to one inbound ACL and one outbound ACL.</p>
<div class="image">
<img src="acl.png" alt="acl.png"/>
</div>
 <p>An ACL can contain one or more Access Control Entries (ACEs). ACEs are the filters that let you match (and accept or reject based on), criteria elements. For example, to accept only messages for topic ABC:</p>
<pre class="fragment">        &lt;acl&gt;
          &lt;inbound&gt;
            &lt;ace match="accept"&gt;
              &lt;topic&gt;ABC&lt;/topic&gt;
            &lt;/ace&gt;
          &lt;/inbound&gt;
        &lt;/acl&gt;
</pre><p>Possible ACE condition elements are:</p>
<ul>
<li>
<code>&lt;multicast-group/&gt;</code> * </li>
<li>
<code>&lt;pcre-pattern&gt;</code> (PCRE wildcard patterns) </li>
<li>
<code>&lt;regex-pattern&gt;</code> (Regex wildcard patterns) </li>
<li>
<code>&lt;source-ip/&gt;</code> * </li>
<li>
<code>&lt;tcp-source-port/&gt;</code> * </li>
<li>
<code>&lt;topic&gt;</code> </li>
<li>
<code>&lt;transport/&gt;</code> * </li>
<li>
<code>&lt;udp-destination-port/&gt;</code> * </li>
<li>
<code>&lt;udp-source-port/&gt;</code> * </li>
<li>
<code>&lt;xport-id/&gt;</code> * (for LBT-IPC traffic) </li>
</ul>
<p>These items apply to only inbound ACLs, and are ignored if used with an outbound ACL.</p>
<p>The above elements are all children of the <code>&lt;ace&gt;</code> element. When an ACL has multiple ACE entries, the UM Router goes down the list until it finds a match. It then accepts (forwards) or rejects, and is done with that ACL. An implicit "reject all" is at the end of every ACL, so the UM Router rejects any topic not matched. If you place multiple conditions within an ACE, the UM Router performs an "and" operation with them.</p>
<p>Note that the portal ignores a condition element if a) it is inbound-only and used in an outbound ACL, or b) it simply does not apply (such as a <code>&lt;udp-source-port/&gt;</code> if the transport is TCP).</p>
<p>Also note that ACLs can affect topic resolution traffic as well as user messages. They can, for example, block a topic (which prevents the creation of proxy receivers) and, thus, protect remote TRDs from unwanted queries and advertisements. This effect does not apply to wildcard receivers, however, because ACLs match only on discrete topics. Thus, while ACLs can operate on specific topic traffic derived from wildcard topic resolution, they cannot prevent pattern interest from propagating throughout the network.</p>
<p>Consider the following example, where we configure a portal to forward on specific topics. This example also illustrates the parent/child hierarchy for ACLs, ACEs, and ACE conditions.</p>
<pre class="fragment">    &lt;endpoint&gt;
      &lt;name&gt;LAN1&lt;/name&gt;
      &lt;lbm-config&gt;lan1.cfg&lt;/lbm-config&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
        &lt;acl&gt;
          &lt;inbound&gt;
            &lt;ace match="accept"&gt;
              &lt;topic&gt;ABC&lt;/topic&gt;
            &lt;/ace&gt;
            &lt;ace match="accept"&gt;
              &lt;topic&gt;DEF&lt;/topic&gt;
              &lt;transport value=lbt-rm comparison=eq/&gt;
            &lt;/ace&gt;
            &lt;ace match="accept"&gt;
              &lt;topic&gt;GHI&lt;/topic&gt;
            &lt;/ace&gt;
          &lt;/inbound&gt;
        &lt;/acl&gt;
    &lt;/endpoint&gt;
</pre><p>The above example shows each topic match in a separate ACE. When topic "GHI" arrives, the portal finds a match in the third ACE and forwards the topic. (Placing all three <code>&lt;topic&gt;</code>s in a single ACE would never match anything.) Also note that "DEF" is forwarded only if it uses an LBT-RM transport.</p>
<p>Since the behavior for multiple ACEs is "first match, then done", list ACEs in a specific-to-general order. For the example below, to forward topic "ABC123" but reject similar topics such as "ABCD123" or "ABCE123", list the ACE for "ABC123" first (as done below). If the ACE to reject "ABC.*123" was listed first, it would also (undesirably) match and reject "ABC123".</p>
<pre class="fragment">    &lt;endpoint&gt;
      &lt;name&gt;LAN1&lt;/name&gt;
      &lt;lbm-config&gt;lan1.cfg&lt;/lbm-config&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
        &lt;acl&gt;
          &lt;inbound&gt;
            &lt;ace match="accept"&gt;
              &lt;topic&gt;ABC123&lt;/topic&gt;
            &lt;/ace&gt;
            &lt;ace match="reject"&gt;
              &lt;pcre-pattern&gt;ABC.*123&lt;/pcre-pattern&gt;
            &lt;/ace&gt;
          &lt;/inbound&gt;
        &lt;/acl&gt;
    &lt;/endpoint&gt;
</pre><p>You can also filter on certain transport types to accept multicast traffic but reject tcp traffic, as shown below.</p>
<pre class="fragment">    &lt;endpoint&gt;
      &lt;name&gt;LAN1&lt;/name&gt;
      &lt;lbm-config&gt;lan1.cfg&lt;/lbm-config&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
        &lt;acl&gt;
          &lt;inbound&gt;
            &lt;ace match="accept"&gt;
              &lt;transport comparison="equal" value="lbtrm"/&gt;
            &lt;/ace&gt;
            &lt;ace match="reject"&gt;
              &lt;transport comparison="equal" value="tcp"/&gt;
            &lt;/ace&gt;
          &lt;/inbound&gt;
        &lt;/acl&gt;
    &lt;/endpoint&gt;
</pre><p><br />
 </p>
<h2><a class="anchor" id="timersandintervals"></a>
Timers and Intervals</h2>
<p>The UM Router offers a wide choice of timer and interval options to fine tune its behavior and performance. There are interactions and dependencies between some of these, and if misconfigured, they may cause race or failure conditions.</p>
<p>This manual's description of configuration options (see <a class="el" href="xmlconfigurationreference.html">XML Configuration Reference</a>), includes identification of such relationships. Please heed them.</p>
<p><br />
 </p>
<h2><a class="anchor" id="multicastimmediatemessagingconsiderations"></a>
Multicast Immediate Messaging Considerations</h2>
<p>Multicast Immediate Messages (MIMs) may pass through the UM Router. You cannot filter MIMs with Access Control Lists (ACL)-MIMs are forwarded to all TRDs. Informatica does not recommend using MIM for messaging traffic across the UM Router. MIM is intended for short-lived topics and applications that cannot tolerate a delay between source creation and the sending of the first message. See also <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.11.1_RC1/doc/Gateway/design.tag:../Design/" href="../Design/umfeatures.html#multicastimmediatemessaging">Multicast Immediate Messaging</a>.</p>
<p><br />
 </p>
<h2><a class="anchor" id="persistenceovertheumrouter"></a>
Persistence Over the UM Router</h2>
<p>The UM Router supports UMP persistence by routing all necessary control and retransmission channels along with transport and topic resolution traffic. A typical implementation places the UMP persistent store in the same TRD as its registered source, as shown in the following figure.</p>
<div class="image">
<img src="persist_1.png" alt="persist_1.png"/>
</div>
 <p>The UM Router also supports UMP implementations with the store located in a receiver's TRD, as shown in the following figure.</p>
<div class="image">
<img src="persist_2.png" alt="persist_2.png"/>
</div>
 <p>Note: For more reliable operation when using UMP with UM Routers, Informatica recommends enabling OTR.</p>
<p><br />
 </p>
<h2><a class="anchor" id="latejoinandofftransportrecovery"></a>
Late Join and Off-Transport Recovery</h2>
<p>The UM Router supports sources and receivers configured for Late Join and/or Off-Transport Recovery (OTR). Retransmission requests and subsequent retransmissions are conducted across the entire path through the UM Router network. A UM Router's proxy sources do not have Late-Join/OTR retention buffers and hence, are not able to provide recovered messages.</p>
<p><br />
 </p>
<h2><a class="anchor" id="topicresolutionreliability"></a>
Topic Resolution Reliability</h2>
<p>Topic resolution can sometimes remain in a quiescent phase due to link interruption, preventing needed re-subscription topic resolution activity. Two ways you can address this are:</p>
<ul>
<li>
For isolated incidents, call <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.11.1_RC1/doc/Gateway/api.tag:../API/" href="../API/lbm_8h.html#ae6dd7c56acf916ef66658cc1ebc7a525">lbm_context_topic_resolution_request()</a> (see example lbmtrreq.c). This restarts the sustaining phase. </li>
<li>
For more chronic problems, such as a UM Router link (especially an endpoint link) over a WAN of questionable reliability, consider configuring Topic resolution to stay in the sustaining phase (options <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.11.1_RC1/doc/Gateway/config.tag:../Config/" href="../Config/grpresolveroperation.html#resolveradvertisementminimumsustaindurationsource">resolver_advertisement_minimum_sustain_duration (source)</a> and <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.1/rc/UMQ_6.11.1_RC1/doc/Gateway/config.tag:../Config/" href="../Config/grpresolveroperation.html#resolverqueryminimumsustaindurationreceiver">resolver_query_minimum_sustain_duration (receiver)</a>). </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="bosandeosbehaviorovertheumrouter"></a>
BOS and EOS Behavior Over the UM Router</h2>
<p>Through a network of UM Routers, a topic traverses a separate session for each link along its path. Thus, the UM Router reports BOS/EOSs based on the activity between the proxy source transport and its associated receiver. There is no end-to-end, application-to-application reporting of the data path state. Also, in the case of multiple topics being assigned to multiple sessions, topics may find themselves with different session mates from hop to hop. Of course, this all influences when, and for which transport session, a topic's BOSs and EOSs are issued.</p>
<p><br />
 </p>
<h1><a class="anchor" id="topologyconfigurationexamples"></a>
Topology Configuration Examples</h1>
<p>Following are example configurations for a variety of UM Router topologies. These are the topology examples presented <a class="el" href="umrouterconcepts.html#routingtopologies">Routing Topologies</a>.</p>
<p>In a real-world situation, you would have UM Router XML configuration files with their portal interfaces referencing complete UM configuration files. However, for these examples, the referred domain configuration files are simplified to contain only information relevant to the applicable UM Router. As part of this simplification, domain configuration files show interfaces for only one or two transport types.</p>
<p>Also, IP addresses are provided in some cases and omitted in other cases. This is because initiator peer portals need to know the IP addresses (and port numbers) of their corresponding acceptor portals to establish connections, whereas endpoint portals communicate via topic resolution and thus, do not need to know IP addresses.</p>
<dl class="section note"><dt>Note</dt><dd>Before designing any UM Router implementations based on configurations or examples other than the types presented in this document, please contact your technical support representative.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="directlinkconfiguration"></a>
Direct Link Configuration</h2>
<p>This example uses a UM Router to connect two topic resolution domain LANs.</p>
<div class="image">
<img src="cfg_direct_link.png" alt="cfg_direct_link.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<p>This UM configuration file, trd1.cfg, describes TRD1 and is referenced in the UM Router configuration file.</p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<p>This UM Router configuration file defines two endpoint portals. In the daemon section, we have turned on monitoring for the all endpoint portals in the UM Router. The configuration specifies that all statistics be collected every 5 seconds and uses the lbm transport module to send statistics to your monitoring application, which runs in TRD1. See also UM Concepts, Monitoring UMS. The Web Monitor has also been turned on (port 15304) to monitor the performance of the UM Router.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!-- G1 xml file- 2 endpoint portals --&gt;
&lt;tnw-gateway version="1.0"&gt;
  &lt;daemon&gt;
    &lt;log type="console"/&gt;
    &lt;lbm-license-file&gt;lic0014.txt&lt;/lbm-license-file&gt;
    &lt;monitor interval="5"&gt;
      &lt;transport-module module="lbm" options="config=trd1.cfg"/&gt;
    &lt;/monitor&gt;
    &lt;web-monitor&gt;*:15304&lt;/web-monitor&gt;
  &lt;/daemon&gt;
  &lt;portals&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1-TRD1&lt;/name&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd1.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1-TRD2&lt;/name&gt;
      &lt;domain-id&gt;2&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd2.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
  &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<p>The configuration file trd2.cfg could look something like this.</p>
<pre class="fragment"># Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><br />
 </p>
<h2><a class="anchor" id="peerlinkconfiguration"></a>
Peer Link Configuration</h2>
<p>In cases where the UM Router connection between two TRDs must tunnel through a WAN or TCP/IP network, you can implement a UM Router at each end, as shown in the example below.</p>
<div class="image">
<img src="cfg_single_link.png" alt="cfg_single_link.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<p>Following is an example of two companion peer portals (on different UM Routers) configured via UM Router XML configuration file for a single TCP setup. Note that one must be an initiator and the other, an acceptor.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
       &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
       &lt;endpoint&gt;
          &lt;name&gt;G1-TRD1&lt;/name&gt;
          &lt;domain-id&gt;1&lt;/domain-id&gt;
          &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
       &lt;/endpoint&gt;
       &lt;peer&gt;
          &lt;name&gt;G1-G2&lt;/name&gt;
          &lt;single-tcp&gt;
             &lt;interface&gt;10.30.3.100&lt;/interface&gt;
             &lt;initiator&gt;
                &lt;address&gt;10.30.3.102&lt;/address&gt;
                &lt;port&gt;26123&lt;/port&gt;
             &lt;/initiator&gt;
          &lt;/single-tcp&gt;
       &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G2</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G2-G1&lt;/name&gt;
         &lt;single-tcp&gt;
           &lt;interface&gt;10.30.3.102&lt;/interface&gt;
           &lt;acceptor&gt;
             &lt;listen-port&gt;26123&lt;/listen-port&gt;
           &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2-TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## LAN2 Configuration Options ##
context request_tcp_interface 10.33.3.0/24
context resolver_multicast_port 13965
</pre><p><br />
 </p>
<h2><a class="anchor" id="transittrdlinkconfiguration"></a>
Transit TRD Link Configuration</h2>
<p>This example, like the previous one, configures two localized UM Routers tunneling a connection between two TRDs, however, the UM Routers in this example are tunneling through an intermediate TRD. This has the added effect of connecting three TRDs.</p>
<div class="image">
<img src="cfg_transit_trd.png" alt="cfg_transit_trd.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">## TRD1 Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<p>Following is an example of two companion peer portals (on different UM Routers) configured via UM Router XML configuration file for a single TCP setup. Note that one must be an initiator and the other, an acceptor.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1-TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1-TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## TRD2 Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><b>G2</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2-TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2-TRD3&lt;/name&gt;
         &lt;domain-id&gt;3&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD3.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD3</b> <b>Configuration</b> </p>
<pre class="fragment">## TRD3 Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.3.37.85
</pre><p><br />
 </p>
<h2><a class="anchor" id="parallellinksconfiguration"></a>
Parallel Links Configuration</h2>
<p>This example is similar in purpose to the single link, peer-to-peer example, except that a second pair of UM Routers is added as a backup route. You can set one of these as a secondary route by assigning a higher cost to portals along the path. In this case we set G3 and G4's portal costs to 5, forcing the lower route to be selected only if the upper (G1, G2) route fails.</p>
<p>Also note that we have configured the peer portals for the leftmost or odd-numbered UM Routers as initiators, and the rightmost or even-numbered UM Router peers as acceptors.</p>
<div class="image">
<img src="cfg_parallel.png" alt="cfg_parallel.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">## TRD1 Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1-TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;cost&gt;2&lt;/cost&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G1-G2&lt;/name&gt;
         &lt;cost&gt;2&lt;/cost&gt;
         &lt;single-tcp&gt;
            &lt;interface&gt;10.30.3.101&lt;/interface&gt;
            &lt;initiator&gt;
               &lt;address&gt;10.30.3.102&lt;/address&gt;
               &lt;port&gt;23745&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G2</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G2-G1&lt;/name&gt;
         &lt;cost&gt;2&lt;/cost&gt;
         &lt;single-tcp&gt;
            &lt;interface&gt;10.30.3.102&lt;/interface&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23745&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2-TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;cost&gt;2&lt;/cost&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G3</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G3-TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;cost&gt;5&lt;/cost&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G3-G4&lt;/name&gt;
         &lt;cost&gt;5&lt;/cost&gt;
         &lt;single-tcp&gt;
            &lt;interface&gt;10.30.3.103&lt;/interface&gt;
            &lt;initiator&gt;
               &lt;address&gt;10.30.3.104&lt;/address&gt;
               &lt;port&gt;23746&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G4</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G4-G3&lt;/name&gt;
         &lt;cost&gt;5&lt;/cost&gt;
         &lt;single-tcp&gt;
            &lt;interface&gt;10.30.3.104&lt;/interface&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23746&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G4-TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;cost&gt;5&lt;/cost&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## TRD2 Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><br />
 </p>
<h2><a class="anchor" id="loopandspurconfiguration"></a>
Loop and Spur Configuration</h2>
<div class="image">
<img src="cfg_loop_spur.png" alt="cfg_loop_spur.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G1_to_G3&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.27&lt;/address&gt;
               &lt;port&gt;23801&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G1_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.26&lt;/address&gt;
               &lt;port&gt;23745&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1_to_TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G2</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.28&lt;/address&gt;
               &lt;port&gt;23632&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G1&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23745&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2_to_TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><b>TRD3</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.3.37.85
</pre><p><b>G3</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G3_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.28&lt;/address&gt;
               &lt;port&gt;23754&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G3_to_G1&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23801&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G3_to_TRD3&lt;/name&gt;
         &lt;domain-id&gt;3&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD3.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G4</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G3&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23754&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G4_to_TRD4&lt;/name&gt;
         &lt;domain-id&gt;4&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD4.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23632&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G5&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.29&lt;/address&gt;
               &lt;port&gt;23739&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD4</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.4.37.85
</pre><p><b>G5</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G5_to_TRD5&lt;/name&gt;
         &lt;domain-id&gt;5&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD5.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G5_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23739&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD5</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.5.37.85
</pre><p><br />
 </p>
<h2><a class="anchor" id="starconfiguration"></a>
Star Configuration</h2>
<p>This network consists of four TRDs. Within each TRD, full multicast connectivity exists. However, no multicast connectivity exists between the four TRDs.</p>
<div class="image">
<img src="cfg_star.png" alt="cfg_star.png"/>
</div>
 <p><b>G1</b> <b>Configuration</b> </p>
<p>The configuration for this UM Router also has transport statistics monitoring and the WebMonitor turned on.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!-- UM GW xml file- 3 endpoint portals --&gt;
&lt;tnw-gateway version="1.0"&gt;
  &lt;daemon&gt;
    &lt;log type="console"/&gt;
    &lt;lbm-license-file&gt;lic0014.txt&lt;/lbm-license-file&gt;
    &lt;monitor interval="5"&gt;
      &lt;transport-module module="lbm" options="config=trd1.cfg"/&gt;
    &lt;/monitor&gt;
    &lt;web-monitor&gt;*:15304&lt;/web-monitor&gt;
  &lt;/daemon&gt;
  &lt;portals&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1_to_TRD1&lt;/name&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd1.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1_to_TRD2&lt;/name&gt;
      &lt;domain-id&gt;2&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd2.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1_to_TRD3&lt;/name&gt;
      &lt;domain-id&gt;3&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd3.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;G1_to_TRD4&lt;/name&gt;
      &lt;domain-id&gt;4&lt;/domain-id&gt;
      &lt;lbm-config&gt;trd4.cfg&lt;/lbm-config&gt;
    &lt;/endpoint&gt;
  &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><b>TRD3</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.3.37.85
</pre><p><b>TRD4</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.4.37.85
</pre><p><br />
 </p>
<h2><a class="anchor" id="meshconfiguration"></a>
Mesh Configuration</h2>
<p>The mesh topology utilizes many connections between many nodes, to provide a variety of alternate routes. However, meshes are not the best solution in many cases, as unneeded complexity can increase the chance for configuration errors or make it more difficult to trace problems.</p>
<div class="image">
<img src="cfg_mesh.png" alt="cfg_mesh.png"/>
</div>
 <p><b>TRD1</b> <b>Configuration</b> </p>
<pre class="fragment">### Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.1.37.85
</pre><p><b>G1</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G1_to_G5&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.105&lt;/address&gt;
               &lt;port&gt;23880&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G1_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.104&lt;/address&gt;
               &lt;port&gt;23801&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1_to_TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G1_to_TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G1_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.102&lt;/address&gt;
               &lt;port&gt;23745&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G2</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G5&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.105&lt;/address&gt;
               &lt;port&gt;23608&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23831&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G1&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23745&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G2_to_G3&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.103&lt;/address&gt;
               &lt;port&gt;23632&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G2_to_TRD2&lt;/name&gt;
         &lt;domain-id&gt;2&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD2.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G3</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G3_to_G5&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.105&lt;/address&gt;
               &lt;port&gt;23739&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G3_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23754&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G3_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23632&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>TRD2</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.2.37.85
</pre><p><b>TRD3</b> <b>Configuration</b> </p>
<pre class="fragment">## Global Configuration Options ##
context request_tcp_interface 10.29.3.0/24
context resolver_multicast_port 13965
context resolver_multicast_interface 10.29.3.0/24
context resolver_multicast_address 225.3.37.85
</pre><p><b>G4</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G5&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.105&lt;/address&gt;
               &lt;port&gt;23580&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G4_to_TRD1&lt;/name&gt;
         &lt;domain-id&gt;1&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD1.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;endpoint&gt;
         &lt;name&gt;G4_to_TRD3&lt;/name&gt;
         &lt;domain-id&gt;3&lt;/domain-id&gt;
         &lt;lbm-config&gt;TRD3.cfg&lt;/lbm-config&gt;
      &lt;/endpoint&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G1&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23801&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G3&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.103&lt;/address&gt;
               &lt;port&gt;23754&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G4_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;initiator&gt;
               &lt;address&gt;55.55.10.102&lt;/address&gt;
               &lt;port&gt;23831&lt;/port&gt;
            &lt;/initiator&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><b>G5</b> <b>Configuration</b> </p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
    &lt;daemon&gt;
        &lt;log type="console"/&gt;
    &lt;/daemon&gt;
    &lt;portals&gt;
      &lt;peer&gt;
         &lt;name&gt;G5_to_G4&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23580&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G5_to_G1&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23880&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G5_to_G3&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23739&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
      &lt;peer&gt;
         &lt;name&gt;G5_to_G2&lt;/name&gt;
         &lt;single-tcp&gt;
            &lt;acceptor&gt;
               &lt;listen-port&gt;23608&lt;/listen-port&gt;
            &lt;/acceptor&gt;
         &lt;/single-tcp&gt;
      &lt;/peer&gt;
    &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><br />
 </p>
<h1><a class="anchor" id="usingumconfigurationfileswiththeumrouter"></a>
Using UM Configuration Files with the UM Router</h1>
<p>Within the UM Router configuration file, the endpoint portal's <code>&lt;lbm-config&gt;</code> element lets you import configurations from either a plain text or XML UM configuration file. However, using the XML type of UM configuration files provides the following advantages over plain text UM configuration files:</p>
<ul>
<li>
You can apply UM attributes per topic and/or per context. </li>
<li>
You can apply attributes to all portals on a particular UM Router using a UM XML template (instead of individual portal settings). </li>
<li>
Using UM XML templates to set options for individual portals lets the UM Router process these settings in the <code>&lt;daemon&gt;</code> element instead of within each portal's configuration. </li>
</ul>
<p><br />
 </p>
<h2><a class="anchor" id="settingindividualendpointoptions"></a>
Setting Individual Endpoint Options</h2>
<p>When setting endpoint options, first name the context of each endpoint in the UM Router's XML configuration file.</p>
<pre class="fragment">&lt;portals&gt;
  &lt;endpoint&gt;
    &lt;name&gt;Endpoint_1&lt;/name&gt;
    &lt;domain-id&gt;1&lt;/domain-id&gt;
    &lt;source-context-name&gt;G1_E1&lt;/source-context-name&gt;
    &lt;lbm-attributes&gt;
      &lt;option name="request_tcp_interface" scope="context" value="10.29.4.0/24"/&gt;
    &lt;/lbm-attributes&gt;
  &lt;/endpoint&gt;
  &lt;endpoint&gt;
    &lt;name&gt;G1-TRD2&lt;/name&gt;
    &lt;domain-id&gt;2&lt;/domain-id&gt;
    &lt;receiver-context-name&gt;G1_E2&lt;/source-context-name&gt;
    &lt;lbm-attributes&gt;
      &lt;option name="request_tcp_interface" scope="context" value="10.29.5.0/24" /&gt;
    &lt;/lbm-attributes&gt;
  &lt;/endpoint&gt;
&lt;/portals&gt;
</pre><p>Then assign configuration templates to those contexts in the UM XML configuration file.</p>
<pre class="fragment">&lt;application name="tnwgd" template="global"&gt;
  &lt;contexts&gt;
    &lt;context name="G1_E1" template="G1-E1-options"&gt;
      &lt;sources /&gt;
    &lt;/context&gt;
    &lt;context name="G1_E2" template="G1-E2-options"&gt;
      &lt;sources /&gt;
    &lt;/context&gt;
  &lt;/contexts&gt;
&lt;/application&gt;
</pre><p>You specify the unique options for each of this UM Router's two endpoints in the UM XML configuration <code>&lt;templates&gt;</code> section used for G1-E1-options and G1-E2-options.</p>
<p><br />
 </p>
<h2><a class="anchor" id="umrouterandumxmlconfigurationusecases"></a>
UM Router and UM XML Configuration Use Cases</h2>
<p>One advantage of using UM XML configuration files with the UM Router is the ability to assign unique UM attributes to the topics and contexts used for the proxy sources and receivers (which plain text UM configuration files cannot do). The following example shows how to assign a different LBTRM multicast address to a source based on its topic.</p>
<p>Create a new UM XML configuration template for the desired topic name.</p>
<pre class="fragment">&lt;template name="AAA-template"&gt;
  &lt;options type="source"&gt;
    &lt;option name="transport_lbtrm_multicast_address"
    default-value="225.2.37.88"/&gt;
  &lt;/options&gt;
&lt;/template&gt;
</pre><p>Then include this template in the <code>&lt;application&gt;</code> element associated with the UM Router.</p>
<pre class="fragment">&lt;application name="tnwgd" template="global-options"&gt;
  &lt;contexts&gt;
    &lt;context&gt;
      &lt;sources template="source-options"&gt;
        &lt;topic topicname="AAA" template="AAA-template" /&gt;
      &lt;/sources&gt;
    &lt;/context&gt;
  &lt;/contexts&gt;
&lt;/application&gt;
</pre><p>It is also possible to assign UM attributes directly in the <code>&lt;application&gt;</code> tag. For example, the following specifies that a particular topic should use an LBT-RU transport.</p>
<pre class="fragment">&lt;application name="tnwgd" template="tnwgd-common"&gt;
  &lt;contexts&gt;
    &lt;context&gt;
      &lt;sources template="source-template"&gt;
        &lt;topic topicname="LBTRU_TOPIC"&gt;
          &lt;options type="source"&gt;
            &lt;option name="transport" default-value="lbtru" /&gt;
            &lt;/options&gt;
        &lt;/topic&gt;
      &lt;/sources&gt;
    &lt;/context&gt;
  &lt;/contexts&gt;
&lt;/application&gt;
</pre><p><br />
 </p>
<h2><a class="anchor" id="sampleconfiguration"></a>
Sample Configuration</h2>
<p>The following sample configuration incorporates many of the examples mentioned above. The UM Router applies options to all UM objects created. The UM XML configuration file overwrites these options for two specific topics. The first topic, LBTRM_TOPIC, uses a different template to change its transport from TCP to LBTRM, and to set an additional property. The second topic, LBTRU_TOPIC, also changes its transport from TCP to a new value. However, its new attributes are applied directly in its associated topic tag, instead of referencing a template. In addition, this sample configuration assigns the rm-source template to all sources and receivers associated with the context endpt_1.</p>
<p><br />
 </p>
<h2><a class="anchor" id="xmlumconfigurationfile"></a>
XML UM Configuration File</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;um-configuration version="1.0"&gt;
  &lt;templates&gt;
    &lt;template name="tnwgd-common"&gt;
      &lt;options type="source"&gt;
        &lt;option name="transport" default-value="tcp" /&gt;
      &lt;/options&gt;
      &lt;options type="context"&gt;
        &lt;option name="request_tcp_interface" default-value="10.29.5.6" /&gt;
        &lt;option name="transport_tcp_port_low" default-value="4400" /&gt;
        &lt;option name="transport_tcp_port_high" default-value="4500" /&gt;
        &lt;option name="resolver_multicast_address" default-value="225.2.37.88"/&gt;
      &lt;/options&gt;
    &lt;/template&gt;
    &lt;template name="rm-source"&gt;
      &lt;options type="source"&gt;
        &lt;option name="transport" default-value="lbtrm" /&gt;
        &lt;option name="transport_lbtrm_multicast_address" default-value="225.2.37.89"/&gt;
      &lt;/options&gt;
    &lt;/template&gt;
  &lt;/templates&gt;
  &lt;applications&gt;
    &lt;application name="tnwgd" template="tnwgd-common"&gt;
     &lt;contexts&gt;
        &lt;context&gt;
          &lt;sources&gt;
            &lt;topic topicname="LBTRM_TOPIC" template="rm-source" /&gt;
            &lt;topic topicname="LBTRU_TOPIC"&gt;
              &lt;options type="source"&gt;
                &lt;option name="transport" default-value="lbtru" /&gt;
                &lt;option name="resolver_unicast_daemon" default-value="10.29.5.1:1234" /&gt;
              &lt;/options&gt;
            &lt;/topic&gt;
          &lt;/sources&gt;
        &lt;/context&gt;
        &lt;context name="endpt_1"&gt;
          &lt;sources template="rm-source"/&gt;
        &lt;/context&gt;
      &lt;/contexts&gt;
    &lt;/application&gt;
  &lt;/applications&gt;
&lt;/um-configuration&gt;
</pre><p><br />
 </p>
<h2><a class="anchor" id="xmlumrouterconfigurationfile"></a>
XML UM Router Configuration File</h2>
<p>This UM Router uses the above XML UM configuration file, sample-config.xml, to set its UM options. It has three endpoints, one of which has the context endpt_1.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;tnw-gateway version="1.0"&gt;
  &lt;daemon&gt;
    &lt;log type="console"/&gt;
    &lt;xml-config&gt;sample-config.xml&lt;/xml-config&gt;
  &lt;/daemon&gt;
  &lt;portals&gt;
    &lt;endpoint&gt;
      &lt;name&gt;Endpoint_1&lt;/name&gt;
      &lt;domain-id&gt;1&lt;/domain-id&gt;
      &lt;lbm-attributes&gt;
        &lt;option name="context_name" scope="context" value="endpt_1" /&gt;
        &lt;option name="request_tcp_interface" scope="context"
        value="10.29.4.0/24"/&gt;
      &lt;/lbm-attributes&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;Endpoint_2&lt;/name&gt;
      &lt;domain-id&gt;2&lt;/domain-id&gt;
      &lt;lbm-attributes&gt;
        &lt;option name="request_tcp_interface" scope="context"
        value="10.29.5.0/24"/&gt;
      &lt;/lbm-attributes&gt;
    &lt;/endpoint&gt;
    &lt;endpoint&gt;
      &lt;name&gt;Endpoint_3&lt;/name&gt;
      &lt;domain-id&gt;3&lt;/domain-id&gt;
      &lt;lbm-attributes&gt;
        &lt;option name="request_tcp_interface" scope="context"
        value="10.29.6.0/24"/&gt;
      &lt;/lbm-attributes&gt;
    &lt;/endpoint&gt;
  &lt;/portals&gt;
&lt;/tnw-gateway&gt;
</pre><p><br />
 </p>
<h1><a class="anchor" id="runningtheumrouterdaemon"></a>
Running the UM Router Daemon</h1>
<p>To run the UM Router, ensure the following:</p>
<ul>
<li>
Library environment variable paths are set correctly (LD_LIBRARY_PATH) </li>
<li>
The license environment variable LBM_LICENSE_FILENAME points to a valid UM Router license file. </li>
<li>
The configuration file is error free. </li>
</ul>
<p>Typically, you run the UM Router with one configuration file argument, for example:</p>
<pre class="fragment">tnwgd gw1-config.xml
</pre><p>The UM Router logs version information on startup. The following is an example of this information:</p>
<pre class="fragment">Version 6.0 Build: Sep 26 2012, 00:31:33 (UMS 6.0 [UMP-6.0] [UMQ-6.0] [64-bit] Build: Sep 26 2012, 00:27:17 ( DEBUG license LBT-RM LBT-RU LBT-IPC LBT-RDMA ) WC[PCRE 7.4 2007-09-21, regex, appcb] HRT[gettimeofday()])
</pre><p><br />
 </p>
<h2><a class="anchor" id="tnwgd"></a>
tnwgd</h2>
<p><b>Name</b> </p>
<p>tnwgd - UM Router Daemon</p>
<p><b>Synopsis</b> </p>
<pre class="fragment">tnwgd [-d] [--dump-dtd] [-h] [--help] [-f] [--detach] [-v] [--validate] configfile
</pre><p><b>Description</b> </p>
<p>UM Router services are provided by tnwgd. A UM Router configuration file is required. The contents and format of the configuration file are documented separately.</p>
<p>The DTD used to validate a configuration file is dumped to standard output with <code>-d</code> or <code>--dump-dtd</code>. After dumping the DTD, tnwgd exits instead of providing UM Router services as usual. See <a class="el" href="xmlconfigurationreference.html#umrouterconfigurationdtd">UM Router Configuration DTD</a> for the DTD with comments removed.</p>
<p>To validate the configuration file, use either the <code>-v</code> or <code>--validate</code> options. After attempting validation, tnwgd exits instead of providing UM Router services as usual. The exit status will be 0 for a configuration file successfully validated by the DTD, and non-zero otherwise.</p>
<p>tnwgd normally remains attached to the controlling terminal and runs until interrupted. If the <code>-f</code> or <code>--detach</code> options are given, tnwgd instead forks, detaches the child from the controlling terminal, and the parent exits immediately.</p>
<p>Command line help is available with <code>-h</code> or <code>--help</code>.</p>
<p><b>Exit</b> <b>Status</b> </p>
<p>The exit status from tnwgd is 0 for success and some non-zero value for failure. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>

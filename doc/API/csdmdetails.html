<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>UM C API: C SDM Details</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_api.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM C API
   &#160;<span id="projectnumber">6.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('csdmdetails.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">C SDM Details </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The LBM Self-Describing Message (SDM) API provides a framework for applications to create and use messages containing self-describing data (name and type). An SDM message contains one or more <b>fields</b>. Each field consists of:</p><ul>
<li>A name, limited to 255 characters in length. Field names are <em>not</em> case-sensitive. So, "price" is the same as "Price" is the same as "PRICE".</li>
<li>A type (discussed below).</li>
<li>A value (particular to the field type). Each named field may only appear once in a message. If multiple fields of the same name and type are needed, create an array field. A field in a nested message <b>may</b> have the same name as a field in the outer message, though.</li>
</ul>
<dl class="section user"><dt>Field types</dt><dd>The following field types (and arrays thereof) are supported by SDM: <table class="doxtable">
<tr>
<th>Description </th><th>SDM Type </th><th>C Type  </th></tr>
<tr>
<td>Boolean </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a7603420b9e1820177c4f610e55557297">LBMSDM_TYPE_BOOLEAN</a> </td><td><code>uint8_t</code>  </td></tr>
<tr>
<td>8-bit signed integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a2870eed723b3961a43c865f6c4d78beb">LBMSDM_TYPE_INT8</a> </td><td><code>int8_t</code>  </td></tr>
<tr>
<td>8-bit unsigned integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a1f75c949753c5da7e6fddb00b7961a16">LBMSDM_TYPE_UINT8</a> </td><td><code>uint8_t</code>  </td></tr>
<tr>
<td>16-bit signed integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635af1f123998cbf6761e13bcf46cef95920">LBMSDM_TYPE_INT16</a> </td><td><code>int16_t</code>  </td></tr>
<tr>
<td>16-bit unsigned integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635aa3c5d89e7b6ea2583809db1a46f716da">LBMSDM_TYPE_UINT16</a> </td><td><code>uint16_t</code>  </td></tr>
<tr>
<td>32-bit signed integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a2a87dc1bb2b17b43c44bdfe47d94a0ed">LBMSDM_TYPE_INT32</a> </td><td><code>int32_t</code>  </td></tr>
<tr>
<td>32-bit unsigned integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a737ae8d4bea8a4a04bb4943c37058c59">LBMSDM_TYPE_UINT32</a> </td><td><code>uint32_t</code>  </td></tr>
<tr>
<td>64-bit signed integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a79bbfa6ca045a42b18e9c2ac9c239e33">LBMSDM_TYPE_INT64</a> </td><td><code>int64_t</code>  </td></tr>
<tr>
<td>64-bit unsigned integer </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a259e3d1afa3ebb20b08f794d052c3fef">LBMSDM_TYPE_UINT64</a> </td><td><code>uint64_t</code>  </td></tr>
<tr>
<td>Single-precision floating point </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635abf9b0ea4a33dab2afe5f5097a41ae31e">LBMSDM_TYPE_FLOAT</a> </td><td><code>float</code>  </td></tr>
<tr>
<td>Double-precision floating point </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a11e3f75fc1f0a413fb1380d190c64b55">LBMSDM_TYPE_DOUBLE</a> </td><td><code>double</code>  </td></tr>
<tr>
<td>String </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a4817a47f7c845187789f64872295385d">LBMSDM_TYPE_STRING</a> </td><td><code>char *</code>  </td></tr>
<tr>
<td>Scaled decimal </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a241e432d2a7d9ecda8d3011de7efe065">LBMSDM_TYPE_DECIMAL</a> </td><td><a class="el" href="lbmsdm_8h.html#ad86eed92720bb347fa43970c2448b9c8" title="Structure to hold a scaled decimal number. A scaled decimal number consists of a mantissa  and an exp...">lbmsdm_decimal_t</a>  </td></tr>
<tr>
<td>Timestamp </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a3649309d2138765de406e08f20237f2d">LBMSDM_TYPE_TIMESTAMP</a> </td><td><code>struct timeval</code>  </td></tr>
<tr>
<td>Nested message </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a84825b57a3fe98e16e62fe7765ebb62a">LBMSDM_TYPE_MESSAGE</a> </td><td><a class="el" href="lbmsdm_8h.html#a64eee900c48f611c54d61d58315262d9" title="Message object for SDM (opaque). ">lbmsdm_msg_t</a> <code>*</code>  </td></tr>
<tr>
<td>Binary large object (BLOB) </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a641a3f20adfe83b1bccfcdcd0e3e2f99">LBMSDM_TYPE_BLOB</a> </td><td><code>void *</code>  </td></tr>
<tr>
<td>Unicode string </td><td><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a03c635dd092687d0844dd6eb6e26e68d">LBMSDM_TYPE_UNICODE</a> </td><td><code>wchar_t *</code>  </td></tr>
</table>
</dd></dl>
<dl class="section user"><dt></dt><dd>Note that arrays are homogeneous. All elements of an array must be of the same type. An error is reported if an attempt is made to add an element of one type to an array containing elements of a different type. </dd></dl>
<dl class="section user"><dt>Building a message</dt><dd>A message must be created (via <a class="el" href="lbmsdm_8h.html#a0c553a6bd696d2acb71427e0a63b502d" title="Create an SDM message to be filled in and sent. ">lbmsdm_msg_create()</a> or <a class="el" href="lbmsdm_8h.html#afef825f4e0d85930f9c6d0a73528a5f7" title="Create an SDM message to be parsed and processed from an existing buffer. ">lbmsdm_msg_parse()</a>) before fields can be added. </dd></dl>
<dl class="section user"><dt></dt><dd>Once a field exists within a message, it can be referenced in one of three ways:<ul>
<li>By the name associated with the field.</li>
<li>By index. This refers to the sequential position of the field within a message. The first field has index 0, the second has index 1, and so forth.</li>
<li>By iterator. See below for more information on iterators. </li>
</ul>
</dd></dl>
<dl class="section user"><dt>Adding fields to a message</dt><dd>Scalar (non-array) fields are added to a message via the <code>lbmsdm_msg_add_xxx()</code> API functions, where <code>xxx</code> is the type of the field being added. See the module <a class="el" href="group__add.html">Add a field to a message</a> for information on these functions. </dd></dl>
<dl class="section user"><dt></dt><dd>When adding a field, data of the appropriate type must be supplied. As an example, to add a 32-bit signed integer field named "quantity" to a message: <div class="fragment"><div class="line">int32_t quant = 50;</div><div class="line"><span class="keywordtype">int</span> rc;</div><div class="line">rc = <a class="code" href="group__add.html#ga4e93a5daa3276d79cfb457a630ec8e8e">lbmsdm_msg_add_int32</a>(msg, <span class="stringliteral">&quot;quantity&quot;</span>, quant);</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt></dt><dd>Alternatively, literals may be used to specify the value. The above example could also be coded as: <div class="fragment"><div class="line">rc = <a class="code" href="group__add.html#ga4e93a5daa3276d79cfb457a630ec8e8e">lbmsdm_msg_add_int32</a>(msg, <span class="stringliteral">&quot;quantity&quot;</span>, 50);</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Adding array fields to a message</dt><dd>Array fields are added to a message in two steps. First, the field itself is added via the <code>lbmsdm_msg_add_xxx_array()</code> API functions, where <code>xxx</code> is the type of the field being added. This does not provide a value for the field. See the module <a class="el" href="group__add__array.html">Add an array field to a message</a> for information on these functions. </dd></dl>
<dl class="section user"><dt></dt><dd>Second, individual elements are added to the array field. This is done via the <code>lbmsdm_msg_add_xxx_elem_idx()</code>, <code>lbmsdm_msg_add_xxx_elem_name()</code>, and <code>lbmsdm_iter_add_xxx_elem()</code> API functions. See the modules <a class="el" href="group__add__elem__idx.html">Add an element to an array field by field index</a>, <a class="el" href="group__add__elem__name.html">Add an element to an array field by field name</a>, and <a class="el" href="group__add__elem__iter.html">Add an element to an array field referenced by an iterator</a> for detailed information on these functions. </dd></dl>
<dl class="section user"><dt></dt><dd>As an example, the following code illustrates how to create a string array field, and add 3 elements to it. <div class="fragment"><div class="line">rc = <a class="code" href="group__add__array.html#ga8e9a3830e0add5b4823053e39f00e236">lbmsdm_msg_add_string_array</a>(msg, <span class="stringliteral">&quot;string_array&quot;</span>);</div><div class="line">rc = <a class="code" href="group__add__elem__name.html#ga1b91a99619d7106c816c8560a74deda6">lbmsdm_msg_add_string_elem_name</a>(msg, <span class="stringliteral">&quot;string_array&quot;</span>, <span class="stringliteral">&quot;String1&quot;</span>);</div><div class="line">rc = <a class="code" href="group__add__elem__name.html#ga1b91a99619d7106c816c8560a74deda6">lbmsdm_msg_add_string_elem_name</a>(msg, <span class="stringliteral">&quot;string_array&quot;</span>, <span class="stringliteral">&quot;String2&quot;</span>);</div><div class="line">rc = <a class="code" href="group__add__elem__name.html#ga1b91a99619d7106c816c8560a74deda6">lbmsdm_msg_add_string_elem_name</a>(msg, <span class="stringliteral">&quot;string_array&quot;</span>, <span class="stringliteral">&quot;String3&quot;</span>);</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Serializing the message</dt><dd>Once the SDM message is constructed, it must be serialized for transmission. The API function <a class="el" href="lbmsdm_8h.html#a82a3118d59f2f01f6cc93f9cac832ca3" title="Get the data buffer for a constructed message, after all fields have been added to the message...">lbmsdm_msg_get_data()</a> returns a static pointer to a buffer containing the serialized form of the message, suitable for transmission. The length of the serialized data may be obtained via the API function <a class="el" href="lbmsdm_8h.html#a104e69ab9fc7b987318029702031247e" title="Get the length of the data buffer for a constructed message, after all fields have been added to the ...">lbmsdm_msg_get_datalen()</a>. For example, a constructed message may be sent by: <div class="fragment"><div class="line">rc = <a class="code" href="lbm_8h.html#a91f4b9cb04fe1323ec56833211cc5cb7">lbm_src_send</a>(src, <a class="code" href="lbmsdm_8h.html#a82a3118d59f2f01f6cc93f9cac832ca3">lbmsdm_msg_get_data</a>(msg), lbmsdm_msg_get_length(msg), 0);</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt></dt><dd>The pointer returned by <a class="el" href="lbmsdm_8h.html#a82a3118d59f2f01f6cc93f9cac832ca3" title="Get the data buffer for a constructed message, after all fields have been added to the message...">lbmsdm_msg_get_data()</a> is owned by the SDM API, and will automatically be freed when the message is destroyed. </dd></dl>
<dl class="section user"><dt>Deserializing a message</dt><dd>When a message is received, it must be deserialized so that individual fields can be accessed. This is done via the <a class="el" href="lbmsdm_8h.html#afef825f4e0d85930f9c6d0a73528a5f7" title="Create an SDM message to be parsed and processed from an existing buffer. ">lbmsdm_msg_parse()</a> API function: <div class="fragment"><div class="line"><a class="code" href="lbmsdm_8h.html#a64eee900c48f611c54d61d58315262d9">lbmsdm_msg_t</a> * sdmmsg;</div><div class="line">rc = <a class="code" href="lbmsdm_8h.html#afef825f4e0d85930f9c6d0a73528a5f7">lbmsdm_msg_parse</a>(&amp;sdmmsg, lbmmsg-&gt;data, lbmmsg-&gt;len);</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Disposing of a message</dt><dd>Once an SDM message (created by either the <a class="el" href="lbmsdm_8h.html#a0c553a6bd696d2acb71427e0a63b502d" title="Create an SDM message to be filled in and sent. ">lbmsdm_msg_create()</a> or <a class="el" href="lbmsdm_8h.html#afef825f4e0d85930f9c6d0a73528a5f7" title="Create an SDM message to be parsed and processed from an existing buffer. ">lbmsdm_msg_parse()</a> API calls) is no longer needed, it must be disposed of to avoid a resource leak. This is done via the <a class="el" href="lbmsdm_8h.html#a5a40892bca8dfe9c5a5596fe7f12cce9" title="Destroy an SDM message object. ">lbmsdm_msg_destroy()</a> API call. </dd></dl>
<dl class="section user"><dt>Retrieving field information</dt><dd>A number of API functions are available to retrieve information about individual fields.<ul>
<li><a class="el" href="lbmsdm_8h.html#aa60feb341c09f6526311630d32341bcd" title="Get the number of fields in a message. ">lbmsdm_msg_get_fldcnt()</a> returns the number of fields in the message.</li>
<li><a class="el" href="lbmsdm_8h.html#ad6c2f6b756b576d4df495c4f7e2543e5" title="Get the name of a field in a message by field index. ">lbmsdm_msg_get_name_idx()</a> and <a class="el" href="lbmsdm_8h.html#a42e484cc335cbda5ab757f304a05335c" title="Get the name of the current field for an iterator. ">lbmsdm_iter_get_name()</a> return the field name associated with the referenced field.</li>
<li><a class="el" href="lbmsdm_8h.html#a3be732b6f20813cff9b3472cbd99120d" title="Get the type of a field in a message by field name. ">lbmsdm_msg_get_type_name()</a>, <a class="el" href="lbmsdm_8h.html#a4fca53e472ee05c1bf53605a7896d094" title="Get the type of a field in a message by field index. ">lbmsdm_msg_get_type_idx()</a>, and <a class="el" href="lbmsdm_8h.html#ad716e8f885b7fd62e51114b469a7d422" title="Get the type of the current field for an iterator. ">lbmsdm_iter_get_type()</a> return the type of the referenced field.</li>
<li><a class="el" href="lbmsdm_8h.html#ac2b0ad3b81ea8fcd5dc6fd6dd9200e93" title="Get the number of elements in an array field in a message by field name. ">lbmsdm_msg_get_elemcnt_name()</a>, <a class="el" href="lbmsdm_8h.html#a0b8d75c28a1130b992b8ca55e944f604" title="Get the number of elements in an array field by field index. ">lbmsdm_msg_get_elemcnt_idx()</a>, and <a class="el" href="lbmsdm_8h.html#ae32f13c82810de71c2a038376f8ad16f" title="Get the number of elements in the current array field for an iterator. ">lbmsdm_iter_get_elemcnt()</a> return the number of elements in an array field.</li>
<li><a class="el" href="lbmsdm_8h.html#a8bc19a44bdebaa5001c1dc7ad6df3806" title="Get the length (in bytes) required for a field in a message by field name. ">lbmsdm_msg_get_len_name()</a>, <a class="el" href="lbmsdm_8h.html#a2e6b00f27514202c07cac26aec52cad5" title="Get the length (in bytes) required for a field in a message by field index. ">lbmsdm_msg_get_len_idx()</a>, and <a class="el" href="lbmsdm_8h.html#a0cd3ca583cd8180fd7854857385bb91b" title="Get the length (in bytes) required for the current field for an iterator. ">lbmsdm_iter_get_len()</a> return the length (in bytes) required for a field.</li>
<li><a class="el" href="lbmsdm_8h.html#a1fede1127ad9db457928061185ce5968" title="Get the length (in bytes) required for an array field element in a message by field name...">lbmsdm_msg_get_elemlen_name()</a>, <a class="el" href="lbmsdm_8h.html#a6374fee21bbce1232142c8b9435aa3d3" title="Get the length (in bytes) required for an array field element in a message by field index...">lbmsdm_msg_get_elemlen_idx()</a>, and <a class="el" href="lbmsdm_8h.html#a8c02e4b34ac98669abefc81da3ddf2ef" title="Get the length (in bytes) required for an element of the current array field for an iterator...">lbmsdm_iter_get_elemlen()</a> return the length (in bytes) for a specific element in an array field. </li>
</ul>
</dd></dl>
<dl class="section user"><dt>Fetching fields from a message</dt><dd>When fetching a field from a message, the field may be referenced by name, by index, or via an iterator. </dd></dl>
<dl class="section user"><dt></dt><dd>Scalar (non-array) fields may be retrieved via the <code>lbmsdm_msg_get_xxx_name()</code>, <code>lbmsdm_msg_get_xxx_idx()</code>, or <code>lbmsdm_iter_get_xxx()</code> functions, where <code>xxx</code> is the type the field value should be retrieved as. The sections <a class="el" href="group__get__scalar__name.html">Get scalar field values by field name</a>, <a class="el" href="group__get__scalar__idx.html">Get scalar field values by field index</a>, and <a class="el" href="group__get__scalar__iter.html">Get a scalar field via an iterator</a> contain detailed information on these functions. </dd></dl>
<dl class="section user"><dt></dt><dd>Array field elements may be retrieved via the <code>lbmsdm_msg_get_xxx_elem_name()</code>, <code>lbmsdm_msg_get_xxx_elem_idx()</code>, or <code>lbmsdm_iter_get_xxx_elem()</code> functions, where <code>xxx</code> is the type the field element value should be retrieved as. The sections <a class="el" href="group__get__elem__name.html">Get an element from an array field by field name</a>, <a class="el" href="group__get__elem__idx.html">Get an element from an array field by field index</a>, and <a class="el" href="group__get__elem__iter.html">Get an element from an array field referenced by an iterator</a> contain detailed information on these functions. </dd></dl>
<dl class="section user"><dt>Type conversion</dt><dd>A limited form of automatic type conversion is provided. Numeric-based fields can be converted to other numeric-based fields. For example, a field defined as <code><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635a7603420b9e1820177c4f610e55557297">LBMSDM_TYPE_BOOLEAN</a></code> may be retrieved as an <code><a class="el" href="lbmsdm_8h.html#a726ca809ffd3d67ab4b8476646f26635abf9b0ea4a33dab2afe5f5097a41ae31e">LBMSDM_TYPE_FLOAT</a></code>. The numeric types are: <ul>
<li>
boolean </li>
<li>
int8 </li>
<li>
uint8 </li>
<li>
int16 </li>
<li>
uint16 </li>
<li>
int32 </li>
<li>
uint32 </li>
<li>
int64 </li>
<li>
uint64 </li>
<li>
float </li>
<li>
double </li>
<li>
decimal </li>
</ul>
Note that if the value being retrieved cannot be represented in the type it is retrieved as, the result is not defined, but no error is indicated. For example if a uint32 field with the value 300 is retrieved as an int8, the result is not defined. </dd></dl>
<dl class="section user"><dt></dt><dd>Non-numeric types may not be converted to other types. The non-numeric types are: <ul>
<li>
string </li>
<li>
unicode </li>
<li>
timestamp </li>
<li>
BLOB </li>
<li>
message </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>The above conversion rules apply also when retrieving array elements. </dd></dl>
<dl class="section user"><dt>Fetching string, unicode, and BLOB values</dt><dd>When fetching a field or array element value as a string, unicode, or BLOB, the data is copied into a buffer provided by the application. In addition to the buffer, the size of the buffer must be given. The size is specified in bytes for string and BLOB fields, and in <code>wchar_t</code>s for unicode fields. If the size specified is too small for the data, the error code <a class="el" href="lbmsdm_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2daed37411487ba42efc6835277834605af">LBMSDM_INSUFFICIENT_BUFFER_LENGTH</a> is returned. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt>Fetching message fields</dt><dd>When fetching the value of a message field, a copy of the message is created (via <a class="el" href="lbmsdm_8h.html#a07be55b4d1541cd10c9a75629d2097c1" title="Clone an existing SDM message. This function is not thread safe. ">lbmsdm_msg_clone()</a>) and returned. It is the application's responsibility to destroy the message (via <a class="el" href="lbmsdm_8h.html#a5a40892bca8dfe9c5a5596fe7f12cce9" title="Destroy an SDM message object. ">lbmsdm_msg_destroy()</a>) when it is no longer needed. </dd></dl>
<dl class="section user"><dt>Modifying fields in a message</dt><dd>Existing fields in a message may be modified, both in terms of the field type and field value. For scalar (non-array) fields, the <code>lbmsdm_msg_set_xxx_idx()</code>, <code>lbmsdm_msg_set_xxx_name()</code>, and <code>lbmsdm_iter_set_xxx()</code> API functions may be used, where <code>xxx</code> is the type to be assigned to the field. See the sections <a class="el" href="group__set__idx.html">Set a field value in a message by field index</a>, <a class="el" href="group__set__name.html">Set a field value in a message by field name</a>, and <a class="el" href="group__set__iter.html">Set a field value in a message referenced by an iterator</a> for information on these functions. </dd></dl>
<dl class="section user"><dt></dt><dd>For array fields, the <code>lbmsdm_msg_set_xxx_array_idx()</code>, <code>lbmsdm_msg_set_xxx_array_name()</code>, and <code>lbmsdm_iter_set_xxx_array()</code> API functions may be used, where <code>xxx</code> is the type to be assigned to the field. See the sections <a class="el" href="group__set__array__idx.html">Set a field value in a message by field index to an array field</a>, <a class="el" href="group__set__array__name.html">Set a field value in a message by field name to an array field</a>, and <a class="el" href="group__set__array__iter.html">Set a field value in a message, referenced by an iterator, to an array field.</a> for information on these functions. As when adding an array field to a message, once the field type has been set to an array type, individual elements must be added to the array field. </dd></dl>
<dl class="section user"><dt></dt><dd>Individual elements of an array field may be modified via the <code>lbmsdm_msg_set_xxx_elem_idx()</code>, <code>lbmsdm_msg_set_xxx_elem_name()</code>, and <code>lbmsdm_iter_set_xxx_elem()</code> API functions. See the sections <a class="el" href="group__set__elem__idx.html">Set an array field element value by field index</a>, <a class="el" href="group__set__elem__name.html">Set an array field element value by field name</a>, and <a class="el" href="group__set__elem__iter.html">Set an array field element value for a field referenced by an iterator</a> for information on these functions. Note that arrays must contain homogeneous elements, so the type of an array element may not be changed, and is considered an error. </dd></dl>
<dl class="section user"><dt>Deleting fields from a message</dt><dd>A field may be deleted from a message via the <a class="el" href="lbmsdm_8h.html#a5f941ca35bb4006a63caa58cdd88d035" title="Delete a field from a message by field index. ">lbmsdm_msg_del_idx()</a>, <a class="el" href="lbmsdm_8h.html#ae7a1e0d6a380f88c088aef6f12600c21" title="Delete a field from a message by field name. ">lbmsdm_msg_del_name()</a>, and <a class="el" href="lbmsdm_8h.html#a14b0861ec4be110c98e98d2cb1ebc87d" title="Delete a field referenced by an iterator. ">lbmsdm_iter_del()</a> API calls. Deleting a field will cause any fields following it to be moved down one position, changing the index of those fields and potentially invalidating any iterators for that message. </dd></dl>
<dl class="section user"><dt>Deleting elements from an array field</dt><dd>Individual elements may be deleted from an array field via the <a class="el" href="lbmsdm_8h.html#ac8e07247b403ec633b1bb9b61dca5958" title="Delete an element from an array field by field index. ">lbmsdm_msg_del_elem_idx()</a>, <a class="el" href="lbmsdm_8h.html#a769aad78a232884b89f397945cfe88c0" title="Delete an element from an array field by field name. ">lbmsdm_msg_del_elem_name()</a>, and <a class="el" href="lbmsdm_8h.html#aba2b8db945224863ffd7c68022f8ccfb" title="Delete an element from an array field referenced by an iterator. ">lbmsdm_iter_del_elem()</a> API functions. </dd></dl>
<dl class="section user"><dt>Null fields</dt><dd>SDM supports the concept of a <b>null</b> field. A null field is present in the message, but has no value associated with it. Once added to a message, a field may be set to null via the <a class="el" href="lbmsdm_8h.html#afea66db3e28e12d98ac3a6c1f4bece5f" title="Set a field in a message to null, by field index. ">lbmsdm_msg_set_null_idx()</a>, <a class="el" href="lbmsdm_8h.html#a776cacd372d044a35a5463d5df8ecece" title="Set a field in a message to null, by field name. ">lbmsdm_msg_set_null_name()</a>, or <a class="el" href="lbmsdm_8h.html#ac7554b1dbde0533e48c4a544d1e97017" title="Set the field referenced by an iterator to null. ">lbmsdm_iter_set_null()</a> API functions. Setting the field (which may be either a scalar or array field) to null removes any values currently associated with the field. </dd></dl>
<dl class="section user"><dt></dt><dd>The <a class="el" href="lbmsdm_8h.html#af5a9143cff98bd4acf890f5d6532588c" title="Determine if a field in a message is null, by field index. ">lbmsdm_msg_is_null_idx()</a>, <a class="el" href="lbmsdm_8h.html#a6c720c63f94de0c75cc78c2b9d748d07" title="Determine if a field in a message is null, by field name. ">lbmsdm_msg_is_null_name()</a>, and <a class="el" href="lbmsdm_8h.html#afe96f6fd276bc277990d27a85e2ffc5f" title="Determine if the field referenced by an iterator is null. ">lbmsdm_iter_is_null()</a> API functions allow an application to determine if a given field is null. </dd></dl>
<dl class="section user"><dt></dt><dd>Attempting to retrieve a value or element value from a null field is not allowed, and will return an error. </dd></dl>
<dl class="section user"><dt>Iterators</dt><dd>A field iterator allows sequential operation on the fields of a message without requiring the field name or index. An iterator is created via <a class="el" href="lbmsdm_8h.html#aca5fa8e8896fdebcf07e64967c97e624" title="Create an SDM message iterator. ">lbmsdm_iter_create()</a>, the first field in a message is located via <a class="el" href="lbmsdm_8h.html#a5c94a14aab279ea75f76034d4bf34699" title="Position an iterator to the first field in the message. ">lbmsdm_iter_first()</a>, and the next field is located via <a class="el" href="lbmsdm_8h.html#a35f7d1afca3f6f395eb5458f9f84cae8" title="Position an iterator to the next field in the message. ">lbmsdm_iter_next()</a>. An iterator should be destroyed when no longer needed, using the <a class="el" href="lbmsdm_8h.html#a499ed20c6f2e2613bea7e67d435fe8bf" title="Destroy an SDM message iterator. ">lbmsdm_iter_destroy()</a> API call. </dd></dl>
<dl class="section user"><dt></dt><dd>Message fields may be queried, fetched, modified, and deleted via an iterator. In each case, the operation applies to the field currently referenced by the iterator. </dd></dl>
<dl class="section user"><dt>Error information</dt><dd>All functions return a value to indicate the success of failure of the operation. Most return <a class="el" href="lbmsdm_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da4bbd2b29fbb42991e4d47bdd37825aa7">LBMSDM_SUCCESS</a> to indicate success, or <a class="el" href="lbmsdm_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da6bc49cc1220175c7324255583eece1f9">LBMSDM_FAILURE</a> otherwise. Consult the individual function documentation for exceptions. </dd></dl>
<dl class="section user"><dt></dt><dd>The function <a class="el" href="lbmsdm_8h.html#a74ae9f09aeb07700c9961a8fa66cddbc" title="Return the error number last encountered by this thread. ">lbmsdm_errnum()</a> can be used to retrieve a detailed error code for the last error encountered, while <a class="el" href="lbmsdm_8h.html#a1011ba472b43e77c12156db60351876d" title="Return an ASCII string containing the error message last encountered by this thread. ">lbmsdm_errmsg()</a> will return a descriptive error message. </dd></dl>
<dl class="section user"><dt>Message Options</dt><dd>The performance of SDM can be tuned through the use of message options. Options are contained within an attributes object (<a class="el" href="lbmsdm_8h.html#a0312b62f163a925b0a106d697d518566" title="Message attributes object for SDM (opaque). ">lbmsdm_msg_attr_t</a>), which is created via <a class="el" href="lbmsdm_8h.html#a6322b91d268c1178f3b9087e5dbd0f84" title="Create and fill an SDM message attribute object with the default values. ">lbmsdm_msg_attr_create()</a>. When no longer needed, an attributes object can be discarded by calling <a class="el" href="lbmsdm_8h.html#a9db444e1d15c2adb6c711c16543a0474" title="Delete an SDM message attribute object. ">lbmsdm_msg_attr_delete()</a>. Individual options within an attributes object can be set via <a class="el" href="lbmsdm_8h.html#a444a7cdc319a624b16632e9173908e94" title="Set an option for the given SDM message attribute object. ">lbmsdm_msg_attr_setopt()</a> and <a class="el" href="lbmsdm_8h.html#acde0a490355a4ec8cc36e528a1d9bd34" title="Set an option for the given SDM message attribute object using a string. ">lbmsdm_msg_attr_str_setopt()</a>, and can be queried via <a class="el" href="lbmsdm_8h.html#a8b1255f6c17ec66f15a8a6c6ee272659" title="Retrieve the value of an option for the given SDM message attribute. ">lbmsdm_msg_attr_getopt()</a> and <a class="el" href="lbmsdm_8h.html#a907f89d21d20ad21fdd8b31ead0f580b" title="Retrieve the value of an option for the given SDM message attribute as a string. ">lbmsdm_msg_attr_str_getopt()</a>. A set of options can be specified at message creation time using <a class="el" href="lbmsdm_8h.html#ab9467f023dd840310da3ab4742f61b5d" title="Create an SDM message to be filled in and sent, with options. ">lbmsdm_msg_create_ex()</a> and <a class="el" href="lbmsdm_8h.html#a04bb9a7c92cf091b215ff1a38290172a" title="Create an SDM message to be parsed and processed from an existing buffer, with options. ">lbmsdm_msg_parse_ex()</a>. </dd></dl>
<dl class="section user"><dt></dt><dd>The following table lists the supported message options. <table class="doxtable">
<tr>
<th>Option </th><th>Data type </th><th>Allowed values </th><th>Default </th><th>Description  </th></tr>
<tr>
<td align="left"><code>field_array_allocation</code> </td><td align="center"><code>int</code> </td><td align="center">Any integer &gt;= 0 </td><td align="center">32 </td><td><p class="starttd">Internally, SDM maintains an array of field entries within a message. This option controls both the number of field entries initially allocated when the message is created, and the increment used when the array must be expanded when a field is added but the array is full. </p>
<p>If it is known that a large number of fields will be added to a message, setting this option to a larger value will result in a slight performance boost, since reallocation of the field array will occur less frequently. </p>
<p></p>
<p>Similarly, if the number of fields to be added is small, setting this option to a smaller value will effect a small savings in memory usage (as well as reducing memory fragmentation). </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td align="left"><code>name_tree</code> </td><td align="center"><code>int</code> </td><td align="center">1 (enable) or 0 (disable) </td><td align="center">1 </td><td><p class="starttd">In order to speed up access to fields by name, a tree of field names is maintained for each message. Maintenance of this tree (such as when fields are added or deleted) does incur some overhead. </p>
<p>In situations where fields are only added to a message (and not retrieved), this overhead can be eliminated by setting this option to <code>0</code>. Be aware, however, that retrieving a field by name from a message for which the name tree is disabled, will degenerate to using a linear search of the field array to locate the named field. This can incur much more overhead than was saved by not using the name tree. </p>
<p></p>
<p>In addition, the use of the name tree allows SDM to detect (and prevent) the attempt to add two fields with the same name. Disabling the name tree also disables this safeguard. Further, any attempts to parse a message with duplicate field names using <a class="el" href="lbmsdm_8h.html#afef825f4e0d85930f9c6d0a73528a5f7" title="Create an SDM message to be parsed and processed from an existing buffer. ">lbmsdm_msg_parse()</a> or <a class="el" href="lbmsdm_8h.html#a04bb9a7c92cf091b215ff1a38290172a" title="Create an SDM message to be parsed and processed from an existing buffer, with options. ">lbmsdm_msg_parse_ex()</a> will fail and return an error. </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td align="left"><code>integer_fieldname</code> </td><td align="center"><code>int</code> </td><td align="center">1 (enable) or 0 (disable) </td><td align="center">0 </td><td><p class="starttd">Some optimizations can be done within SDM if it is known that each field name will be the string representation of a non-negative integer. Rather than looking up by name, each field name is used as the index of the field, and name lookups can be faster. </p>
<p>This option requires each field name to be a string representation of a non-negative integer. Any attempts to add a field or parse a message containing a field name which is not the string representation of a non-negative integer, when this option is set, will fail and return an error. </p>
<p class="endtd"></p>
</td></tr>
</table>
</dd></dl>
<dl class="section user"><dt></dt><dd>As an example, the following code fragment creates an attributes object, sets options, get the options, creates a message using the attributes object, then destroys the attributes object. For the sake of brevity, error checking has been omitted, as has the code to add fields to the message. <div class="fragment"><div class="line"><a class="code" href="lbmsdm_8h.html#a0312b62f163a925b0a106d697d518566">lbmsdm_msg_attr_t</a> * attr;</div><div class="line"><a class="code" href="lbmsdm_8h.html#a64eee900c48f611c54d61d58315262d9">lbmsdm_msg_t</a> * msg;</div><div class="line"><span class="keywordtype">int</span> name_tree;</div><div class="line"><span class="keywordtype">int</span> alloc_size;</div><div class="line"><span class="keywordtype">char</span> val_buf[256];</div><div class="line"><span class="keywordtype">size_t</span> val_len;</div><div class="line"></div><div class="line"><a class="code" href="lbmsdm_8h.html#a6322b91d268c1178f3b9087e5dbd0f84">lbmsdm_msg_attr_create</a>(&amp;attr);</div><div class="line"></div><div class="line">name_tree = 0;</div><div class="line"><a class="code" href="lbmsdm_8h.html#a444a7cdc319a624b16632e9173908e94">lbmsdm_msg_attr_setopt</a>(attr, <span class="stringliteral">&quot;name_tree&quot;</span>, (<span class="keywordtype">void</span> *)&amp;name_tree, <span class="keyword">sizeof</span>(name_tree));</div><div class="line"><a class="code" href="lbmsdm_8h.html#acde0a490355a4ec8cc36e528a1d9bd34">lbmsdm_msg_attr_str_setopt</a>(attr, <span class="stringliteral">&quot;field_array_allocation&quot;</span>, <span class="stringliteral">&quot;128&quot;</span>);</div><div class="line"></div><div class="line">val_len = <span class="keyword">sizeof</span>(val_buf);</div><div class="line"><a class="code" href="lbmsdm_8h.html#a907f89d21d20ad21fdd8b31ead0f580b">lbmsdm_msg_attr_str_getopt</a>(attr, <span class="stringliteral">&quot;name_tree&quot;</span>, val_buf, &amp;val_len);</div><div class="line">printf(<span class="stringliteral">&quot;name_tree=%s\n&quot;</span>, val_buf);</div><div class="line">val_len = <span class="keyword">sizeof</span>(alloc_size);</div><div class="line"><a class="code" href="lbmsdm_8h.html#a8b1255f6c17ec66f15a8a6c6ee272659">lbmsdm_msg_attr_getopt</a>(attr, <span class="stringliteral">&quot;field_array_allocation&quot;</span>, (<span class="keywordtype">void</span> *)&amp;alloc_size, &amp;val_len);</div><div class="line">printf(<span class="stringliteral">&quot;field_array_allocation=%d\n&quot;</span>, alloc_size);</div><div class="line"></div><div class="line"><a class="code" href="lbmsdm_8h.html#ab9467f023dd840310da3ab4742f61b5d">lbmsdm_msg_create_ex</a>(&amp;msg, attr);</div><div class="line"></div><div class="line"><a class="code" href="lbmsdm_8h.html#a9db444e1d15c2adb6c711c16543a0474">lbmsdm_msg_attr_delete</a>(attr);</div></div><!-- fragment --></dd></dl>
<p><br />
<br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>

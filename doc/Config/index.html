<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Configuration Guide: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Configuration Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title"></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<img src="infa_logo.png" width="400" height="138" alt="Informatica"/><br/><br/>
<big><b>Ultra Messaging</b></big> <small>(Version 6.15)</small><br/>
<br/><br/><br/>
<center class="mytitle">Configuration Guide</center>
<br/><br/><br/>
[&nbsp;<a href="html1/index.html">Single-page HTML</a>&nbsp;]&nbsp;&nbsp;|&nbsp;&nbsp;[&nbsp;<a href="Configuration_Guide=en.pdf">PDF</a>&nbsp;]
<br/><br/>
<h1>Introduction</h1>
</p>
<p>This document describes how Ultra Messaging-based user applications are configured.</p>
<p>For information on configuring other UM components, see: </p><ul>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/design.tag:../Design/" href="../Design/lbmrdconfigurationfile.html">Lbmrd (Unicast Resolver Daemon) Configuration</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/design.tag:../Design/" href="../Design/srsconfigurationfile.html">SRS (TCP-based Resolver Service) Configuration</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/gateway.tag:../Gateway/" href="../Gateway/xmlconfigurationreference.html">DRO Configuration</a> </li>
<li>
<a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/ume.tag:../UME/" href="../UME/configurationreferenceforumestored.html">Persistent Store Configuration</a> </li>
</ul>
<p>For policies and procedures related to Ultra Messaging Technical Support, see <a href="https://ultramessaging.github.io/UM_Support.html">UM Support</a>.</p>
<p><b>(C) Copyright 2004,2022 Informatica LLC. All Rights Reserved.</b></p>
<p>This software and documentation are provided only under a separate license agreement containing restrictions on use and disclosure. No part of this document may be reproduced or transmitted in any form, by any means (electronic, photocopying, recording or otherwise) without prior consent of Informatica LLC.</p>
<p>A current list of Informatica trademarks is available on the web at <a href="https://www.informatica.com/trademarks.html">https://www.informatica.com/trademarks.html</a>.</p>
<p>Portions of this software and/or documentation are subject to copyright held by third parties. Required third party notices are included with the product.</p>
<p>This software is protected by patents as detailed at <a href="https://www.informatica.com/legal/patents.html">https://www.informatica.com/legal/patents.html</a>.</p>
<p>The information in this documentation is subject to change without notice. If you find any problems in this documentation, please report them to us in writing at Informatica LLC 2100 Seaport Blvd. Redwood City, CA 94063.</p>
<p>Informatica products are warranted according to the terms and conditions of the agreements under which they are provided. <br />
INFORMATICA LLC PROVIDES THE INFORMATION IN THIS DOCUMENT "AS IS" WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING WITHOUT ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND ANY WARRANTY OR CONDITION OF NON-INFRINGEMENT.</p>
<p>This document assumes familiarity with the <a href="../Design/index.html">UM Concepts Guide</a>.</p>
<p>See <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/design.tag:../Design/" href="../Design/umglossary.html">UM Glossary</a> for Ultra Messaging terminology, abbreviations, and acronyms.</p>
<p><br />
 </p>
<h1><a class="anchor" id="configurationoverview"></a>
Configuration Overview&nbsp;&nbsp;<small><a href="#configurationoverview">&lt;-</a></small></h1>
<p>There are different kinds of configuration. </p><ul>
<li>
Applications create UM objects (contexts, sources, receivers) using the UM library. Those objects must be configured to control their operation and behavior using <b>"LBM configuration options"</b>. An application typically uses an <b>"LBM configuration file"</b> in either XML or flat format. </li>
<li>
Informatica daemons (e.g. SRS, Store, DRO) are configured using program-specific configuration files in XML format. </li>
<li>
Informatica daemons (e.g. SRS, Store, DRO) also internally create UM objects (contexts, sources, receivers) using the UM library. Those objects must also be configured using one or more LBM configuration files. </li>
</ul>
<p>This document describes the options available for LBM configuration.</p>
<p>For Ultra Messaging applications, you can set a variety of operational options to customize the application's behavior or performance. You assign values to these options in configuration files or by using API calls. You can assign option values to objects upon or after object creation. Within an object, the implemented option values are referred to as attributes.</p>
<p>Ultra Messaging uses reasonable default values for configuration options, enabling applications to run "out of the box." However, expect to customize Ultra Messaging options to optimize your operating environment. You can use different ways to configure option default and customized value assignments.</p>
<p><br />
 </p>
<h2><a class="anchor" id="assignmentmethods"></a>
Assignment Methods&nbsp;&nbsp;<small><a href="#assignmentmethods">&lt;-</a></small></h2>
<p>You can use the following ways to set attributes with configuration options:</p>
<dl class="section user"><dt><b>plain</b> <b>text</b> <b>configuration</b> <b>file</b> </dt><dd>The simplest way to configure an application, a plain text configuration file (sometimes called a "flat" file) allows you to re-define UM's default berhaviors. These new defaults are read into a process-global configuration buffer, and are used as UM objects are created. Note that after reading a plain text configuration file, an application can still override the defaults on a per-object basis using UM's API. <b>NOTE: Informatica recommends the use of XML configuration files for their added flexibility.</b></dd></dl>
<dl class="section user"><dt><b>XML</b> <b>configuration</b> <b>file</b> </dt><dd>An XML configuration file provides a more sophisticated way to set UM's default behavior, allowing users to customize UM's default behavior on a per-application and/or per-object basis. And while an application can still override the defaults, restrictions can be imposed, constraining applications to only certain options and certain values of those options. <b>NOTE: Informatica recommends the use of XML configuration files.</b></dd></dl>
<dl class="section user"><dt><b>attributes</b> <b>objects</b> <b>API</b> </dt><dd>The application program can call API functions to create UM attributes objects and set configuration options in those objects. The attributes objects are then used to create other UM messaging objects to set those options. </dd></dl>
<dl class="section user"><dt></dt><dd>Alternatively, there are API functions which allow you to modify a subset of configurable options on already-created UM messaging objects. <b>NOTE: Informatica recommends the use of XML configuration files so that configuration can be adjusted without changing source code.</b></dd></dl>
<p>The following image shows the different ways Ultra Messaging stores and assigns option values before, during, and after primitive object creation. Primitive objects are sources, receivers, wildcard receivers, event queues, contexts, or HFX objects. The ultimate result is a primitive object with the assigned values residing in current attributes.</p>
<div class="image">
<img src="Attr_Config_and_XML.png" alt="Attr_Config_and_XML.png"/>
</div>
 <p>The <em>initial default attributes</em> is the set of factory defaults in Ultra Messaging. At process initialization time, these factory defaults are copied into a set of internal process-global attribute structures (<em>current default attributes</em>).</p>
<p>An application can modify desired options by reading a <em>plaintext configuration file</em>. UM will store these values in <em>current default attributes</em>, overwriting the factory defaults.</p>
<p>An instantiated primitive object uses values from current default attributes, the <em>XML config table</em>, and the <em>custom attributes object</em>, and then holds the results in <em>current attributes</em>.</p>
<p>An <em>XML configuration file</em> can pass its setting to an object being created either by directly populating the XML config table, or by creating a custom attributes object.</p>
<p><br />
 </p>
<h2><a class="anchor" id="assignmentflow"></a>
Assignment Flow&nbsp;&nbsp;<small><a href="#assignmentflow">&lt;-</a></small></h2>
<p>The above diagram implies, but does not fully explain, the flow of attribute value assignment that UM performs when an application creates a primitive object. This flow is described below, and is important in understanding how and when default values are overridden:</p>
<ol>
<li>
If applicable, copy plain text configuration file values to current process-global default attributes. </li>
<li>
Start creating object. </li>
<li>
Custom attributes object(s) created/populated (if applicable). </li>
<li>
If lbm_*_create() has a NULL attr, copy current default attributes into current attributes. Otherwise, copy custom attributes object values into current attributes. </li>
<li>
Read applicable options from the XML config table into the current attributes. Do not overwrite options set with <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#aecac05969bba0d6057589ca03dfe60a2">lbm_config()</a>, or lbm_*_attr_setopt(), which were tagged when modified. </li>
<li>
Finish object creation. </li>
<li>
current attributes can be changed further (only certain options) via lbm_*_setopt(). </li>
</ol>
<p><br />
 </p>
<h2><a class="anchor" id="definitions"></a>
Definitions&nbsp;&nbsp;<small><a href="#definitions">&lt;-</a></small></h2>
<p>Before discussing how UM options can be set, some terminology is in order.</p>
<dl class="section user"><dt><b>Option</b> </dt><dd>A single configuration item that controls some aspect of UM operation. An option typically resides in a configuration file, but can also be assigned a value via API call. We use options to assign values to an object's attributes.</dd></dl>
<dl class="section user"><dt><b>Attribute</b> </dt><dd>An operational characteristic of an object. An attribute's value is set by an option, hence, there is a one-to-one correspondence between options and attributes. (Note: This use of the term "attribute" is unrelated to, and not to be confused with, "attribute" in XML syntax. In this document, we refer to the latter as "XML attribute".)</dd></dl>
<dl class="section user"><dt><b>XML</b> <b>attribute</b> </dt><dd>See above. In XML syntax, XML attributes are parameters for XML elements.</dd></dl>
<dl class="section user"><dt><b>Custom</b> <b>attributes</b> <b>object</b> </dt><dd>A UM object that contains custom attribute values (set by options) for a specific UM object. Separate (and multiple) sets of attributes can exist for each application, though only one can be used when creating a primitive object.</dd></dl>
<dl class="section user"><dt><b>Initial</b> <b>default</b> <b>attributes</b> </dt><dd>The default attributes values built into UM. UM and your applications use these if you have not set any options for the attributes.</dd></dl>
<dl class="section user"><dt><b>Primitive</b> <b>object</b> </dt><dd>Specifically, an object that is a source, receiver, wildcard receiver, event queue, context, or HFX object.</dd></dl>
<dl class="section user"><dt><b>Configuration</b> <b>file</b> </dt><dd>This comes in two types: XML and plain text. Configuration files contain assigned values for options, but the different types are read/copied at different times during the creation of an object.</dd></dl>
<dl class="section user"><dt><b>XML</b> <b>config</b> <b>table</b> </dt><dd>Contains option values that are read from the XML configuration file.</dd></dl>
<dl class="section user"><dt><b>Current</b> <b>default</b> <b>attributes</b> </dt><dd>The attributes values used to create an object in the absence of custom attributes values.</dd></dl>
<dl class="section user"><dt><b>Current</b> <b>attributes</b> </dt><dd>The attribute values for an instantiated UM object that control the current operation of that object.</dd></dl>
<dl class="section user"><dt><b>Scope</b> </dt><dd>The type of object to which an option can apply. Possible scopes are context, source, receiver, wildcard_receiver, event_queue, and hfx.</dd></dl>
<p><br />
 </p>
<h2><a class="anchor" id="whichmethodshouldiuse"></a>
Which Method Should I Use?&nbsp;&nbsp;<small><a href="#whichmethodshouldiuse">&lt;-</a></small></h2>
<p>Informatica generally recommends the use of XML configuration files. They provide a flexible method of controlling configuration that doesn't require changing source code.</p>
<p>For example, a publisher can map sources to transport sessions by topic name using regular expression pattern matching. Other configurations can be customized to specific applications.</p>
<p><br />
 </p>
<h2><a class="anchor" id="configurationerrorhandling"></a>
Configuration Error Handling&nbsp;&nbsp;<small><a href="#configurationerrorhandling">&lt;-</a></small></h2>
<p>Prior to UM version 6.13, an error in a configuration file typically resulted in the remainder of the configuration file not being processed.</p>
<p>As of UM version 6.13, UM will attempt to process the entire configuration file, even if there are errors. Any lines which cannot be properly parsed will generate an error to the logger, but subsequent lines will still be processed.</p>
<p>Note that the API function will return a bad status to indicate that one or more errors were encountered, and the application can decide what to do. For example: </p><div class="fragment"><div class="line">err = <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#aecac05969bba0d6057589ca03dfe60a2">lbm_config</a>(<span class="stringliteral">&quot;test.cfg&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> (err == LBM_FAILURE) {</div><div class="line">  fprintf(stderr, <span class="stringliteral">&quot;Warning, ignoring lbm_config error: %s\n&quot;</span>, <a class="codeRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#a22a4650d3a5b649c84a0c05adedcc055">lbm_errmsg</a>());</div><div class="line">}</div></div><!-- fragment --><p> The last error encountered will be returned by the <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#a22a4650d3a5b649c84a0c05adedcc055">lbm_errmsg()</a> call. Note that all errors are also reported via the UM logger callback; see <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#aae14099b91f2919f424e81f20ca10951">lbm_log()</a>. Thus, if the "test.cfg" file has two errors in it, both will be logged to the logger, and the last one is returned by <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#a22a4650d3a5b649c84a0c05adedcc055">lbm_errmsg()</a>.</p>
<p><b>Why Ignore Errors?</b></p>
<p>Normally an application would want to exit if <a class="elRef" doxygen="/29W/Amun/home/jenkins/backup_exclude.areas/builds/UMQ_6.15/doc/Config/api.tag:../API/" href="../API/lbm_8h.html#aecac05969bba0d6057589ca03dfe60a2">lbm_config()</a> returned an error. However, here is an example use case for considering it a warning and continuing with the application execution.</p>
<p>Let's imagine that future UM version 42.0 has a new configuration option, "receiver predict_next_message 1", which allows receivers to receive messages before they are sent, achieving the elusive goal of negative latency. The user could include this option in the master configuration file, and all applications at version 42.0 and beyond will benefit from negative latencies. Applications at version 6.13 through 41 will log an error when they encounter that option, but will continue to load the rest of the configuration file, and will run normally.</p>
<p>Thus, new configuration options can be included in a master configuration file, and older versions will log warnings about but will still run.</p>
<p>Note however that any pre-6.13 applications will return an error and <em>not</em> process the rest of the configuration file.</p>
<p>Also note that the user must be very careful to examine the error messages logged to ensure that all errors are expected (due to earlier versions not understanding options included for later versions). If lbm_config errors are ignored, it would be easy to overlook a mistyped option and have it not take effect.</p>
<p><b>XML Errors</b></p>
<p>If an XML configuration file is being used, the basic XML structure must be valid for the parser to read the whole file.</p>
<p>For example: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> ?&gt;</div><div class="line">&lt;um-configuration version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;mistake /&gt;</div><div class="line">  &lt;applications&gt;</div><div class="line">    &lt;application&gt;</div><div class="line">      &lt;contexts&gt;</div><div class="line">        &lt;context&gt;</div><div class="line">          &lt;options type=<span class="stringliteral">&quot;context&quot;</span>&gt;</div><div class="line">            &lt;option name=<span class="stringliteral">&quot;request_tcp_port_low&quot;</span> <span class="keywordflow">default</span>-value=<span class="stringliteral">&quot;13000&quot;</span>&gt;</div><div class="line">            &lt;option name=<span class="stringliteral">&quot;request_tcp_port_high&quot;</span> <span class="keywordflow">default</span>-value=<span class="stringliteral">&quot;13010&quot;</span>&gt;</div><div class="line">            &lt;/option&gt;</div><div class="line">          &lt;/options&gt;</div><div class="line">        &lt;/context&gt;</div><div class="line">      &lt;/contexts&gt;</div><div class="line">    &lt;/application&gt;</div><div class="line">  &lt;/applications&gt;</div><div class="line">&lt;/um-configuration&gt;</div></div><!-- fragment --><p> This XML file will be rejected <em>without</em> applying the two request port options because of the "&lt;mistake /&gt;" element.</p>
<p>However, if the XML elements are properly coded, invalid option names or values will follow the same pattern as flat configuration files: errors will be reported, and parsing will continue.</p>
<p>For example: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> ?&gt;</div><div class="line">&lt;um-configuration version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div><div class="line">  &lt;applications&gt;</div><div class="line">    &lt;application&gt;</div><div class="line">      &lt;contexts&gt;</div><div class="line">        &lt;context&gt;</div><div class="line">          &lt;options type=<span class="stringliteral">&quot;context&quot;</span>&gt;</div><div class="line">            &lt;option name=<span class="stringliteral">&quot;mistake&quot;</span> <span class="keywordflow">default</span>-value=<span class="stringliteral">&quot;1&quot;</span>&gt;</div><div class="line">            &lt;option name=<span class="stringliteral">&quot;request_tcp_port_low&quot;</span> <span class="keywordflow">default</span>-value=<span class="stringliteral">&quot;13000&quot;</span>&gt;</div><div class="line">            &lt;option name=<span class="stringliteral">&quot;request_tcp_port_high&quot;</span> <span class="keywordflow">default</span>-value=<span class="stringliteral">&quot;13010&quot;</span>&gt;</div><div class="line">            &lt;/option&gt;</div><div class="line">          &lt;/options&gt;</div><div class="line">        &lt;/context&gt;</div><div class="line">      &lt;/contexts&gt;</div><div class="line">    &lt;/application&gt;</div><div class="line">  &lt;/applications&gt;</div><div class="line">&lt;/um-configuration&gt;</div></div><!-- fragment --><p> This XML file will be accepted and the request TCP port range will be applied. The "mistake" option will log an error. And the API will return LBM_FAILURE, which the application can decide to ignore.</p>
<p><b>Daemon Config Files</b></p>
<p>This behavior of continuing execution in the event of errors is extended to the UMP Store and the DRO for UM configuration configuration files. That is, an error found in a UM configuration file will be logged, and the daemon will continue to run. Users should again be very careful to examine log files to prevent mistyped options from leading to undesired behavior.</p>
<p>However, for the Store and DRO configuration XML files, this "log and continue" error handling is <em>not</em> used. Errors in the Store or DRO configuration files will prevent them from running.</p>
<p><br />
 </p>
<h2><a class="anchor" id="hostnameresolution"></a>
Host Name Resolution&nbsp;&nbsp;<small><a href="#hostnameresolution">&lt;-</a></small></h2>
<p>Many of UM's configuration options specify an IP address. Prior to UM version 6.10 these needed to be specified in dotted numeric format. For example, <b>10.23.19.210</b>. Starting in version 6.10, any configuration option that accepts an IP address can also accept a DNS host name (the few exceptions are noted in the documentation). For example, <b>myhost.mydomain.com</b>. Note that the DNS name system is not necessarily used when host names are specified; for example, most Unix systems will first look up the name in <b>/etc/hosts</b>.</p>
<p>When host names are specified, the name is resolved to an IP address when the configuration option is parsed. If you change the IP address associated with a name, that change will not take effect until the configuration file is re-read, typically by restarting the application.</p>
<p><br />
 </p>
<h2><a class="anchor" id="configurationfiles"></a>
Configuration Files&nbsp;&nbsp;<small><a href="#configurationfiles">&lt;-</a></small></h2>
<p>There are two types of UM Configuration files:</p>
<ul>
<li>
<a class="el" href="xmlconfigurationfiles.html">XML Configuration Files</a> - recommended. </li>
<li>
<a class="el" href="plaintextconfigurationfiles.html">Plain Text Configuration Files</a> </li>
</ul>
<p>You can read Configuration files either by API call, or automatically upon application launch by specifying a file name in an environment variable. See <a class="el" href="index.html#assignmentmethods">Assignment Methods</a> and <a class="el" href="index.html#assignmentflow">Assignment Flow</a> for details on how these options replace or override default values.</p>
<p>There are some UM configuration options which cannot be set via configuration files. These are options whose values are function pointers or data structures. These options can only be set via API functions <b>*_setopt</b>. For example, <b>context resolver_source_notification_function</b> has a function pointer as its value.</p>
<p><br />
<br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
 <br />
</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>
